var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,l)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,__spreadValues=(e,t)=>{for(var l in t||(t={}))__hasOwnProp.call(t,l)&&__defNormalProp(e,l,t[l]);if(__getOwnPropSymbols)for(var l of __getOwnPropSymbols(t))__propIsEnum.call(t,l)&&__defNormalProp(e,l,t[l]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__publicField=(e,t,l)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,l),l);if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((l=>t.resolve(e()).then((()=>l))),(l=>t.resolve(e()).then((()=>{throw l}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e,t){"use strict";var l=(e,t)=>{const l=e.__vccOpts||e;for(const[a,o]of t)l[a]=o;return l};var a=l({name:"u-icon",props:{name:{type:String,default:""},color:{type:String,default:""},size:{type:[Number,String],default:"inherit"},bold:{type:Boolean,default:!1},index:{type:[Number,String],default:""},hoverClass:{type:String,default:""},customPrefix:{type:String,default:"uicon"},label:{type:[String,Number],default:""},labelPos:{type:String,default:"right"},labelSize:{type:[String,Number],default:"28"},labelColor:{type:String,default:"#606266"},marginLeft:{type:[String,Number],default:"6"},marginTop:{type:[String,Number],default:"6"},marginRight:{type:[String,Number],default:"6"},marginBottom:{type:[String,Number],default:"6"},imgMode:{type:String,default:"widthFix"},customStyle:{type:Object,default:()=>({})},width:{type:[String,Number],default:""},height:{type:[String,Number],default:""},top:{type:[String,Number],default:0},showDecimalIcon:{type:Boolean,default:!1},inactiveColor:{type:String,default:"#ececec"},percent:{type:[Number,String],default:"50"}},computed:{customClass(){let e=[];return e.push(this.customPrefix+"-"+this.name),"uicon"==this.customPrefix?e.push("u-iconfont"):e.push(this.customPrefix),this.showDecimalIcon&&this.inactiveColor&&e.push("u-icon__icon--"+this.inactiveColor),e},iconStyle(){let e={};return e={fontSize:"inherit"==this.size?"inherit":this.size,fontWeight:this.bold?"bold":"normal",top:this.top},this.showDecimalIcon&&this.inactiveColor?e.color=this.inactiveColor:this.color&&(e.color=this.color),e},isImg(){return-1!==this.name.indexOf("/")},imgStyle(){let e={};return e.width=this.width?this.width:this.size,e.height=this.height?this.height:this.size,e},decimalIconStyle(){let e={};return e={fontSize:"inherit"==this.size?"inherit":this.size,fontWeight:this.bold?"bold":"normal",top:this.top,width:this.percent+"%"},this.color&&(e.color=this.color),e},decimalIconClass(){let e=[];return e.push(this.customPrefix+"-"+this.name),"uicon"==this.customPrefix?e.push("u-iconfont"):e.push(this.customPrefix),this.color?e.push("u-icon__icon--"+this.color):e.push("u-icon__icon--primary"),e}},methods:{click(){this.$emit("click",this.index)},touchstart(){this.$emit("touchstart",this.index)}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:e.normalizeStyle([a.customStyle]),class:e.normalizeClass(["u-icon",["u-icon--"+a.labelPos]]),onClick:l[1]||(l[1]=(...e)=>i.click&&i.click(...e))},[i.isImg?(e.openBlock(),e.createElementBlock("image",{key:0,class:"u-icon__img",src:a.name,mode:a.imgMode,style:e.normalizeStyle([i.imgStyle])},null,12,["src","mode"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:e.normalizeClass(["u-icon__icon",i.customClass]),style:e.normalizeStyle([i.iconStyle]),"hover-class":a.hoverClass,onTouchstart:l[0]||(l[0]=(...e)=>i.touchstart&&i.touchstart(...e))},[a.showDecimalIcon?(e.openBlock(),e.createElementBlock("text",{key:0,style:e.normalizeStyle([i.decimalIconStyle]),class:e.normalizeClass([i.decimalIconClass,"u-icon__decimal"]),"hover-class":a.hoverClass},null,14,["hover-class"])):e.createCommentVNode("",!0)],46,["hover-class"])),""!==a.label?(e.openBlock(),e.createElementBlock("text",{key:2,class:"u-icon__label",style:e.normalizeStyle({color:a.labelColor,fontSize:a.labelSize,marginLeft:"right"==a.labelPos?a.marginLeft:0,marginTop:"bottom"==a.labelPos?a.marginTop:0,marginRight:"left"==a.labelPos?a.marginRight:0,marginBottom:"top"==a.labelPos?a.marginBottom:0})},e.toDisplayString(a.label),5)):e.createCommentVNode("",!0)],6)}],["__scopeId","data-v-68ca13ff"]]);function o(e,l){return"Function"===t.toRawType(l)?"function() { [native code] }":l}function n(e,l,a){if("string"==typeof __channelId__&&__channelId__)return a.push(l.replace("at ","uni-app:///")),console[e].apply(console,a);return a.map((function(e){const l=t.toTypeString(e).toLowerCase();if(-1!==["[object object]","[object array]","[object module]"].indexOf(l))try{e="---BEGIN:JSON---"+JSON.stringify(e,o)+"---END:JSON---"}catch(Mn){e=l}else if(null===e)e="---NULL---";else if(void 0===e)e="---UNDEFINED---";else{const l=t.toRawType(e).toUpperCase();e="NUMBER"===l||"BOOLEAN"===l?"---BEGIN:"+l+"---"+e+"---END:"+l+"---":String(e)}return e})).join("---COMMA---")+" "+l}function i(e,t,...l){const a=n(e,t,l);a&&console[e](a)}function r(e,l){return t.isString(e)?l:e}const s=t=>(l,a=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(t,l,a)},c=s("onShow"),d=s("onHide"),u=s("onLaunch"),m=s("onReachBottom"),p=s("onPullDownRefresh");function v(e,t,l=!1){l?uni.setStorageSync(e,t):uni.setStorage({key:e,data:t})}function h(e,t=!1){return t?new Promise((function(t,l){uni.getStorage({key:e,success:({data:e})=>t(e),fail:e=>l(e)})})):uni.getStorageSync(e)}function f(e=!1){e?uni.clearStorageSync():uni.clearStorage()}class g{}__publicField(g,"TokenNoExist",-201),__publicField(g,"TokenInvalid",202),__publicField(g,"OK",0);class y{constructor({Code:e,Message:t,Data:l}){__publicField(this,"Code"),__publicField(this,"Message"),__publicField(this,"Data"),this.Code=e,this.Message=t,this.Data=l}}const w="X-Token";function N(){return h(w)}const C={system:1,asset:2,consumable:3,myWork:4,OBPProject:5,file:Symbol()},E=class{static get(e){switch(e){case C.asset:return E.asset;case C.consumable:return E.consumable;case C.file:return E.file;case C.myWork:return E.myWork;case C.system:return E.system;case e.OBPProject:return E.OBPProject;default:throw`找不到产品-${e}`}}static set(e,t){switch(e){case C.asset:return void(E.asset=t);case C.consumable:return void(E.consumable=t);case C.file:return void(E.file=t);case C.myWork:return void(E.myWork=t);case C.system:return void(E.system=t);case C.OBPProject:E.OBPProject=t;default:throw`找不到产品-${e}`}}};let b=E;function D(e){return b.file+e}function V(e,t){return b.get(e)+t}function k(e){e=B(e),uni.navigateTo({url:e})}function x(e){e=B(e),uni.redirectTo({url:e})}function _(e){e=B(e),uni.reLaunch({url:e})}function S(e){uni.navigateBack({delta:e})}function I(){f(),_("pages/login/login")}function B(e){return e.startsWith(".")||e.startsWith("/")?e:"/"+e}function T(e){return""===e||null==e}function A(e=0){return new Promise((function(t){setTimeout((function(){t({})}),e)}))}function P(e,t){for(const l of t){if(l.Code===e)return l;if(l.Children&&l.Children.length){const t=P(e,l.Children);if(t)return t}}}function O(e,t){for(const l of t){const t=P(e,l.Menus);if(t)return t}return!1}function R(e){return e.startsWith("http")?function(e,t){var l=(t=decodeURIComponent(t)).indexOf(e+"=");if(-1===l)return"";var a=t.indexOf("&",l);return-1===a&&(a=void 0),t.substring(l,a).split("=")[1]||""}("Code",e):e}function L(e){e.length>7?uni.showToast({title:e,icon:"none"}):uni.showToast({title:e,icon:"success"})}function F(e){e.length>7?uni.showToast({title:e,icon:"none"}):uni.showToast({title:e,icon:"error"})}function q(){uni.showLoading({mask:!0,title:"加载中"})}function z(){uni.hideLoading()}function U(){z(),uni.hideToast()}__publicField(b,"system","http://192.168.0.215:8001"),__publicField(b,"asset","http://192.168.0.215:8002"),__publicField(b,"consumable","http://192.168.0.215:8004"),__publicField(b,"file","http://192.168.0.215:8003"),__publicField(b,"myWork","http://192.168.0.215:8006"),__publicField(b,"ws","ws://192.168.0.215:8002"),__publicField(b,"OBPProject","http://192.168.0.215:8013");const M={image:"image",video:"video",audio:"audio"},W={post:"post",get:"get",put:"put",delete:"delete"};function $(e,t,l,a){if(!W.hasOwnProperty(l))throw`无效的请求类型-${l}`;return new Promise((function(o,n){uni.request({url:e,header:t,method:l,data:a,success:e=>{200===e.statusCode?o(e):n(e)},fail:e=>n(e)})}))}function Q(){const e=getCurrentPages();return e[e.length-1]}function j(){return Q().route}const H=["pages/login/login","pages/login/appletLogin"];function K(e,t,l){const{header:a,url:o}=Y(e,t);return Z(o,a,l)}function G(e,t){const l=N();if(!H.includes(j())&&T(l))return void I();return Z(e,{[w]:l},t)}function J(e,t,l,a){const{header:o,url:n}=Y(e,t);return function(e,t,l,a){return new Promise((function(o,n){(function(e,t,l,a){if(!M.hasOwnProperty(l))throw`无效的文件类型-${l}`;return new Promise((function(o,n){uni.uploadFile({url:e,filePath:a,fileType:l,header:t,name:"file",success:e=>{e.data=JSON.parse(e.data),200===e.statusCode?o(e):n(e)},fail:e=>n(e)})}))})(e,t,l,a).then((e=>X(e,o,n))).catch((t=>ee(e,t,n)))}))}(n,o,l,a)}function Y(e,t){const l=N(),a={[w]:l};if(H.includes(j())||!T(l))return{header:a,url:t=b.get(e)+t};I()}function Z(e,t,l){return new Promise((function(a,o){$(e,t,W.post,{Data:l}).then((e=>X(e,a,o))).catch((t=>ee(e,t,o)))}))}function X({data:e},t,l){const a=new y(e);return a.Code===g.TokenNoExist||a.Code===g.TokenInvalid?(I(),void l({})):a.Code!==g.OK?(F(a.Message),void l(a.Data)):void t(a.Data)}function ee(e,t,l){F(`地址【${e}】无法访问,请检查网络或联系管理员`),l(t)}class te{constructor(e,t){this.billName=e,this.product=t}httpRequest(...e){return K(this.product,...e)}httpUpload(...e){return J(this.product,...e)}preStartFlow(e){return K(this.product,`/Bill/${this.billName}/PreStartFlow`,{ID:e})}startFlow(e){return K(this.product,`/Bill/${this.billName}/StartFlow`,e)}prevApproval(e){return K(this.product,`/Bill/${this.billName}/PrevApproval`,{ID:e})}submitApproval(e){return K(this.product,`/Bill/${this.billName}/SubmitApproval`,e)}getFlowTrail(e){return K(this.product,`/Bill/${this.billName}/GetFlowTrail`,{ID:e})}}const le=C.system;class ae extends te{constructor(e){super(e,le)}request(e,t){return super.httpRequest(e,t)}}var oe=new class extends ae{constructor(){super("system")}getTenantIDByUser(e){return this.request("/User/GetTenantIDByUser",{UserName:e})}getUser(e){return this.request("/Employee/GetByID",e)}login(e){return this.request("/User/Login",e)}ddLogin(e,t,l){return this.request("/User/Platform/ddLogin",{Code:e,UserName:t,Password:l})}wxLogin(e,t,l){return this.request("/User/Platform/wxLogin",{Code:e,UserName:t,Password:l})}getkinds(){return this.request("/User/Menu/Mine",{Product:2})}getEmployeekinds(){return this.request("/User/Menu/Employee",{IsPower:!1})}quickLogin(e,t){return this.getTenantIDByUser(e).then((l=>(v("TenantID",l),this.login({SessionID:"",VerifyCode:"9",UserName:e,Password:t,TenantID:l}))))}};const ne=1,ie=2,re=3;let se;se=ne;function ce(e,t,l=!0){var a;a=e.Token,v(w,a,!0),v("directlyLogin",l,!0),v("AssetDicSettings",JSON.stringify(e.AssetDicSettings),!0),v("SystemPasswordPolicy",JSON.stringify(e.UserSetting.SystemPasswordPolicy),!0),v("UserType",e.User.UserType,!0),v("isAdmin",e.User.isAdmin,!0),v("UserName",e.User.Name,!0),v("User",JSON.stringify(e.User),!0),v("UserCode",e.User.EmployeeCode,!0),v("UserID",e.User.ID,!0),v("Corp",JSON.stringify(e.User.Corp),!0),v("CorpID",e.User.Corp.ID,!0),v("CorpName",e.User.Corp.Name,!0),v("OrgID",e.User.Dept.ID,!0),v("OrgName",e.User.Dept.Name,!0),v("EmployeeID",e.User.EmployeeID,!0),v("SystemVersion",e.AuthorizationInfo.Version,!0),v("ConsumableDicSettings",e.ConsumableDicSettings,!0),z(),x("1"!==t?"/pages/home/home":"/pages/mine/todo/todo")}var de=l({props:{link:String},setup({link:t}){const l=e.ref(""),a=e.ref("");function o(e,l){dd.getAuthCode({success:({authCode:a})=>{oe.ddLogin(a,e,l).then((e=>ce(e,t))).catch((()=>z()))},fail:()=>{}})}function n(e,l){wx.login({success({code:a}){a?oe.wxLogin(a,e,l).then((e=>ce(e,t))).catch((()=>z())):F("登录失败！"+res.errMsg)}})}if(h("directlyLogin"))switch(q(),se){case ie:n();break;case re:o();break;default:return void z()}return{setting:function(){k("pages/login/setting")},name:h("UserName"),isAppPlatform:!0,login:function(){if(0!=l.value.length)if(0!=a.value.length)switch(q(),se){case ie:n(l.value,a.value);break;case re:o(l.value,a.value);break;default:oe.quickLogin(l.value,a.value).then((e=>ce(e,t,!1))).catch((()=>z()))}else F("请输入密码");else F("请输入用户名")},uid:l,pwd:a,loginBackgroundImage:`url('${D("/static/bg_beijing.jpg")}')`}}},[["render",function(t,l,o,n,i,s){const c=r(e.resolveDynamicComponent("u-icon"),a);return e.openBlock(),e.createElementBlock("view",{class:"login",style:e.normalizeStyle({backgroundImage:n.loginBackgroundImage})},[e.createElementVNode("view",{class:"van-overlay",style:{"z-index":"2001",display:"none"}}),e.createElementVNode("view",{role:"dialog","aria-labelledby":"用户协议和隐私政策概要",class:"Agreement van-dialog",style:{"z-index":"2002",display:"none"}},[e.createElementVNode("view",{class:"van-dialog__header"},"用户协议和隐私政策概要"),e.createElementVNode("view",{class:"van-dialog__content"},[e.createElementVNode("ul",null,[e.createElementVNode("li",null," 欢迎使用后勤之星APP！在您使用后勤之星APP前，请认真阅读并充分理解以下条款: "),e.createElementVNode("li",{class:"Jump"},"《用户协议/隐私政策》"),e.createElementVNode("li",null,'如果同意以上条款，请点击"同意"开始接收我们的服务。')])]),e.createElementVNode("view",{class:"van-hairline--top van-dialog__footer van-dialog__footer--buttons"},[e.createElementVNode("button",{class:"van-button van-button--default van-button--large van-dialog__cancel"},[e.createElementVNode("span",{class:"van-button__text"},"不同意")]),e.createElementVNode("button",{class:"van-button van-button--default van-button--large van-dialog__confirm van-hairline--left"},[e.createElementVNode("span",{class:"van-button__text"},"同意")])])]),e.createElementVNode("view",{class:"head"},[e.createElementVNode("span",null,[e.createTextVNode(" Hello！  "),n.name?(e.openBlock(),e.createElementBlock("span",{key:0},e.toDisplayString(n.name),1)):e.createCommentVNode("",!0),e.createElementVNode("br"),e.createElementVNode("br"),e.createElementVNode("span",null,"欢迎回来")]),n.isAppPlatform?(e.openBlock(),e.createElementBlock("span",{key:0,class:"right"},[e.createVNode(c,{name:"setting",size:"33px",onClick:n.setting},null,8,["onClick"])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"loginContainer"},[e.createElementVNode("view",{class:"van-cell-group van-hairline--top-bottom"},[e.createElementVNode("view",{class:"van-cell van-field"},[e.createElementVNode("view",{class:"van-cell__title van-field__label"},[e.createElementVNode("span",null,"用户名")]),e.createElementVNode("view",{class:"van-cell__value"},[e.createElementVNode("view",{class:"van-field__body"},[e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"请输入用户名",class:"van-field__control","onUpdate:modelValue":l[0]||(l[0]=e=>n.uid=e)},null,512),[[e.vModelText,n.uid]])])])]),e.createElementVNode("view",{class:"van-cell van-field"},[e.createElementVNode("view",{class:"van-cell__title van-field__label"},[e.createElementVNode("span",null,"密码")]),e.createElementVNode("view",{class:"van-cell__value"},[e.createElementVNode("view",{class:"van-field__body"},[e.withDirectives(e.createElementVNode("input",{password:"",placeholder:"请输入密码",maxlength:"50",class:"van-field__control","onUpdate:modelValue":l[1]||(l[1]=e=>n.pwd=e)},null,512),[[e.vModelText,n.pwd]])])])])]),e.createElementVNode("view",{class:"center"},[e.createElementVNode("button",{class:"surebth van-button van-button--default van-button--normal center",onClick:l[2]||(l[2]=(...e)=>n.login&&n.login(...e))},[e.createElementVNode("span",{class:"van-button__text"},"登录")])]),e.createElementVNode("view",{class:"bomm_img"},[e.createElementVNode("image",{src:"/static/images/bg_logo.png"})])])],4)}],["__scopeId","data-v-493ae8ad"]]);var ue=l({inheritAttrs:!1,name:"UniSection",emits:["click"],props:{type:{type:String,default:""},title:{type:String,default:""},color:{type:String,default:"#333"},subTitle:{type:String,default:""},padding:{type:Boolean,default:!1}},data:()=>({}),watch:{title(e){uni.report&&""!==e&&uni.report("title",e)}},methods:{onClick(){this.$emit("click")}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-section"},[e.createElementVNode("view",{class:"uni-section-header",nvue:""},[a.type?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-section__head"},[e.createElementVNode("view",{class:e.normalizeClass([a.type,"uni-section__head-tag"])},null,2)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-section__content"},[e.createElementVNode("text",{class:e.normalizeClass([{distraction:!a.subTitle},"uni-section__content-title"]),style:e.normalizeStyle({color:a.color})},e.toDisplayString(a.title),7),a.subTitle?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-section__content-sub"},e.toDisplayString(a.subTitle),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{style:e.normalizeStyle({padding:a.padding?"10px":""})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],4)])}],["__scopeId","data-v-20b8ddc2"]]);var me=l({name:"UniGridItem",inject:["grid"],props:{index:{type:Number,default:0}},data:()=>({column:0,showBorder:!0,square:!0,highlight:!0,left:0,top:0,openNum:2,width:0,borderColor:"#e5e5e5"}),created(){this.column=this.grid.column,this.showBorder=this.grid.showBorder,this.square=this.grid.square,this.highlight=this.grid.highlight,this.top=0===this.hor?this.grid.hor:this.hor,this.left=0===this.ver?this.grid.ver:this.ver,this.borderColor=this.grid.borderColor,this.grid.children.push(this),this.width=this.grid.width},beforeDestroy(){this.grid.children.forEach(((e,t)=>{e===this&&this.grid.children.splice(t,1)}))},methods:{_onClick(){this.grid.change({detail:{index:this.index}})}}},[["render",function(t,l,a,o,n,i){return n.width?(e.openBlock(),e.createElementBlock("view",{key:0,style:e.normalizeStyle("width:"+n.width+";"+(n.square?"height:"+n.width:"")),class:"uni-grid-item"},[e.createElementVNode("view",{class:e.normalizeClass([{"uni-grid-item--border":n.showBorder,"uni-grid-item--border-top":n.showBorder&&a.index<n.column,"uni-highlight":n.highlight},"uni-grid-item__box"]),style:e.normalizeStyle({"border-right-color":n.borderColor,"border-bottom-color":n.borderColor,"border-top-color":n.borderColor}),onClick:l[0]||(l[0]=(...e)=>i._onClick&&i._onClick(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)],4)):e.createCommentVNode("",!0)}],["__scopeId","data-v-03164978"]]);const pe={name:"UniGrid",emits:["change"],props:{column:{type:Number,default:3},showBorder:{type:Boolean,default:!0},borderColor:{type:String,default:"#D2D2D2"},square:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0}},provide(){return{grid:this}},data:()=>({elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,width:0}),created(){this.children=[]},mounted(){this.$nextTick((()=>{this.init()}))},methods:{init(){setTimeout((()=>{this._getSize((e=>{this.children.forEach(((t,l)=>{t.width=e}))}))}),50)},change(e){this.$emit("change",e)},_getSize(e){uni.createSelectorQuery().in(this).select(`#${this.elId}`).boundingClientRect().exec((t=>{this.width=parseInt((t[0].width-1)/this.column)+"px",e(this.width)}))}}};var ve=l(pe,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-grid-wrap"},[e.createElementVNode("view",{id:n.elId,ref:"uni-grid",class:e.normalizeClass(["uni-grid",{"uni-grid--border":a.showBorder}]),style:e.normalizeStyle({"border-left-color":a.borderColor})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],14,["id"])])}],["__scopeId","data-v-32f05aa8"]]),he={id:"2852637",name:"uniui图标库",font_family:"uniicons",css_prefix_text:"uniui-",description:"",glyphs:[{icon_id:"25027049",name:"yanse",font_class:"color",unicode:"e6cf",unicode_decimal:59087},{icon_id:"25027048",name:"wallet",font_class:"wallet",unicode:"e6b1",unicode_decimal:59057},{icon_id:"25015720",name:"settings-filled",font_class:"settings-filled",unicode:"e6ce",unicode_decimal:59086},{icon_id:"25015434",name:"shimingrenzheng-filled",font_class:"auth-filled",unicode:"e6cc",unicode_decimal:59084},{icon_id:"24934246",name:"shop-filled",font_class:"shop-filled",unicode:"e6cd",unicode_decimal:59085},{icon_id:"24934159",name:"staff-filled-01",font_class:"staff-filled",unicode:"e6cb",unicode_decimal:59083},{icon_id:"24932461",name:"VIP-filled",font_class:"vip-filled",unicode:"e6c6",unicode_decimal:59078},{icon_id:"24932462",name:"plus_circle_fill",font_class:"plus-filled",unicode:"e6c7",unicode_decimal:59079},{icon_id:"24932463",name:"folder_add-filled",font_class:"folder-add-filled",unicode:"e6c8",unicode_decimal:59080},{icon_id:"24932464",name:"yanse-filled",font_class:"color-filled",unicode:"e6c9",unicode_decimal:59081},{icon_id:"24932465",name:"tune-filled",font_class:"tune-filled",unicode:"e6ca",unicode_decimal:59082},{icon_id:"24932455",name:"a-rilidaka-filled",font_class:"calendar-filled",unicode:"e6c0",unicode_decimal:59072},{icon_id:"24932456",name:"notification-filled",font_class:"notification-filled",unicode:"e6c1",unicode_decimal:59073},{icon_id:"24932457",name:"wallet-filled",font_class:"wallet-filled",unicode:"e6c2",unicode_decimal:59074},{icon_id:"24932458",name:"paihangbang-filled",font_class:"medal-filled",unicode:"e6c3",unicode_decimal:59075},{icon_id:"24932459",name:"gift-filled",font_class:"gift-filled",unicode:"e6c4",unicode_decimal:59076},{icon_id:"24932460",name:"fire-filled",font_class:"fire-filled",unicode:"e6c5",unicode_decimal:59077},{icon_id:"24928001",name:"refreshempty",font_class:"refreshempty",unicode:"e6bf",unicode_decimal:59071},{icon_id:"24926853",name:"location-ellipse",font_class:"location-filled",unicode:"e6af",unicode_decimal:59055},{icon_id:"24926735",name:"person-filled",font_class:"person-filled",unicode:"e69d",unicode_decimal:59037},{icon_id:"24926703",name:"personadd-filled",font_class:"personadd-filled",unicode:"e698",unicode_decimal:59032},{icon_id:"24923351",name:"back",font_class:"back",unicode:"e6b9",unicode_decimal:59065},{icon_id:"24923352",name:"forward",font_class:"forward",unicode:"e6ba",unicode_decimal:59066},{icon_id:"24923353",name:"arrowthinright",font_class:"arrow-right",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923353",name:"arrowthinright",font_class:"arrowthinright",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrow-left",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrowthinleft",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923355",name:"arrowthinup",font_class:"arrow-up",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923355",name:"arrowthinup",font_class:"arrowthinup",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923356",name:"arrowthindown",font_class:"arrow-down",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923356",name:"arrowthindown",font_class:"arrowthindown",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923349",name:"arrowdown",font_class:"bottom",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923349",name:"arrowdown",font_class:"arrowdown",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923346",name:"arrowright",font_class:"right",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923346",name:"arrowright",font_class:"arrowright",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923347",name:"arrowup",font_class:"top",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923347",name:"arrowup",font_class:"arrowup",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923348",name:"arrowleft",font_class:"left",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923348",name:"arrowleft",font_class:"arrowleft",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923334",name:"eye",font_class:"eye",unicode:"e651",unicode_decimal:58961},{icon_id:"24923335",name:"eye-filled",font_class:"eye-filled",unicode:"e66a",unicode_decimal:58986},{icon_id:"24923336",name:"eye-slash",font_class:"eye-slash",unicode:"e6b3",unicode_decimal:59059},{icon_id:"24923337",name:"eye-slash-filled",font_class:"eye-slash-filled",unicode:"e6b4",unicode_decimal:59060},{icon_id:"24923305",name:"info-filled",font_class:"info-filled",unicode:"e649",unicode_decimal:58953},{icon_id:"24923299",name:"reload-01",font_class:"reload",unicode:"e6b2",unicode_decimal:59058},{icon_id:"24923195",name:"mic_slash_fill",font_class:"micoff-filled",unicode:"e6b0",unicode_decimal:59056},{icon_id:"24923165",name:"map-pin-ellipse",font_class:"map-pin-ellipse",unicode:"e6ac",unicode_decimal:59052},{icon_id:"24923166",name:"map-pin",font_class:"map-pin",unicode:"e6ad",unicode_decimal:59053},{icon_id:"24923167",name:"location",font_class:"location",unicode:"e6ae",unicode_decimal:59054},{icon_id:"24923064",name:"starhalf",font_class:"starhalf",unicode:"e683",unicode_decimal:59011},{icon_id:"24923065",name:"star",font_class:"star",unicode:"e688",unicode_decimal:59016},{icon_id:"24923066",name:"star-filled",font_class:"star-filled",unicode:"e68f",unicode_decimal:59023},{icon_id:"24899646",name:"a-rilidaka",font_class:"calendar",unicode:"e6a0",unicode_decimal:59040},{icon_id:"24899647",name:"fire",font_class:"fire",unicode:"e6a1",unicode_decimal:59041},{icon_id:"24899648",name:"paihangbang",font_class:"medal",unicode:"e6a2",unicode_decimal:59042},{icon_id:"24899649",name:"font",font_class:"font",unicode:"e6a3",unicode_decimal:59043},{icon_id:"24899650",name:"gift",font_class:"gift",unicode:"e6a4",unicode_decimal:59044},{icon_id:"24899651",name:"link",font_class:"link",unicode:"e6a5",unicode_decimal:59045},{icon_id:"24899652",name:"notification",font_class:"notification",unicode:"e6a6",unicode_decimal:59046},{icon_id:"24899653",name:"staff",font_class:"staff",unicode:"e6a7",unicode_decimal:59047},{icon_id:"24899654",name:"VIP",font_class:"vip",unicode:"e6a8",unicode_decimal:59048},{icon_id:"24899655",name:"folder_add",font_class:"folder-add",unicode:"e6a9",unicode_decimal:59049},{icon_id:"24899656",name:"tune",font_class:"tune",unicode:"e6aa",unicode_decimal:59050},{icon_id:"24899657",name:"shimingrenzheng",font_class:"auth",unicode:"e6ab",unicode_decimal:59051},{icon_id:"24899565",name:"person",font_class:"person",unicode:"e699",unicode_decimal:59033},{icon_id:"24899566",name:"email-filled",font_class:"email-filled",unicode:"e69a",unicode_decimal:59034},{icon_id:"24899567",name:"phone-filled",font_class:"phone-filled",unicode:"e69b",unicode_decimal:59035},{icon_id:"24899568",name:"phone",font_class:"phone",unicode:"e69c",unicode_decimal:59036},{icon_id:"24899570",name:"email",font_class:"email",unicode:"e69e",unicode_decimal:59038},{icon_id:"24899571",name:"personadd",font_class:"personadd",unicode:"e69f",unicode_decimal:59039},{icon_id:"24899558",name:"chatboxes-filled",font_class:"chatboxes-filled",unicode:"e692",unicode_decimal:59026},{icon_id:"24899559",name:"contact",font_class:"contact",unicode:"e693",unicode_decimal:59027},{icon_id:"24899560",name:"chatbubble-filled",font_class:"chatbubble-filled",unicode:"e694",unicode_decimal:59028},{icon_id:"24899561",name:"contact-filled",font_class:"contact-filled",unicode:"e695",unicode_decimal:59029},{icon_id:"24899562",name:"chatboxes",font_class:"chatboxes",unicode:"e696",unicode_decimal:59030},{icon_id:"24899563",name:"chatbubble",font_class:"chatbubble",unicode:"e697",unicode_decimal:59031},{icon_id:"24881290",name:"upload-filled",font_class:"upload-filled",unicode:"e68e",unicode_decimal:59022},{icon_id:"24881292",name:"upload",font_class:"upload",unicode:"e690",unicode_decimal:59024},{icon_id:"24881293",name:"weixin",font_class:"weixin",unicode:"e691",unicode_decimal:59025},{icon_id:"24881274",name:"compose",font_class:"compose",unicode:"e67f",unicode_decimal:59007},{icon_id:"24881275",name:"qq",font_class:"qq",unicode:"e680",unicode_decimal:59008},{icon_id:"24881276",name:"download-filled",font_class:"download-filled",unicode:"e681",unicode_decimal:59009},{icon_id:"24881277",name:"pengyouquan",font_class:"pyq",unicode:"e682",unicode_decimal:59010},{icon_id:"24881279",name:"sound",font_class:"sound",unicode:"e684",unicode_decimal:59012},{icon_id:"24881280",name:"trash-filled",font_class:"trash-filled",unicode:"e685",unicode_decimal:59013},{icon_id:"24881281",name:"sound-filled",font_class:"sound-filled",unicode:"e686",unicode_decimal:59014},{icon_id:"24881282",name:"trash",font_class:"trash",unicode:"e687",unicode_decimal:59015},{icon_id:"24881284",name:"videocam-filled",font_class:"videocam-filled",unicode:"e689",unicode_decimal:59017},{icon_id:"24881285",name:"spinner-cycle",font_class:"spinner-cycle",unicode:"e68a",unicode_decimal:59018},{icon_id:"24881286",name:"weibo",font_class:"weibo",unicode:"e68b",unicode_decimal:59019},{icon_id:"24881288",name:"videocam",font_class:"videocam",unicode:"e68c",unicode_decimal:59020},{icon_id:"24881289",name:"download",font_class:"download",unicode:"e68d",unicode_decimal:59021},{icon_id:"24879601",name:"help",font_class:"help",unicode:"e679",unicode_decimal:59001},{icon_id:"24879602",name:"navigate-filled",font_class:"navigate-filled",unicode:"e67a",unicode_decimal:59002},{icon_id:"24879603",name:"plusempty",font_class:"plusempty",unicode:"e67b",unicode_decimal:59003},{icon_id:"24879604",name:"smallcircle",font_class:"smallcircle",unicode:"e67c",unicode_decimal:59004},{icon_id:"24879605",name:"minus-filled",font_class:"minus-filled",unicode:"e67d",unicode_decimal:59005},{icon_id:"24879606",name:"micoff",font_class:"micoff",unicode:"e67e",unicode_decimal:59006},{icon_id:"24879588",name:"closeempty",font_class:"closeempty",unicode:"e66c",unicode_decimal:58988},{icon_id:"24879589",name:"clear",font_class:"clear",unicode:"e66d",unicode_decimal:58989},{icon_id:"24879590",name:"navigate",font_class:"navigate",unicode:"e66e",unicode_decimal:58990},{icon_id:"24879591",name:"minus",font_class:"minus",unicode:"e66f",unicode_decimal:58991},{icon_id:"24879592",name:"image",font_class:"image",unicode:"e670",unicode_decimal:58992},{icon_id:"24879593",name:"mic",font_class:"mic",unicode:"e671",unicode_decimal:58993},{icon_id:"24879594",name:"paperplane",font_class:"paperplane",unicode:"e672",unicode_decimal:58994},{icon_id:"24879595",name:"close",font_class:"close",unicode:"e673",unicode_decimal:58995},{icon_id:"24879596",name:"help-filled",font_class:"help-filled",unicode:"e674",unicode_decimal:58996},{icon_id:"24879597",name:"plus-filled",font_class:"paperplane-filled",unicode:"e675",unicode_decimal:58997},{icon_id:"24879598",name:"plus",font_class:"plus",unicode:"e676",unicode_decimal:58998},{icon_id:"24879599",name:"mic-filled",font_class:"mic-filled",unicode:"e677",unicode_decimal:58999},{icon_id:"24879600",name:"image-filled",font_class:"image-filled",unicode:"e678",unicode_decimal:59e3},{icon_id:"24855900",name:"locked-filled",font_class:"locked-filled",unicode:"e668",unicode_decimal:58984},{icon_id:"24855901",name:"info",font_class:"info",unicode:"e669",unicode_decimal:58985},{icon_id:"24855903",name:"locked",font_class:"locked",unicode:"e66b",unicode_decimal:58987},{icon_id:"24855884",name:"camera-filled",font_class:"camera-filled",unicode:"e658",unicode_decimal:58968},{icon_id:"24855885",name:"chat-filled",font_class:"chat-filled",unicode:"e659",unicode_decimal:58969},{icon_id:"24855886",name:"camera",font_class:"camera",unicode:"e65a",unicode_decimal:58970},{icon_id:"24855887",name:"circle",font_class:"circle",unicode:"e65b",unicode_decimal:58971},{icon_id:"24855888",name:"checkmarkempty",font_class:"checkmarkempty",unicode:"e65c",unicode_decimal:58972},{icon_id:"24855889",name:"chat",font_class:"chat",unicode:"e65d",unicode_decimal:58973},{icon_id:"24855890",name:"circle-filled",font_class:"circle-filled",unicode:"e65e",unicode_decimal:58974},{icon_id:"24855891",name:"flag",font_class:"flag",unicode:"e65f",unicode_decimal:58975},{icon_id:"24855892",name:"flag-filled",font_class:"flag-filled",unicode:"e660",unicode_decimal:58976},{icon_id:"24855893",name:"gear-filled",font_class:"gear-filled",unicode:"e661",unicode_decimal:58977},{icon_id:"24855894",name:"home",font_class:"home",unicode:"e662",unicode_decimal:58978},{icon_id:"24855895",name:"home-filled",font_class:"home-filled",unicode:"e663",unicode_decimal:58979},{icon_id:"24855896",name:"gear",font_class:"gear",unicode:"e664",unicode_decimal:58980},{icon_id:"24855897",name:"smallcircle-filled",font_class:"smallcircle-filled",unicode:"e665",unicode_decimal:58981},{icon_id:"24855898",name:"map-filled",font_class:"map-filled",unicode:"e666",unicode_decimal:58982},{icon_id:"24855899",name:"map",font_class:"map",unicode:"e667",unicode_decimal:58983},{icon_id:"24855825",name:"refresh-filled",font_class:"refresh-filled",unicode:"e656",unicode_decimal:58966},{icon_id:"24855826",name:"refresh",font_class:"refresh",unicode:"e657",unicode_decimal:58967},{icon_id:"24855808",name:"cloud-upload",font_class:"cloud-upload",unicode:"e645",unicode_decimal:58949},{icon_id:"24855809",name:"cloud-download-filled",font_class:"cloud-download-filled",unicode:"e646",unicode_decimal:58950},{icon_id:"24855810",name:"cloud-download",font_class:"cloud-download",unicode:"e647",unicode_decimal:58951},{icon_id:"24855811",name:"cloud-upload-filled",font_class:"cloud-upload-filled",unicode:"e648",unicode_decimal:58952},{icon_id:"24855813",name:"redo",font_class:"redo",unicode:"e64a",unicode_decimal:58954},{icon_id:"24855814",name:"images-filled",font_class:"images-filled",unicode:"e64b",unicode_decimal:58955},{icon_id:"24855815",name:"undo-filled",font_class:"undo-filled",unicode:"e64c",unicode_decimal:58956},{icon_id:"24855816",name:"more",font_class:"more",unicode:"e64d",unicode_decimal:58957},{icon_id:"24855817",name:"more-filled",font_class:"more-filled",unicode:"e64e",unicode_decimal:58958},{icon_id:"24855818",name:"undo",font_class:"undo",unicode:"e64f",unicode_decimal:58959},{icon_id:"24855819",name:"images",font_class:"images",unicode:"e650",unicode_decimal:58960},{icon_id:"24855821",name:"paperclip",font_class:"paperclip",unicode:"e652",unicode_decimal:58962},{icon_id:"24855822",name:"settings",font_class:"settings",unicode:"e653",unicode_decimal:58963},{icon_id:"24855823",name:"search",font_class:"search",unicode:"e654",unicode_decimal:58964},{icon_id:"24855824",name:"redo-filled",font_class:"redo-filled",unicode:"e655",unicode_decimal:58965},{icon_id:"24841702",name:"list",font_class:"list",unicode:"e644",unicode_decimal:58948},{icon_id:"24841489",name:"mail-open-filled",font_class:"mail-open-filled",unicode:"e63a",unicode_decimal:58938},{icon_id:"24841491",name:"hand-thumbsdown-filled",font_class:"hand-down-filled",unicode:"e63c",unicode_decimal:58940},{icon_id:"24841492",name:"hand-thumbsdown",font_class:"hand-down",unicode:"e63d",unicode_decimal:58941},{icon_id:"24841493",name:"hand-thumbsup-filled",font_class:"hand-up-filled",unicode:"e63e",unicode_decimal:58942},{icon_id:"24841494",name:"hand-thumbsup",font_class:"hand-up",unicode:"e63f",unicode_decimal:58943},{icon_id:"24841496",name:"heart-filled",font_class:"heart-filled",unicode:"e641",unicode_decimal:58945},{icon_id:"24841498",name:"mail-open",font_class:"mail-open",unicode:"e643",unicode_decimal:58947},{icon_id:"24841488",name:"heart",font_class:"heart",unicode:"e639",unicode_decimal:58937},{icon_id:"24839963",name:"loop",font_class:"loop",unicode:"e633",unicode_decimal:58931},{icon_id:"24839866",name:"pulldown",font_class:"pulldown",unicode:"e632",unicode_decimal:58930},{icon_id:"24813798",name:"scan",font_class:"scan",unicode:"e62a",unicode_decimal:58922},{icon_id:"24813786",name:"bars",font_class:"bars",unicode:"e627",unicode_decimal:58919},{icon_id:"24813788",name:"cart-filled",font_class:"cart-filled",unicode:"e629",unicode_decimal:58921},{icon_id:"24813790",name:"checkbox",font_class:"checkbox",unicode:"e62b",unicode_decimal:58923},{icon_id:"24813791",name:"checkbox-filled",font_class:"checkbox-filled",unicode:"e62c",unicode_decimal:58924},{icon_id:"24813794",name:"shop",font_class:"shop",unicode:"e62f",unicode_decimal:58927},{icon_id:"24813795",name:"headphones",font_class:"headphones",unicode:"e630",unicode_decimal:58928},{icon_id:"24813796",name:"cart",font_class:"cart",unicode:"e631",unicode_decimal:58929}]};var fe=l({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""}},data:()=>({icons:he.glyphs}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?unescape(`%u${e.unicode}`):""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e}},methods:{_onClick(){this.$emit("click")}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("text",{style:e.normalizeStyle({color:a.color,"font-size":i.iconSize}),class:e.normalizeClass(["uni-icons",["uniui-"+a.type,a.customPrefix,a.customPrefix?a.type:""]]),onClick:l[0]||(l[0]=(...e)=>i._onClick&&i._onClick(...e))},null,6)}],["__scopeId","data-v-a0895554"]]);var ge=l({name:"UniBadge",emits:["click"],props:{type:{type:String,default:"error"},inverted:{type:Boolean,default:!1},isDot:{type:Boolean,default:!1},maxNum:{type:Number,default:99},absolute:{type:String,default:""},offset:{type:Array,default:()=>[0,0]},text:{type:[String,Number],default:""},size:{type:String,default:"small"},customStyle:{type:Object,default:()=>({})}},data:()=>({}),computed:{width(){return 8*String(this.text).length+12},classNames(){const{inverted:e,type:t,size:l,absolute:a}=this;return[e?"uni-badge--"+t+"-inverted":"","uni-badge--"+t,"uni-badge--"+l,a?"uni-badge--absolute":""].join(" ")},positionStyle(){if(!this.absolute)return{};let e=this.width/2,t=10;this.isDot&&(e=5,t=5);const l=`${-e+this.offset[0]}px`,a=`${-t+this.offset[1]}px`,o={rightTop:{right:l,top:a},rightBottom:{right:l,bottom:a},leftBottom:{left:l,bottom:a},leftTop:{left:l,top:a}},n=o[this.absolute];return n||o.rightTop},badgeWidth(){return{width:`${this.width}px`}},dotStyle(){return this.isDot?{width:"10px",height:"10px",borderRadius:"10px"}:{}},displayValue(){const{isDot:e,text:t,maxNum:l}=this;return e?"":Number(t)>l?`${l}+`:t}},methods:{onClick(){this.$emit("click")}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-badge--x"},[e.renderSlot(t.$slots,"default",{},void 0,!0),a.text?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass([i.classNames,"uni-badge"]),style:e.normalizeStyle([i.badgeWidth,i.positionStyle,a.customStyle,i.dotStyle]),onClick:l[0]||(l[0]=e=>i.onClick())},e.toDisplayString(i.displayValue),7)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-a2cf781e"]]);const ye={name:"UniListItem",emits:["click","switchChange"],props:{direction:{type:String,default:"row"},title:{type:String,default:""},note:{type:String,default:""},ellipsis:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},clickable:{type:Boolean,default:!1},showArrow:{type:[Boolean,String],default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},showBadge:{type:[Boolean,String],default:!1},showSwitch:{type:[Boolean,String],default:!1},switchChecked:{type:[Boolean,String],default:!1},badgeText:{type:String,default:""},badgeType:{type:String,default:"success"},badgeStyle:{type:Object,default:()=>({})},rightText:{type:String,default:""},thumb:{type:String,default:""},thumbSize:{type:String,default:"base"},showExtraIcon:{type:[Boolean,String],default:!1},extraIcon:{type:Object,default:()=>({type:"",color:"#000000",size:20})},border:{type:Boolean,default:!0}},data:()=>({isFirstChild:!1}),mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0))},methods:{getForm(e="uniList"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t},onClick(){""===this.to?(this.clickable||this.link)&&this.$emit("click",{data:{}}):this.openPage()},onSwitchChange(e){this.$emit("switchChange",e.detail)},openPage(){-1!==["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(e){let t={url:this.to,success:e=>{this.$emit("click",{data:e})},fail:e=>{this.$emit("click",{data:e})}};switch(e){case"navigateTo":default:uni.navigateTo(t);break;case"redirectTo":uni.redirectTo(t);break;case"reLaunch":uni.reLaunch(t);break;case"switchTab":uni.switchTab(t)}}}};var we=l(ye,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-icons"),fe),c=r(e.resolveDynamicComponent("uni-badge"),ge);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass([{"uni-list-item--disabled":a.disabled},"uni-list-item"]),"hover-class":!a.clickable&&!a.link||a.disabled||a.showSwitch?"":"uni-list-item--hover",onClick:l[1]||(l[1]=(...e)=>i.onClick&&i.onClick(...e))},[n.isFirstChild?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["border--left",{"uni-list--border":a.border}])},null,2)),e.createElementVNode("view",{class:e.normalizeClass(["uni-list-item__container",{"container--right":a.showArrow||a.link,"flex--direction":"column"===a.direction}])},[e.renderSlot(t.$slots,"header",{},(()=>[e.createElementVNode("view",{class:"uni-list-item__header"},[a.thumb?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-list-item__icon"},[e.createElementVNode("image",{src:a.thumb,class:e.normalizeClass(["uni-list-item__icon-img",["uni-list--"+a.thumbSize]])},null,10,["src"])])):a.showExtraIcon?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-list-item__icon"},[e.createVNode(s,{color:a.extraIcon.color,size:a.extraIcon.size,type:a.extraIcon.type},null,8,["color","size","type"])])):e.createCommentVNode("",!0)])]),!0),e.renderSlot(t.$slots,"body",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-list-item__content",{"uni-list-item__content--center":a.thumb||a.showExtraIcon||a.showBadge||a.showSwitch}])},[a.title?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass(["uni-list-item__content-title",[0!==a.ellipsis&&a.ellipsis<=2?"uni-ellipsis-"+a.ellipsis:""]])},e.toDisplayString(a.title),3)):e.createCommentVNode("",!0),a.note?(e.openBlock(),e.createElementBlock("text",{key:1,class:"uni-list-item__content-note"},e.toDisplayString(a.note),1)):e.createCommentVNode("",!0)],2)]),!0),e.renderSlot(t.$slots,"footer",{},(()=>[a.rightText||a.showBadge||a.showSwitch?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-list-item__extra",{"flex--justify":"column"===a.direction}])},[a.rightText?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-list-item__extra-text"},e.toDisplayString(a.rightText),1)):e.createCommentVNode("",!0),a.showBadge?(e.openBlock(),e.createBlock(c,{key:1,type:a.badgeType,text:a.badgeText,"custom-style":a.badgeStyle},null,8,["type","text","custom-style"])):e.createCommentVNode("",!0),a.showSwitch?(e.openBlock(),e.createElementBlock("switch",{key:2,disabled:a.disabled,checked:a.switchChecked,onChange:l[0]||(l[0]=(...e)=>i.onSwitchChange&&i.onSwitchChange(...e))},null,40,["disabled","checked"])):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0)]),!0)],2),a.showArrow||a.link?(e.openBlock(),e.createBlock(s,{key:1,size:16,class:"uni-icon-wrapper",color:"#bbb",type:"arrowright"})):e.createCommentVNode("",!0)],10,["hover-class"])}],["__scopeId","data-v-0eddbdb2"]]);var Ne=l({name:"uniList","mp-weixin":{options:{multipleSlots:!1}},props:{enableBackToTop:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},border:{type:Boolean,default:!0}},created(){this.firstChildAppend=!1},methods:{loadMore(e){this.$emit("scrolltolower")}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-list uni-border-top-bottom"},[a.border?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-list--border-top"})):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"default",{},void 0,!0),a.border?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-list--border-bottom"})):e.createCommentVNode("",!0)])}],["__scopeId","data-v-5d0c354c"]]);const Ce=C.asset;class Ee extends te{constructor(e){super(e,Ce)}request(e,t){return super.httpRequest(e,t)}upload(e,t,l){return super.httpUpload(e,t,l)}preStartFlow(e){return super.preStartFlow(e)}startFlow(e){return super.startFlow(e)}prevApproval(e){return super.prevApproval(e)}submitApproval(e){return super.submitApproval(e)}getFlowTrail(e){return super.getFlowTrail(e)}}var be=new class extends Ee{constructor(){super("asset")}myAssetList(e,t){const l={DutyType:"0",PageNO:t,PageSize:20,QST:e};return this.request("/Asset/My/List",l)}getById(e){return this.request("/Asset/GetByID",{ID:e,Visibility:1})}async uploadImage(e){const t=[];for(const l of e){const{UploadedFileInfo:e}=await this.upload("/Asset/UploadImage",M.image,l);t.push(e[0])}return t}async uploadAttachment(e){const t=[];for(const l of e){const{UploadedFileInfo:e}=await this.upload("/Attachment/Upload",M.image,l);t.push(e[0])}return t}uploadSignImageByBase64(e){return this.request("/Attachment/SignRotate",{ImgBaseCode:e,ImgType:"image/jpeg"})}uploadRotate(e){return this.upload("/Attachment/UploadRotate",M.image,e)}edit(e){return this.request("/Asset/Edit",e)}editPicture(e){return this.request("/Asset/EditPicture",e)}assetListQuery(e,t,l){const a={IsSetNumber:!0,PageNO:t,PageSize:20,QST:e,Conditions:l};return this.request("/Asset/List/Query",a)}scanQuery(e){const t={PageNO:1,PageSize:1,Conditions:[{AssetPropertyCode:"Code",Operator:1,Values:[{Value:e}]}]};return this.request("/Asset/List/Query",t)}getAssetProperty(e=1){return this.request("/Asset/Property/All",e)}getPrintAssets(e){const t={IDs:e};return this.request("/LabelPrint/GetPrintAssets",t)}getLabelTemplate(){return this.request("/Setting/LabelTemplate/Get")}assetChangeLocation(e,t){const l={ID:e,LocationID:t.id,LocationNameCN:t.name,LocationNameEN:t.name};return this.request("/Asset/ChangeLocation",l)}assetGetOptions(){return this.request("/Asset/GetOptions",{})}};const De=[{code:"Employee/WaitingApproval",name:"",icon:"calendar-filled",iconColor:"#777",iconPath:"../../static/icon/clock.png",url:"subcontract/mine/todo/todo",show:!0},{code:"Employee/ApprovalHistory",name:"",icon:"person-filled",iconColor:"#777",iconPath:"../../static/icon/alldo.png",url:"subcontract/mine/done/done",show:!0},{code:"Employee/MyAsset",name:"",icon:"person-filled",iconColor:"#777",iconPath:"../../static/icon/mxzc.png",url:"subcontract/asset/myAssetList/list",show:!0},{code:"Employee/Asset/RequestDraw",name:"",icon:"undo",iconColor:"#777",iconPath:"../../static/icon/shenling.png",url:"subcontract/asset/requestDraw/requestDraw",show:!0},{code:"Employee/Consumable/RequestDraw",name:"",icon:"undo",iconColor:"#777",iconPath:"../../static/icon/shenling.png",url:"subcontract/consumable/requestDraw/requestDraw",show:!0},{code:"",name:"扫码报修",icon:"compose",iconColor:"#777",iconPath:"../../static/icon/baoxius.png",url:"subcontract/asset/repair/request/repairRequestList",show:!0},{code:"",name:"扫码借用",icon:"redo-filled",iconColor:"#777",iconPath:"../../static/icon/jieyongs.png",url:"subcontract/asset/borrowReturn/quickBorrow/quickBorrow",show:!0},{code:"",name:"扫码归还",icon:"undo-filled",iconColor:"#777",iconPath:"../../static/icon/return.png",url:"subcontract/asset/borrowReturn/quickReturn/quickReturn",show:!0},{code:"Employee/InventoryEmployeeTask",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/pandian.png",url:"subcontract/asset/inventory/employee/list",show:!0},{code:"",name:"扫码签字确认",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/qianming.png",url:"pages/system/signConfirm/signConfirm",show:!0},{code:"",name:"资产退库申请",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/tuiku.png",url:"subcontract/asset/drawBack/drawBackDetail",show:!0},{code:"Employee/Asset/Transform",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/zhuanyi.png",url:"subcontract/asset/transform/detail",show:!0}],Ve=[{code:"Asset/List",name:"",icon:"list",iconPath:"../../static/icon/list.png",iconColor:"#777",url:"subcontract/asset/assetList/list",show:!1},{code:"",name:"扫码查资产",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/sys.png",url:"subcontract/asset/assetInfo/scanCode",show:!1},{code:"Asset/Bill/Draw",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/lingyong.png",url:"subcontract/asset/draw/drawDetail",show:!1},{code:"Asset/Repair/Result",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/weixiu.png",url:"subcontract/asset/repair/result/detail",show:!1},{code:"Asset/Bill/RequestDiscard",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/baofei.png",url:"subcontract/asset/requestDiscard/detail",show:!1},{code:"Asset/Bill/Discard",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/chuzhi.png",url:"subcontract/asset/discard/detail",show:!1},{code:"Asset/Inventory",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/pandian.png",url:"subcontract/asset/inventory/manageUser/list",show:!1}],ke=[{code:"Consumable/Stock",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/kucunmingxi.png",url:"subcontract/consumable/stock/condition",show:!1},{code:"Consumable/Bill/Inwarehouse",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/ruku.png",url:"subcontract/consumable/inwarehouse/detail/detail",show:!1},{code:"Consumable/Bill/Outwarehouse",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/chuku.png",url:"subcontract/consumable/outwarehouse/detail/detail",show:!1},{code:"Consumable/Bill/Allocate",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/diaobo.png",url:"subcontract/consumable/allocate/detail/detail",show:!1},{code:"Consumable/Bill/Discard",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/baofei.png",url:"subcontract/consumable/discard/detail/detail",show:!1},{code:"Consumable/Inventory",name:"",icon:"settings-filled",iconColor:"#777",iconPath:"../../static/icon/pandian.png",url:"subcontract/consumable/inventory/list",show:!1}];function xe(e){for(const t of De)if(t.url===e)return void uni.setNavigationBarTitle({title:t.name});for(const t of Ve)if(t.url===e)return void uni.setNavigationBarTitle({title:t.name});for(const t of ke)if(t.url===e)return void uni.setNavigationBarTitle({title:t.name});return!1}var _e=l({components:{SwiperDot:l({props:{height:{type:[String,Number],default:150},swiperImg:{type:Array,default:()=>[D("/static/app1.jpg"),D("/static/app2.jpg"),D("/static/app3.jpg")]}},setup(){}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"swiper-dot",style:e.normalizeStyle(`height:${a.height}px`)},[e.createElementVNode("swiper",{style:{height:"100%"},"indicator-dots":!1,autoplay:!0,vertical:!1,interval:3e3,circular:!0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.swiperImg,((t,l)=>(e.openBlock(),e.createElementBlock("swiper-item",{key:l},[e.createElementVNode("img",{src:t,alt:""},null,8,["src"])])))),128))])],4)}],["__scopeId","data-v-6628a8e2"]])},setup(){const t=e.reactive(De),l=e.reactive(Ve),a=e.reactive(ke);oe.getEmployeekinds().then((({Products:e})=>{for(const l of t)if(l.code&&""==l.name){const t=O(l.code,e);if(!1===t)continue;l.name=t.Name}})),oe.getkinds().then((({Products:e})=>{for(const t of l)if(t.code&&""==t.name){const l=O(t.code,e);if(!1===l)continue;t.name=l.Name,t.show=!0}for(const t of a)if(t.code&&""==t.name){const l=O(t.code,e);if(i("log","at pages/home/home.vue:217",l),!1===l)continue;t.name=l.Name,t.show=!0}i("log","at pages/home/home.vue:223",a)}));const o=e.ref(1),n=h("UserName"),r=[{lable:"工号",text:h("UserCode"),icon:"/static/icon/yuangong.png",subLable:""},{lable:"所属部门",text:h("OrgName"),icon:"/static/icon/bumen.png",subLable:""},{lable:"所属公司",text:h("CorpName"),icon:"/static/icon/gongsi.png",subLable:""}];let s=[{icon:"/static/icon/xgmm.png",lable:"修改密码",subLable:"",click:()=>k("subcontract/mine/changePassword/index")},{icon:"/static/icon/print.png",lable:"蓝牙打印",subLable:"",click:()=>k("subcontract/mine/printer/index")},{icon:"/static/icon/wtjd.png",lable:"帮助",subLable:"",click:()=>k("subcontract/mine/help/index")},{icon:"/static/icon/bzzx.png",lable:"服务热线",subLable:"400-1878-996",click:({subLable:e})=>uni.makePhoneCall({phoneNumber:e})},{icon:"/static/icon/logo.png",lable:"关于",subLable:"",click:()=>k("subcontract/mine/aboutSystem/index")}];if(se!==ne){const e=s.splice(1,1);s=s.filter((t=>t!==e))}function c(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{e=R(e),q(),be.scanQuery(e).then((({Items:e})=>{e.length?k(`subcontract/asset/assetInfo/assetView?id=${e[0].ID}&handle=1`):F("未查询到资产信息")})).finally((()=>z()))}})}const d=e.ref(0);return uni.getSystemInfo({success:e=>{d.value=e.windowHeight}}),{commonMenu:t,assetMenu:l,consumableMenu:a,commonlyChange:function({detail:{index:e}}){k(t[e].url)},assetMenuChange:function({detail:{index:e}}){const t=l[e];"subcontract/asset/assetInfo/scanCode"!=t.url?k(t.url):c()},consumableChange:function({detail:{index:e}}){k(a[e].url)},flag:o,list:[{id:"1",url:"pages/home/home",name:"首页",icon1:"home-filled",color1:"#ff5402",icon2:"home-filled",color2:"#666"},{id:"2",url:"subcontract/mine/index/index",name:"我的",icon1:"person-filled",color1:"#ff5402",icon2:"person-filled",color2:"#666"}],userName:n,contentDatas:r,headPhoto:"/static/images/touxiang.png",logout:function(){(function(e,t="确认提醒"){return new Promise((function(l,a){uni.showModal({title:t,content:e,showCancel:!0,cancelText:"取消",confirmText:"确定",cancelColor:"#000",confirmColor:"#007aff",success:({confirm:t,cancel:o})=>{t?l():o?a("已取消："+e):a()},fail:a})}))})("确定要退出登录吗？").then((()=>{f(),_("pages/login/login")}))},isMP:false,contentOperations:s,scan:c,windowHeights:d}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("SwiperDot"),c=r(e.resolveDynamicComponent("uni-section"),ue),d=r(e.resolveDynamicComponent("uni-grid-item"),me),u=r(e.resolveDynamicComponent("uni-grid"),ve),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-list"),Ne),v=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("view",{class:"menu",style:e.normalizeStyle(`height:${o.windowHeights-10}px`)},[e.createElementVNode("view",{class:"nav-swiper"},[e.createVNode(s)]),e.createElementVNode("view",{class:"contents",style:e.normalizeStyle(`height:${o.windowHeights-250}px`)},[o.commonMenu.length?(e.openBlock(),e.createBlock(c,{key:0,title:"通用操作",type:"line"})):e.createCommentVNode("",!0),e.createVNode(u,{column:4,borderColor:"#fff",highlight:!0,onChange:o.commonlyChange},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.commonMenu,(({name:t,icon:l,iconColor:a,iconPath:o,url:n,show:i},r)=>e.withDirectives((e.openBlock(),e.createBlock(d,{index:r,key:n},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"grid-item-box"},[e.createElementVNode("view",{class:"uni-fab__item"},[e.createElementVNode("image",{src:o,class:"uni-fab__item-image",mode:"aspectFit"},null,8,["src"])]),e.createElementVNode("text",{class:"text"},e.toDisplayString(t),1)])])),_:2},1032,["index"])),[[e.vShow,i]]))),128))])),_:1},8,["onChange"]),o.assetMenu.length?(e.openBlock(),e.createBlock(c,{key:1,title:"资产管理",type:"line"})):e.createCommentVNode("",!0),e.createVNode(u,{column:4,borderColor:"#fff",highlight:!0,onChange:o.assetMenuChange},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetMenu,(({name:t,icon:l,iconColor:a,iconPath:o,url:n,show:i},r)=>e.withDirectives((e.openBlock(),e.createBlock(d,{index:r,key:n},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"grid-item-box"},[e.createElementVNode("view",{class:"uni-fab__item"},[e.createElementVNode("image",{src:o,class:"uni-fab__item-image",mode:"aspectFit"},null,8,["src"])]),e.createElementVNode("text",{class:"text"},e.toDisplayString(t),1)])])),_:2},1032,["index"])),[[e.vShow,i]]))),128))])),_:1},8,["onChange"]),o.consumableMenu.length?(e.openBlock(),e.createBlock(c,{key:2,title:"易耗品管理",type:"line"})):e.createCommentVNode("",!0),e.createVNode(u,{column:4,borderColor:"#fff",highlight:!0,onChange:o.consumableChange},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.consumableMenu,(({name:t,icon:l,iconColor:a,iconPath:o,url:n,show:i},r)=>e.withDirectives((e.openBlock(),e.createBlock(d,{index:r,key:n},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"grid-item-box"},[e.createElementVNode("view",{class:"uni-fab__item"},[e.createElementVNode("image",{src:o,class:"uni-fab__item-image",mode:"aspectFit"},null,8,["src"])]),e.createElementVNode("text",{class:"text"},e.toDisplayString(t),1)])])),_:2},1032,["index"])),[[e.vShow,i]]))),128))])),_:1},8,["onChange"])],4)],4),[[e.vShow,1==o.flag]]),e.withDirectives(e.createElementVNode("view",{style:e.normalizeStyle(`height:${o.windowHeights-10}px`),class:"mine"},[e.createElementVNode("view",{class:"top"},[e.createElementVNode("view",{class:"top_top"},[e.createElementVNode("view",{class:"top_top_left"},[e.createElementVNode("image",{src:o.headPhoto,class:"top_top_image",mode:"aspectFit",onClick:l[0]||(l[0]=(...e)=>o.logout&&o.logout(...e))},null,8,["src"])]),e.createElementVNode("view",{class:"top_top_right"},[e.createElementVNode("view",{class:"top_top_right_text bigtext"},e.toDisplayString(o.userName),1)])])]),e.createElementVNode("view",{class:"content",style:e.normalizeStyle(`height:${o.windowHeights-230}px`)},[e.createElementVNode("view",{class:"content_top"},[e.createVNode(p,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.contentDatas,(({icon:t,lable:l,text:a,click:o})=>(e.openBlock(),e.createBlock(m,{title:l,thumb:t,rightText:a},null,8,["title","thumb","rightText"])))),256))])),_:1})]),e.createElementVNode("view",{class:"content_top"},[e.createVNode(p,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.contentOperations,(({icon:t,lable:l,subLable:a,click:o})=>(e.openBlock(),e.createBlock(m,{title:l,thumb:t,rightText:a,onClick:e=>o({subLable:a}),showArrow:"",clickable:""},null,8,["title","thumb","rightText","onClick"])))),256))])),_:1})]),o.isMP?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"signOut",onClick:l[1]||(l[1]=(...e)=>o.logout&&o.logout(...e))}," 退出登录 "))],4)],4),[[e.vShow,2==o.flag]]),e.createElementVNode("view",{class:"tableboxpage"},[e.createElementVNode("view",{class:"footerShells"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,((t,l)=>(e.openBlock(),e.createElementBlock("view",{key:l,class:e.normalizeClass({Selection:o.flag==t.id}),onClick:e=>o.flag=t.id},[o.flag==t.id?(e.openBlock(),e.createBlock(v,{key:0,type:t.icon1,color:t.color1,size:"25"},null,8,["type","color"])):(e.openBlock(),e.createBlock(v,{key:1,type:t.icon1,color:t.color2,size:"25"},null,8,["type","color"])),e.createElementVNode("view",{class:"footText"},e.toDisplayString(t.name),1)],10,["onClick"])))),128))])])],64)}],["__scopeId","data-v-51ec8c64"]]);function Se(e){let t="";for(let l in e){t+=`${l}:${e[l]};`}return t}var Ie=l({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!0},passwordIcon:{type:Boolean,default:!0},styles:{type:Object,default:()=>({color:"#333",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:""}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let t="";for(let l in e)e[l]&&(t+=`${l} `);return t}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled})},inputContentStyle(){const e=this.focusShow?"#2979ff":this.styles.borderColor;return Se({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:"#fff"})},inputStyle(){return Se({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px"})}},watch:{value(e){this.val=e},modelValue(e){this.val=e},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue?this.val=this.modelValue:this.val=null},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let t=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(t=this.trimStr(t)),"string"==typeof this.trim&&(t=this.trimStr(t,this.trim))),this.errMsg&&(this.errMsg=""),this.val=t,this.$emit("input",t),this.$emit("update:modelValue",t)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("focus",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.$emit("change",this.val)},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},trimStr:(e,t="both")=>"both"===t?e.trim():"left"===t?e.trimLeft():"right"===t?e.trimRight():"start"===t?e.trimStart():"end"===t?e.trimEnd():"all"===t?e.replace(/\s+/g,""):e}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-easyinput",{"uni-easyinput-error":i.msg}]),style:e.normalizeStyle(i.boxStyle)},[e.createElementVNode("view",{class:e.normalizeClass(["uni-easyinput__content",i.inputContentClass]),style:e.normalizeStyle(i.inputContentStyle)},[a.prefixIcon?(e.openBlock(),e.createBlock(s,{key:0,class:"content-clear-icon",type:a.prefixIcon,color:"#c0c4cc",onClick:l[0]||(l[0]=e=>i.onClickIcon("prefix")),size:"22"},null,8,["type"])):e.createCommentVNode("",!0),"textarea"===a.type?(e.openBlock(),e.createElementBlock("textarea",{key:1,class:e.normalizeClass(["uni-easyinput__content-textarea",{"input-padding":a.inputBorder}]),name:a.name,value:n.val,placeholder:a.placeholder,placeholderStyle:a.placeholderStyle,disabled:a.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:i.inputMaxlength,focus:n.focused,autoHeight:a.autoHeight,onInput:l[1]||(l[1]=(...e)=>i.onInput&&i.onInput(...e)),onBlur:l[2]||(l[2]=(...e)=>i._Blur&&i._Blur(...e)),onFocus:l[3]||(l[3]=(...e)=>i._Focus&&i._Focus(...e)),onConfirm:l[4]||(l[4]=(...e)=>i.onConfirm&&i.onConfirm(...e))},null,42,["name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight"])):(e.openBlock(),e.createElementBlock("input",{key:2,type:"password"===a.type?"text":a.type,class:"uni-easyinput__content-input",style:e.normalizeStyle(i.inputStyle),name:a.name,value:n.val,password:!n.showPassword&&"password"===a.type,placeholder:a.placeholder,placeholderStyle:a.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:a.disabled,maxlength:i.inputMaxlength,focus:n.focused,confirmType:a.confirmType,onFocus:l[5]||(l[5]=(...e)=>i._Focus&&i._Focus(...e)),onBlur:l[6]||(l[6]=(...e)=>i._Blur&&i._Blur(...e)),onInput:l[7]||(l[7]=(...e)=>i.onInput&&i.onInput(...e)),onConfirm:l[8]||(l[8]=(...e)=>i.onConfirm&&i.onConfirm(...e))},null,44,["type","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType"])),"password"===a.type&&a.passwordIcon?(e.openBlock(),e.createElementBlock(e.Fragment,{key:3},[i.isVal?(e.openBlock(),e.createBlock(s,{key:0,class:e.normalizeClass(["content-clear-icon",{"is-textarea-icon":"textarea"===a.type}]),type:n.showPassword?"eye-slash-filled":"eye-filled",size:22,color:n.focusShow?"#2979ff":"#c0c4cc",onClick:i.onEyes},null,8,["class","type","color","onClick"])):e.createCommentVNode("",!0)],64)):a.suffixIcon?(e.openBlock(),e.createElementBlock(e.Fragment,{key:4},[a.suffixIcon?(e.openBlock(),e.createBlock(s,{key:0,class:"content-clear-icon",type:a.suffixIcon,color:"#c0c4cc",onClick:l[9]||(l[9]=e=>i.onClickIcon("suffix")),size:"22"},null,8,["type"])):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:5},[a.clearable&&i.isVal&&!a.disabled&&"textarea"!==a.type?(e.openBlock(),e.createBlock(s,{key:0,class:e.normalizeClass(["content-clear-icon",{"is-textarea-icon":"textarea"===a.type}]),type:"clear",size:a.clearSize,color:i.msg?"#dd524d":n.focusShow?"#2979ff":"#c0c4cc",onClick:i.onClear},null,8,["class","size","color","onClick"])):e.createCommentVNode("",!0)],64)),e.renderSlot(t.$slots,"right",{},void 0,!0)],6)],6)}],["__scopeId","data-v-3a3aab1d"]]);const Be={name:"uniFormsItem",props:{custom:{type:Boolean,default:!1},showMessage:{type:Boolean,default:!0},name:String,required:Boolean,validateTrigger:{type:String,default:""},leftIcon:String,iconColor:{type:String,default:"#606266"},label:String,labelWidth:{type:[Number,String],default:""},labelAlign:{type:String,default:""},labelPosition:{type:String,default:""},errorMessage:{type:[String,Boolean],default:""},rules:{type:Array,default:()=>[]}},data:()=>({errorTop:!1,errorBottom:!1,labelMarginBottom:"",errorWidth:"",errMsg:"",val:"",labelPos:"",labelWid:"",labelAli:"",showMsg:"undertext",border:!1,isFirstBorder:!1,isArray:!1,arrayField:""}),computed:{msg(){return this.errorMessage||this.errMsg},fieldStyle(){let e={};return"top"==this.labelPos&&(e.padding="0 0",this.labelMarginBottom="6px"),"left"==this.labelPos&&!1!==this.msg&&""!=this.msg?(e.paddingBottom="0px",this.errorBottom=!0,this.errorTop=!1):"top"==this.labelPos&&!1!==this.msg&&""!=this.msg?(this.errorBottom=!1,this.errorTop=!0):(this.errorTop=!1,this.errorBottom=!1),e},justifyContent(){return"left"===this.labelAli?"flex-start":"center"===this.labelAli?"center":"right"===this.labelAli?"flex-end":void 0},labelLeft(){return("left"===this.labelPos?parseInt(this.labelWid):0)+"px"}},watch:{validateTrigger(e){this.formTrigger=e}},created(){this.form=this.getForm(),this.group=this.getForm("uniGroup"),this.formRules=[],this.formTrigger=this.validateTrigger,this.name&&-1!==this.name.indexOf("[")&&-1!==this.name.indexOf("]")&&(this.isArray=!0,this.arrayField=this.name,this.form.formData[this.name]=this.form._getValue(this.name,""))},mounted(){this.form&&this.form.childrens.push(this),this.init()},unmounted(){this.__isUnmounted=!0,this.unInit()},methods:{init(){if(this.form){let{formRules:e,validator:t,formData:l,value:a,labelPosition:o,labelWidth:n,labelAlign:i,errShowType:r}=this.form;this.labelPos=this.labelPosition?this.labelPosition:o,this.label?this.labelWid=this.labelWidth?this.labelWidth:n||70:this.labelWid=this.labelWidth?this.labelWidth:n||"auto",this.labelWid&&"auto"!==this.labelWid&&(this.labelWid+="px"),this.labelAli=this.labelAlign?this.labelAlign:i,this.form.isFirstBorder||(this.form.isFirstBorder=!0,this.isFirstBorder=!0),this.group&&(this.group.isFirstBorder||(this.group.isFirstBorder=!0,this.isFirstBorder=!0)),this.border=this.form.border,this.showMsg=r;let s=this.isArray?this.arrayField:this.name;if(!s)return;e&&this.rules.length>0&&(e[s]||(e[s]={rules:this.rules}),t.updateSchema(e)),this.formRules=e[s]||{},this.validator=t}else this.labelPos=this.labelPosition||"left",this.labelWid=this.labelWidth||65,this.labelAli=this.labelAlign||"left"},unInit(){this.form&&this.form.childrens.forEach(((e,t)=>{e===this&&(this.form.childrens.splice(t,1),delete this.form.formData[e.name])}))},getForm(e="uniForms"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t},clearValidate(){this.errMsg=""},setValue(e){let t=this.isArray?this.arrayField:this.name;if(t){if(this.errMsg&&(this.errMsg=""),this.form.formData[t]=this.form._getValue(t,e),!this.formRules||(this.formRules,"{}"===JSON.stringify(this.formRules)))return;this.triggerCheck(this.form._getValue(this.name,e))}},async triggerCheck(e,t){if(this.errMsg="",!this.validator||0===Object.keys(this.formRules).length)return;const l=this.isRequired(this.formRules.rules||[]);let a=this.isTrigger(this.formRules.validateTrigger,this.validateTrigger,this.form.validateTrigger),o=null;if(a||t){let t=this.isArray?this.arrayField:this.name;o=await this.validator.validateUpdate({[t]:e},this.form.formData)}l||void 0!==e&&""!==e||(o=null);const n=this.form.inputChildrens.find((e=>e.rename===this.name));return(a||t)&&o&&o.errorMessage?(n&&(n.errMsg=o.errorMessage),"toast"===this.form.errShowType&&uni.showToast({title:o.errorMessage||"校验错误",icon:"none"}),"modal"===this.form.errShowType&&uni.showModal({title:"提示",content:o.errorMessage||"校验错误"})):n&&(n.errMsg=""),this.errMsg=o?o.errorMessage:"",this.form.validateCheck(o||null),o||null},isTrigger:(e,t,l)=>!("submit"===e||!e)||void 0===e&&("bind"===t||!t&&"bind"===l),isRequired(e){let t=!1;for(let l=0;l<e.length;l++){if(e[l].required){t=!0;break}}return t}}};var Te=l(Be,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-forms-item",{"uni-forms-item--border":n.border,"is-first-border":n.border&&n.isFirstBorder,"uni-forms-item-error":i.msg}])},[e.createElementVNode("view",{class:"uni-forms-item__box"},[e.createElementVNode("view",{class:e.normalizeClass(["uni-forms-item__inner",["is-direction-"+n.labelPos]])},[e.createElementVNode("view",{class:"uni-forms-item__label",style:e.normalizeStyle({width:n.labelWid,justifyContent:i.justifyContent})},[e.renderSlot(t.$slots,"label",{},(()=>[a.required?(e.openBlock(),e.createElementBlock("text",{key:0,class:"is-required"},"*")):e.createCommentVNode("",!0),a.leftIcon?(e.openBlock(),e.createBlock(s,{key:1,class:"label-icon",size:"16",type:a.leftIcon,color:a.iconColor},null,8,["type","color"])):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"label-text"},e.toDisplayString(a.label),1),a.label?(e.openBlock(),e.createElementBlock("view",{key:2,class:"label-seat"})):e.createCommentVNode("",!0)]),!0)],4),e.createElementVNode("view",{class:e.normalizeClass(["uni-forms-item__content",{"is-input-error-border":i.msg}])},[e.renderSlot(t.$slots,"default",{},void 0,!0)],2)],2),i.msg?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-error-message",{"uni-error-msg--boeder":n.border}]),style:e.normalizeStyle({paddingLeft:i.labelLeft})},[e.createElementVNode("text",{class:"uni-error-message-text"},e.toDisplayString("undertext"===n.showMsg?i.msg:""),1)],6)):e.createCommentVNode("",!0)])],2)}],["__scopeId","data-v-30762ac2"]]),Ae={email:/^\S+?@\S+?\.\S+?$/,idcard:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i")};const Pe={int:"integer",bool:"boolean",double:"number",long:"number",password:"string"};function Oe(e,t=""){["label"].forEach((t=>{void 0===e[t]&&(e[t]="")}));let l=t;for(let a in e){let t=new RegExp("{"+a+"}");l=l.replace(t,e[a])}return l}const Re={integer:e=>Re.number(e)&&parseInt(e,10)===e,string:e=>"string"==typeof e,number:e=>!isNaN(e)&&"number"==typeof e,boolean:function(e){return"boolean"==typeof e},float:function(e){return Re.number(e)&&!Re.integer(e)},array:e=>Array.isArray(e),object:e=>"object"==typeof e&&!Re.array(e),date:e=>e instanceof Date,timestamp(e){return!(!this.integer(e)||Math.abs(e).toString().length>16)},file:e=>"string"==typeof e.url,email:e=>"string"==typeof e&&!!e.match(Ae.email)&&e.length<255,url:e=>"string"==typeof e&&!!e.match(Ae.url),pattern(e,t){try{return new RegExp(e).test(t)}catch(Mn){return!1}},method:e=>"function"==typeof e,idcard:e=>"string"==typeof e&&!!e.match(Ae.idcard),"url-https"(e){return this.url(e)&&e.startsWith("https://")},"url-scheme":e=>e.startsWith("://"),"url-web":e=>!1};const Le={required:(e,t,l)=>e.required&&function(e,t){return null==e||"string"==typeof e&&!e||!(!Array.isArray(e)||e.length)||"object"===t&&!Object.keys(e).length}(t,e.format||typeof t)?Oe(e,e.errorMessage||l.required):null,range(e,t,l){const{range:a,errorMessage:o}=e;let n=new Array(a.length);for(let r=0;r<a.length;r++){const e=a[r];Re.object(e)&&void 0!==e.value?n[r]=e.value:n[r]=e}let i=!1;return Array.isArray(t)?i=new Set(t.concat(n)).size===n.length:n.indexOf(t)>-1&&(i=!0),i?null:Oe(e,o||l.enum)},rangeNumber(e,t,l){if(!Re.number(t))return Oe(e,e.errorMessage||l.pattern.mismatch);let{minimum:a,maximum:o,exclusiveMinimum:n,exclusiveMaximum:i}=e,r=n?t<=a:t<a,s=i?t>=o:t>o;return void 0!==a&&r?Oe(e,e.errorMessage||l.number[n?"exclusiveMinimum":"minimum"]):void 0!==o&&s?Oe(e,e.errorMessage||l.number[i?"exclusiveMaximum":"maximum"]):void 0!==a&&void 0!==o&&(r||s)?Oe(e,e.errorMessage||l.number.range):null},rangeLength(e,t,l){if(!Re.string(t)&&!Re.array(t))return Oe(e,e.errorMessage||l.pattern.mismatch);let a=e.minLength,o=e.maxLength,n=t.length;return void 0!==a&&n<a?Oe(e,e.errorMessage||l.length.minLength):void 0!==o&&n>o?Oe(e,e.errorMessage||l.length.maxLength):void 0!==a&&void 0!==o&&(n<a||n>o)?Oe(e,e.errorMessage||l.length.range):null},pattern:(e,t,l)=>Re.pattern(e.pattern,t)?null:Oe(e,e.errorMessage||l.pattern.mismatch),format(e,t,l){var a=Object.keys(Re),o=Pe[e.format]?Pe[e.format]:e.format||e.arrayType;return a.indexOf(o)>-1&&!Re[o](t)?Oe(e,e.errorMessage||l.typeError):null},arrayTypeFormat(e,t,l){if(!Array.isArray(t))return Oe(e,e.errorMessage||l.typeError);for(let a=0;a<t.length;a++){const o=t[a];let n=this.format(e,o,l);if(null!==n)return n}return null}};class Fe extends class{constructor(e){this._message=e}async validateRule(e,t,l,a,o){var n=null;let i=t.rules;if(i.findIndex((e=>e.required))<0){if(null==l)return n;if("string"==typeof l&&!l.length)return n}var r=this._message;if(void 0===i)return r.default;for(var s=0;s<i.length;s++){let c=i[s],d=this._getValidateType(c);if(Object.assign(c,{label:t.label||`["${e}"]`}),Le[d]&&null!=(n=Le[d](c,l,r)))break;if(c.validateExpr){let e=Date.now();if(!1===c.validateExpr(l,o,e)){n=this._getMessage(c,c.errorMessage||this._message.default);break}}if(c.validateFunction&&null!==(n=await this.validateFunction(c,l,a,o,d)))break}return null!==n&&(n=r.TAG+n),n}async validateFunction(e,t,l,a,o){let n=null;try{let i=null;const r=await e.validateFunction(e,t,a||l,(e=>{i=e}));(i||"string"==typeof r&&r||!1===r)&&(n=this._getMessage(e,i||r,o))}catch(Mn){n=this._getMessage(e,Mn.message,o)}return n}_getMessage(e,t,l){return Oe(e,t||e.errorMessage||this._message[l]||t.default)}_getValidateType(e){var t="";return e.required?t="required":e.format?t="format":e.arrayType?t="arrayTypeFormat":e.range?t="range":void 0!==e.maximum||void 0!==e.minimum?t="rangeNumber":void 0!==e.maxLength||void 0!==e.minLength?t="rangeLength":e.pattern?t="pattern":e.validateFunction&&(t="validateFunction"),t}}{constructor(e,t){super(Fe.message),this._schema=e,this._options=t||null}updateSchema(e){this._schema=e}async validate(e,t){let l=this._checkFieldInSchema(e);return l||(l=await this.invokeValidate(e,!1,t)),l.length?l[0]:null}async validateAll(e,t){let l=this._checkFieldInSchema(e);return l||(l=await this.invokeValidate(e,!0,t)),l}async validateUpdate(e,t){let l=this._checkFieldInSchema(e);return l||(l=await this.invokeValidateUpdate(e,!1,t)),l.length?l[0]:null}async invokeValidate(e,t,l){let a=[],o=this._schema;for(let n in o){let i=o[n],r=await this.validateRule(n,i,e[n],e,l);if(null!=r&&(a.push({key:n,errorMessage:r}),!t))break}return a}async invokeValidateUpdate(e,t,l){let a=[];for(let o in e){let n=await this.validateRule(o,this._schema[o],e[o],e,l);if(null!=n&&(a.push({key:o,errorMessage:n}),!t))break}return a}_checkFieldInSchema(e){var t=Object.keys(e),l=Object.keys(this._schema);if(new Set(t.concat(l)).size===l.length)return"";var a=t.filter((e=>l.indexOf(e)<0));return[{key:"invalid",errorMessage:Oe({field:JSON.stringify(a)},Fe.message.TAG+Fe.message.defaultInvalid)}]}}Fe.message=new function(){return{TAG:"",default:"验证错误",defaultInvalid:"提交的字段{field}在数据库中并不存在",validateFunction:"验证无效",required:"{label}必填",enum:"{label}超出范围",timestamp:"{label}格式无效",whitespace:"{label}不能为空",typeError:"{label}类型无效",date:{format:"{label}日期{value}格式无效",parse:"{label}日期无法解析,{value}无效",invalid:"{label}日期{value}无效"},length:{minLength:"{label}长度不能少于{minLength}",maxLength:"{label}长度不能超过{maxLength}",range:"{label}必须介于{minLength}和{maxLength}之间"},number:{minimum:"{label}不能小于{minimum}",maximum:"{label}不能大于{maximum}",exclusiveMinimum:"{label}不能小于等于{minimum}",exclusiveMaximum:"{label}不能大于等于{maximum}",range:"{label}必须介于{minimum}and{maximum}之间"},pattern:{mismatch:"{label}格式不匹配"}}};const qe={name:"uniForms",components:{},emits:["input","reset","validate","submit"],props:{value:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})},rules:{type:Object,default:()=>({})},validateTrigger:{type:String,default:""},labelPosition:{type:String,default:"left"},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:"left"},errShowType:{type:String,default:"undertext"},border:{type:Boolean,default:!1}},data:()=>({formData:{}}),computed:{dataValue(){return"{}"===JSON.stringify(this.modelValue)?this.value:this.modelValue}},watch:{rules(e){this.init(e)},labelPosition(){this.childrens.forEach((e=>{e.init()}))}},created(){getApp().$vm.$.appContext.config.globalProperties.binddata||(getApp().$vm.$.appContext.config.globalProperties.binddata=function(e,t,l){if(l)this.$refs[l].setValue(e,t);else{let l;for(let e in this.$refs){const t=this.$refs[e];if(t&&t.$options&&"uniForms"===t.$options.name){l=t;break}}if(!l)return i("error","at uni_modules/uni-forms/components/uni-forms/uni-forms.vue:152","当前 uni-froms 组件缺少 ref 属性");l.setValue(e,t)}}),this.unwatchs=[],this.childrens=[],this.inputChildrens=[],this.checkboxChildrens=[],this.formRules=[],this.init(this.rules)},methods:{init(e){0!==Object.keys(e).length?(this.formRules=e,this.validator=new Fe(e),this.registerWatch()):this.formData=this.dataValue},registerWatch(){this.unwatchs.forEach((e=>e())),this.childrens.forEach((e=>{e.init()})),Object.keys(this.dataValue).forEach((e=>{let t=this.$watch("dataValue."+e,(t=>{if(t)if("[object Object]"===t.toString())for(let l in t){let a=`${e}[${l}]`;this.formData[a]=this._getValue(a,t[l])}else this.formData[e]=this._getValue(e,t)}),{deep:!0,immediate:!0});this.unwatchs.push(t)}))},setRules(e){this.init(e)},setValue(e,t,l){let a=this.childrens.find((t=>t.name===e));return a?(t=this._getValue(a.name,t),this.formData[e]=t,a.val=t,a.triggerCheck(t,l)):null},resetForm(e){this.childrens.forEach((e=>{e.errMsg="";const t=this.inputChildrens.find((t=>t.rename===e.name));t&&(t.errMsg="",t.is_reset=!0,t.$emit("input",t.multiple?[]:""),t.$emit("update:modelValue",t.multiple?[]:""))})),this.childrens.forEach((e=>{e.name&&(this.formData[e.name]=this._getValue(e.name,""))})),this.$emit("reset",e)},validateCheck(e){null===e&&(e=null),this.$emit("validate",e)},async validateAll(e,t,l,a){let o,n=[];for(let s in e){const e=this.childrens.find((e=>e.name===s));e&&n.push(e)}a||"function"!=typeof l||(a=l),!a&&"function"!=typeof a&&Promise&&(o=new Promise(((e,t)=>{a=function(l,a){l?t(l):e(a)}})));let i=[],r={};if(this.validator)for(let s in n){const t=n[s];let l=t.isArray?t.arrayField:t.name;if(t.isArray){if(-1!==t.name.indexOf("[")&&-1!==t.name.indexOf("]")){const a=t.name.split("["),o=a[0],n=a[1].replace("]","");r[o]||(r[o]={}),r[o][n]=this._getValue(l,e[l])}}else r[l]=this._getValue(l,e[l]);const a=await t.triggerCheck(e[l],!0);if(a&&(i.push(a),"toast"===this.errShowType||"modal"===this.errShowType))break}else r=e;return Array.isArray(i)&&0===i.length&&(i=null),Array.isArray(l)&&l.forEach((e=>{r[e]=this.dataValue[e]})),"submit"===t?this.$emit("submit",{detail:{value:r,errors:i}}):this.$emit("validate",i),a&&"function"==typeof a&&a(i,r),o&&a?o:null},submitForm(){},submit(e,t,l){for(let a in this.dataValue){this.childrens.find((e=>e.name===a))&&void 0===this.formData[a]&&(this.formData[a]=this._getValue(a,this.dataValue[a]))}return l||i("warn","at uni_modules/uni-forms/components/uni-forms/uni-forms.vue:371","submit 方法即将废弃，请使用validate方法代替！"),this.validateAll(this.formData,"submit",e,t)},validate(e,t){return this.submit(e,t,!0)},validateField(e,t){e=[].concat(e);let l={};return this.childrens.forEach((t=>{-1!==e.indexOf(t.name)&&(l=Object.assign({},l,{[t.name]:this.formData[t.name]}))})),this.validateAll(l,"submit",[],t)},resetFields(){this.resetForm()},clearValidate(e){e=[].concat(e),this.childrens.forEach((t=>{const l=this.inputChildrens.find((e=>e.rename===t.name));(0===e.length||-1!==e.indexOf(t.name))&&(t.errMsg="",l&&(l.errMsg=""))}))},_getValue(e,t){const l=this.formRules[e]&&this.formRules[e].rules||[],a=l.find((e=>e.format&&this.type_filter(e.format))),o=l.find((e=>e.format&&"boolean"===e.format||"bool"===e.format));return a&&(t=isNaN(t)?t:""===t||null===t?null:Number(t)),o&&(t=!!t),t},type_filter:e=>"int"===e||"double"===e||"number"===e||"timestamp"===e}};var ze=l(qe,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-forms",{"uni-forms--top":!a.border}])},[e.createElementVNode("form",{onSubmit:l[0]||(l[0]=e.withModifiers(((...e)=>i.submitForm&&i.submitForm(...e)),["stop"])),onReset:l[1]||(l[1]=(...e)=>i.resetForm&&i.resetForm(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],32)],2)}],["__scopeId","data-v-248644e8"]]);var Ue=l({setup(){const t=e.ref(null),l=e.reactive({serverAddress:""});l.serverAddress="string"==typeof h("serverAddress")&&0==h("serverAddress").indexOf("http")?h("serverAddress"):"http://demo.houqinstar.com/";const a=e.reactive({serverAddress:{rules:[{required:!0,errorMessage:"服务地址必填"},{validateFunction:function(e,t,l,a){return 0!==t.indexOf("http")&&a("请输入正确的服务地址"),!0}}]}});function o(){k("/")}return{form:t,rules:a,blur:function(){t.value.validate()},formData:l,submit:function(){t.value.validate().then((()=>{const e=l.serverAddress+"/configure.jsonp";$(e,{},"get").then((e=>{let t=e.data;t=t.replace(/\s+/g,'"'),t=t.replace(/:"/g,'":"'),t=t.replace(/,"$/gi,""),t=t.replace(',"}',"}"),t=t.slice(1),t=t.slice(0,-1);const a=function(e){let t=null;if("string"==typeof e){const l=/^\w+\((\{[^()]+\})\)$/,a=e.match(l);a&&(i("log","at pages/login/setting.vue:150","dddd"),t=JSON.parse(a[1]))}return t}(t);v("services",JSON.stringify(a)),v("serverAddress",l.serverAddress),b.set(C.system,a.system),b.set(C.asset,a.asset),b.set(C.consumable,a.consumables),b.set(C.myWork,a.myWork),b.set(C.file,a.fileServiceRoot),L("设置成功"),o()})).catch((e=>{F("服务地址错误！")}));var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",e),t.setAttribute("onerror","errorfunc()"),document.querySelector("head").appendChild(t),window.jsonpCallback=function(e){v("services",JSON.stringify(e)),v("serverAddress",l.serverAddress),b.set(C.system,e.system),b.set(C.asset,e.asset),b.set(C.consumable,e.consumables),b.set(C.myWork,e.myWork),b.set(C.file,e.fileServiceRoot),L("设置成功"),o()},F("服务地址错误！")}))},goBack:o}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-easyinput"),Ie),c=r(e.resolveDynamicComponent("uni-forms-item"),Te),d=r(e.resolveDynamicComponent("uni-forms"),ze);return e.openBlock(),e.createElementBlock("view",{class:"upbox"},[e.createVNode(d,{ref:"form",modelValue:o.formData,rules:o.rules},{default:e.withCtx((()=>[e.createVNode(c,{label:"服务地址",required:!0,name:"serverAddress"},{default:e.withCtx((()=>[e.createVNode(s,{type:"text",modelValue:o.formData.serverAddress,"onUpdate:modelValue":l[0]||(l[0]=e=>o.formData.serverAddress=e),placeholder:"请输入服务器地址",onBlur:o.blur},null,8,["modelValue","onBlur"])])),_:1})])),_:1},8,["modelValue","rules"]),e.createElementVNode("view",{class:"quick-return-btn"},[e.createElementVNode("button",{type:"primary",onClick:l[1]||(l[1]=(...e)=>o.submit&&o.submit(...e))},"确 认"),e.createElementVNode("button",{onClick:l[2]||(l[2]=(...e)=>o.goBack&&o.goBack(...e))},"取 消")])])}],["__scopeId","data-v-90fff342"]]);let Me="",We="",$e="",Qe="",je="";const He="done";var Ke=l({emits:[He],props:{list:{type:Array,default:()=>[]},params:{type:Object,default:()=>({})},idKey:{type:String,default:"id"},nameKey:{type:String,default:"name"},parentIdKey:{type:String,default:"parentId"},childrenKey:{type:String,default:"children"},itemDisabledKey:{type:String,default:"disabled"},isLast:{type:Boolean,default:!0},multiple:{type:Boolean,default:!0},initIds:{type:Array,default:[]}},data:()=>({treeList:[],treeParams:{defaultIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFEAAABRCAYAAACqj0o2AAACE0lEQVR4Xu3c200DMRCF4XEltJAOkEugA+ggpUAHoQMqiFMCdEAJUMEiS4mEELlIO7bPOeN9i6K1rG/952myyea1WiCtXmEuYBPR4RBMxInoIOCwhOtJLKVszWyXc/5y2BvNEq6I+/3+kFK6M7OHnPM7jcLKjbZAvD/uaZtzflm5P4rbWyJWgDcze1LPuzVihfxUz7sH4ilJ2bx7Isrm3RtRMu8RiHJ5j0SUyXs0okTeCIj0eSMh0uaNhkiZNyIiXd7IiDR5oyNS5M2ACJ83EyJs3myIkHkzIsLlzYwIkzc7IkTeCojD81ZCHJa3GuKQvBURu+etjNgtb3XELnlHQGyedyTEZnlHQ2ySd0RE97wjI7rlHR3RJe+JeIrbLOecD6ePpZQ6W1kn2epo4MUrPOKyLN8ppYq1+y1VStncOjIdGnFZlo+U0uOtWOeOY2TE12Ouq//pEA7xXL7XfvcufR8K0Svfv6CREN3yDYfYIt9QiK3yjYTYLF95xB75SiP2ylcZsVu+cogj8pVCHJWvEuKwfOkREfKlRkTJlxkRJl86RMR8qRBR82VChM0XHpEhX2hElnyREWnyhUNkzBcKkTVfJETafIcjKuQ7FFEl35GIMvl2R1TMtyuiar49EWXzbY5oZpv/hibXTF2h3+s60FRKeT6+3TjMS3nrA3ZFRD8xrfY3ER1kJ+JEdBBwWGKeRAfEH1wS5WFZSDB/AAAAAElFTkSuQmCC",currentIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFEAAABRCAYAAACqj0o2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MEQ0QTM0MzQ1Q0RBMTFFOUE0MjY4NzI1Njc1RjI1ODIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MEQ0QTM0MzU1Q0RBMTFFOUE0MjY4NzI1Njc1RjI1ODIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowRDRBMzQzMjVDREExMUU5QTQyNjg3MjU2NzVGMjU4MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowRDRBMzQzMzVDREExMUU5QTQyNjg3MjU2NzVGMjU4MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PidwepsAAAK0SURBVHja7JxbTsJAFIYHww7ciStgCeoGvGxAiOsgURegoL5720AXYLiIr0aJviq3Zx3PhIEnKG3ndtr+f3KixrSUj/ZjzjClIqUUiFm2gAAQAREQEUAEREAERAQQAREQAREBREAEREBEEqa67h9RFDWllDv0awWYlqlQHmu1WjMRRMoV1QFttA12y3xRtdNczq8EsE4/f8FumX2q77ROvNXk8UGMEKdUz6tYJHljaZAbuyUH+UR1to5BEohTuqwPCeS4pAA/qY6o/kyHOAMCeRK3owJnj+rH1jjxhqpVsstaebCz6TmnHWyXyY+xHjSBWBY/bvSgadtXBj9u9KCN3rnIfkzkQVsTEEX0Y2IP2oKo/HhMICcFAThUcwVZNGU6FdbX/XURzkbVF4+ybGhjPrFdgP66QdXNurGtSdk6Xdb9nAJ8oDo3OQlsQZzkdPw41ONBo6vI5scDefRjZg+6gpg3Pxp50CXEvPjR2IOuIXL3oxUPuobI3Y9WPOgDIlc/WvOgL4iL/vqFCcD7LH0xB4hj7cfQ/fWH9qCT+FhG0tN+DBk1PzjOM0SVllixcsBT1AvYc/kAPhc0hRg/3uvxoCgKRN9+dOrBUBB9+9GpB0NC9OVH5x4MDdG1H714kANEV3705kEOEBf9dcPi/lQnsuvLg1wgSu3Ha0v7Uh4MMgUXeuG71H407a+VBy9CPQkOdw+MtB+nGbd/D+FBbhBNxo9SjwcngJjNj0E9yBFiFj8G9SBXiGn8GNyDnCEm8SMLD3KHGOdHNh7kDjHOj2w8mAeIi/5arX+c6b/fxHz9oADEdGdjR/fXCw/OOB5oVfCOgnepz8IB14PMw03jCmTE+QBx5z0gAmKSqK9OUF+hcAeIhu/QYr4Qie8rjW83hhMBERARQAREQAREBBABERCLnH8BBgA+TQI7U4t53AAAAABJRU5ErkJggg==",lastIcon:"",border:!1},selectedIds:[]}),mounted(){Me=this.idKey,We=this.nameKey,$e=this.parentIdKey,Qe=this.childrenKey,je=this.itemDisabledKey,this.selectedIds=this.initIds},watch:{list(e){this.treeParams=Object.assign(this.treeParams,this.params),this.renderTreeList(e)}},methods:{renderTreeList(e=[],t=0,l=[]){e.forEach((e=>{const a={[Me]:e[Me],[We]:e[We],[$e]:l,rank:t,showChild:!1,show:0===t,checked:this.selectedIds.includes(e[Me].toString())};if(this.treeList.push(Object.assign(e,a)),Array.isArray(e[Qe])&&e[Qe].length>0){let a=[...l];a.push(e[Me]),this.renderTreeList(e[Qe],t+1,a)}else this.treeList[this.treeList.length-1].lastRank=!0}))},treeItemTap(e){let t=this.treeList,l=e[Me];!0!==e.lastRank?(e.showChild=!e.showChild,t.forEach((t=>{if(!1===e.showChild){if(!t[$e].includes(l))return;!0!==t.lastRank&&(t.showChild=!1),t.show=!1}else t[$e][t[$e].length-1]===l&&(t.show=!0)}))):this.isLast&&!1===this.multiple&&!0!==e[je]&&this.$emit(He,e)},treeItemTextClick(e){this.isLast||this.multiple||e[je]||this.$emit(He,e)},multipleDone(){const e=Array.from(this.treeList),t={},l=Array.from(this.selectedIds);t.ids=l;const a=l.map((t=>e.find((e=>e[Me]==t))));t.items=a,t.names=a.map((e=>e[We])).toString(),this.$emit(He,t)},checkboxChange({detail:{value:e}}){this.selectedIds=e}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[a.multiple?(e.openBlock(),e.createElementBlock("view",{key:0,class:"mix-tree-top"},[e.createElementVNode("view",null,"当前选中"+e.toDisplayString(n.selectedIds.length)+"条",1),e.createElementVNode("view",null,[e.createElementVNode("button",{onClick:l[0]||(l[0]=(...e)=>i.multipleDone&&i.multipleDone(...e)),type:"primary"},"完成")])])):e.createCommentVNode("",!0),e.createElementVNode("checkbox-group",{onChange:l[2]||(l[2]=(...e)=>i.checkboxChange&&i.checkboxChange(...e))},[e.createElementVNode("view",{class:"mix-tree-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.treeList,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:t[a.idKey],class:e.normalizeClass(["mix-tree-item",{border:!0===n.treeParams.border,show:t.show,last:t.lastRank,showchild:t.showChild,mixItemDisabled:t[a.itemDisabledKey]}]),style:e.normalizeStyle([{paddingLeft:19*t.rank+"rpx",zIndex:-1*t.rank+50}]),onClick:e.withModifiers((e=>i.treeItemTap(t,o)),["stop"])},[e.createElementVNode("image",{class:"mix-tree-icon",src:t.lastRank?n.treeParams.lastIcon:t.showChild?n.treeParams.currentIcon:n.treeParams.defaultIcon},null,8,["src"]),a.multiple?(e.openBlock(),e.createElementBlock("checkbox",{key:0,onClick:l[1]||(l[1]=e.withModifiers((()=>{}),["stop"])),checked:t.checked,class:"mix-checkbox",value:t[a.idKey].toString(),disabled:t[a.itemDisabledKey]},null,8,["checked","value","disabled"])):e.createCommentVNode("",!0),a.isLast||a.multiple||t[a.itemDisabledKey]?(e.openBlock(),e.createElementBlock("text",{key:1,class:e.normalizeClass({disabled:t[a.itemDisabledKey]})},e.toDisplayString(t[a.nameKey]),3)):(e.openBlock(),e.createElementBlock("text",{key:2,onClick:e.withModifiers((e=>i.treeItemTextClick(t)),["stop"])},e.toDisplayString(t[a.nameKey]),9,["onClick"]))],14,["onClick"])))),128))])],32)],64)}],["__scopeId","data-v-e9087e16"]]);const Ge=C.consumable;class Je extends te{constructor(e){super(e,Ge)}request(e,t){return super.httpRequest(e,t)}preStartFlow(e){return super.preStartFlow(e)}startFlow(e){return super.startFlow(e)}prevApproval(e){return super.prevApproval(e)}submitApproval(e){return super.submitApproval(e)}}var Ye=new class extends Je{getWarehouseTree(e=!0,t=!1){const l={IsEnableDataPermission:e,IsDisableOrgSelect:t};return this.request("/BasicData/Warehouse/GetTree",l)}getCategoryTree(){return this.request("/BasicData/Category/GetTree",{IsLazyLoad:!1,ParentId:null})}getConsumable(e){return this.request("/BasicData/Consumable/Selector/Query",e)}};const Ze=new Map;function Xe(e,...t){if(Ze.has(e))return Ze.get(e)(...t)}function et(e,...t){const l=Xe(e,...t);return function(e){if(null==e)return!1;const t=Promise.prototype,l=Object.getPrototypeOf(e);return t===l||t.toString()===l.toString()}(l)?l:(i("warn","at share/util/uniEvent.js:25","触发了异步事件，但返回值非Promise。已兼容处理：创建了一个空Promise"),Promise.resolve())}function tt(e,t){Ze.set(e,t)}const lt={assetPictureBack:Symbol(),billDetailBack:Symbol(),drawBackDetailBack:Symbol(),transformDetailBack:Symbol(),repairRequestDetailBack:Symbol(),borrowBackBack:Symbol(),requestDrawDetailBack:Symbol(),takeDeliveryDetailBack:Symbol(),employeeInvDetailBack:Symbol(),employeeStockConfirmBack:Symbol(),inventoryConfirmDetailBack:Symbol(),registerDetailBack:Symbol(),signBack:Symbol(),locationSelectBack:Symbol(),deptSelectBack:Symbol(),assetCategorySelectBack:Symbol(),consumableWarehouseBack:Symbol(),consumableCategoryBack:Symbol(),employeeSelectBack:Symbol(),supplierSelectBack:Symbol(),consumableAllocateConditionBack:Symbol(),consumableAllocateEditBill:Symbol(),consumableOrderBack:Symbol(),consumableInwarehouseConditionBack:Symbol(),consumableInwarehouseEditBill:Symbol(),consumableOutwarehouseBillRequestDrawSelectorBack:Symbol(),conditionBack:Symbol(),refreshBack:Symbol()};var at=l({components:{"mix-tree":Ke},props:{isPower:{},isLast:{},multiple:{},ids:{},disableOrg:{}},setup({isPower:t="1",isLast:l="0",multiple:a="0",ids:o="",disableOrg:n="0"}){const i=e.ref(null),r="1"===l,s="1"===t,c="1"===a,d=o?o.split(","):[],u="1"===n;return q(),Ye.getWarehouseTree(s,u).then((e=>i.value=e)).finally(z),{list:i,treeDone:function(e){Xe(lt.consumableWarehouseBack,e),S()},insideIsLast:r,insideMultiple:c,insideIds:d}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("mix-tree"),Ke);return e.openBlock(),e.createBlock(s,{list:o.list,onDone:o.treeDone,idKey:"id",nameKey:"label",parentIdKey:"parent_id",childrenKey:"children",itemDisabledKey:"isDisabled",isLast:o.insideIsLast,multiple:o.insideMultiple,initIds:o.insideIds},null,8,["list","onDone","isLast","multiple","initIds"])}]]);var ot=l({components:{"mix-tree":Ke},props:{isLast:{},multiple:{},ids:{}},setup({isLast:t="0",multiple:l="0",ids:a=""}){const o=e.ref(null),n="1"===t,i="1"===l,r=a?a.split(","):[];return q(),Ye.getCategoryTree().then((({Items:e})=>o.value=e)).finally(z),{list:o,treeDone:function(e){Xe(lt.consumableCategoryBack,e),S()},insideIsLast:n,insideMultiple:i,insideIds:r}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("mix-tree"),Ke);return e.openBlock(),e.createBlock(s,{list:o.list,onDone:o.treeDone,idKey:"id",nameKey:"label",parentIdKey:"parent_id",childrenKey:"children",isLast:o.insideIsLast,multiple:o.insideMultiple,initIds:o.insideIds},null,8,["list","onDone","isLast","multiple","initIds"])}]]);const nt="done",it="search";var rt=l({emits:[nt,it],props:{multiple:{},list:{type:Array,default:()=>[]},initIds:{type:Array,default:[]},idKey:{type:String,default:"id"},nameKey:{type:String,default:"name"},codeKey:{type:String,default:"code"},searchPlaceholder:{type:String,default:"编码/名称"},maxRowCount:{type:Number,default:30}},setup(t,{emit:l}){const a=e.ref(""),o=e.computed((()=>t.list?t.list.length:0)),n=e.ref([...t.initIds]),i=t.idKey,r=t.nameKey;return{doneSelect:function(e){t.multiple||l(nt,e)},doneSearch:function(){const e=a.value;n.value=[],l(it,e)},qst:a,listLength:o,checkboxChange:function({detail:{value:e}}){n.value=e},selectedIds:n,multipleSelectDone:function(){const e=Array.from(t.list),a=Array.from(n.value),o=a.map((t=>e.find((e=>e[i]==t))));l(nt,{ids:a,items:o,names:o.map((e=>e[r])).toString()})}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[a.multiple?(e.openBlock(),e.createElementBlock("view",{key:0,class:"mix-tree-top"},[e.createElementVNode("view",null,"当前选中"+e.toDisplayString(o.selectedIds.length)+"条",1),e.createElementVNode("view",null,[e.createElementVNode("button",{onClick:l[0]||(l[0]=(...e)=>o.multipleSelectDone&&o.multipleSelectDone(...e)),type:"primary"},"完成")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"top"},[e.createVNode(s,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[1]||(l[1]=e=>o.qst=e),placeholder:a.searchPlaceholder,onIconClick:o.doneSearch,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.doneSearch,onClear:o.doneSearch},null,8,["modelValue","placeholder","onIconClick","onConfirm","onClear"])]),e.createElementVNode("view",{class:"list"},[e.createElementVNode("checkbox-group",{onChange:l[3]||(l[3]=(...e)=>o.checkboxChange&&o.checkboxChange(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.list,(t=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t[a.idKey],onClick:e=>o.doneSelect(t)},[e.createElementVNode("label",null,[a.multiple?(e.openBlock(),e.createElementBlock("checkbox",{key:0,onClick:l[2]||(l[2]=e.withModifiers((()=>{}),["stop"])),checked:o.selectedIds.includes(t[a.idKey].toString()),class:"mix-checkbox",value:t[a.idKey].toString()},null,8,["checked","value"])):e.createCommentVNode("",!0),e.createTextVNode(e.toDisplayString(t[a.nameKey])+" "+e.toDisplayString(t[a.codeKey]),1)])],8,["onClick"])))),128))],32)]),e.createElementVNode("view",{class:"footer"},[o.listLength<a.maxRowCount?(e.openBlock(),e.createElementBlock("text",{key:0},"已到底部，没有数据了")):(e.openBlock(),e.createElementBlock("text",{key:1}," 当前只显示前"+e.toDisplayString(a.maxRowCount)+"条数据，请搜索以获得更精确的结果 ",1))])],64)}],["__scopeId","data-v-605ae19f"]]);var st=new class extends ae{list({qst:e="",qse:t="",corpID:l=null,isLeave:a=null,isUser:o=null,isPower:n=!0,isChildrenCorp:i=null,enableEmployeeAccount:r=null}={}){return this.request("/Employee/List",{QST:e,QSE:t,CorpID:l,IsShowLeaveJobEmployee:a,IsFilterUser:o,IsContainSubordinateCompany:i,EnableEmployeeAccount:r,IsEnableDataPermission:n,PageNO:1,PageSize:30})}};var ct=l({components:{"list-data-select":rt},props:{isPower:{},multiple:{},ids:{},qse:{},corpID:{},isLeave:{},isUser:{},isChildrenCorp:{},enableEmployeeAccount:{}},setup({isPower:t="1",multiple:l="0",ids:a=null,qse:o=null,corpID:n=null,isLeave:i,isUser:r,isChildrenCorp:s,enableEmployeeAccount:c=null}){const d=e.ref(null),u="1"===t,m="1"===l,p=a?a.split(","):[],v=i?"1"===i:null,h=r?"1"===r:null,f=s?"1"===s:null,g=c?"1"===c:null;function y(e){q(),st.list({qst:e,qse:o,corpID:n,isPower:u,isLeave:v,isUser:h,isChildrenCorp:f,enableEmployeeAccount:g}).then((({Items:e})=>d.value=e)).finally(z)}return y(),{list:d,done:function(e){Xe(lt.employeeSelectBack,e),S()},insideMultiple:m,insideIds:p,search:y}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("list-data-select"),rt);return e.openBlock(),e.createBlock(s,{list:o.list,idKey:"ID",nameKey:"Name",codeKey:"Code",multiple:o.insideMultiple,onDone:o.done,onSearch:o.search,initIds:o.insideIds},null,8,["list","multiple","onDone","onSearch","initIds"])}]]);var dt=new class extends Ee{getLocationTree(e=!0,t=null){const l={ParentId:t,Delay:!1,OnlyLoadPrivilegeLocation:e};return this.request("/BasicData/Location/GetTree",l)}getAssetCategoryTree(e=!0){const t={ParentId:null,Delay:!1,OnlyLoadPrivilegeLocation:e};return this.request("/BasicData/Location/GetTree",t)}getSupplierCategory(e=!0){const t={ParentId:null,Delay:!1,OnlyLoadPrivilegeLocation:e};return this.request("/BasicData/SupplierCategory/GetTree",t)}getSupplierList(e,t){const l={QST:e,QSE:t,PageSize:30,PageNO:1,IsSetNumber:!1};return this.request("/BasicData/Supplier/List",l)}};var ut=l({components:{"mix-tree":Ke},props:{parentId:{},isPower:{},isLast:{},multiple:{},ids:{}},setup({isPower:t="1",parentId:l=null,isLast:a="0",multiple:o="0",ids:n=""}){const i=e.ref(null),r="1"===a,s="1"===t,c="1"===o,d=n?n.split(","):[];return q(),dt.getLocationTree(s,l).then((({Items:e})=>{i.value=e})).finally(z),{list:i,treeItemClick:function(e){Xe(lt.locationSelectBack,e),S()},insideIsLast:r,insideMultiple:c,insideIds:d}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("mix-tree"),Ke);return e.openBlock(),e.createBlock(s,{list:o.list,onDone:o.treeItemClick,idKey:"id",nameKey:"label",parentIdKey:"parent_id",isLast:o.insideIsLast,multiple:o.insideMultiple,initIds:o.insideIds},null,8,["list","onDone","isLast","multiple","initIds"])}]]);var mt=new class extends ae{getDeptTree(e=!0,t=null){2!=t&&(t=3);const l={LoadOrganizationType:t,OnlyLoadOrganization:!1,OnlyLoadEnableOrg:!0,OnlyLoadPrivilegeOrg:e,Delay:!1,ParentId:null,IsIncludeSelf:!1};return this.request("/Organization/GetTree",l)}};function pt(e,t){if("1"==t){if(2===e.Type)return F("请选择部门(当前选择不应该包含公司)"),!1}else if("2"==t&&2!==e.Type)return F("请选择公司(当前选择不应该包含部门)"),!1}var vt=l({components:{"mix-tree":Ke},props:{isPower:{},isLast:{},multiple:{},ids:{},type:{}},setup({isPower:t="1",isLast:l="0",multiple:a="0",ids:o="",type:n=null}){const i=e.ref(null),r="1"===l,s="1"===t,c="1"===a,d=o?o.split(","):[],u=n||null;return"1"===u?uni.setNavigationBarTitle({title:"请选择部门"}):"2"===u&&uni.setNavigationBarTitle({title:"请选择公司"}),q(),mt.getDeptTree(s,u).then((e=>i.value=e)).finally(z),{list:i,treeDone:function(e){if(null!==u)if(c){for(const t of e.items)if(!1===pt(t,u))return}else if(!1===pt(e,u))return;Xe(lt.deptSelectBack,e),S()},insideIsLast:r,insideMultiple:c,insideIds:d}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("mix-tree"),Ke);return e.openBlock(),e.createBlock(s,{list:o.list,onDone:o.treeDone,idKey:"id",nameKey:"label",parentIdKey:"parent_id",childrenKey:"children",isLast:o.insideIsLast,multiple:o.insideMultiple,initIds:o.insideIds},null,8,["list","onDone","isLast","multiple","initIds"])}]]);var ht=l({components:{"mix-tree":Ke},props:{isPower:{},isLast:{},multiple:{},ids:{}},setup({isPower:t="1",isLast:l="0",multiple:a="0",ids:o=""}){const n=e.ref(null),i="1"===l,r="1"===t,s="1"===a,c=o?o.split(","):[];return q(),dt.getAssetCategoryTree(r).then((({Items:e})=>n.value=e)).finally(z),{list:n,treeDone:function(e){Xe(lt.assetCategorySelectBack,e),S()},insideIsLast:i,insideMultiple:s,insideIds:c}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("mix-tree"),Ke);return e.openBlock(),e.createBlock(s,{list:o.list,onDone:o.treeDone,idKey:"id",nameKey:"label",parentIdKey:"parent_id",childrenKey:"children",isLast:o.insideIsLast,multiple:o.insideMultiple,initIds:o.insideIds},null,8,["list","onDone","isLast","multiple","initIds"])}]]);var ft=l({components:{"list-data-select":rt},props:{multiple:{},ids:{},qse:{}},setup({multiple:t="0",ids:l=null,qse:a=null}){const o=e.ref(null),n="1"===t,i=l?l.split(","):[];function r(e){q(),dt.getSupplierList(e,a).then((({Items:e})=>o.value=e)).finally(z)}return r(),{list:o,done:function(e){Xe(lt.supplierSelectBack,e),S()},insideMultiple:n,insideIds:i,search:r}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("list-data-select"),rt);return e.openBlock(),e.createBlock(s,{list:o.list,idKey:"ID",nameKey:"Name",codeKey:"Code",multiple:o.insideMultiple,onDone:o.done,onSearch:o.search,initIds:o.insideIds},null,8,["list","multiple","onDone","onSearch","initIds"])}]]),gt=!1;const yt={data:()=>({ctx:{},moveX:"",moveY:"",windowHeight:0,windowWidth:0,canvasStyle:{height:"",width:"85vw",backgroundColor:"#fff"}}),methods:{touchstart(e){let{x:t,y:l}=e.changedTouches[0];this.ctx.beginPath(),this.ctx.moveTo(t,l),this.moveX="",this.moveY=""},cancel(){this.$emit("cancel")},touchmove(e){let{x:t,y:l}=e.changedTouches[0];this.moveX&&this.moveY&&(this.ctx.moveTo(this.moveX,this.moveY),this.ctx.lineTo(this.moveX,this.moveY)),gt=!0,this.ctx.lineTo(t,l),this.moveX=t,this.moveY=l,this.ctx.stroke(),this.ctx.draw(!0)},clearCotent(){this.ctx.draw(!1),this.ctx.lineWidth=4,this.ctx.setLineCap("round"),this.ctx.setLineJoin("round"),this.ctx.strokeStyle="rgb(0,0,0)",this.moveX="",this.moveY="",this.ctx.draw(!1),gt=!1},submit(){if(!gt)return void F("请进行签字操作");let e=this;this.ctx.draw(!0,(()=>{uni.canvasToTempFilePath({fileType:"png",canvasId:"handWriting1",success:function(t){i("log","at components/cj-signed-version/cj-signed-version.vue:168",t),e.$emit("success",t)},fail(t){e.$emit("error",t)}},this),gt=!1}))}},mounted(){uni.getSystemInfo({success:e=>{this.windowHeight=e.windowHeight,this.windowWidth=e.windowWidth,this.canvasStyle.height=e.windowHeight+"px"}});let e=uni.createCanvasContext("handWriting1",this);e.lineWidth=4,e.setLineCap("round"),e.setLineJoin("round"),e.strokeStyle="rgb(0,0,0)",this.ctx=e}};var wt=l(yt,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"panel",style:e.normalizeStyle({height:n.windowHeight+"px",width:n.windowWidth+"px"})},[e.createElementVNode("view",{class:"sign-panel"},[e.createElementVNode("canvas",{"disable-scroll":"",style:e.normalizeStyle(n.canvasStyle),"canvas-id":"handWriting1",id:"handWriting1",onTouchstart:l[0]||(l[0]=(...e)=>i.touchstart&&i.touchstart(...e)),onTouchmove:l[1]||(l[1]=(...e)=>i.touchmove&&i.touchmove(...e))},null,36)]),e.createElementVNode("view",{class:"bottom"},[e.createElementVNode("button",{class:"remove",style:{position:"absolute",left:"7.5vw",bottom:"250px",width:"45px",height:"80px","font-size":"16px",display:"flex",color:"#ccc","flex-direction":"column","justify-content":"space-around","border-radius":"10px",transform:"translateX(-50%)"},onClick:l[2]||(l[2]=(...e)=>i.clearCotent&&i.clearCotent(...e))},[e.createElementVNode("view",{class:"signtextrotate"},"清"),e.createElementVNode("view",{class:"signtextrotate"},"空")]),e.createElementVNode("button",{style:{position:"absolute",left:"7.5vw",bottom:"150px",width:"45px",height:"80px","font-size":"16px",display:"flex","flex-direction":"column","justify-content":"space-around","background-color":"#4a74e7",color:"#fff","border-radius":"10px",transform:"translateX(-50%)"},onClick:l[3]||(l[3]=(...e)=>i.submit&&i.submit(...e))},[e.createElementVNode("view",{class:"signtextrotate"},"确"),e.createElementVNode("view",{class:"signtextrotate"},"定")]),e.createElementVNode("button",{style:{position:"absolute",left:"7.5vw",bottom:"50px",width:"45px",height:"80px","font-size":"16px",display:"flex",color:"#444","flex-direction":"column","justify-content":"space-around","border-radius":"10px",transform:"translateX(-50%)"},onClick:l[4]||(l[4]=(...e)=>i.cancel&&i.cancel(...e))},[e.createElementVNode("view",{class:"signtextrotate"},"取"),e.createElementVNode("view",{class:"signtextrotate"},"消")])])],4)}],["__scopeId","data-v-3cd4cccc"]]);class Nt{}function Ct(e){let t=Nt.keyValues.filter((t=>t.key==e))[0];return V(t.product,t.url)}__publicField(Nt,"keyValues",[{key:100,url:"/Bill/RequestDraw/Confirm",product:C.asset},{key:101,url:"/Bill/Draw/Confirm",product:C.asset},{key:102,url:"/Bill/DrawBack/Confirm",product:C.asset},{key:103,url:"/Bill/Transform/Confirm",product:C.asset},{key:104,url:"/Bill/Borrow/Confirm",product:C.asset},{key:105,url:"/Bill/Return/Confirm",product:C.asset},{key:106,url:"/Bill/RequestDiscard/Confirm",product:C.asset},{key:107,url:"/Bill/Discard/Confirm",product:C.asset},{key:108,url:"/Bill/PurchasingApplication/Confirm",product:C.asset},{key:109,url:"/Bill/PurchasingOrder/Confirm",product:C.asset},{key:110,url:"/Bill/PurchasingAccept/Confirm",product:C.asset},{key:111,url:"/Bill/PurchasingReturn/Confirm",product:C.asset},{key:112,url:"/Bill/AssetInWarehouse/Confirm",product:C.asset},{key:200,url:"/Bill/InWarehouse/Confirm",product:C.consumable},{key:201,url:"/Bill/OutWarehouse/Confirm",product:C.consumable},{key:202,url:"/Bill/Discard/Confirm",product:C.consumable},{key:203,url:"/Bill/Allocate/Confirm",product:C.consumable},{key:204,url:"/Bill/PurchasingApplication/Confirm",product:C.consumable},{key:205,url:"/Bill/PurchasingOrder/Confirm",product:C.consumable},{key:206,url:"/Bill/PurchasingReturn/Confirm",product:C.consumable},{key:207,url:"/Bill/RequestDraw/Confirm",product:C.consumable},{key:208,url:"/Bill/TransferOut/Confirm",product:C.consumable},{key:209,url:"/Bill/TransferIn/Confirm",product:C.consumable},{key:210,url:"/Bill/OriginalAmountAlteration/Confirm",product:C.asset},{key:211,url:"/Bill/Project/Confirm",product:C.OBPProject},{key:212,url:"/Bill/Contract/Confirm",product:C.OBPProject},{key:213,url:"/Bill/Convert/Confirm",product:C.OBPProject},{key:214,url:"/Bill/CancelRequestDiscard/Confirm",product:C.OBPProject},{key:215,url:"/Bill/Split/Confirm",product:C.OBPProject}]),__publicField(Nt,"filePath","/Attachment/Upload");let Et="";function bt(e){}function Dt(e){}function Vt(e){}function kt(e){}function xt(e){return new Promise((function(t,l){if("object"==typeof window&&"document"in window){if("function"==typeof FileReader){var a=new XMLHttpRequest;return a.open("GET",e,!0),a.responseType="blob",a.onload=function(){if(200===this.status){let e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=l,e.readAsDataURL(this.response)}},a.onerror=l,void a.send()}var o=document.createElement("canvas"),n=o.getContext("2d"),i=new Image;return i.onload=function(){o.width=i.width,o.height=i.height,n.drawImage(i,0,0),t(o.toDataURL()),o.height=o.width=0},i.onerror=l,void(i.src=e)}"object"!=typeof plus?"object"==typeof wx&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:e,encoding:"base64",success:function(e){t("data:image/png;base64,"+e.data)},fail:function(e){l(e)}}):("object"==typeof dd&&t(e),l(new Error("not support"))):plus.io.resolveLocalFileSystemURL(function(e){if(0===e.indexOf("_www")||0===e.indexOf("_doc")||0===e.indexOf("_documents")||0===e.indexOf("_downloads"))return e;if(0===e.indexOf("file://"))return e;if(0===e.indexOf("/storage/emulated/0/"))return e;if(0===e.indexOf("/")){var t=plus.io.convertAbsoluteFileSystem(e);if(t!==e)return t;e=e.substr(1)}return"_www/"+e}(e),(function(e){e.file((function(e){var a=new plus.io.FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){l(e)},a.readAsDataURL(e)}),(function(e){l(e)}))}),(function(e){l(e)}))}))}const _t={data:()=>({signShow:!1,key:"",billID:"",apiPath:"",filePath:"/Attachment/Upload",type:0}),methods:{cancel(){uni.navigateBack({delta:1})},async success(e){let t=e.tempFilePath;t=await xt(e.tempFilePath),"object"==typeof dd?be.uploadRotate(t).then((e=>{let t=e;G(this.apiPath,{ID:parseInt(this.billID),IsPass:!0,SignPictureUrl:t.UploadedFileInfo.FileUrl}).then((()=>{if(0==this.type){let e={target:0,billType:this.key};uni.sendSocketMessage({data:JSON.stringify(e)})}et(lt.signBack).then((()=>S()))}))})):be.uploadSignImageByBase64(t).then((e=>{let t=e;i("log","at pages/system/signConfirm/signConfirm.vue:79",t),G(this.apiPath,{ID:parseInt(this.billID),IsPass:!0,SignPictureUrl:t.UploadedFileInfo.FileUrl}).then((()=>{if(0==this.type){let e={target:0,billType:this.key};uni.sendSocketMessage({data:JSON.stringify(e)})}et(lt.signBack).then((()=>S()))}))}))}},mounted(){var e;let t=getCurrentPages(),l=t[t.length-1].options;if(this.type=null!=(e=l.type)?e:0,this.key=l.key,this.billID=l.billID,0==this.type){(e=>{let t=N();if(i("log","at share/util/websocket.js:13",t),e||(i("log","at share/util/websocket.js:15",b.ws),e=b.ws),Et)i("log","at share/util/websocket.js:36","websocket已连接");else{if(i("log","at share/util/websocket.js:20","建立websocket连接"),i("log","at share/util/websocket.js:21",t),!t)return;i("log","at share/util/websocket.js:25",1),Et=uni.connectSocket({url:e+"?token="+t+"&type=1",complete:()=>{}}),uni.onSocketOpen(bt),uni.onSocketMessage(Dt),uni.onSocketError(Vt),uni.onSocketClose(kt)}})();let e=this;uni.scanCode({cancel:()=>{uni.navigateBack({delta:1})},success:function(t){let l=t.result;if("##t"==l.substring(0,3).toLowerCase()){if(!/T=(1|2|10|3|100|101|102|103|104|105|106|107|108|109|110|111|112|200|201|202|203|204|205|206|207|208|209|210|211|212|213)&V=(\d+)/g.test(l))return void uni.showToast({title:"二维码无效",icon:"error"});e.key=RegExp.$1,e.billID=RegExp.$2,e.apiPath=Ct(e.key),e.signShow=!0}else uni.showToast({title:"二维码无效",icon:"error"})}})}1==this.type&&(this.apiPath=Ct(this.key),this.signShow=!0)}};var St=l(_t,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("cj-signed-version"),wt);return n.signShow?(e.openBlock(),e.createBlock(s,{key:0,onSuccess:i.success,onCancel:i.cancel},null,8,["onSuccess","onCancel"])):e.createCommentVNode("",!0)}]]);const It={data:()=>({signShow:!1,ID:"",SignPictureUrl:"",ProductType:"",BillType:"",ActivityID:"",ActivityName:"",apiPath:"/BillApproval/ApprovalFlow/Sign"}),methods:{cancel(){uni.navigateBack({delta:1})},async success(e){let t=e.tempFilePath;t=await xt(e.tempFilePath),i("log","at pages/system/sign/sign.vue:41",t),"object"==typeof dd?be.uploadRotate(t).then((e=>{let t=e;G(this.apiPath,{ID:parseInt(this.billID),IsPass:!0,SignPictureUrl:t.UploadedFileInfo.FileUrl}).then((()=>{uni.navigateBack({delta:1})}))})):be.uploadSignImageByBase64(t).then((e=>{let t=e,l={ID:parseInt(this.ID),SignPictureUrl:t.UploadedFileInfo.FileUrl,ProductType:this.ProductType,BillType:this.BillType,ActivityID:this.ActivityID,ActivityName:this.ActivityName};G(this.apiPath,l).then((()=>{uni.navigateBack({delta:1})}))}))}},mounted(){let e=getCurrentPages(),t=e[e.length-1].options;var l;this.ID=t.ID,this.ProductType=t.ProductType,this.BillType=t.BillType,this.ActivityID=t.ActivityID,this.ActivityName=t.ActivityName,this.apiPath=(l=this.apiPath,V(C.system,l)),this.signShow=!0}};var Bt=l(It,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("cj-signed-version"),wt);return n.signShow?(e.openBlock(),e.createBlock(s,{key:0,onSuccess:i.success,onCancel:i.cancel},null,8,["onSuccess","onCancel"])):e.createCommentVNode("",!0)}]]);var Tt=l({props:{qty:{type:[Number,String],default:0},totalQty:{type:[Number,String],default:0},bottom:{type:[Number,String],default:70},right:{type:[Number,String],default:10},scrollAreaHeight:{type:[Number,String],default:0},scrollTopDistance:{type:[Number,String],default:0}},emits:["scrollTop"],setup:(e,t)=>({scorllTop:function(){t.emit("scrollTop")}})},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock("view",{class:"anchor-point-qty",style:e.normalizeStyle(`bottom:${a.bottom}px;right:${a.right}px;`)},[e.createElementVNode("view",{class:"qty"},[e.createElementVNode("view",{class:"qty-content"},[e.createElementVNode("view",{class:"list-qty"},e.toDisplayString(a.qty),1),e.createElementVNode("view",{class:"total-qty"},e.toDisplayString(a.totalQty),1)])]),e.withDirectives(e.createElementVNode("view",{class:"anchor-point",onClick:l[0]||(l[0]=(...e)=>o.scorllTop&&o.scorllTop(...e))},[e.createVNode(s,{type:"top",size:"30"})],512),[[e.vShow,a.scrollTopDistance>a.scrollAreaHeight]])],4)}],["__scopeId","data-v-76b233d6"]]);function At(e,t){uni.previewImage({current:e[t],urls:e})}function Pt(e){uni.previewImage({urls:[e]})}const Ot=[{text:"取消",style:{backgroundColor:"#007aff"}},{text:"删除",style:{backgroundColor:"#F56C6C"}}],Rt={color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#007AFF",iconColor:"#fff"},Lt=[{iconPath:"/static/icon/sys.png",selectedIconPath:"/static/icon/sys.png",text:"扫码",active:!1},{iconPath:"/static/icon/edit.png",selectedIconPath:"/static/icon/edit.png",text:"检索",active:!1},{iconPath:"/static/icon/asset_mingxi.png",selectedIconPath:"/static/icon/asset_mingxi.png",text:"明细",active:!1},{iconPath:"/static/icon/asset_fujian.png",selectedIconPath:"/static/icon/asset_fujian.png",text:"附件",active:!1}];function Ft(e){let t={"border-color":"rgba(0,0,0,.0)",color:"rgba(0,0,0,.0)"};switch(e){case 1:t["border-color"]="#444",t.color="#444";break;case 2:t["border-color"]="#ffc067",t.color="#ffc067";break;case 3:t["border-color"]="#f06a70",t.color="#f06a70";break;case 4:t["border-color"]="#ff5404",t.color="#ff5404";break;case 5:t["border-color"]="red",t.color="red";break;case 7:t["border-color"]="#00cffe",t.color="#00cffe";break;case 8:t["border-color"]="#83ca1d",t.color="#83ca1d"}return t}function qt(e){let t={"border-color":"rgba(0,0,0,.0)",color:"rgba(0,0,0,.0)"};switch(e){case 1:t["border-color"]="#c2c7ca",t.color="#c2c7ca";break;case 2:t["border-color"]="#00bc4b",t.color="#00bc4b";break;case 3:t["border-color"]="#feae4b",t.color="#feae4b";break;case 4:t["border-color"]="#ff5306",t.color="#ff5306"}return t}function zt({url:e}){const t=e.slice(e.lastIndexOf(".")+1);"jpg"!=t&&"png"!=t&&"jpeg"!=t?"pdf"==t&&k(`/subcontract/mine/help/onlinePDF?filePath=${e}`):Pt(D(e))}var Ut=l({components:{uniSection:ue,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),r=e.ref(""),s=e.ref(0),c=e.ref(""),d=e.ref("");function u(){q(),be.myAssetList(t.value,l).then((({PageCount:e,Items:t,TotalRecordQty:r})=>{a=e,1===l?(o.value=t,i("log","at subcontract/asset/myAssetList/list.vue:119",o.value)):o.value=o.value.concat(t),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()})).finally((()=>z()))}function v(){l=1,u()}return uni.showNavigationBarLoading(),u(),uni.getSystemInfo({success:e=>{c.value=e.windowHeight,d.value=e.windowWidth}}),m((()=>{l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,u())})),p((()=>{v()})),{qst:t,list:o,totalQty:n,toIndex:r,scrollTopDistance:s,scroll:function({detail:e}){s.value=e.scrollTop,r.value=""},refreshList:v,itemClick:function(e){k(`subcontract/asset/assetInfo/assetView?id=${e}&handle=1&setLocation=1`)},windowWidths:d,windowHeights:c,assetStatusColor:qt}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("AnchorPointAndQty"),c=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(s,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(c,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[1]||(l[1]=e=>o.qst=e),placeholder:"编码/名称",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-45}px`),onScrolltolower:l[2]||(l[2]=(...e)=>t.reachBottom&&t.reachBottom(...e)),onScroll:l[3]||(l[3]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({AssetStatus:t,Name:l,AssetStatusText:a,AssetUsageText:n,Code:i,OriginalCode:r,CategoryName:s,LocationName:c,ID:d})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:d,onClick:e=>o.itemClick(d)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold"},e.toDisplayString(l),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.assetStatusColor(t))},e.toDisplayString(a),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",{selectable:""},"资产编码："+e.toDisplayString(i),1),e.createElementVNode("text",null,"资产状态："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",{selectable:""},"原编码："+e.toDisplayString(r),1),e.createElementVNode("text",null,"使用情况："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"资产分类："),e.createElementVNode("text",null,e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(c),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-45}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])])],64)}]]),Mt={data:()=>({}),created(){this.popup=this.getParent()},methods:{getParent(e="uniPopup"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t}}};const Wt=["{","}"];const $t=/^(?:\d)+/,Qt=/^(?:\w)+/;const jt="zh-Hans",Ht="zh-Hant",Kt="en",Gt=Object.prototype.hasOwnProperty,Jt=(e,t)=>Gt.call(e,t),Yt=new class{constructor(){this._caches=Object.create(null)}interpolate(e,t,l=Wt){if(!t)return[e];let a=this._caches[e];return a||(a=function(e,[t,l]){const a=[];let o=0,n="";for(;o<e.length;){let i=e[o++];if(i===t){n&&a.push({type:"text",value:n}),n="";let t="";for(i=e[o++];void 0!==i&&i!==l;)t+=i,i=e[o++];const r=i===l,s=$t.test(t)?"list":r&&Qt.test(t)?"named":"unknown";a.push({value:t,type:s})}else n+=i}return n&&a.push({type:"text",value:n}),a}(e,l),this._caches[e]=a),function(e,t){const l=[];let a=0;const o=Array.isArray(t)?"list":(n=t,null!==n&&"object"==typeof n?"named":"unknown");var n;if("unknown"===o)return l;for(;a<e.length;){const n=e[a];switch(n.type){case"text":l.push(n.value);break;case"list":l.push(t[parseInt(n.value,10)]);break;case"named":"named"===o&&l.push(t[n.value])}a++}return l}(a,t)}};function Zt(e,t){if(!e)return;if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if("chinese"===(e=e.toLowerCase()))return jt;if(0===e.indexOf("zh"))return e.indexOf("-hans")>-1?jt:e.indexOf("-hant")>-1?Ht:(l=e,["-tw","-hk","-mo","-cht"].find((e=>-1!==l.indexOf(e)))?Ht:jt);var l;const a=function(e,t){return t.find((t=>0===e.indexOf(t)))}(e,[Kt,"fr","es"]);return a||void 0}class Xt{constructor({locale:e,fallbackLocale:t,messages:l,watcher:a,formater:o}){this.locale=Kt,this.fallbackLocale=Kt,this.message={},this.messages={},this.watchers=[],t&&(this.fallbackLocale=t),this.formater=o||Yt,this.messages=l||{},this.setLocale(e||Kt),a&&this.watchLocale(a)}setLocale(e){const t=this.locale;this.locale=Zt(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],t!==this.locale&&this.watchers.forEach((e=>{e(this.locale,t)}))}getLocale(){return this.locale}watchLocale(e){const t=this.watchers.push(e)-1;return()=>{this.watchers.splice(t,1)}}add(e,t,l=!0){const a=this.messages[e];a?l?Object.assign(a,t):Object.keys(t).forEach((e=>{Jt(a,e)||(a[e]=t[e])})):this.messages[e]=t}f(e,t,l){return this.formater.interpolate(e,t,l).join("")}t(e,t,l){let a=this.message;return"string"==typeof t?(t=Zt(t,this.messages))&&(a=this.messages[t]):l=t,Jt(a,e)?this.formater.interpolate(a[e],l).join(""):(console.warn(`Cannot translate the value of keypath ${e}. Use the value of keypath as default.`),e)}}function el(e,t={},l,a){"string"!=typeof e&&([e,t]=[t,e]),"string"!=typeof e&&(e="undefined"!=typeof uni&&uni.getLocale?uni.getLocale():"undefined"!=typeof global&&global.getLocale?global.getLocale():Kt),"string"!=typeof l&&(l="undefined"!=typeof __uniConfig&&__uniConfig.fallbackLocale||Kt);const o=new Xt({locale:e,fallbackLocale:l,messages:t,watcher:a});let n=(e,t)=>{if("function"!=typeof getApp)n=function(e,t){return o.t(e,t)};else{let e=!1;n=function(t,l){const a=getApp().$vm;return a&&(a.$locale,e||(e=!0,function(e,t){e.$watchLocale?e.$watchLocale((e=>{t.setLocale(e)})):e.$watch((()=>e.$locale),(e=>{t.setLocale(e)}))}(a,o))),o.t(t,l)}}return n(e,t)};return{i18n:o,f:(e,t,l)=>o.f(e,t,l),t:(e,t)=>n(e,t),add:(e,t,l=!0)=>o.add(e,t,l),watch:e=>o.watchLocale(e),getLocale:()=>o.getLocale(),setLocale:e=>o.setLocale(e)}}var tl={en:{"uni-popup.cancel":"cancel","uni-popup.ok":"ok","uni-popup.placeholder":"pleace enter","uni-popup.title":"Hint","uni-popup.shareTitle":"Share to"},"zh-Hans":{"uni-popup.cancel":"取消","uni-popup.ok":"确定","uni-popup.placeholder":"请输入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"},"zh-Hant":{"uni-popup.cancel":"取消","uni-popup.ok":"確定","uni-popup.placeholder":"請輸入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"}};const{t:ll}=el(tl);var al=l({name:"uniPopupDialog",mixins:[Mt],emits:["confirm","close"],props:{value:{type:[String,Number],default:""},placeholder:{type:[String,Number],default:""},type:{type:String,default:"error"},mode:{type:String,default:"base"},title:{type:String,default:""},content:{type:String,default:""},beforeClose:{type:Boolean,default:!1},cancelText:{type:String,default:""},confirmText:{type:String,default:""}},data:()=>({dialogType:"error",focus:!1,val:""}),computed:{okText(){return this.confirmText||ll("uni-popup.ok")},closeText(){return this.cancelText||ll("uni-popup.cancel")},placeholderText(){return this.placeholder||ll("uni-popup.placeholder")},titleText(){return this.title||ll("uni-popup.title")}},watch:{type(e){this.dialogType=e},mode(e){"input"===e&&(this.dialogType="info")},value(e){this.val=e}},created(){this.popup.disableMask(),"input"===this.mode?(this.dialogType="info",this.val=this.value):this.dialogType=this.type},mounted(){this.focus=!0},methods:{onOk(){"input"===this.mode?this.$emit("confirm",this.val):this.$emit("confirm"),this.beforeClose||this.popup.close()},closeDialog(){this.$emit("close"),this.beforeClose||this.popup.close()},close(){this.popup.close()}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-popup-dialog"},[e.createElementVNode("view",{class:"uni-dialog-title"},[e.createElementVNode("text",{class:e.normalizeClass(["uni-dialog-title-text",["uni-popup__"+n.dialogType]])},e.toDisplayString(i.titleText),3)]),"base"===a.mode?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-dialog-content"},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("text",{class:"uni-dialog-content-text"},e.toDisplayString(a.content),1)]),!0)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-dialog-content"},[e.renderSlot(t.$slots,"default",{},(()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-dialog-input","onUpdate:modelValue":l[0]||(l[0]=e=>n.val=e),type:"text",placeholder:i.placeholderText,focus:n.focus},null,8,["placeholder","focus"]),[[e.vModelText,n.val]])]),!0)])),e.createElementVNode("view",{class:"uni-dialog-button-group"},[e.createElementVNode("view",{class:"uni-dialog-button",onClick:l[1]||(l[1]=(...e)=>i.closeDialog&&i.closeDialog(...e))},[e.createElementVNode("text",{class:"uni-dialog-button-text"},e.toDisplayString(i.closeText),1)]),e.createElementVNode("view",{class:"uni-dialog-button uni-border-left",onClick:l[2]||(l[2]=(...e)=>i.onOk&&i.onOk(...e))},[e.createElementVNode("text",{class:"uni-dialog-button-text uni-button-color"},e.toDisplayString(i.okText),1)])])])}],["__scopeId","data-v-53d80307"]]);class ol{constructor(e,t){this.options=e,this.animation=uni.createAnimation(e),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let l=this.currentStepAnimates[this.next],a={};if(a=l||{styles:{},config:{}},nl.includes(e)){a.styles.transform||(a.styles.transform="");let l="";"rotate"===e&&(l="deg"),a.styles.transform+=`${e}(${t+l}) `}else a.styles[e]=`${t}`;this.currentStepAnimates[this.next]=a}_animateRun(e={},t={}){let l=this.$.$refs.ani.ref;if(l)return new Promise(((a,o)=>{nvueAnimation.transition(l,__spreadValues({styles:e},t),(e=>{a()}))}))}_nvueNextAnimate(e,t=0,l){let a=e[t];if(a){let{styles:o,config:n}=a;this._animateRun(o,n).then((()=>{t+=1,this._nvueNextAnimate(e,t,l)}))}else this.currentStepAnimates={},"function"==typeof l&&l(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const nl=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function il(e,t){if(t)return clearTimeout(t.timer),new ol(e,t)}nl.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{ol.prototype[e]=function(...t){return this.animation[e](...t),this}}));const rl={name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e=__spreadProps(__spreadValues({},this.styles),{"transition-duration":this.duration/1e3+"s"}),t="";for(let l in e){t+=this.toLine(l)+":"+e[l]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=il(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,t={}){if(this.animation){for(let t in e)try{"object"==typeof e[t]?this.animation[t](...e[t]):this.animation[t](e[t])}catch(Mn){i("error","at uni_modules/uni-transition/components/uni-transition/uni-transition.vue:139",`方法 ${t} 不存在`)}return this.animation.step(t),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=il(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},l=(e,l)=>{"fade"===l?t.opacity=this.animationType(e)[l]:t.transform+=this.animationType(e)[l]+" "};return"string"==typeof this.modeClass?l(e,this.modeClass):this.modeClass.forEach((t=>{l(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let l=null;"fade"===t?l=e?0:1:(l=e?"-100%":"0","zoom-in"===t&&(l=e?.8:1),"zoom-out"===t&&(l=e?1.2:1),"slide-right"===t&&(l=e?"100%":"0"),"slide-bottom"===t&&(l=e?"100%":"0")),this.animation[this.animationMode()[t]](l)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach((l=>{t(e,l)})),this.animation},animationType:e=>({fade:e?1:0,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}};var sl=l(rl,[["render",function(t,l,a,o,n,i){return n.isShow?(e.openBlock(),e.createElementBlock("view",{key:0,ref:"ani",animation:n.animationData,class:e.normalizeClass(a.customClass),style:e.normalizeStyle(i.transformStyles),onClick:l[0]||(l[0]=(...e)=>i.onClick&&i.onClick(...e))},[e.renderSlot(t.$slots,"default")],14,["animation"])):e.createCommentVNode("",!0)}]]);const cl={name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0},isMaskClick:{handler:function(e){this.mkclick=e},immediate:!0},showPopup(e){}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:this.isDesktop?"fixforpc-top":"top"}},computed:{isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:e,windowHeight:t,windowTop:l,safeArea:a,screenHeight:o,safeAreaInsets:n}=uni.getSystemInfoSync();this.popupWidth=e,this.popupHeight=t+(l||0),a&&this.safeArea?this.safeAreaInsets=n.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(){},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){this.showPopup&&(clearTimeout(this.timer),this.showPopup=!1);e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)||(e=this.type),this.config[e]?(this[this.config[e]](),this.$emit("change",{show:!0,type:e})):i("error","at uni_modules/uni-popup/components/uni-popup/uni-popup.vue:280","缺少类型：",e)},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg},e||(this.showPopup=!0,this.showTrans=!0)},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center"},e||(this.showPopup=!0,this.showTrans=!0)},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)}}};var dl=l(cl,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-transition"),sl);return n.showPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-popup",[n.popupstyle,i.isDesktop?"fixforpc-z-index":""]])},[e.createElementVNode("view",{onTouchstart:l[1]||(l[1]=(...e)=>i.touchstart&&i.touchstart(...e))},[n.maskShow?(e.openBlock(),e.createBlock(s,{key:"1",name:"mask","mode-class":"fade",styles:n.maskClass,duration:n.duration,show:n.showTrans,onClick:i.onTap},null,8,["styles","duration","show","onClick"])):e.createCommentVNode("",!0),e.createVNode(s,{key:"2","mode-class":n.ani,name:"content",styles:n.transClass,duration:n.duration,show:n.showTrans,onClick:i.onTap},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-popup__wrapper",[n.popupstyle]]),style:e.normalizeStyle({backgroundColor:i.bg}),onClick:l[0]||(l[0]=(...e)=>i.clear&&i.clear(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)])),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],2)):e.createCommentVNode("",!0)}],["__scopeId","data-v-02b8a82d"]]);var ul=l({name:"UniFab",emits:["fabClick","trigger"],props:{pattern:{type:Object,default:()=>({})},horizontal:{type:String,default:"left"},vertical:{type:String,default:"bottom"},direction:{type:String,default:"horizontal"},content:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},popMenu:{type:Boolean,default:!0}},data:()=>({fabShow:!1,isShow:!1,isAndroidNvue:!1,styles:{color:"#3c3e49",selectedColor:"#007AFF",backgroundColor:"#fff",buttonColor:"#007AFF",iconColor:"#fff"}}),computed:{contentWidth(e){return 55*(this.content.length+1)+15+"px"},contentWidthMin:()=>"55px",boxWidth(){return this.getPosition(3,"horizontal")},boxHeight(){return this.getPosition(3,"vertical")},leftBottom(){return this.getPosition(0,"left","bottom")},rightBottom(){return this.getPosition(0,"right","bottom")},leftTop(){return this.getPosition(0,"left","top")},rightTop(){return this.getPosition(0,"right","top")},flexDirectionStart(){return this.getPosition(1,"vertical","top")},flexDirectionEnd(){return this.getPosition(1,"vertical","bottom")},horizontalLeft(){return this.getPosition(2,"horizontal","left")},horizontalRight(){return this.getPosition(2,"horizontal","right")}},watch:{pattern:{handler(e,t){this.styles=Object.assign({},this.styles,e)},deep:!0}},created(){this.isShow=this.show,0===this.top&&(this.fabShow=!0),this.styles=Object.assign({},this.styles,this.pattern)},methods:{_onClick(){this.$emit("fabClick"),this.popMenu&&(this.isShow=!this.isShow)},open(){this.isShow=!0},close(){this.isShow=!1},_onItemClick(e,t){this.$emit("trigger",{index:e,item:t})},getPosition(e,t,l){return 0===e?this.horizontal===t&&this.vertical===l:1===e?this.direction===t&&this.vertical===l:2===e?this.direction===t&&this.horizontal===l:this.isShow&&this.direction===t?this.contentWidth:this.contentWidthMin}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock("view",{class:"uni-cursor-point"},[a.popMenu&&(i.leftBottom||i.rightBottom||i.leftTop||i.rightTop)&&a.content.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass([{"uni-fab--leftBottom":i.leftBottom,"uni-fab--rightBottom":i.rightBottom,"uni-fab--leftTop":i.leftTop,"uni-fab--rightTop":i.rightTop},"uni-fab"])},[e.createElementVNode("view",{class:e.normalizeClass([{"uni-fab__content--left":"left"===a.horizontal,"uni-fab__content--right":"right"===a.horizontal,"uni-fab__content--flexDirection":"vertical"===a.direction,"uni-fab__content--flexDirectionStart":i.flexDirectionStart,"uni-fab__content--flexDirectionEnd":i.flexDirectionEnd,"uni-fab__content--other-platform":!n.isAndroidNvue},"uni-fab__content"]),style:e.normalizeStyle({width:i.boxWidth,height:i.boxHeight,backgroundColor:n.styles.backgroundColor}),elevation:"5"},[i.flexDirectionStart||i.horizontalLeft?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-fab__item uni-fab__item--first"})):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.content,((t,l)=>(e.openBlock(),e.createElementBlock("view",{key:l,class:e.normalizeClass([{"uni-fab__item--active":n.isShow},"uni-fab__item"]),onClick:e=>i._onItemClick(l,t)},[e.createElementVNode("image",{src:t.active?t.selectedIconPath:t.iconPath,class:"uni-fab__item-image",mode:"aspectFit"},null,8,["src"]),e.createElementVNode("text",{class:"uni-fab__item-text",style:e.normalizeStyle({color:t.active?n.styles.selectedColor:n.styles.color})},e.toDisplayString(t.text),5)],10,["onClick"])))),128)),i.flexDirectionEnd||i.horizontalRight?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-fab__item uni-fab__item--first"})):e.createCommentVNode("",!0)],6)],2)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass([{"uni-fab__circle--leftBottom":i.leftBottom,"uni-fab__circle--rightBottom":i.rightBottom,"uni-fab__circle--leftTop":i.leftTop,"uni-fab__circle--rightTop":i.rightTop,"uni-fab__content--other-platform":!n.isAndroidNvue},"uni-fab__circle uni-fab__plus"]),style:e.normalizeStyle({"background-color":n.styles.buttonColor}),onClick:l[0]||(l[0]=(...e)=>i._onClick&&i._onClick(...e))},[e.createVNode(s,{class:e.normalizeClass(["fab-circle-icon",{"uni-fab__plus--active":n.isShow&&a.content.length>0}]),type:"plusempty",color:n.styles.iconColor,size:"32"},null,8,["color","class"])],6)])}],["__scopeId","data-v-7f70c59e"]]);const ml={img:Symbol(),repair:Symbol(),borrow:Symbol(),printer:Symbol(),location:Symbol()};function pl(){return"undefined"!=typeof navigator&&"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}const vl="function"==typeof Proxy;class hl{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const l={};if(e.settings)for(const n in e.settings){const t=e.settings[n];l[n]=t.defaultValue}const a=`__vue-devtools-plugin-settings__${e.id}`;let o=__spreadValues({},l);try{const e=localStorage.getItem(a),t=JSON.parse(e);Object.assign(o,t)}catch(Mn){}this.fallbacks={getSettings:()=>o,setSettings(e){try{localStorage.setItem(a,JSON.stringify(e))}catch(Mn){}o=e}},t.on("plugin:settings:set",((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((l=>{this.targetQueue.push({method:t,args:e,resolve:l})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function fl(e,t){const l=pl(),a=pl().__VUE_DEVTOOLS_GLOBAL_HOOK__,o=vl&&e.enableEarlyProxy;if(!a||!l.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&o){const n=o?new hl(e,a):null;(l.__VUE_DEVTOOLS_PLUGINS__=l.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:e,setupFn:t,proxy:n}),n&&t(n.proxiedTarget)}else a.emit("devtools-plugin:setup",e,t)}
/*!
   * vuex v4.0.2
   * (c) 2021 Evan You
   * @license MIT
   */var gl="store";function yl(t){return void 0===t&&(t=null),e.inject(null!==t?t:gl)}function wl(e,t){Object.keys(e).forEach((function(l){return t(e[l],l)}))}function Nl(e,t,l){return t.indexOf(e)<0&&(l&&l.prepend?t.unshift(e):t.push(e)),function(){var l=t.indexOf(e);l>-1&&t.splice(l,1)}}function Cl(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var l=e.state;bl(e,l,[],e._modules.root,!0),El(e,l,t)}function El(t,l,a){var o=t._state;t.getters={},t._makeLocalGettersCache=Object.create(null);var n=t._wrappedGetters,i={};wl(n,(function(e,l){i[l]=function(e,t){return function(){return e(t)}}(e,t),Object.defineProperty(t.getters,l,{get:function(){return i[l]()},enumerable:!0})})),t._state=e.reactive({data:l}),t.strict&&function(t){e.watch((function(){return t._state.data}),(function(){}),{deep:!0,flush:"sync"})}(t),o&&a&&t._withCommit((function(){o.data=null}))}function bl(e,t,l,a,o){var n=!l.length,i=e._modules.getNamespace(l);if(a.namespaced&&(e._modulesNamespaceMap[i],e._modulesNamespaceMap[i]=a),!n&&!o){var r=Vl(t,l.slice(0,-1)),s=l[l.length-1];e._withCommit((function(){r[s]=a.state}))}var c=a.context=function(e,t,l){var a=""===t,o={dispatch:a?e.dispatch:function(l,a,o){var n=kl(l,a,o),i=n.payload,r=n.options,s=n.type;return r&&r.root||(s=t+s),e.dispatch(s,i)},commit:a?e.commit:function(l,a,o){var n=kl(l,a,o),i=n.payload,r=n.options,s=n.type;r&&r.root||(s=t+s),e.commit(s,i,r)}};return Object.defineProperties(o,{getters:{get:a?function(){return e.getters}:function(){return Dl(e,t)}},state:{get:function(){return Vl(e.state,l)}}}),o}(e,i,l);a.forEachMutation((function(t,l){!function(e,t,l,a){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){l.call(e,a.state,t)}))}(e,i+l,t,c)})),a.forEachAction((function(t,l){var a=t.root?l:i+l,o=t.handler||t;!function(e,t,l,a){(e._actions[t]||(e._actions[t]=[])).push((function(t){var o,n=l.call(e,{dispatch:a.dispatch,commit:a.commit,getters:a.getters,state:a.state,rootGetters:e.getters,rootState:e.state},t);return(o=n)&&"function"==typeof o.then||(n=Promise.resolve(n)),e._devtoolHook?n.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):n}))}(e,a,o,c)})),a.forEachGetter((function(t,l){!function(e,t,l,a){if(e._wrappedGetters[t])return;e._wrappedGetters[t]=function(e){return l(a.state,a.getters,e.state,e.getters)}}(e,i+l,t,c)})),a.forEachChild((function(a,n){bl(e,t,l.concat(n),a,o)}))}function Dl(e,t){if(!e._makeLocalGettersCache[t]){var l={},a=t.length;Object.keys(e.getters).forEach((function(o){if(o.slice(0,a)===t){var n=o.slice(a);Object.defineProperty(l,n,{get:function(){return e.getters[o]},enumerable:!0})}})),e._makeLocalGettersCache[t]=l}return e._makeLocalGettersCache[t]}function Vl(e,t){return t.reduce((function(e,t){return e[t]}),e)}function kl(e,t,l){var a;return null!==(a=e)&&"object"==typeof a&&e.type&&(l=t,t=e,e=e.type),{type:e,payload:t,options:l}}var xl="vuex:mutations",_l="vuex:actions",Sl="vuex",Il=0;function Bl(e,t){fl({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:["vuex bindings"]},(function(l){l.addTimelineLayer({id:xl,label:"Vuex Mutations",color:Tl}),l.addTimelineLayer({id:_l,label:"Vuex Actions",color:Tl}),l.addInspector({id:Sl,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),l.on.getInspectorTree((function(l){if(l.app===e&&l.inspectorId===Sl)if(l.filter){var a=[];Rl(a,t._modules.root,l.filter,""),l.rootNodes=a}else l.rootNodes=[Ol(t._modules.root,"")]})),l.on.getInspectorState((function(l){if(l.app===e&&l.inspectorId===Sl){var a=l.nodeId;Dl(t,a),l.state=function(e,t,l){t="root"===l?t:t[l];var a=Object.keys(t),o={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(a.length){var n=function(e){var t={};return Object.keys(e).forEach((function(l){var a=l.split("/");if(a.length>1){var o=t,n=a.pop();a.forEach((function(e){o[e]||(o[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),o=o[e]._custom.value})),o[n]=Ll((function(){return e[l]}))}else t[l]=Ll((function(){return e[l]}))})),t}(t);o.getters=Object.keys(n).map((function(e){return{key:e.endsWith("/")?Pl(e):e,editable:!1,value:Ll((function(){return n[e]}))}}))}return o}((o=t._modules,(i=(n=a).split("/").filter((function(e){return e}))).reduce((function(e,t,l){var a=e[t];if(!a)throw new Error('Missing module "'+t+'" for path "'+n+'".');return l===i.length-1?a:a._children}),"root"===n?o:o.root._children)),"root"===a?t.getters:t._makeLocalGettersCache,a)}var o,n,i})),l.on.editInspectorState((function(l){if(l.app===e&&l.inspectorId===Sl){var a=l.nodeId,o=l.path;"root"!==a&&(o=a.split("/").filter(Boolean).concat(o)),t._withCommit((function(){l.set(t._state.data,o,l.state.value)}))}})),t.subscribe((function(e,t){var a={};e.payload&&(a.payload=e.payload),a.state=t,l.notifyComponentUpdate(),l.sendInspectorTree(Sl),l.sendInspectorState(Sl),l.addTimelineEvent({layerId:xl,event:{time:Date.now(),title:e.type,data:a}})})),t.subscribeAction({before:function(e,t){var a={};e.payload&&(a.payload=e.payload),e._id=Il++,e._time=Date.now(),a.state=t,l.addTimelineEvent({layerId:_l,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:a}})},after:function(e,t){var a={},o=Date.now()-e._time;a.duration={_custom:{type:"duration",display:o+"ms",tooltip:"Action duration",value:o}},e.payload&&(a.payload=e.payload),a.state=t,l.addTimelineEvent({layerId:_l,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:a}})}})}))}var Tl=8702998,Al={label:"namespaced",textColor:16777215,backgroundColor:6710886};function Pl(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function Ol(e,t){return{id:t||"root",label:Pl(t),tags:e.namespaced?[Al]:[],children:Object.keys(e._children).map((function(l){return Ol(e._children[l],t+l+"/")}))}}function Rl(e,t,l,a){a.includes(l)&&e.push({id:a||"root",label:a.endsWith("/")?a.slice(0,a.length-1):a||"Root",tags:t.namespaced?[Al]:[]}),Object.keys(t._children).forEach((function(o){Rl(e,t._children[o],l,a+o+"/")}))}function Ll(e){try{return e()}catch(Mn){return Mn}}var Fl=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var l=e.state;this.state=("function"==typeof l?l():l)||{}},ql={namespaced:{configurable:!0}};ql.namespaced.get=function(){return!!this._rawModule.namespaced},Fl.prototype.addChild=function(e,t){this._children[e]=t},Fl.prototype.removeChild=function(e){delete this._children[e]},Fl.prototype.getChild=function(e){return this._children[e]},Fl.prototype.hasChild=function(e){return e in this._children},Fl.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},Fl.prototype.forEachChild=function(e){wl(this._children,e)},Fl.prototype.forEachGetter=function(e){this._rawModule.getters&&wl(this._rawModule.getters,e)},Fl.prototype.forEachAction=function(e){this._rawModule.actions&&wl(this._rawModule.actions,e)},Fl.prototype.forEachMutation=function(e){this._rawModule.mutations&&wl(this._rawModule.mutations,e)},Object.defineProperties(Fl.prototype,ql);var zl=function(e){this.register([],e,!1)};function Ul(e,t,l){if(t.update(l),l.modules)for(var a in l.modules){if(!t.getChild(a))return;Ul(e.concat(a),t.getChild(a),l.modules[a])}}zl.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},zl.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,l){return e+((t=t.getChild(l)).namespaced?l+"/":"")}),"")},zl.prototype.update=function(e){Ul([],this.root,e)},zl.prototype.register=function(e,t,l){var a=this;void 0===l&&(l=!0);var o=new Fl(t,l);0===e.length?this.root=o:this.get(e.slice(0,-1)).addChild(e[e.length-1],o);t.modules&&wl(t.modules,(function(t,o){a.register(e.concat(o),t,l)}))},zl.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),l=e[e.length-1],a=t.getChild(l);a&&a.runtime&&t.removeChild(l)},zl.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),l=e[e.length-1];return!!t&&t.hasChild(l)};var Ml=function(e){var t=this;void 0===e&&(e={});var l=e.plugins;void 0===l&&(l=[]);var a=e.strict;void 0===a&&(a=!1);var o=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new zl(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=o;var n=this,i=this.dispatch,r=this.commit;this.dispatch=function(e,t){return i.call(n,e,t)},this.commit=function(e,t,l){return r.call(n,e,t,l)},this.strict=a;var s=this._modules.root.state;bl(this,s,[],this._modules.root),El(this,s),l.forEach((function(e){return e(t)}))},Wl={state:{configurable:!0}};function $l(){let e=new Date,t=e.getFullYear(),l=e.getMonth()+1;l=l<10?"0"+l:l;let a=e.getDate();return a=a<10?"0"+a:a,e.getHours(),e.getMinutes(),e.getSeconds(),t+"-"+l+"-"+a}function Ql(e){return T(e)?"":e.length<=10?e:e.substr(0,10)}Ml.prototype.install=function(e,t){e.provide(t||gl,this),e.config.globalProperties.$store=this,void 0!==this._devtools&&this._devtools&&Bl(e,this)},Wl.state.get=function(){return this._state.data},Wl.state.set=function(e){},Ml.prototype.commit=function(e,t,l){var a=this,o=kl(e,t,l),n=o.type,i=o.payload,r={type:n,payload:i},s=this._mutations[n];s&&(this._withCommit((function(){s.forEach((function(e){e(i)}))})),this._subscribers.slice().forEach((function(e){return e(r,a.state)})))},Ml.prototype.dispatch=function(e,t){var l=this,a=kl(e,t),o=a.type,n=a.payload,i={type:o,payload:n},r=this._actions[o];if(r){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(i,l.state)}))}catch(Mn){}var s=r.length>1?Promise.all(r.map((function(e){return e(n)}))):r[0](n);return new Promise((function(e,t){s.then((function(t){try{l._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(i,l.state)}))}catch(Mn){}e(t)}),(function(e){try{l._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(i,l.state,e)}))}catch(Mn){}t(e)}))}))}},Ml.prototype.subscribe=function(e,t){return Nl(e,this._subscribers,t)},Ml.prototype.subscribeAction=function(e,t){return Nl("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},Ml.prototype.watch=function(t,l,a){var o=this;return e.watch((function(){return t(o.state,o.getters)}),l,Object.assign({},a))},Ml.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},Ml.prototype.registerModule=function(e,t,l){void 0===l&&(l={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),bl(this,this.state,e,this._modules.get(e),l.preserveState),El(this,this.state)},Ml.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){delete Vl(t.state,e.slice(0,-1))[e[e.length-1]]})),Cl(this)},Ml.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},Ml.prototype.hotUpdate=function(e){this._modules.update(e),Cl(this,!0)},Ml.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(Ml.prototype,Wl);const jl=(Hl="DothanTech-LPAPI",weex.requireModule(Hl));var Hl;function Kl(e,t,l){return i("log","at subcontract/mine/printer/lpapi-uniplugin.js:4",`### Request: action = ${e}`),i("log","at subcontract/mine/printer/lpapi-uniplugin.js:5",t?JSON.stringify(t):t),new Promise((a=>{jl&&jl[e]?jl[e](t||{},(e=>{i("log","at subcontract/mine/printer/lpapi-uniplugin.js:9","### Response:"),i("log","at subcontract/mine/printer/lpapi-uniplugin.js:10",JSON.stringify(t)),e&&0===e.code?a(e.data||!0):(a(void 0),i("log","at subcontract/mine/printer/lpapi-uniplugin.js:15",e.data)),"function"==typeof l&&l(0===e.code?e.data:null)})):jl?(a(void 0),i("log","at subcontract/mine/printer/lpapi-uniplugin.js:24","LPAPI插件加载失败")):(a(void 0),i("log","at subcontract/mine/printer/lpapi-uniplugin.js:27","未检测到该方法:"+e))}))}const Gl={getPrinters:e=>("string"==typeof e&&(e={name:e}),Kl("getPrinters",e)),getFirstPrinter:e=>("string"==typeof e&&(e={name:e}),Kl("getFirstPrinter",e)),openPrinter:(e,t)=>("string"==typeof e&&(e={name:e}),Kl("openPrinter","object"==typeof e?e:{},t)),getPrinterName:()=>Kl("getPrinterName",{}),getPrinterInfo:()=>Kl("getPrinterInfo",{}),isPrinterOpened:()=>Kl("isPrinterOpened",{}),isPrinterSupported(e){return Kl("isPrinterSupported",(e="object"==typeof e?e:{name:arguments[0],model:arguments[1]})||{})},closePrinter:()=>Kl("closePrinter",{}),printImage:e=>Kl("printImage",e),startJob:e=>(i("log","at subcontract/mine/printer/lpapi-uniplugin.js:139",JSON.stringify(e)),Kl("startJob",e)),commitJob:e=>Kl("commitJob",e),endJob:()=>Kl("endJob",{}),getJobPages:()=>Kl("getJobPages",{}),setDrawParam:e=>Kl("setDrawParam",e),setItemOrientation:e=>Kl("setItemOrientation",e="object"==typeof e?e:{orientation:e}),setItemHorizontalAlignment:e=>Kl("setItemHorizontalAlignment",e="object"==typeof e?e:{alignment:e}),setItemVerticalAlignment:e=>Kl("setItemVerticalAlignment",e="object"==typeof e?e:{alignment:e}),setBackground:e=>Kl("setBackground",e="object"==typeof e?e:{color:e}),drawText:e=>Kl("drawText",e),draw1DBarcode:e=>Kl("draw1DBarcode",e),draw2DQRCode:e=>Kl("draw2DQRCode",e),drawRectangle:e=>Kl("drawRectangle",e),fillRectangle:e=>Kl("fillRectangle",e),drawRoundRectangle:e=>Kl("drawRoundRectangle",e),fillRoundRectangle:e=>Kl("fillRoundRectangle",e),drawEllipse:e=>Kl("drawEllipse",e),fillEllipse:e=>Kl("fillEllipse",e),drawCircle:e=>Kl("drawCircle",e),fillCircle:e=>Kl("fillCircle",e),drawLine:e=>Kl("drawLine",e),drawDashLine:e=>Kl("drawDashLine",e),drawImage:e=>Kl("drawImage",e)};var Jl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Yl={exports:{}},Zl={},Xl={},ea={};function ta(e,t){return void 0===t&&(t=Object),t&&"function"==typeof t.freeze?t.freeze(e):e}var la=ta({HTML:"text/html",isHTML:function(e){return e===la.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),aa=ta({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===aa.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});ea.freeze=ta,ea.MIME_TYPE=la,ea.NAMESPACE=aa;var oa=ea.NAMESPACE;function na(e){return""!==e}function ia(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function ra(e){if(!e)return[];var t=function(e){return e?e.split(/[\t\n\f\r ]+/).filter(na):[]}(e);return Object.keys(t.reduce(ia,{}))}function sa(e,t){for(var l in e)t[l]=e[l]}function ca(e,t){var l=e.prototype;if(!(l instanceof t)){let a=function(){};a.prototype=t.prototype,a=new a,sa(l,a),e.prototype=l=a}l.constructor!=e&&("function"!=typeof e&&i("error","at node_modules/@xmldom/xmldom/lib/dom.js:84","unknown Class:"+e),l.constructor=e)}var da={},ua=da.ELEMENT_NODE=1,ma=da.ATTRIBUTE_NODE=2,pa=da.TEXT_NODE=3,va=da.CDATA_SECTION_NODE=4,ha=da.ENTITY_REFERENCE_NODE=5,fa=da.ENTITY_NODE=6,ga=da.PROCESSING_INSTRUCTION_NODE=7,ya=da.COMMENT_NODE=8,wa=da.DOCUMENT_NODE=9,Na=da.DOCUMENT_TYPE_NODE=10,Ca=da.DOCUMENT_FRAGMENT_NODE=11,Ea=da.NOTATION_NODE=12,ba={},Da={};ba.INDEX_SIZE_ERR=(Da[1]="Index size error",1),ba.DOMSTRING_SIZE_ERR=(Da[2]="DOMString size error",2);var Va=ba.HIERARCHY_REQUEST_ERR=(Da[3]="Hierarchy request error",3);ba.WRONG_DOCUMENT_ERR=(Da[4]="Wrong document",4),ba.INVALID_CHARACTER_ERR=(Da[5]="Invalid character",5),ba.NO_DATA_ALLOWED_ERR=(Da[6]="No data allowed",6),ba.NO_MODIFICATION_ALLOWED_ERR=(Da[7]="No modification allowed",7);var ka=ba.NOT_FOUND_ERR=(Da[8]="Not found",8);ba.NOT_SUPPORTED_ERR=(Da[9]="Not supported",9);var xa=ba.INUSE_ATTRIBUTE_ERR=(Da[10]="Attribute in use",10);function _a(e,t){if(t instanceof Error)var l=t;else l=this,Error.call(this,Da[e]),this.message=Da[e],Error.captureStackTrace&&Error.captureStackTrace(this,_a);return l.code=e,t&&(this.message=this.message+": "+t),l}function Sa(){}function Ia(e,t){this._node=e,this._refresh=t,Ba(this)}function Ba(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var l=e._refresh(e._node);uo(e,"length",l.length),sa(l,e),e._inc=t}}function Ta(){}function Aa(e,t){for(var l=e.length;l--;)if(e[l]===t)return l}function Pa(e,t,l,a){if(a?t[Aa(t,a)]=l:t[t.length++]=l,e){l.ownerElement=e;var o=e.ownerDocument;o&&(a&&Ua(o,e,a),function(e,t,l){e&&e._inc++,l.namespaceURI===oa.XMLNS&&(t._nsMap[l.prefix?l.localName:""]=l.value)}(o,e,l))}}function Oa(e,t,l){var a=Aa(t,l);if(!(a>=0))throw _a(ka,new Error(e.tagName+"@"+l));for(var o=t.length-1;a<o;)t[a]=t[++a];if(t.length=o,e){var n=e.ownerDocument;n&&(Ua(n,e,l),l.ownerElement=null)}}function Ra(){}function La(){}function Fa(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function qa(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(qa(e,t))return!0}while(e=e.nextSibling)}function za(){}function Ua(e,t,l,a){e&&e._inc++,l.namespaceURI===oa.XMLNS&&delete t._nsMap[l.prefix?l.localName:""]}function Ma(e,t,l){if(e&&e._inc){e._inc++;var a=t.childNodes;if(l)a[a.length++]=l;else{for(var o=t.firstChild,n=0;o;)a[n++]=o,o=o.nextSibling;a.length=n}}}function Wa(e,t){var l=t.previousSibling,a=t.nextSibling;return l?l.nextSibling=a:e.firstChild=a,a?a.previousSibling=l:e.lastChild=l,Ma(e.ownerDocument,e),t}function $a(e,t,l){var a=t.parentNode;if(a&&a.removeChild(t),t.nodeType===Ca){var o=t.firstChild;if(null==o)return t;var n=t.lastChild}else o=n=t;var i=l?l.previousSibling:e.lastChild;o.previousSibling=i,n.nextSibling=l,i?i.nextSibling=o:e.firstChild=o,null==l?e.lastChild=n:l.previousSibling=n;do{o.parentNode=e}while(o!==n&&(o=o.nextSibling));return Ma(e.ownerDocument||e,e),t.nodeType==Ca&&(t.firstChild=t.lastChild=null),t}function Qa(){this._nsMap={}}function ja(){}function Ha(){}function Ka(){}function Ga(){}function Ja(){}function Ya(){}function Za(){}function Xa(){}function eo(){}function to(){}function lo(){}function ao(){}function oo(e,t){var l=[],a=9==this.nodeType&&this.documentElement||this,o=a.prefix,n=a.namespaceURI;if(n&&null==o&&null==(o=a.lookupPrefix(n)))var i=[{namespace:n,prefix:null}];return ro(this,l,e,t,i),l.join("")}function no(e,t,l){var a=e.prefix||"",o=e.namespaceURI;if(!o)return!1;if("xml"===a&&o===oa.XML||o===oa.XMLNS)return!1;for(var n=l.length;n--;){var i=l[n];if(i.prefix===a)return i.namespace!==o}return!0}function io(e,t,l){e.push(" ",t,'="',l.replace(/[<&"]/g,Fa),'"')}function ro(e,t,l,a,o){if(o||(o=[]),a){if(!(e=a(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case ua:var n=e.attributes,i=n.length,r=e.firstChild,s=e.tagName,c=s;if(!(l=oa.isHTML(e.namespaceURI)||l)&&!e.prefix&&e.namespaceURI){for(var d,u=0;u<n.length;u++)if("xmlns"===n.item(u).name){d=n.item(u).value;break}if(!d)for(var m=o.length-1;m>=0;m--){if(""===(p=o[m]).prefix&&p.namespace===e.namespaceURI){d=p.namespace;break}}if(d!==e.namespaceURI)for(m=o.length-1;m>=0;m--){var p;if((p=o[m]).namespace===e.namespaceURI){p.prefix&&(c=p.prefix+":"+s);break}}}t.push("<",c);for(var v=0;v<i;v++){"xmlns"==(h=n.item(v)).prefix?o.push({prefix:h.localName,namespace:h.value}):"xmlns"==h.nodeName&&o.push({prefix:"",namespace:h.value})}for(v=0;v<i;v++){var h,f,g;if(no(h=n.item(v),0,o))io(t,(f=h.prefix||"")?"xmlns:"+f:"xmlns",g=h.namespaceURI),o.push({prefix:f,namespace:g});ro(h,t,l,a,o)}if(s===c&&no(e,0,o))io(t,(f=e.prefix||"")?"xmlns:"+f:"xmlns",g=e.namespaceURI),o.push({prefix:f,namespace:g});if(r||l&&!/^(?:meta|link|img|br|hr|input)$/i.test(s)){if(t.push(">"),l&&/^script$/i.test(s))for(;r;)r.data?t.push(r.data):ro(r,t,l,a,o.slice()),r=r.nextSibling;else for(;r;)ro(r,t,l,a,o.slice()),r=r.nextSibling;t.push("</",c,">")}else t.push("/>");return;case wa:case Ca:for(r=e.firstChild;r;)ro(r,t,l,a,o.slice()),r=r.nextSibling;return;case ma:return io(t,e.name,e.value);case pa:return t.push(e.data.replace(/[<&]/g,Fa).replace(/]]>/g,"]]&gt;"));case va:return t.push("<![CDATA[",e.data,"]]>");case ya:return t.push("\x3c!--",e.data,"--\x3e");case Na:var y=e.publicId,w=e.systemId;if(t.push("<!DOCTYPE ",e.name),y)t.push(" PUBLIC ",y),w&&"."!=w&&t.push(" ",w),t.push(">");else if(w&&"."!=w)t.push(" SYSTEM ",w,">");else{var N=e.internalSubset;N&&t.push(" [",N,"]"),t.push(">")}return;case ga:return t.push("<?",e.target," ",e.data,"?>");case ha:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function so(e,t,l){var a;switch(t.nodeType){case ua:(a=t.cloneNode(!1)).ownerDocument=e;case Ca:break;case ma:l=!0}if(a||(a=t.cloneNode(!1)),a.ownerDocument=e,a.parentNode=null,l)for(var o=t.firstChild;o;)a.appendChild(so(e,o,l)),o=o.nextSibling;return a}function co(e,t,l){var a=new t.constructor;for(var o in t){var n=t[o];"object"!=typeof n&&n!=a[o]&&(a[o]=n)}switch(t.childNodes&&(a.childNodes=new Sa),a.ownerDocument=e,a.nodeType){case ua:var i=t.attributes,r=a.attributes=new Ta,s=i.length;r._ownerElement=a;for(var c=0;c<s;c++)a.setAttributeNode(co(e,i.item(c),!0));break;case ma:l=!0}if(l)for(var d=t.firstChild;d;)a.appendChild(co(e,d,l)),d=d.nextSibling;return a}function uo(e,t,l){e[t]=l}ba.INVALID_STATE_ERR=(Da[11]="Invalid state",11),ba.SYNTAX_ERR=(Da[12]="Syntax error",12),ba.INVALID_MODIFICATION_ERR=(Da[13]="Invalid modification",13),ba.NAMESPACE_ERR=(Da[14]="Invalid namespace",14),ba.INVALID_ACCESS_ERR=(Da[15]="Invalid access",15),_a.prototype=Error.prototype,sa(ba,_a),Sa.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var l=[],a=0;a<this.length;a++)ro(this[a],l,e,t);return l.join("")}},Ia.prototype.item=function(e){return Ba(this),this[e]},ca(Ia,Sa),Ta.prototype={length:0,item:Sa.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var l=this[t];if(l.nodeName==e)return l}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new _a(xa);var l=this.getNamedItem(e.nodeName);return Pa(this._ownerElement,this,e,l),l},setNamedItemNS:function(e){var t,l=e.ownerElement;if(l&&l!=this._ownerElement)throw new _a(xa);return t=this.getNamedItemNS(e.namespaceURI,e.localName),Pa(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return Oa(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var l=this.getNamedItemNS(e,t);return Oa(this._ownerElement,this,l),l},getNamedItemNS:function(e,t){for(var l=this.length;l--;){var a=this[l];if(a.localName==t&&a.namespaceURI==e)return a}return null}},Ra.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,l){var a=new za;if(a.implementation=this,a.childNodes=new Sa,a.doctype=l||null,l&&a.appendChild(l),t){var o=a.createElementNS(e,t);a.appendChild(o)}return a},createDocumentType:function(e,t,l){var a=new Ya;return a.name=e,a.nodeName=e,a.publicId=t||"",a.systemId=l||"",a}},La.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return $a(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return Wa(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return co(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==pa&&e.nodeType==pa?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var l=t._nsMap;if(l)for(var a in l)if(l[a]==e)return a;t=t.nodeType==ma?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var l=t._nsMap;if(l&&e in l)return l[e];t=t.nodeType==ma?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},sa(da,La),sa(da,La.prototype),za.prototype={nodeName:"#document",nodeType:wa,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==Ca){for(var l=e.firstChild;l;){var a=l.nextSibling;this.insertBefore(l,t),l=a}return e}return null==this.documentElement&&e.nodeType==ua&&(this.documentElement=e),$a(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),Wa(this,e)},importNode:function(e,t){return so(this,e,t)},getElementById:function(e){var t=null;return qa(this.documentElement,(function(l){if(l.nodeType==ua&&l.getAttribute("id")==e)return t=l,!0})),t},getElementsByClassName:function(e){var t=ra(e);return new Ia(this,(function(l){var a=[];return t.length>0&&qa(l.documentElement,(function(o){if(o!==l&&o.nodeType===ua){var n=o.getAttribute("class");if(n){var i=e===n;if(!i){var r=ra(n);i=t.every((s=r,function(e){return s&&-1!==s.indexOf(e)}))}i&&a.push(o)}}var s})),a}))},createElement:function(e){var t=new Qa;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new Sa,(t.attributes=new Ta)._ownerElement=t,t},createDocumentFragment:function(){var e=new to;return e.ownerDocument=this,e.childNodes=new Sa,e},createTextNode:function(e){var t=new Ka;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new Ga;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new Ja;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var l=new lo;return l.ownerDocument=this,l.tagName=l.target=e,l.nodeValue=l.data=t,l},createAttribute:function(e){var t=new ja;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new eo;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var l=new Qa,a=t.split(":"),o=l.attributes=new Ta;return l.childNodes=new Sa,l.ownerDocument=this,l.nodeName=t,l.tagName=t,l.namespaceURI=e,2==a.length?(l.prefix=a[0],l.localName=a[1]):l.localName=t,o._ownerElement=l,l},createAttributeNS:function(e,t){var l=new ja,a=t.split(":");return l.ownerDocument=this,l.nodeName=t,l.name=t,l.namespaceURI=e,l.specified=!0,2==a.length?(l.prefix=a[0],l.localName=a[1]):l.localName=t,l}},ca(za,La),Qa.prototype={nodeType:ua,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var l=this.ownerDocument.createAttribute(e);l.value=l.nodeValue=""+t,this.setAttributeNode(l)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===Ca?this.insertBefore(e,null):function(e,t){var l=t.parentNode;if(l){var a=e.lastChild;l.removeChild(t),a=e.lastChild}return a=e.lastChild,t.parentNode=e,t.previousSibling=a,t.nextSibling=null,a?a.nextSibling=t:e.firstChild=t,e.lastChild=t,Ma(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var l=this.getAttributeNodeNS(e,t);l&&this.removeAttributeNode(l)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var l=this.getAttributeNodeNS(e,t);return l&&l.value||""},setAttributeNS:function(e,t,l){var a=this.ownerDocument.createAttributeNS(e,t);a.value=a.nodeValue=""+l,this.setAttributeNode(a)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new Ia(this,(function(t){var l=[];return qa(t,(function(a){a===t||a.nodeType!=ua||"*"!==e&&a.tagName!=e||l.push(a)})),l}))},getElementsByTagNameNS:function(e,t){return new Ia(this,(function(l){var a=[];return qa(l,(function(o){o===l||o.nodeType!==ua||"*"!==e&&o.namespaceURI!==e||"*"!==t&&o.localName!=t||a.push(o)})),a}))}},za.prototype.getElementsByTagName=Qa.prototype.getElementsByTagName,za.prototype.getElementsByTagNameNS=Qa.prototype.getElementsByTagNameNS,ca(Qa,La),ja.prototype.nodeType=ma,ca(ja,La),Ha.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(Da[Va])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,l){l=this.data.substring(0,e)+l+this.data.substring(e+t),this.nodeValue=this.data=l,this.length=l.length}},ca(Ha,La),Ka.prototype={nodeName:"#text",nodeType:pa,splitText:function(e){var t=this.data,l=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var a=this.ownerDocument.createTextNode(l);return this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling),a}},ca(Ka,Ha),Ga.prototype={nodeName:"#comment",nodeType:ya},ca(Ga,Ha),Ja.prototype={nodeName:"#cdata-section",nodeType:va},ca(Ja,Ha),Ya.prototype.nodeType=Na,ca(Ya,La),Za.prototype.nodeType=Ea,ca(Za,La),Xa.prototype.nodeType=fa,ca(Xa,La),eo.prototype.nodeType=ha,ca(eo,La),to.prototype.nodeName="#document-fragment",to.prototype.nodeType=Ca,ca(to,La),lo.prototype.nodeType=ga,ca(lo,La),ao.prototype.serializeToString=function(e,t,l){return oo.call(e,t,l)},La.prototype.toString=oo;try{if(Object.defineProperty){let e=function(t){switch(t.nodeType){case ua:case Ca:var l=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&l.push(e(t)),t=t.nextSibling;return l.join("");default:return t.nodeValue}};Object.defineProperty(Ia.prototype,"length",{get:function(){return Ba(this),this.$$length}}),Object.defineProperty(La.prototype,"textContent",{get:function(){return e(this)},set:function(e){switch(this.nodeType){case ua:case Ca:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),uo=function(e,t,l){e["$$"+t]=l}}}catch(Mn){}Xl.DocumentType=Ya,Xl.DOMException=_a,Xl.DOMImplementation=Ra,Xl.Element=Qa,Xl.Node=La,Xl.NodeList=Sa,Xl.XMLSerializer=ao;var mo,po,vo={},ho={};mo=ho,po=ea.freeze,mo.XML_ENTITIES=po({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),mo.HTML_ENTITIES=po({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}),mo.entityMap=mo.HTML_ENTITIES;var fo={},go=ea.NAMESPACE,yo=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,wo=new RegExp("[\\-\\.0-9"+yo.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),No=new RegExp("^"+yo.source+wo.source+"*(?::"+yo.source+wo.source+"*)?$");function Co(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,Co)}function Eo(){}function bo(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function Do(e,t,l,a,o,n){function i(e,t,a){l.attributeNames.hasOwnProperty(e)&&n.fatalError("Attribute "+e+" redefined"),l.addValue(e,t,a)}for(var r,s=++t,c=0;;){var d=e.charAt(s);switch(d){case"=":if(1===c)r=e.slice(t,s),c=3;else{if(2!==c)throw new Error("attribute equal must after attrName");c=3}break;case"'":case'"':if(3===c||1===c){if(1===c&&(n.warning('attribute value must after "="'),r=e.slice(t,s)),t=s+1,!((s=e.indexOf(d,t))>0))throw new Error("attribute value no end '"+d+"' match");i(r,u=e.slice(t,s).replace(/&#?\w+;/g,o),t-1),c=5}else{if(4!=c)throw new Error('attribute value must after "="');i(r,u=e.slice(t,s).replace(/&#?\w+;/g,o),t),n.warning('attribute "'+r+'" missed start quot('+d+")!!"),t=s+1,c=5}break;case"/":switch(c){case 0:l.setTagName(e.slice(t,s));case 5:case 6:case 7:c=7,l.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return n.error("unexpected end of input"),0==c&&l.setTagName(e.slice(t,s)),s;case">":switch(c){case 0:l.setTagName(e.slice(t,s));case 5:case 6:case 7:break;case 4:case 1:"/"===(u=e.slice(t,s)).slice(-1)&&(l.closed=!0,u=u.slice(0,-1));case 2:2===c&&(u=r),4==c?(n.warning('attribute "'+u+'" missed quot(")!'),i(r,u.replace(/&#?\w+;/g,o),t)):(go.isHTML(a[""])&&u.match(/^(?:disabled|checked|selected)$/i)||n.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),i(u,u,t));break;case 3:throw new Error("attribute value missed!!")}return s;case"":d=" ";default:if(d<=" ")switch(c){case 0:l.setTagName(e.slice(t,s)),c=6;break;case 1:r=e.slice(t,s),c=2;break;case 4:var u=e.slice(t,s).replace(/&#?\w+;/g,o);n.warning('attribute "'+u+'" missed quot(")!!'),i(r,u,t);case 5:c=6}else switch(c){case 2:l.tagName,go.isHTML(a[""])&&r.match(/^(?:disabled|checked|selected)$/i)||n.warning('attribute "'+r+'" missed value!! "'+r+'" instead2!!'),i(r,r,t),t=s,c=1;break;case 5:n.warning('attribute space is required"'+r+'"!!');case 6:c=1,t=s;break;case 3:c=4,t=s;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function Vo(e,t,l){for(var a=e.tagName,o=null,n=e.length;n--;){var i=e[n],r=i.qName,s=i.value;if((m=r.indexOf(":"))>0)var c=i.prefix=r.slice(0,m),d=r.slice(m+1),u="xmlns"===c&&d;else d=r,c=null,u="xmlns"===r&&"";i.localName=d,!1!==u&&(null==o&&(o={},_o(l,l={})),l[u]=o[u]=s,i.uri=go.XMLNS,t.startPrefixMapping(u,s))}for(n=e.length;n--;){(c=(i=e[n]).prefix)&&("xml"===c&&(i.uri=go.XML),"xmlns"!==c&&(i.uri=l[c||""]))}var m;(m=a.indexOf(":"))>0?(c=e.prefix=a.slice(0,m),d=e.localName=a.slice(m+1)):(c=null,d=e.localName=a);var p=e.uri=l[c||""];if(t.startElement(p,d,a,e),!e.closed)return e.currentNSMap=l,e.localNSMap=o,!0;if(t.endElement(p,d,a),o)for(c in o)t.endPrefixMapping(c)}function ko(e,t,l,a,o){if(/^(?:script|textarea)$/i.test(l)){var n=e.indexOf("</"+l+">",t),i=e.substring(t+1,n);if(/[&<]/.test(i))return/^script$/i.test(l)?(o.characters(i,0,i.length),n):(i=i.replace(/&#?\w+;/g,a),o.characters(i,0,i.length),n)}return t+1}function xo(e,t,l,a){var o=a[l];return null==o&&((o=e.lastIndexOf("</"+l+">"))<t&&(o=e.lastIndexOf("</"+l)),a[l]=o),o<t}function _o(e,t){for(var l in e)t[l]=e[l]}function So(e,t,l,a){if("-"===e.charAt(t+2))return"-"===e.charAt(t+3)?(o=e.indexOf("--\x3e",t+4))>t?(l.comment(e,t+4,o-t-4),o+3):(a.error("Unclosed comment"),-1):-1;if("CDATA["==e.substr(t+3,6)){var o=e.indexOf("]]>",t+9);return l.startCDATA(),l.characters(e,t+9,o-t-9),l.endCDATA(),o+3}var n=function(e,t){var l,a=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;o.lastIndex=t,o.exec(e);for(;l=o.exec(e);)if(a.push(l),l[1])return a}(e,t),i=n.length;if(i>1&&/!doctype/i.test(n[0][0])){var r=n[1][0],s=!1,c=!1;i>3&&(/^public$/i.test(n[2][0])?(s=n[3][0],c=i>4&&n[4][0]):/^system$/i.test(n[2][0])&&(c=n[3][0]));var d=n[i-1];return l.startDTD(r,s,c),l.endDTD(),d.index+d[0].length}return-1}function Io(e,t,l){var a=e.indexOf("?>",t);if(a){var o=e.substring(t,a).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return o?(o[0].length,l.processingInstruction(o[1],o[2]),a+2):-1}return-1}function Bo(){this.attributeNames={}}Co.prototype=new Error,Co.prototype.name=Co.name,Eo.prototype={parse:function(e,t,l){var a=this.domBuilder;a.startDocument(),_o(t,t={}),function(e,t,l,a,o){function n(e){if(e>65535){var t=55296+((e-=65536)>>10),l=56320+(1023&e);return String.fromCharCode(t,l)}return String.fromCharCode(e)}function i(e){var t=e.slice(1,-1);return t in l?l[t]:"#"===t.charAt(0)?n(parseInt(t.substr(1).replace("x","0x"))):(o.error("entity not found:"+e),e)}function r(t){if(t>h){var l=e.substring(h,t).replace(/&#?\w+;/g,i);m&&s(h),a.characters(l,0,t-h),h=t}}function s(t,l){for(;t>=d&&(l=u.exec(e));)c=l.index,d=c+l[0].length,m.lineNumber++;m.columnNumber=t-c+1}var c=0,d=0,u=/.*(?:\r\n?|\n)|.*$/g,m=a.locator,p=[{currentNSMap:t}],v={},h=0;for(;;){try{var f=e.indexOf("<",h);if(f<0){if(!e.substr(h).match(/^\s*$/)){var g=a.doc,y=g.createTextNode(e.substr(h));g.appendChild(y),a.currentElement=y}return}switch(f>h&&r(f),e.charAt(f+1)){case"/":var w=e.indexOf(">",f+3),N=e.substring(f+2,w).replace(/[ \t\n\r]+$/g,""),C=p.pop();w<0?(N=e.substring(f+2).replace(/[\s<].*/,""),o.error("end tag name: "+N+" is not complete:"+C.tagName),w=f+1+N.length):N.match(/\s</)&&(N=N.replace(/[\s<].*/,""),o.error("end tag name: "+N+" maybe not complete"),w=f+1+N.length);var E=C.localNSMap,b=C.tagName==N;if(b||C.tagName&&C.tagName.toLowerCase()==N.toLowerCase()){if(a.endElement(C.uri,C.localName,N),E)for(var D in E)a.endPrefixMapping(D);b||o.fatalError("end tag name: "+N+" is not match the current start tagName:"+C.tagName)}else p.push(C);w++;break;case"?":m&&s(f),w=Io(e,f,a);break;case"!":m&&s(f),w=So(e,f,a,o);break;default:m&&s(f);var V=new Bo,k=p[p.length-1].currentNSMap,x=(w=Do(e,f,V,k,i,o),V.length);if(!V.closed&&xo(e,w,V.tagName,v)&&(V.closed=!0,l.nbsp||o.warning("unclosed xml attribute")),m&&x){for(var _=bo(m,{}),S=0;S<x;S++){var I=V[S];s(I.offset),I.locator=bo(m,{})}a.locator=_,Vo(V,a,k)&&p.push(V),a.locator=m}else Vo(V,a,k)&&p.push(V);go.isHTML(V.uri)&&!V.closed?w=ko(e,w,V.tagName,i,a):w++}}catch(Mn){if(Mn instanceof Co)throw Mn;o.error("element parse error: "+Mn),w=-1}w>h?h=w:r(Math.max(f,h)+1)}}(e,t,l,a,this.errorHandler),a.endDocument()}},Bo.prototype={setTagName:function(e){if(!No.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,l){if(!No.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:l}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},fo.XMLReader=Eo,fo.ParseError=Co;var To=ea,Ao=Xl,Po=ho,Oo=fo,Ro=Ao.DOMImplementation,Lo=To.NAMESPACE,Fo=Oo.ParseError,qo=Oo.XMLReader;function zo(e){this.options=e||{locator:{}}}function Uo(){this.cdata=!1}function Mo(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function Wo(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function $o(e,t,l){return"string"==typeof e?e.substr(t,l):e.length>=t+l||t?new java.lang.String(e,t,l)+"":e}function Qo(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}zo.prototype.parseFromString=function(e,t){var l=this.options,a=new qo,o=l.domBuilder||new Uo,n=l.errorHandler,i=l.locator,r=l.xmlns||{},s=/\/x?html?$/.test(t),c=s?Po.HTML_ENTITIES:Po.XML_ENTITIES;return i&&o.setDocumentLocator(i),a.errorHandler=function(e,t,l){if(!e){if(t instanceof Uo)return t;e=t}var a={},o=e instanceof Function;function n(t){var n=e[t];!n&&o&&(n=2==e.length?function(l){e(t,l)}:e),a[t]=n&&function(e){n("[xmldom "+t+"]\t"+e+Wo(l))}||function(){}}return l=l||{},n("warning"),n("error"),n("fatalError"),a}(n,o,i),a.domBuilder=l.domBuilder||o,s&&(r[""]=Lo.HTML),r.xml=r.xml||Lo.XML,e&&"string"==typeof e?a.parse(e,r,c):a.errorHandler.error("invalid doc source"),o.doc},Uo.prototype={startDocument:function(){this.doc=(new Ro).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,l,a){var o=this.doc,n=o.createElementNS(e,l||t),i=a.length;Qo(this,n),this.currentElement=n,this.locator&&Mo(this.locator,n);for(var r=0;r<i;r++){e=a.getURI(r);var s=a.getValue(r),c=(l=a.getQName(r),o.createAttributeNS(e,l));this.locator&&Mo(a.getLocator(r),c),c.value=c.nodeValue=s,n.setAttributeNode(c)}},endElement:function(e,t,l){var a=this.currentElement;a.tagName,this.currentElement=a.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var l=this.doc.createProcessingInstruction(e,t);this.locator&&Mo(this.locator,l),Qo(this,l)},ignorableWhitespace:function(e,t,l){},characters:function(e,t,l){if(e=$o.apply(this,arguments)){if(this.cdata)var a=this.doc.createCDATASection(e);else a=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(a):/^\s*$/.test(e)&&this.doc.appendChild(a),this.locator&&Mo(this.locator,a)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,l){e=$o.apply(this,arguments);var a=this.doc.createComment(e);this.locator&&Mo(this.locator,a),Qo(this,a)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,l){var a=this.doc.implementation;if(a&&a.createDocumentType){var o=a.createDocumentType(e,t,l);this.locator&&Mo(this.locator,o),Qo(this,o),this.doc.doctype=o}},warning:function(e){i("warn","at node_modules/@xmldom/xmldom/lib/dom-parser.js:188","[xmldom warning]\t"+e,Wo(this.locator))},error:function(e){i("error","at node_modules/@xmldom/xmldom/lib/dom-parser.js:191","[xmldom error]\t"+e,Wo(this.locator))},fatalError:function(e){throw new Fo(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){Uo.prototype[e]=function(){return null}})),vo.__DOMHandler=Uo,vo.DOMParser=zo,vo.DOMImplementation=Ao.DOMImplementation,vo.XMLSerializer=Ao.XMLSerializer;var jo,Ho,Ko,Go=Xl;Zl.DOMImplementation=Go.DOMImplementation,Zl.XMLSerializer=Go.XMLSerializer,Zl.DOMParser=vo.DOMParser,Ho=Jl,Ko=function(e){return function(t){(t=t||{}).arrayAccessForm=t.arrayAccessForm||"none",t.emptyNodeForm=t.emptyNodeForm||"text",t.jsAttributeFilter=t.jsAttributeFilter,t.jsAttributeConverter=t.jsAttributeConverter,t.attributeConverters=t.attributeConverters||[],t.datetimeAccessFormPaths=t.datetimeAccessFormPaths||[],t.arrayAccessFormPaths=t.arrayAccessFormPaths||[],t.xmldomOptions=t.xmldomOptions||{},void 0===t.enableToStringFunc&&(t.enableToStringFunc=!0),void 0===t.skipEmptyTextNodesForObj&&(t.skipEmptyTextNodesForObj=!0),void 0===t.stripWhitespaces&&(t.stripWhitespaces=!0),void 0===t.useDoubleQuotes&&(t.useDoubleQuotes=!0),void 0===t.ignoreRoot&&(t.ignoreRoot=!1),void 0===t.escapeMode&&(t.escapeMode=!0),void 0===t.attributePrefix&&(t.attributePrefix="_"),void 0===t.selfClosingElements&&(t.selfClosingElements=!0),void 0===t.keepCData&&(t.keepCData=!1),void 0===t.keepText&&(t.keepText=!1),void 0===t.jsDateUTC&&(t.jsDateUTC=!1),function(){function e(e){var t=String(e);return 1===t.length&&(t="0"+t),t}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var l=1,a=3,o=4,n=8,i=9;function r(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!==t||(t=e.nodeName),t}function s(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):e}function c(e,l,a){if("property"===t.arrayAccessForm&&(e[l]instanceof Array?e[l+"_asArray"]=e[l]:e[l+"_asArray"]=[e[l]]),!(e[l]instanceof Array)&&t.arrayAccessFormPaths.length>0){for(var o=!1,n=0;n<t.arrayAccessFormPaths.length;n++){var i=t.arrayAccessFormPaths[n];if("string"==typeof i){if(i===a){o=!0;break}}else if(i instanceof RegExp){if(i.test(a)){o=!0;break}}else if("function"==typeof i&&i(l,a)){o=!0;break}}o&&(e[l]=[e[l]])}}function d(e){var t=e.split(/[-T:+Z]/g),l=new Date(t[0],t[1]-1,t[2]),a=t[5].split(".");if(l.setHours(t[3],t[4],a[0]),a.length>1&&l.setMilliseconds(a[1]),t[6]&&t[7]){var o=60*t[6]+Number(t[7]);o=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*o:o),l.setMinutes(l.getMinutes()-o-l.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(l=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds())));return l}function u(e,l){for(var a={__cnt:0},o=e.childNodes,i=0;i<o.length;i++){var s=o.item(i),u=r(s);s.nodeType!==n&&(a.__cnt++,null==a[u]?(a[u]=m(s,l+"."+u),c(a,u,l+"."+u)):(a[u]instanceof Array||(a[u]=[a[u]],c(a,u,l+"."+u)),a[u][a[u].length]=m(s,l+"."+u)))}for(var p=0;p<e.attributes.length;p++){var v=e.attributes.item(p);a.__cnt++;for(var h=v.value,f=0;f<t.attributeConverters.length;f++){var g=t.attributeConverters[f];g.test.call(null,v.name,v.value)&&(h=g.convert.call(null,v.name,v.value))}a[t.attributePrefix+v.name]=h}var y=e.prefix;return y&&(a.__cnt++,a.__prefix=y),a["#text"]&&(a.__text=a["#text"],a.__text instanceof Array&&(a.__text=a.__text.join("\n")),t.escapeMode&&(a.__text=a.__text.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")),t.stripWhitespaces&&(a.__text=a.__text.trim()),delete a["#text"],"property"===t.arrayAccessForm&&delete a["#text_asArray"],a.__text=function(e,l,a){if(t.datetimeAccessFormPaths.length>0)for(var o=a.split(".#")[0],n=0;n<t.datetimeAccessFormPaths.length;n++){var i=t.datetimeAccessFormPaths[n];if("string"==typeof i){if(i===o)return d(e)}else if(i instanceof RegExp){if(i.test(o))return d(e)}else if("function"==typeof i&&i(o))return d(e)}return e}(a.__text,0,l+".#text")),a.hasOwnProperty("#cdata-section")&&(a.__cdata=a["#cdata-section"],delete a["#cdata-section"],"property"===t.arrayAccessForm&&delete a["#cdata-section_asArray"]),1===a.__cnt&&a.__text&&!t.keepText?a=a.__text:0===a.__cnt&&"text"===t.emptyNodeForm?a="":a.__cnt>1&&void 0!==a.__text&&t.skipEmptyTextNodesForObj&&(t.stripWhitespaces&&""===a.__text||""===a.__text.trim())&&delete a.__text,delete a.__cnt,t.keepCData||a.hasOwnProperty("__text")||!a.hasOwnProperty("__cdata")||1!==Object.keys(a).length?(t.enableToStringFunc&&(a.__text||a.__cdata)&&(a.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),a):a.__cdata?a.__cdata:""}function m(e,n){return e.nodeType===i?function(e){for(var a={},o=e.childNodes,n=0;n<o.length;n++){var i=o.item(n);if(i.nodeType===l){var s=r(i);t.ignoreRoot?a=m(i,s):a[s]=m(i,s)}}return a}(e):e.nodeType===l?u(e,n):e.nodeType===a||e.nodeType===o?e.nodeValue:null}function p(e,l,a,o){var n="<"+(e&&e.__prefix?e.__prefix+":":"")+l;if(a)for(var i=0;i<a.length;i++){var r=a[i],c=e[r];t.escapeMode&&(c=s(c)),n+=" "+r.substr(t.attributePrefix.length)+"=",t.useDoubleQuotes?n+='"'+c+'"':n+="'"+c+"'"}return n+=o?" />":">"}function v(e,t){return"</"+(e&&e.__prefix?e.__prefix+":":"")+t+">"}function h(e,l){return"property"===t.arrayAccessForm&&(a=l.toString(),o="_asArray",-1!==a.indexOf(o,a.length-o.length))||0===l.toString().indexOf(t.attributePrefix)||0===l.toString().indexOf("__")||e[l]instanceof Function;var a,o}function f(e){var t=0;if(e instanceof Object)for(var l in e)h(e,l)||t++;return t}function g(e){var l=[];if(e instanceof Object)for(var a in e)-1===a.toString().indexOf("__")&&0===a.toString().indexOf(t.attributePrefix)&&l.push(a);return l}function y(e){var l="";return e instanceof Object?l+=function(e){var l="";return e.__cdata&&(l+="<![CDATA["+e.__cdata+"]]>"),(e.__text||"number"==typeof e.__text||"boolean"==typeof e.__text)&&(t.escapeMode?l+=s(e.__text):l+=e.__text),l}(e):null!==e&&(t.escapeMode?l+=s(e):l+=e),l}function w(e,l,a){var o="";return t.jsAttributeFilter&&t.jsAttributeFilter.call(null,l,e)||(t.jsAttributeConverter&&(e=t.jsAttributeConverter.call(null,l,e)),null!=e&&""!==e||!t.selfClosingElements?"object"==typeof e?"[object Array]"===Object.prototype.toString.call(e)?o+=function(e,t,l){var a="";if(0===e.length)a+=p(e,t,l,!0);else for(var o=0;o<e.length;o++)a+=w(e[o],t,g(e[o]));return a}(e,l,a):e instanceof Date?(o+=p(e,l,a,!1),o+=t.jsDateUTC?e.toUTCString():e.toISOString(),o+=v(e,l)):f(e)>0||"number"==typeof e.__text||"boolean"==typeof e.__text||e.__text||e.__cdata?(o+=p(e,l,a,!1),o+=N(e),o+=v(e,l)):t.selfClosingElements?o+=p(e,l,a,!0):(o+=p(e,l,a,!1),o+=v(e,l)):(o+=p(e,l,a,!1),o+=y(e),o+=v(e,l)):o+=p(e,l,a,!0)),o}function N(e){var t="";if(f(e)>0)for(var l in e)if(!h(e,l)){var a=e[l];t+=w(a,l,g(a))}return t+=y(e)}function C(l){if(void 0===l)return null;if("string"!=typeof l)return null;var a=null,o=null;if(e)o=(a=new e(t.xmldomOptions)).parseFromString(l,"text/xml");else if(window&&window.DOMParser){a=new window.DOMParser;var n=null;if(!window.ActiveXObject&&!("ActiveXObject"in window)&&document.all&&!document.addEventListener)try{n=a.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(i){n=null}try{o=a.parseFromString(l,"text/xml"),null!==n&&o.getElementsByTagNameNS(n,"parsererror").length>0&&(o=null)}catch(i){o=null}}else 0===l.indexOf("<?")&&(l=l.substr(l.indexOf("?>")+2)),(o=new ActiveXObject("Microsoft.XMLDOM")).async="false",o.loadXML(l);return o}this.asArray=function(e){return null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?d(e):e},this.xml2dom=function(e){return C(e)},this.dom2js=function(e){return m(e,null)},this.js2dom=function(e){return C(this.js2xml(e))},this.xml2js=function(e){var t=C(e);return null!=t?this.dom2js(t):null},this.js2xml=function(e){return N(e)},this.getVersion=function(){return"3.4.0"}}},(jo=Yl).exports?jo.exports=Ko(Zl.DOMParser):Ho.X2JS=Ko();let Jo=new(0,Yl.exports);var Yo=l({inheritAttrs:!1,props:{id:String,handle:String,setLocation:String},setup({id:t,handle:l,setLocation:a}){const o=yl(),n=e.ref({}),r=e.ref([]),s=e.ref(null),c=e.ref(null),d=e.ref({text:"",value:null});let u=e.reactive([{iconPath:"/static/icon/upload_picture_32.png",text:"图片",active:!1,code:ml.img},{iconPath:"/static/icon/repair_32.png",text:"报修",active:!1,code:ml.repair},{iconPath:"/static/icon/borrow_32.png",text:"借用",active:!1,code:ml.borrow}]);a&&u.push({iconPath:"/static/icon/edit.png",text:"存放位置",active:!1,code:ml.location});let m=e.ref({});async function p(){q();try{const e=await be.getById(t),{Asset:l,AssetPics:a}=e;o.commit("asset/initAsset",e),n.value=l,r.value=a.map((e=>D(e.FileUrl)))}finally{z()}}return se===ne&&u.push({iconPath:"/static/icon/printer_32.png",text:"打印",active:!1,code:ml.printer}),p(),tt(lt.assetPictureBack,p),tt(lt.repairRequestDetailBack,p),tt(lt.borrowBack,p),{handle:l,asset:n,imgs:r,imgClick:function(e){At(r.value,e)},content:u,trigger:function({item:{code:e}}){switch(i("log","at subcontract/asset/assetInfo/assetView.vue:404",e),e){case ml.img:k("subcontract/asset/assetInfo/assetPicture");break;case ml.repair:k(`subcontract/asset/repairRequest/repairRequestDetail?id=${t}`);break;case ml.borrow:k(`subcontract/asset/borrowReturn/quickBorrow/quickBorrow?id=${t}`);break;case ml.printer:!function(){i("log","at subcontract/asset/assetInfo/assetView.vue:460","打印===>"),q();try{if(!h("SelectLabelTemplate"))return i("log","at subcontract/asset/assetInfo/assetView.vue:464","请先选择标签模板[我的>蓝牙打印>标签模板]"),void F("请先选择标签模板[我的>蓝牙打印>标签模板]");m=Jo.xml2js(h("SelectLabelTemplate").Definexml),Promise.all([m,be.getAssetProperty().then((e=>{i("log","at subcontract/asset/assetInfo/assetView.vue:478","getAssetProperty------------Data>"+JSON.stringify(e));let t=e.Properties.sort(((e,t)=>e.AssetPropertyID-t.AssetPropertyID));return t.unshift({AssetPropertyCode:"url"}),t})).catch((e=>{i("log","at subcontract/asset/assetInfo/assetView.vue:489","getAssetProperty==ERR>"+e),F("getAssetProperty="+e)})),be.getPrintAssets(t).then((e=>(i("log","at subcontract/asset/assetInfo/assetView.vue:496","getPrintAssets----------Data>"+JSON.stringify(e)),e))).catch((e=>{i("log","at subcontract/asset/assetInfo/assetView.vue:502","getAssetProperty==>"+e),F("getPrintAssets="+e)})),be.getLabelTemplate().then((e=>(i("log","at subcontract/asset/assetInfo/assetView.vue:508","getLabelTemplate-----------Data>"+JSON.stringify(e)),e))).catch((e=>{i("log","at subcontract/asset/assetInfo/assetView.vue:515","getAssetProperty==>"+e),F("getLabelTemplate="+e)}))]).then((async e=>{let t=e[0].KibonLabelDefine;i("log","at subcontract/asset/assetInfo/assetView.vue:522","xml模板数据========-------\x3e"+JSON.stringify(t)),t||F("请选择标签模板");let l=e[1],a=e[2].PrintAssets[0],o=e[3].AssetUrl;function n(e,t){if(e)if(e[t]instanceof Array)e[t].map((e=>{-1!=e.DataField&&(0==e.DataField?e.Content=`${o}/#/AppAssetDetail?Code=${a.Code}&TenantID=${localStorage.getItem("TenantID")}`:e.Content=a[l[e.DataField].AssetPropertyCode])}));else{let n=e[t];-1!=n.DataField&&(0==n.DataField?n.Content=`${o}/#/AppAssetDetail?Code=${a.Code}&TenantID=${localStorage.getItem("TenantID")}`:n.Content=a[l[n.DataField].AssetPropertyCode])}}if(t.TextList)if(t.TextList.Text instanceof Array)t.TextList.Text.map((e=>{-1!=e.DataField&&(0==e.DataField?e.Content=`${o}/#/AppAssetDetail?Code=${a.Code}&TenantID=${h("TenantID")}`:e.Content=a[l[e.DataField].AssetPropertyCode])}));else{let e=t.TextList.Text;-1!=e.DataField&&(0==e.DataField?e.Content=`${o}/#/AppAssetDetail?Code=${a.Code}&TenantID=${h("TenantID")}`:e.Content=a[l[e.DataField].AssetPropertyCode])}if(n(t.QRCodeList,"QRCode"),n(t.BarcodeList,"Barcode"),n(t.Barcode2DList,"Barcode2D"),await Gl.isPrinterOpened()){await async function(e){i("log","at subcontract/asset/assetInfo/assetView.vue:630","1，打印相关数据"+JSON.stringify(e));let t=e;const l=t.Label.Width,a=t.Label.Height,o=90,n=0,r=.5;if(!(await Gl.startJob({width:l,height:a,orientation:o})))return!1;if(i("log","at subcontract/asset/assetInfo/assetView.vue:652","2，打印相关数据"),t.TextList){let e=t.TextList.Text;e instanceof Array?e.filter((async e=>{"True"==e.Visible&&await Gl.drawText({text:e.Content,x:e.Left,y:e.Top,fontHeight:e.Size,fontStyle:n,linespace:r})})):"True"==e.Visible&&await Gl.drawText({text:e.Content,x:e.Left,y:e.Top,fontHeight:e.Size,fontStyle:n,linespace:r})}if(i("log","at subcontract/asset/assetInfo/assetView.vue:689","2.1，打印二维码"),t.QRCodeList){let e=t.QRCodeList.QRCode;e instanceof Array?e.filter((async e=>{"True"==e.Visible&&await Gl.draw2DQRCode({text:e.Content,x:e.Left,y:e.Top,width:e.Height})})):"True"==e.Visible&&await Gl.draw2DQRCode({text:e.Content,x:e.Left,y:e.Top,width:e.Height})}if(i("log","at subcontract/asset/assetInfo/assetView.vue:716","2.3，打印一维码"),t.BarcodeList){let e=t.BarcodeList.Barcode;e instanceof Array?e.filter((async e=>{"True"==e.Visible&&await Gl.draw1DBarcode({text:e.Content,x:e.Left,y:e.Top,type:28,width:e.Width,height:e.Height})})):"True"==e.Visible&&await Gl.draw1DBarcode({text:e.Content,x:e.Left,y:e.Top,type:28,width:e.Width,height:e.Height})}if(i("log","at subcontract/asset/assetInfo/assetView.vue:745","2.4，打印条码"),t.Barcode2DList){let e=t.Barcode2DList.Barcode2D;e instanceof Array?e.filter((async e=>{"True"==e.Visible&&await Gl.draw1DBarcode({text:e.Content,x:e.Left,y:e.Top,width:e.Width,height:e.Height})})):"True"==e.Visible&&await Gl.draw1DBarcode({text:e.Content,x:e.Left,y:e.Top,width:e.Width,height:e.Height})}return i("log","at subcontract/asset/assetInfo/assetView.vue:773","提交打印"),await Gl.commitJob()}(t)?L("打印成功"):F("打印失败")}else i("log","at subcontract/asset/assetInfo/assetView.vue:611","请先选择标签模板[我的>蓝牙打印>刷新]"),F("请先选择标签模板[我的>蓝牙打印>刷新]");z(),U()})).then((e=>{i("log","at subcontract/asset/assetInfo/assetView.vue:620","打印错误=>"+e)}))}finally{z()}}();break;case ml.location:d.value.text=n.value.LocationName,d.value.value=n.value.LocationID,c.value.open()}s.value.close()},timeConvertDate:Ql,GetWithinLimitsByType:m,locationDialog:c,fab:s,location:d,editLocationConfirm:function(){d.value.value?(q(),be.assetChangeLocation(t,{id:d.value.value,name:d.value.text}).then((e=>{c.value.close(),p(),d.value.text=null,d.value.value=null})).finally((()=>z()))):F("请选择存放位置")},editLocationClose:function(){c.value.close(),d.value.text=null,d.value.value=null},locationSelect:function(e){tt(lt.locationSelectBack,(({id:e,label:t})=>{d.value.value=e,d.value.text=t})),k(`pages/selector/asset/location?isLast=1&multiple=0&ids=${d.value.value}`)}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-list-item"),we),c=r(e.resolveDynamicComponent("uni-list"),Ne),d=r(e.resolveDynamicComponent("uni-popup-dialog"),al),u=r(e.resolveDynamicComponent("uni-popup"),dl),m=r(e.resolveDynamicComponent("uni-section"),ue),p=r(e.resolveDynamicComponent("uni-grid-item"),me),v=r(e.resolveDynamicComponent("uni-grid"),ve),h=r(e.resolveDynamicComponent("uni-fab"),ul);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(u,{ref:"locationDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(d,{"before-close":!0,mode:"input",title:"编辑存放位置",onConfirm:o.editLocationConfirm,onClose:o.editLocationClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"edit-asset-info"},[e.createVNode(c,{class:"inputDialog"},{default:e.withCtx((()=>[e.createVNode(s,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"location"},[e.createElementVNode("text",{class:"slot-box"},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["location-body",o.location.value?"checked":"unchecked"]),onClick:l[0]||(l[0]=(...e)=>o.locationSelect&&o.locationSelect(...e))},[e.createElementVNode("text",{class:"location-text"},e.toDisplayString(o.location.value?o.location.text:"请选择存放位置"),1)],2)])),_:1})])),_:1})])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(m,{title:"基本信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产编码："),e.createElementVNode("view",null,[e.createElementVNode("text",{selectable:""},e.toDisplayString(o.asset.Code),1)])]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"原编码："),e.createElementVNode("view",null,[e.createElementVNode("text",{selectable:""},e.toDisplayString(o.asset.OriginalCode),1)])])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"设备序列号："),e.createElementVNode("view",null,[e.createElementVNode("text",{selectable:""},e.toDisplayString(o.asset.SN),1)])]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产名称："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Name),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产分类："),e.createElementVNode("view",null,e.toDisplayString(o.asset.CategoryName),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"品牌："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Brand),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"规格："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Spec),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"型号："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Model),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"数量："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Qty),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"计量单位："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Unit),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"是否盘点："),e.createElementVNode("view",null,e.toDisplayString(o.asset.IsRequiredStockChecking?"是":"否"),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"购置日期："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.DateOfPurchase)),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产用途："),e.createElementVNode("view",null,e.toDisplayString(o.asset.AssetPurposeText),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"取得方式："),e.createElementVNode("view",null,e.toDisplayString(o.asset.AcquireWayText),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产性质："),e.createElementVNode("view",null,e.toDisplayString(o.asset.AssetAttributeText),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产状态："),e.createElementVNode("view",null,e.toDisplayString(o.asset.AssetStatusText),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产描述："),e.createElementVNode("view",null,e.toDisplayString(o.asset.AssetDesc),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"备注："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Remark),1)])])])),_:1}),e.createVNode(m,{title:"使用信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"所属公司："),e.createElementVNode("view",null,e.toDisplayString(o.asset.CorpName),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"管理部门："),e.createElementVNode("view",null,e.toDisplayString(o.asset.KAOName),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"管理人员："),e.createElementVNode("view",null,e.toDisplayString(o.asset.KAEName),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"使用部门："),e.createElementVNode("view",null,e.toDisplayString(o.asset.UAOName),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"使用人员："),e.createElementVNode("view",null,e.toDisplayString(o.asset.UAEName),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"存放位置："),e.createElementVNode("view",null,e.toDisplayString(o.asset.LocationName),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"详细地址："),e.createElementVNode("view",null,e.toDisplayString(o.asset.DetailAddress),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"领用日期："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.DatetimeOfUse)),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"过保日期："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.ExpiredDateOfMaintenance)),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"下次保养日期："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.NextMaintenanceDate)),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"使用期至："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.ExpiredDateOfUsage)),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"登记日期："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.RegisterDatetime)),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"首次领用日期："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.FirstDrawDate)),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"报废日期："),e.createElementVNode("view",null,e.toDisplayString(o.timeConvertDate(o.asset.RequestDiscardDate)),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"使用情况："),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.asset.AssetUsage,((t,l)=>(e.openBlock(),e.createElementBlock("view",null,[l==o.asset.AssetUsage.length-1?(e.openBlock(),e.createElementBlock("span",{key:0},e.toDisplayString(t.UsageText),1)):(e.openBlock(),e.createElementBlock("span",{key:1},e.toDisplayString(t.UsageText)+", ",1))])))),256))])])])),_:1}),e.createVNode(m,{title:"数据来源",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"来源渠道："),e.createElementVNode("view",null,e.toDisplayString(o.asset.SourceChannel),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"来源单号："),e.createElementVNode("view",null,e.toDisplayString(o.asset.SourceCode),1)])])])),_:1}),e.createVNode(m,{title:"资产图片",type:"line"},{default:e.withCtx((()=>[0===o.imgs.length?(e.openBlock(),e.createElementBlock("text",{key:0,class:"noimg"},"无图片")):e.createCommentVNode("",!0),e.createVNode(v,{column:2},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.imgs,((t,l)=>(e.openBlock(),e.createBlock(p,null,{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",mode:"scaleToFill",onClick:e=>o.imgClick(l),src:t},null,8,["onClick","src"])])),_:2},1024)))),256))])),_:1})])),_:1}),1==o.handle?(e.openBlock(),e.createBlock(h,{key:0,ref:"fab",content:o.content,horizontal:"right",onTrigger:o.trigger},null,8,["content","onTrigger"])):e.createCommentVNode("",!0)],64)}],["__scopeId","data-v-09def023"]]);var Zo={pages:[{path:"pages/login/login",style:{enablePullDownRefresh:!1,titleNView:!1}},{path:"pages/home/home",style:{titleNView:!1,enablePullDownRefresh:!1}},{path:"pages/login/setting",style:{navigationBarTitleText:"服务器设置",enablePullDownRefresh:!1}},{path:"pages/selector/consumable/warehouse",style:{navigationBarTitleText:"选择易耗品仓库",enablePullDownRefresh:!1}},{path:"pages/selector/consumable/category",style:{navigationBarTitleText:"选择易耗品分类",enablePullDownRefresh:!1}},{path:"pages/selector/system/employee",style:{navigationBarTitleText:"选择员工",enablePullDownRefresh:!1}},{path:"pages/selector/asset/location",style:{navigationBarTitleText:"选择存放位置",enablePullDownRefresh:!1}},{path:"pages/selector/system/corpDept",style:{navigationBarTitleText:"选择公司部门",enablePullDownRefresh:!1}},{path:"pages/selector/asset/category",style:{navigationBarTitleText:"选择资产分类",enablePullDownRefresh:!1}},{path:"pages/selector/asset/supplier",style:{navigationBarTitleText:"选择供应商",enablePullDownRefresh:!1}},{path:"pages/system/signConfirm/signConfirm",style:{navigationBarTitleText:"扫码签字确认",enablePullDownRefresh:!1}},{path:"pages/system/sign/sign",style:{navigationBarTitleText:"签字确认",enablePullDownRefresh:!1}}],subPackages:[{root:"subcontract/asset",pages:[{path:"myAssetList/list",style:{navigationBarTitleText:"我的资产",enablePullDownRefresh:!0}},{path:"assetInfo/assetView",style:{navigationBarTitleText:"资产详情",enablePullDownRefresh:!1}},{path:"assetInfo/assetPicture",style:{navigationBarTitleText:"上传资产图片",enablePullDownRefresh:!1}},{path:"requestDraw/requestDraw",style:{navigationBarTitleText:"资产申领",enablePullDownRefresh:!1}},{path:"requestDraw/requestDrawList",style:{navigationBarTitleText:"申领列表",enablePullDownRefresh:!0}},{path:"repair/request/repairRequestList",style:{navigationBarTitleText:"扫码报修",enablePullDownRefresh:!0}},{path:"repair/request/repairRequestDetail",style:{navigationBarTitleText:"资产报修",enablePullDownRefresh:!1}},{path:"borrowReturn/canBorrow/list",style:{navigationBarTitleText:"可借用资产",enablePullDownRefresh:!0}},{path:"borrowReturn/quickBorrow/quickBorrow",style:{navigationBarTitleText:"扫码借用",enablePullDownRefresh:!1}},{path:"borrowReturn/quickReturn/quickReturn",style:{navigationBarTitleText:"扫码归还"}},{path:"inventory/employee/list",style:{navigationBarTitleText:"员工自助盘点",enablePullDownRefresh:!0}},{path:"inventory/employee/detail",style:{navigationBarTitleText:"盘点明细",enablePullDownRefresh:!1}},{path:"inventory/employee/stockConfirm",style:{navigationBarTitleText:"盘点确认",enablePullDownRefresh:!1}},{path:"inventory/manageUser/list",style:{navigationBarTitleText:"资产盘点",enablePullDownRefresh:!0}},{path:"inventory/manageUser/detail",style:{navigationBarTitleText:"盘点明细",enablePullDownRefresh:!0}},{path:"inventory/manageUser/inventoryConfirm",style:{navigationBarTitleText:"盘点结果",enablePullDownRefresh:!1}},{path:"inventory/manageUser/register",style:{navigationBarTitleText:"盘点登记",enablePullDownRefresh:!1}},{path:"assetList/list",style:{navigationBarTitleText:"资产列表",enablePullDownRefresh:!0}},{path:"draw/drawDetail",style:{navigationBarTitleText:"发放单",enablePullDownRefresh:!1}},{path:"draw/drawList",style:{navigationBarTitleText:"发放列表",enablePullDownRefresh:!0}},{path:"drawBack/drawBackDetail",style:{navigationBarTitleText:"退库单",enablePullDownRefresh:!1}},{path:"drawBack/drawBackList",style:{navigationBarTitleText:"退库列表",enablePullDownRefresh:!0}},{path:"discard/detail",style:{navigationBarTitleText:"资产处置",enablePullDownRefresh:!1}},{path:"discard/list",style:{navigationBarTitleText:"处置列表",enablePullDownRefresh:!0}},{path:"repair/result/detail",style:{navigationBarTitleText:"维修结果",enablePullDownRefresh:!1}},{path:"requestDiscard/detail",style:{navigationBarTitleText:"资产报废",enablePullDownRefresh:!1}},{path:"requestDiscard/list",style:{navigationBarTitleText:"报废单列表",enablePullDownRefresh:!0}},{path:"transform/detail",style:{navigationBarTitleText:"资产转移",enablePullDownRefresh:!1}},{path:"transform/list",style:{navigationBarTitleText:"转移列表",enablePullDownRefresh:!0}},{path:"assetInfo/scanCode",style:{navigationBarTitleText:"扫码查资产",enablePullDownRefresh:!1}},{path:"repair/record/list",style:{navigationBarTitleText:"报修/维修记录",enablePullDownRefresh:!0}}]},{root:"subcontract/consumable",pages:[{path:"allocate/detail/detail",style:{navigationBarTitleText:"易耗品调拨",enablePullDownRefresh:!1,"app-plus":{bounce:"none"},"mp-alipay":{allowsBounceVertical:"NO"},allowsBounceVertical:"NO"}},{path:"allocate/condition/condition",style:{navigationBarTitleText:"易耗品调拨单筛选条件",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"allocate/list/list",style:{navigationBarTitleText:"易耗品调拨单列表",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"discard/detail/detail",style:{navigationBarTitleText:"易耗品报废",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"discard/condition/condition",style:{navigationBarTitleText:"易耗品报废-筛选条件",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inventory/taskDetail",style:{enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inventory/inventoryConfirm",style:{navigationBarTitleText:"易耗品盘点确认",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"discard/list/list",style:{navigationBarTitleText:"易耗品报废-列表",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inventory/list",style:{navigationBarTitleText:"易耗品盘点",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inventory/condition",style:{navigationBarTitleText:"易耗品盘点-筛选条件",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inwarehouse/detail/detail",style:{navigationBarTitleText:"易耗品入库",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inwarehouse/order/order",style:{navigationBarTitleText:"易耗品入库-选择采购明细",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inwarehouse/list/list",style:{navigationBarTitleText:"易耗品入库-列表",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"inwarehouse/condition/condition",style:{navigationBarTitleText:"易耗品入库-列表筛选器",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"outwarehouse/detail/detail",style:{navigationBarTitleText:"易耗品出库",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"outwarehouse/requestDraw/requestDraw",style:{navigationBarTitleText:"易耗品出库-选择申请单",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"outwarehouse/list/list",style:{navigationBarTitleText:"易耗品出库-列表",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"outwarehouse/condition/condition",style:{navigationBarTitleText:"易耗品出库-列表筛选器",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"stock/condition",style:{navigationBarTitleText:"库存明细-选择器筛选条件",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"stock/list",style:{navigationBarTitleText:"库存明细",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"requestDraw/requestDraw",style:{navigationBarTitleText:"易耗品申领",enablePullDownRefresh:!1,"mp-alipay":{allowsBounceVertical:"NO"}}},{path:"requestDraw/requestDrawList",style:{navigationBarTitleText:"易耗品申领列表",enablePullDownRefresh:!0,"mp-alipay":{allowsBounceVertical:"NO"}}}]},{root:"subcontract/mine",pages:[{path:"index/index",style:{navigationBarTitleText:"我的",enablePullDownRefresh:!1}},{path:"todo/todo",style:{navigationBarTitleText:"我的待办",enablePullDownRefresh:!0}},{path:"done/done",style:{navigationBarTitleText:"已办事宜",enablePullDownRefresh:!0}},{path:"changePassword/index",style:{navigationBarTitleText:"修改密码",enablePullDownRefresh:!1}},{path:"printer/index",style:{navigationBarTitleText:"蓝牙打印",enablePullDownRefresh:!1}},{path:"aboutSystem/index",style:{navigationBarTitleText:"关于",enablePullDownRefresh:!1}},{path:"aboutSystem/userAgreement",style:{navigationBarTitleText:"用户协议/隐私政策",enablePullDownRefresh:!1}},{path:"help/index",style:{navigationBarTitleText:"帮助",enablePullDownRefresh:!1}},{path:"help/onlinePDF",style:{navigationBarTitleText:"操作手册",enablePullDownRefresh:!1}}]}],globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"资产管理系统",navigationBarBackgroundColor:"#F8F8F8",backgroundColor:"#F8F8F8","app-plus":{bounce:"none"}}};function Xo(e,t,l){return e(l={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&l.path)}},l.exports),l.exports}var en=Xo((function(e,t){var l;e.exports=(l=l||function(e,t){var l=Object.create||function(){function e(){}return function(t){var l;return e.prototype=t,l=new e,e.prototype=null,l}}(),a={},o=a.lib={},n=o.Base={extend:function(e){var t=l(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},i=o.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,l=e.words,a=this.sigBytes,o=e.sigBytes;if(this.clamp(),a%4)for(var n=0;n<o;n++){var i=l[n>>>2]>>>24-n%4*8&255;t[a+n>>>2]|=i<<24-(a+n)%4*8}else for(n=0;n<o;n+=4)t[a+n>>>2]=l[n>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,l=this.sigBytes;t[l>>>2]&=4294967295<<32-l%4*8,t.length=e.ceil(l/4)},clone:function(){var e=n.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var l,a=[],o=function(t){var l=987654321,a=4294967295;return function(){var o=((l=36969*(65535&l)+(l>>16)&a)<<16)+(t=18e3*(65535&t)+(t>>16)&a)&a;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},n=0;n<t;n+=4){var r=o(4294967296*(l||e.random()));l=987654071*r(),a.push(4294967296*r()|0)}return new i.init(a,t)}}),r=a.enc={},s=r.Hex={stringify:function(e){for(var t=e.words,l=e.sigBytes,a=[],o=0;o<l;o++){var n=t[o>>>2]>>>24-o%4*8&255;a.push((n>>>4).toString(16)),a.push((15&n).toString(16))}return a.join("")},parse:function(e){for(var t=e.length,l=[],a=0;a<t;a+=2)l[a>>>3]|=parseInt(e.substr(a,2),16)<<24-a%8*4;return new i.init(l,t/2)}},c=r.Latin1={stringify:function(e){for(var t=e.words,l=e.sigBytes,a=[],o=0;o<l;o++){var n=t[o>>>2]>>>24-o%4*8&255;a.push(String.fromCharCode(n))}return a.join("")},parse:function(e){for(var t=e.length,l=[],a=0;a<t;a++)l[a>>>2]|=(255&e.charCodeAt(a))<<24-a%4*8;return new i.init(l,t)}},d=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=o.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var l=this._data,a=l.words,o=l.sigBytes,n=this.blockSize,r=o/(4*n),s=(r=t?e.ceil(r):e.max((0|r)-this._minBufferSize,0))*n,c=e.min(4*s,o);if(s){for(var d=0;d<s;d+=n)this._doProcessBlock(a,d);var u=a.splice(0,s);l.sigBytes-=c}return new i.init(u,c)},clone:function(){var e=n.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=u.extend({cfg:n.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,l){return new e.init(l).finalize(t)}},_createHmacHelper:function(e){return function(t,l){return new m.HMAC.init(e,l).finalize(t)}}});var m=a.algo={};return a}(Math),l)})),tn=(Xo((function(e,t){var l;e.exports=(l=en,function(e){var t=l,a=t.lib,o=a.WordArray,n=a.Hasher,i=t.algo,r=[];!function(){for(var t=0;t<64;t++)r[t]=4294967296*e.abs(e.sin(t+1))|0}();var s=i.MD5=n.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var l=0;l<16;l++){var a=t+l,o=e[a];e[a]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var n=this._hash.words,i=e[t+0],s=e[t+1],p=e[t+2],v=e[t+3],h=e[t+4],f=e[t+5],g=e[t+6],y=e[t+7],w=e[t+8],N=e[t+9],C=e[t+10],E=e[t+11],b=e[t+12],D=e[t+13],V=e[t+14],k=e[t+15],x=n[0],_=n[1],S=n[2],I=n[3];x=c(x,_,S,I,i,7,r[0]),I=c(I,x,_,S,s,12,r[1]),S=c(S,I,x,_,p,17,r[2]),_=c(_,S,I,x,v,22,r[3]),x=c(x,_,S,I,h,7,r[4]),I=c(I,x,_,S,f,12,r[5]),S=c(S,I,x,_,g,17,r[6]),_=c(_,S,I,x,y,22,r[7]),x=c(x,_,S,I,w,7,r[8]),I=c(I,x,_,S,N,12,r[9]),S=c(S,I,x,_,C,17,r[10]),_=c(_,S,I,x,E,22,r[11]),x=c(x,_,S,I,b,7,r[12]),I=c(I,x,_,S,D,12,r[13]),S=c(S,I,x,_,V,17,r[14]),x=d(x,_=c(_,S,I,x,k,22,r[15]),S,I,s,5,r[16]),I=d(I,x,_,S,g,9,r[17]),S=d(S,I,x,_,E,14,r[18]),_=d(_,S,I,x,i,20,r[19]),x=d(x,_,S,I,f,5,r[20]),I=d(I,x,_,S,C,9,r[21]),S=d(S,I,x,_,k,14,r[22]),_=d(_,S,I,x,h,20,r[23]),x=d(x,_,S,I,N,5,r[24]),I=d(I,x,_,S,V,9,r[25]),S=d(S,I,x,_,v,14,r[26]),_=d(_,S,I,x,w,20,r[27]),x=d(x,_,S,I,D,5,r[28]),I=d(I,x,_,S,p,9,r[29]),S=d(S,I,x,_,y,14,r[30]),x=u(x,_=d(_,S,I,x,b,20,r[31]),S,I,f,4,r[32]),I=u(I,x,_,S,w,11,r[33]),S=u(S,I,x,_,E,16,r[34]),_=u(_,S,I,x,V,23,r[35]),x=u(x,_,S,I,s,4,r[36]),I=u(I,x,_,S,h,11,r[37]),S=u(S,I,x,_,y,16,r[38]),_=u(_,S,I,x,C,23,r[39]),x=u(x,_,S,I,D,4,r[40]),I=u(I,x,_,S,i,11,r[41]),S=u(S,I,x,_,v,16,r[42]),_=u(_,S,I,x,g,23,r[43]),x=u(x,_,S,I,N,4,r[44]),I=u(I,x,_,S,b,11,r[45]),S=u(S,I,x,_,k,16,r[46]),x=m(x,_=u(_,S,I,x,p,23,r[47]),S,I,i,6,r[48]),I=m(I,x,_,S,y,10,r[49]),S=m(S,I,x,_,V,15,r[50]),_=m(_,S,I,x,f,21,r[51]),x=m(x,_,S,I,b,6,r[52]),I=m(I,x,_,S,v,10,r[53]),S=m(S,I,x,_,C,15,r[54]),_=m(_,S,I,x,s,21,r[55]),x=m(x,_,S,I,w,6,r[56]),I=m(I,x,_,S,k,10,r[57]),S=m(S,I,x,_,g,15,r[58]),_=m(_,S,I,x,D,21,r[59]),x=m(x,_,S,I,h,6,r[60]),I=m(I,x,_,S,E,10,r[61]),S=m(S,I,x,_,p,15,r[62]),_=m(_,S,I,x,N,21,r[63]),n[0]=n[0]+x|0,n[1]=n[1]+_|0,n[2]=n[2]+S|0,n[3]=n[3]+I|0},_doFinalize:function(){var t=this._data,l=t.words,a=8*this._nDataBytes,o=8*t.sigBytes;l[o>>>5]|=128<<24-o%32;var n=e.floor(a/4294967296),i=a;l[15+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),l[14+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(l.length+1),this._process();for(var r=this._hash,s=r.words,c=0;c<4;c++){var d=s[c];s[c]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return r},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,l,a,o,n,i){var r=e+(t&l|~t&a)+o+i;return(r<<n|r>>>32-n)+t}function d(e,t,l,a,o,n,i){var r=e+(t&a|l&~a)+o+i;return(r<<n|r>>>32-n)+t}function u(e,t,l,a,o,n,i){var r=e+(t^l^a)+o+i;return(r<<n|r>>>32-n)+t}function m(e,t,l,a,o,n,i){var r=e+(l^(t|~a))+o+i;return(r<<n|r>>>32-n)+t}t.MD5=n._createHelper(s),t.HmacMD5=n._createHmacHelper(s)}(Math),l.MD5)})),Xo((function(e,t){var l,a,o;e.exports=(a=(l=en).lib.Base,o=l.enc.Utf8,void(l.algo.HMAC=a.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var l=e.blockSize,a=4*l;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var n=this._oKey=t.clone(),i=this._iKey=t.clone(),r=n.words,s=i.words,c=0;c<l;c++)r[c]^=1549556828,s[c]^=909522486;n.sigBytes=i.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,l=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(l))}})))})),Xo((function(e,t){e.exports=en.HmacMD5})));const ln="FUNCTION";function an(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function on(e){return"object"===an(e)}function nn(e){return e&&"string"==typeof e?JSON.parse(e):e}let rn;rn="app",nn({}.UNICLOUD_DEBUG);const sn=nn("[]");let cn="";try{cn="__UNI__ECB23D1"}catch(Mn){}let dn={};function un(e,t={}){var l,a;return l=dn,a=e,Object.prototype.hasOwnProperty.call(l,a)||(dn[e]=t),dn[e]}"app"===rn&&(dn=uni._globalUniCloudObj?uni._globalUniCloudObj:uni._globalUniCloudObj={});const mn=["invoke","success","fail","complete"],pn=un("_globalUniCloudInterceptor");function vn(e,t){pn[e]||(pn[e]={}),on(t)&&Object.keys(t).forEach((l=>{mn.indexOf(l)>-1&&function(e,t,l){let a=pn[e][t];a||(a=pn[e][t]=[]),-1===a.indexOf(l)&&"function"==typeof l&&a.push(l)}(e,l,t[l])}))}function hn(e,t){pn[e]||(pn[e]={}),on(t)?Object.keys(t).forEach((l=>{mn.indexOf(l)>-1&&function(e,t,l){const a=pn[e][t];if(!a)return;const o=a.indexOf(l);o>-1&&a.splice(o,1)}(e,l,t[l])})):delete pn[e]}function fn(e,t){return e&&0!==e.length?e.reduce(((e,l)=>e.then((()=>l(t)))),Promise.resolve()):Promise.resolve()}function gn(e,t){return pn[e]&&pn[e][t]||[]}const yn=un("_globalUniCloudListener"),wn="response",Nn="needLogin",Cn="refreshToken",En="clientdb",bn="cloudfunction",Dn="cloudobject";function Vn(e){return yn[e]||(yn[e]=[]),yn[e]}function kn(e,t){const l=Vn(e);l.includes(t)||l.push(t)}function xn(e,t){const l=Vn(e),a=l.indexOf(t);-1!==a&&l.splice(a,1)}function _n(e,t){const l=Vn(e);for(let a=0;a<l.length;a++)(0,l[a])(t)}function Sn(e,t){return t?function(l){let a=!1;if("callFunction"===t){const e=l&&l.type||ln;a=e!==ln}const o="callFunction"===t&&!a;let n;n=this.isReady?Promise.resolve():this.initUniCloud,l=l||{};const i=n.then((()=>a?Promise.resolve():fn(gn(t,"invoke"),l))).then((()=>e.call(this,l))).then((e=>a?Promise.resolve(e):fn(gn(t,"success"),e).then((()=>fn(gn(t,"complete"),e))).then((()=>(o&&_n(wn,{type:bn,content:e}),Promise.resolve(e))))),(e=>a?Promise.reject(e):fn(gn(t,"fail"),e).then((()=>fn(gn(t,"complete"),e))).then((()=>(_n(wn,{type:bn,content:e}),Promise.reject(e))))));if(!(l.success||l.fail||l.complete))return i;i.then((e=>{l.success&&l.success(e),l.complete&&l.complete(e),o&&_n(wn,{type:bn,content:e})}),(e=>{l.fail&&l.fail(e),l.complete&&l.complete(e),o&&_n(wn,{type:bn,content:e})}))}:function(t){if(!((t=t||{}).success||t.fail||t.complete))return e.call(this,t);e.call(this,t).then((e=>{t.success&&t.success(e),t.complete&&t.complete(e)}),(e=>{t.fail&&t.fail(e),t.complete&&t.complete(e)}))}}class In extends Error{constructor(e){super(e.message),this.errMsg=e.message||"",this.errCode=this.code=e.code||"SYSTEM_ERROR",this.requestId=e.requestId}}let Bn;function Tn(){const e=uni.getLocale&&uni.getLocale()||"en";if(Bn)return __spreadProps(__spreadValues({},Bn),{locale:e,LOCALE:e});const t=uni.getSystemInfoSync(),{deviceId:l,osName:a,uniPlatform:o,appId:n}=t,i=["pixelRatio","brand","model","system","language","version","platform","host","SDKVersion","swanNativeVersion","app","AppPlatform","fontSizeSetting"];for(let r=0;r<i.length;r++)delete t[i[r]];return Bn=__spreadValues(__spreadValues({PLATFORM:o,OS:a,APPID:n,DEVICEID:l},function(){let e,t;try{if(uni.getLaunchOptionsSync){if(uni.getLaunchOptionsSync.toString().indexOf("not yet implemented")>-1)return;const{scene:l,channel:a}=uni.getLaunchOptionsSync();e=a,t=l}}catch(l){}return{channel:e,scene:t}}()),t),__spreadProps(__spreadValues({},Bn),{locale:e,LOCALE:e})}var An=function(e,t){let l="";return Object.keys(e).sort().forEach((function(t){e[t]&&(l=l+"&"+t+"="+e[t])})),l=l.slice(1),tn(l,t).toString()},Pn=function(e,t){return new Promise(((l,a)=>{t(Object.assign(e,{complete(e){e||(e={});const t=e.data&&e.data.header&&e.data.header["x-serverless-request-id"]||e.header&&e.header["request-id"];if(!e.statusCode||e.statusCode>=400)return a(new In({code:"SYS_ERR",message:e.errMsg||"request:fail",requestId:t}));const o=e.data;if(o.error)return a(new In({code:o.error.code,message:o.error.message,requestId:t}));o.result=o.data,o.requestId=t,delete o.data,l(o)}}))}))},On={request:e=>uni.request(e),uploadFile:e=>uni.uploadFile(e),setStorageSync:(e,t)=>uni.setStorageSync(e,t),getStorageSync:e=>uni.getStorageSync(e),removeStorageSync:e=>uni.removeStorageSync(e),clearStorageSync:()=>uni.clearStorageSync()},Rn={"uniCloud.init.paramRequired":"{param} required","uniCloud.uploadFile.fileError":"filePath should be instance of File"};const{t:Ln}=el({"zh-Hans":{"uniCloud.init.paramRequired":"缺少参数：{param}","uniCloud.uploadFile.fileError":"filePath应为File对象"},"zh-Hant":{"uniCloud.init.paramRequired":"缺少参数：{param}","uniCloud.uploadFile.fileError":"filePath应为File对象"},en:Rn,fr:{"uniCloud.init.paramRequired":"{param} required","uniCloud.uploadFile.fileError":"filePath should be instance of File"},es:{"uniCloud.init.paramRequired":"{param} required","uniCloud.uploadFile.fileError":"filePath should be instance of File"},ja:Rn},"zh-Hans");var Fn=class{constructor(e){["spaceId","clientSecret"].forEach((t=>{if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error(Ln("uniCloud.init.paramRequired",{param:t}))})),this.config=Object.assign({},{endpoint:"https://api.bspapp.com"},e),this.config.provider="aliyun",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.config.accessTokenKey="access_token_"+this.config.spaceId,this.adapter=On,this._getAccessTokenPromise=null,this._getAccessTokenPromiseStatus=null}get hasAccessToken(){return!!this.accessToken}setAccessToken(e){this.accessToken=e}requestWrapped(e){return Pn(e,this.adapter.request)}requestAuth(e){return this.requestWrapped(e)}request(e,t){return Promise.resolve().then((()=>this.hasAccessToken?t?this.requestWrapped(e):this.requestWrapped(e).catch((t=>new Promise(((e,l)=>{!t||"GATEWAY_INVALID_TOKEN"!==t.code&&"InvalidParameter.InvalidToken"!==t.code?l(t):e()})).then((()=>this.getAccessToken())).then((()=>{const t=this.rebuildRequest(e);return this.request(t,!0)})))):this.getAccessToken().then((()=>{const t=this.rebuildRequest(e);return this.request(t,!0)}))))}rebuildRequest(e){const t=Object.assign({},e);return t.data.token=this.accessToken,t.header["x-basement-token"]=this.accessToken,t.header["x-serverless-sign"]=An(t.data,this.config.clientSecret),t}setupRequest(e,t){const l=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),a={"Content-Type":"application/json"};return"auth"!==t&&(l.token=this.accessToken,a["x-basement-token"]=this.accessToken),a["x-serverless-sign"]=An(l,this.config.clientSecret),{url:this.config.requestUrl,method:"POST",data:l,dataType:"json",header:a}}getAccessToken(){return"pending"===this._getAccessTokenPromiseStatus||(this._getAccessTokenPromiseStatus="pending",this._getAccessTokenPromise=this.requestAuth(this.setupRequest({method:"serverless.auth.user.anonymousAuthorize",params:"{}"},"auth")).then((e=>new Promise(((t,l)=>{e.result&&e.result.accessToken?(this.setAccessToken(e.result.accessToken),this._getAccessTokenPromiseStatus="fulfilled",t(this.accessToken)):(this._getAccessTokenPromiseStatus="rejected",l(new In({code:"AUTH_FAILED",message:"获取accessToken失败"})))}))),(e=>(this._getAccessTokenPromiseStatus="rejected",Promise.reject(e))))),this._getAccessTokenPromise}authorize(){this.getAccessToken()}callFunction(e){const t={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:e.name,functionArgs:e.data||{}})};return this.request(this.setupRequest(t))}getOSSUploadOptionsFromPath(e){const t={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}uploadFileToOSS({url:e,formData:t,name:l,filePath:a,fileType:o,onUploadProgress:n}){return new Promise(((i,r)=>{const s=this.adapter.uploadFile({url:e,formData:t,name:l,filePath:a,fileType:o,header:{"X-OSS-server-side-encrpytion":"AES256"},success(e){e&&e.statusCode<400?i(e):r(new In({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){r(new In({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof n&&s&&"function"==typeof s.onProgressUpdate&&s.onProgressUpdate((e=>{n({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}reportOSSUpload(e){const t={method:"serverless.file.resource.report",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}uploadFile({filePath:e,cloudPath:t,fileType:l="image",onUploadProgress:a,config:o}){if("string"!==an(t))throw new In({code:"INVALID_PARAM",message:"cloudPath必须为字符串类型"});if(!(t=t.trim()))throw new In({code:"CLOUDPATH_REQUIRED",message:"cloudPath不可为空"});if(/:\/\//.test(t))throw new In({code:"INVALID_PARAM",message:"cloudPath不合法"});const n=o&&o.envType||this.config.envType;let i,r;return this.getOSSUploadOptionsFromPath({env:n,filename:t}).then((t=>{const o=t.result;i=o.id,r="https://"+o.cdnDomain+"/"+o.ossPath;const n={url:"https://"+o.host,formData:{"Cache-Control":"max-age=2592000","Content-Disposition":"attachment",OSSAccessKeyId:o.accessKeyId,Signature:o.signature,host:o.host,id:i,key:o.ossPath,policy:o.policy,success_action_status:200},fileName:"file",name:"file",filePath:e,fileType:l};return this.uploadFileToOSS(Object.assign({},n,{onUploadProgress:a}))})).then((()=>this.reportOSSUpload({id:i}))).then((t=>new Promise(((l,a)=>{t.success?l({success:!0,filePath:e,fileID:r}):a(new In({code:"UPLOAD_FAILED",message:"文件上传失败"}))}))))}deleteFile({fileList:e}){const t={method:"serverless.file.resource.delete",params:JSON.stringify({id:e[0]})};return this.request(this.setupRequest(t))}getTempFileURL({fileList:e}={}){return new Promise(((t,l)=>{Array.isArray(e)&&0!==e.length||l(new In({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"})),t({fileList:e.map((e=>({fileID:e,tempFileURL:e})))})}))}},qn={init(e){const t=new Fn(e),l={signInAnonymously:function(){return t.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return l},t.customAuth=t.auth,t}};const zn="undefined"!=typeof location&&"http:"===location.protocol?"http:":"https:";var Un,Mn;(Mn=Un||(Un={})).local="local",Mn.none="none",Mn.session="session";var Wn=function(){};const $n=()=>{let e;if(!Promise){e=()=>{},e.promise={};const t=()=>{throw new In({message:'Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.'})};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}const t=new Promise(((t,l)=>{e=(e,a)=>e?l(e):t(a)}));return e.promise=t,e};function Qn(e){return void 0===e}function jn(e){return"[object Null]"===Object.prototype.toString.call(e)}var Hn;!function(e){e.WEB="web",e.WX_MP="wx_mp"}(Hn||(Hn={}));const Kn={adapter:null,runtime:void 0},Gn=["anonymousUuidKey"];class Jn extends Wn{constructor(){super(),Kn.adapter.root.tcbObject||(Kn.adapter.root.tcbObject={})}setItem(e,t){Kn.adapter.root.tcbObject[e]=t}getItem(e){return Kn.adapter.root.tcbObject[e]}removeItem(e){delete Kn.adapter.root.tcbObject[e]}clear(){delete Kn.adapter.root.tcbObject}}function Yn(e,t){switch(e){case"local":return t.localStorage||new Jn;case"none":return new Jn;default:return t.sessionStorage||new Jn}}class Zn{constructor(e){if(!this._storage){this._persistence=Kn.adapter.primaryStorage||e.persistence,this._storage=Yn(this._persistence,Kn.adapter);const t=`access_token_${e.env}`,l=`access_token_expire_${e.env}`,a=`refresh_token_${e.env}`,o=`anonymous_uuid_${e.env}`,n=`login_type_${e.env}`,i=`user_info_${e.env}`;this.keys={accessTokenKey:t,accessTokenExpireKey:l,refreshTokenKey:a,anonymousUuidKey:o,loginTypeKey:n,userInfoKey:i}}}updatePersistence(e){if(e===this._persistence)return;const t="local"===this._persistence;this._persistence=e;const l=Yn(e,Kn.adapter);for(const a in this.keys){const e=this.keys[a];if(t&&Gn.includes(a))continue;const o=this._storage.getItem(e);Qn(o)||jn(o)||(l.setItem(e,o),this._storage.removeItem(e))}this._storage=l}setStore(e,t,l){if(!this._storage)return;const a={version:l||"localCachev1",content:t},o=JSON.stringify(a);try{this._storage.setItem(e,o)}catch(n){throw n}}getStore(e,t){try{if(!this._storage)return}catch(a){return""}t=t||"localCachev1";const l=this._storage.getItem(e);return l&&l.indexOf(t)>=0?JSON.parse(l).content:""}removeStore(e){this._storage.removeItem(e)}}const Xn={},ei={};function ti(e){return Xn[e]}class li{constructor(e,t){this.data=t||null,this.name=e}}class ai extends li{constructor(e,t){super("error",{error:e,data:t}),this.error=e}}const oi=new class{constructor(){this._listeners={}}on(e,t){return l=e,a=t,(o=this._listeners)[l]=o[l]||[],o[l].push(a),this;var l,a,o}off(e,t){return function(e,t,l){if(l&&l[e]){const a=l[e].indexOf(t);-1!==a&&l[e].splice(a,1)}}(e,t,this._listeners),this}fire(e,t){if(e instanceof ai)return console.error(e.error),this;const l="string"==typeof e?new li(e,t||{}):e,a=l.name;if(this._listens(a)){l.target=this;const e=this._listeners[a]?[...this._listeners[a]]:[];for(const t of e)t.call(this,l)}return this}_listens(e){return this._listeners[e]&&this._listeners[e].length>0}};function ni(e,t){oi.on(e,t)}function ii(e,t={}){oi.fire(e,t)}function ri(e,t){oi.off(e,t)}const si="loginStateChanged",ci="loginStateExpire",di="loginTypeChanged",ui="anonymousConverted",mi="refreshAccessToken";var pi;!function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.NULL="NULL"}(pi||(pi={}));const vi=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"],hi={"X-SDK-Version":"1.3.5"};function fi(e,t,l){const a=e[t];e[t]=function(t){const o={},n={};l.forEach((l=>{const{data:a,headers:i}=l.call(e,t);Object.assign(o,a),Object.assign(n,i)}));const i=t.data;return i&&(()=>{var e;if(e=i,"[object FormData]"!==Object.prototype.toString.call(e))t.data=__spreadValues(__spreadValues({},i),o);else for(const t in o)i.append(t,o[t])})(),t.headers=__spreadValues(__spreadValues({},t.headers||{}),n),a.call(e,t)}}function gi(){const e=Math.random().toString(16).slice(2);return{data:{seqId:e},headers:__spreadProps(__spreadValues({},hi),{"x-seqid":e})}}class yi{constructor(e={}){var t;this.config=e,this._reqClass=new Kn.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:`请求在${this.config.timeout/1e3}s内未完成，已中断`,restrictedMethods:["post"]}),this._cache=ti(this.config.env),this._localCache=(t=this.config.env,ei[t]),fi(this._reqClass,"post",[gi]),fi(this._reqClass,"upload",[gi]),fi(this._reqClass,"download",[gi])}async post(e){return await this._reqClass.post(e)}async upload(e){return await this._reqClass.upload(e)}async download(e){return await this._reqClass.download(e)}async refreshAccessToken(){let e,t;this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken());try{e=await this._refreshAccessTokenPromise}catch(l){t=l}if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,t)throw t;return e}async _refreshAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:l,loginTypeKey:a,anonymousUuidKey:o}=this._cache.keys;this._cache.removeStore(e),this._cache.removeStore(t);let n=this._cache.getStore(l);if(!n)throw new In({message:"未登录CloudBase"});const i={refresh_token:n},r=await this.request("auth.fetchAccessTokenWithRefreshToken",i);if(r.data.code){const{code:e}=r.data;if("SIGN_PARAM_INVALID"===e||"REFRESH_TOKEN_EXPIRED"===e||"INVALID_REFRESH_TOKEN"===e){if(this._cache.getStore(a)===pi.ANONYMOUS&&"INVALID_REFRESH_TOKEN"===e){const e=this._cache.getStore(o),t=this._cache.getStore(l),a=await this.send("auth.signInAnonymously",{anonymous_uuid:e,refresh_token:t});return this.setRefreshToken(a.refresh_token),this._refreshAccessToken()}ii(ci),this._cache.removeStore(l)}throw new In({code:r.data.code,message:`刷新access token失败：${r.data.code}`})}if(r.data.access_token)return ii(mi),this._cache.setStore(e,r.data.access_token),this._cache.setStore(t,r.data.access_token_expire+Date.now()),{accessToken:r.data.access_token,accessTokenExpire:r.data.access_token_expire};r.data.refresh_token&&(this._cache.removeStore(l),this._cache.setStore(l,r.data.refresh_token),this._refreshAccessToken())}async getAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:l}=this._cache.keys;if(!this._cache.getStore(l))throw new In({message:"refresh token不存在，登录状态异常"});let a=this._cache.getStore(e),o=this._cache.getStore(t),n=!0;return this._shouldRefreshAccessTokenHook&&!(await this._shouldRefreshAccessTokenHook(a,o))&&(n=!1),(!a||!o||o<Date.now())&&n?this.refreshAccessToken():{accessToken:a,accessTokenExpire:o}}async request(e,t,l){const a=`x-tcb-trace_${this.config.env}`;let o="application/x-www-form-urlencoded";const n=__spreadValues({action:e,env:this.config.env,dataVersion:"2019-08-16"},t);if(-1===vi.indexOf(e)){const{refreshTokenKey:e}=this._cache.keys;this._cache.getStore(e)&&(n.access_token=(await this.getAccessToken()).accessToken)}let i;if("storage.uploadFile"===e){i=new FormData;for(let e in i)i.hasOwnProperty(e)&&void 0!==i[e]&&i.append(e,n[e]);o="multipart/form-data"}else{o="application/json",i={};for(let e in n)void 0!==n[e]&&(i[e]=n[e])}let r={headers:{"content-type":o}};l&&l.onUploadProgress&&(r.onUploadProgress=l.onUploadProgress);const s=this._localCache.getStore(a);s&&(r.headers["X-TCB-Trace"]=s);const{parse:c,inQuery:d,search:u}=t;let m={env:this.config.env};c&&(m.parse=!0),d&&(m=__spreadValues(__spreadValues({},d),m));let p=function(e,t,l={}){const a=/\?/.test(t);let o="";for(let n in l)""===o?!a&&(t+="?"):o+="&",o+=`${n}=${encodeURIComponent(l[n])}`;return/^http(s)?\:\/\//.test(t+=o)?t:`${e}${t}`}(zn,"//tcb-api.tencentcloudapi.com/web",m);u&&(p+=u);const v=await this.post(__spreadValues({url:p,data:i},r)),h=v.header&&v.header["x-tcb-trace"];if(h&&this._localCache.setStore(a,h),200!==Number(v.status)&&200!==Number(v.statusCode)||!v.data)throw new In({code:"NETWORK_ERROR",message:"network request error"});return v}async send(e,t={}){const l=await this.request(e,t,{onUploadProgress:t.onUploadProgress});if("ACCESS_TOKEN_EXPIRED"===l.data.code&&-1===vi.indexOf(e)){await this.refreshAccessToken();const l=await this.request(e,t,{onUploadProgress:t.onUploadProgress});if(l.data.code)throw new In({code:l.data.code,message:l.data.message});return l.data}if(l.data.code)throw new In({code:l.data.code,message:l.data.message});return l.data}setRefreshToken(e){const{accessTokenKey:t,accessTokenExpireKey:l,refreshTokenKey:a}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(l),this._cache.setStore(a,e)}}const wi={};function Ni(e){return wi[e]}class Ci{constructor(e){this.config=e,this._cache=ti(e.env),this._request=Ni(e.env)}setRefreshToken(e){const{accessTokenKey:t,accessTokenExpireKey:l,refreshTokenKey:a}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(l),this._cache.setStore(a,e)}setAccessToken(e,t){const{accessTokenKey:l,accessTokenExpireKey:a}=this._cache.keys;this._cache.setStore(l,e),this._cache.setStore(a,t)}async refreshUserInfo(){const{data:e}=await this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e}setLocalUserInfo(e){const{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e)}}class Ei{constructor(e){if(!e)throw new In({code:"PARAM_ERROR",message:"envId is not defined"});this._envId=e,this._cache=ti(this._envId),this._request=Ni(this._envId),this.setUserInfo()}linkWithTicket(e){if("string"!=typeof e)throw new In({code:"PARAM_ERROR",message:"ticket must be string"});return this._request.send("auth.linkWithTicket",{ticket:e})}linkWithRedirect(e){e.signInWithRedirect()}updatePassword(e,t){return this._request.send("auth.updatePassword",{oldPassword:t,newPassword:e})}updateEmail(e){return this._request.send("auth.updateEmail",{newEmail:e})}updateUsername(e){if("string"!=typeof e)throw new In({code:"PARAM_ERROR",message:"username must be a string"});return this._request.send("auth.updateUsername",{username:e})}async getLinkedUidList(){const{data:e}=await this._request.send("auth.getLinkedUidList",{});let t=!1;const{users:l}=e;return l.forEach((e=>{e.wxOpenId&&e.wxPublicId&&(t=!0)})),{users:l,hasPrimaryUid:t}}setPrimaryUid(e){return this._request.send("auth.setPrimaryUid",{uid:e})}unlink(e){return this._request.send("auth.unlink",{platform:e})}async update(e){const{nickName:t,gender:l,avatarUrl:a,province:o,country:n,city:i}=e,{data:r}=await this._request.send("auth.updateUserInfo",{nickName:t,gender:l,avatarUrl:a,province:o,country:n,city:i});this.setLocalUserInfo(r)}async refresh(){const{data:e}=await this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e}setUserInfo(){const{userInfoKey:e}=this._cache.keys,t=this._cache.getStore(e);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl"].forEach((e=>{this[e]=t[e]})),this.location={country:t.country,province:t.province,city:t.city}}setLocalUserInfo(e){const{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e),this.setUserInfo()}}class bi{constructor(e){if(!e)throw new In({code:"PARAM_ERROR",message:"envId is not defined"});this._cache=ti(e);const{refreshTokenKey:t,accessTokenKey:l,accessTokenExpireKey:a}=this._cache.keys,o=this._cache.getStore(t),n=this._cache.getStore(l),i=this._cache.getStore(a);this.credential={refreshToken:o,accessToken:n,accessTokenExpire:i},this.user=new Ei(e)}get isAnonymousAuth(){return this.loginType===pi.ANONYMOUS}get isCustomAuth(){return this.loginType===pi.CUSTOM}get isWeixinAuth(){return this.loginType===pi.WECHAT||this.loginType===pi.WECHAT_OPEN||this.loginType===pi.WECHAT_PUBLIC}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}}class Di extends Ci{async signIn(){this._cache.updatePersistence("local");const{anonymousUuidKey:e,refreshTokenKey:t}=this._cache.keys,l=this._cache.getStore(e)||void 0,a=this._cache.getStore(t)||void 0,o=await this._request.send("auth.signInAnonymously",{anonymous_uuid:l,refresh_token:a});if(o.uuid&&o.refresh_token){this._setAnonymousUUID(o.uuid),this.setRefreshToken(o.refresh_token),await this._request.refreshAccessToken(),ii(si),ii(di,{env:this.config.env,loginType:pi.ANONYMOUS,persistence:"local"});const e=new bi(this.config.env);return await e.user.refresh(),e}throw new In({message:"匿名登录失败"})}async linkAndRetrieveDataWithTicket(e){const{anonymousUuidKey:t,refreshTokenKey:l}=this._cache.keys,a=this._cache.getStore(t),o=this._cache.getStore(l),n=await this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:a,refresh_token:o,ticket:e});if(n.refresh_token)return this._clearAnonymousUUID(),this.setRefreshToken(n.refresh_token),await this._request.refreshAccessToken(),ii(ui,{env:this.config.env}),ii(di,{loginType:pi.CUSTOM,persistence:"local"}),{credential:{refreshToken:n.refresh_token}};throw new In({message:"匿名转化失败"})}_setAnonymousUUID(e){const{anonymousUuidKey:t,loginTypeKey:l}=this._cache.keys;this._cache.removeStore(t),this._cache.setStore(t,e),this._cache.setStore(l,pi.ANONYMOUS)}_clearAnonymousUUID(){this._cache.removeStore(this._cache.keys.anonymousUuidKey)}}class Vi extends Ci{async signIn(e){if("string"!=typeof e)throw new In({param:"PARAM_ERROR",message:"ticket must be a string"});const{refreshTokenKey:t}=this._cache.keys,l=await this._request.send("auth.signInWithTicket",{ticket:e,refresh_token:this._cache.getStore(t)||""});if(l.refresh_token)return this.setRefreshToken(l.refresh_token),await this._request.refreshAccessToken(),ii(si),ii(di,{env:this.config.env,loginType:pi.CUSTOM,persistence:this.config.persistence}),await this.refreshUserInfo(),new bi(this.config.env);throw new In({message:"自定义登录失败"})}}class ki extends Ci{async signIn(e,t){if("string"!=typeof e)throw new In({code:"PARAM_ERROR",message:"email must be a string"});const{refreshTokenKey:l}=this._cache.keys,a=await this._request.send("auth.signIn",{loginType:"EMAIL",email:e,password:t,refresh_token:this._cache.getStore(l)||""}),{refresh_token:o,access_token:n,access_token_expire:i}=a;if(o)return this.setRefreshToken(o),n&&i?this.setAccessToken(n,i):await this._request.refreshAccessToken(),await this.refreshUserInfo(),ii(si),ii(di,{env:this.config.env,loginType:pi.EMAIL,persistence:this.config.persistence}),new bi(this.config.env);throw a.code?new In({code:a.code,message:`邮箱登录失败: ${a.message}`}):new In({message:"邮箱登录失败"})}async activate(e){return this._request.send("auth.activateEndUserMail",{token:e})}async resetPasswordWithToken(e,t){return this._request.send("auth.resetPasswordWithToken",{token:e,newPassword:t})}}class xi extends Ci{async signIn(e,t){if("string"!=typeof e)throw new In({code:"PARAM_ERROR",message:"username must be a string"});"string"!=typeof t&&(t="",console.warn("password is empty"));const{refreshTokenKey:l}=this._cache.keys,a=await this._request.send("auth.signIn",{loginType:pi.USERNAME,username:e,password:t,refresh_token:this._cache.getStore(l)||""}),{refresh_token:o,access_token_expire:n,access_token:i}=a;if(o)return this.setRefreshToken(o),i&&n?this.setAccessToken(i,n):await this._request.refreshAccessToken(),await this.refreshUserInfo(),ii(si),ii(di,{env:this.config.env,loginType:pi.USERNAME,persistence:this.config.persistence}),new bi(this.config.env);throw a.code?new In({code:a.code,message:`用户名密码登录失败: ${a.message}`}):new In({message:"用户名密码登录失败"})}}class _i{constructor(e){this.config=e,this._cache=ti(e.env),this._request=Ni(e.env),this._onAnonymousConverted=this._onAnonymousConverted.bind(this),this._onLoginTypeChanged=this._onLoginTypeChanged.bind(this),ni(di,this._onLoginTypeChanged)}get currentUser(){const e=this.hasLoginState();return e&&e.user||null}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}anonymousAuthProvider(){return new Di(this.config)}customAuthProvider(){return new Vi(this.config)}emailAuthProvider(){return new ki(this.config)}usernameAuthProvider(){return new xi(this.config)}async signInAnonymously(){return new Di(this.config).signIn()}async signInWithEmailAndPassword(e,t){return new ki(this.config).signIn(e,t)}signInWithUsernameAndPassword(e,t){return new xi(this.config).signIn(e,t)}async linkAndRetrieveDataWithTicket(e){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new Di(this.config)),ni(ui,this._onAnonymousConverted),await this._anonymousAuthProvider.linkAndRetrieveDataWithTicket(e)}async signOut(){if(this.loginType===pi.ANONYMOUS)throw new In({message:"匿名用户不支持登出操作"});const{refreshTokenKey:e,accessTokenKey:t,accessTokenExpireKey:l}=this._cache.keys,a=this._cache.getStore(e);if(!a)return;const o=await this._request.send("auth.logout",{refresh_token:a});return this._cache.removeStore(e),this._cache.removeStore(t),this._cache.removeStore(l),ii(si),ii(di,{env:this.config.env,loginType:pi.NULL,persistence:this.config.persistence}),o}async signUpWithEmailAndPassword(e,t){return this._request.send("auth.signUpWithEmailAndPassword",{email:e,password:t})}async sendPasswordResetEmail(e){return this._request.send("auth.sendPasswordResetEmail",{email:e})}onLoginStateChanged(e){ni(si,(()=>{const t=this.hasLoginState();e.call(this,t)}));const t=this.hasLoginState();e.call(this,t)}onLoginStateExpired(e){ni(ci,e.bind(this))}onAccessTokenRefreshed(e){ni(mi,e.bind(this))}onAnonymousConverted(e){ni(ui,e.bind(this))}onLoginTypeChanged(e){ni(di,(()=>{const t=this.hasLoginState();e.call(this,t)}))}async getAccessToken(){return{accessToken:(await this._request.getAccessToken()).accessToken,env:this.config.env}}hasLoginState(){const{refreshTokenKey:e}=this._cache.keys;return this._cache.getStore(e)?new bi(this.config.env):null}async isUsernameRegistered(e){if("string"!=typeof e)throw new In({code:"PARAM_ERROR",message:"username must be a string"});const{data:t}=await this._request.send("auth.isUsernameRegistered",{username:e});return t&&t.isRegistered}getLoginState(){return Promise.resolve(this.hasLoginState())}async signInWithTicket(e){return new Vi(this.config).signIn(e)}shouldRefreshAccessToken(e){this._request._shouldRefreshAccessTokenHook=e.bind(this)}getUserInfo(){return this._request.send("auth.getUserInfo",{}).then((e=>e.code?e:__spreadProps(__spreadValues({},e.data),{requestId:e.seqId})))}getAuthHeader(){const{refreshTokenKey:e,accessTokenKey:t}=this._cache.keys,l=this._cache.getStore(e);return{"x-cloudbase-credentials":this._cache.getStore(t)+"/@@/"+l}}_onAnonymousConverted(e){const{env:t}=e.data;t===this.config.env&&this._cache.updatePersistence(this.config.persistence)}_onLoginTypeChanged(e){const{loginType:t,persistence:l,env:a}=e.data;a===this.config.env&&(this._cache.updatePersistence(l),this._cache.setStore(this._cache.keys.loginTypeKey,t))}}const Si=function(e,t){t=t||$n();const l=Ni(this.config.env),{cloudPath:a,filePath:o,onUploadProgress:n,fileType:i="image"}=e;return l.send("storage.getUploadMetadata",{path:a}).then((e=>{const{data:{url:r,authorization:s,token:c,fileId:d,cosFileId:u},requestId:m}=e,p={key:a,signature:s,"x-cos-meta-fileid":u,success_action_status:"201","x-cos-security-token":c};l.upload({url:r,data:p,file:o,name:a,fileType:i,onUploadProgress:n}).then((e=>{201===e.statusCode?t(null,{fileID:d,requestId:m}):t(new In({code:"STORAGE_REQUEST_FAIL",message:`STORAGE_REQUEST_FAIL: ${e.data}`}))})).catch((e=>{t(e)}))})).catch((e=>{t(e)})),t.promise},Ii=function(e,t){t=t||$n();const l=Ni(this.config.env),{cloudPath:a}=e;return l.send("storage.getUploadMetadata",{path:a}).then((e=>{t(null,e)})).catch((e=>{t(e)})),t.promise},Bi=function({fileList:e},t){if(t=t||$n(),!e||!Array.isArray(e))return{code:"INVALID_PARAM",message:"fileList必须是非空的数组"};for(let a of e)if(!a||"string"!=typeof a)return{code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"};const l={fileid_list:e};return Ni(this.config.env).send("storage.batchDeleteFile",l).then((e=>{e.code?t(null,e):t(null,{fileList:e.data.delete_list,requestId:e.requestId})})).catch((e=>{t(e)})),t.promise},Ti=function({fileList:e},t){t=t||$n(),e&&Array.isArray(e)||t(null,{code:"INVALID_PARAM",message:"fileList必须是非空的数组"});let l=[];for(let o of e)"object"==typeof o?(o.hasOwnProperty("fileID")&&o.hasOwnProperty("maxAge")||t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是包含fileID和maxAge的对象"}),l.push({fileid:o.fileID,max_age:o.maxAge})):"string"==typeof o?l.push({fileid:o}):t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是字符串"});const a={file_list:l};return Ni(this.config.env).send("storage.batchGetDownloadUrl",a).then((e=>{e.code?t(null,e):t(null,{fileList:e.data.download_list,requestId:e.requestId})})).catch((e=>{t(e)})),t.promise},Ai=async function({fileID:e},t){const l=(await Ti.call(this,{fileList:[{fileID:e,maxAge:600}]})).fileList[0];if("SUCCESS"!==l.code)return t?t(l):new Promise((e=>{e(l)}));const a=Ni(this.config.env);let o=l.download_url;if(o=encodeURI(o),!t)return a.download({url:o});t(await a.download({url:o}))},Pi=function({name:e,data:t,query:l,parse:a,search:o},n){const i=n||$n();let r;try{r=t?JSON.stringify(t):""}catch(c){return Promise.reject(c)}if(!e)return Promise.reject(new In({code:"PARAM_ERROR",message:"函数名不能为空"}));const s={inQuery:l,parse:a,search:o,function_name:e,request_data:r};return Ni(this.config.env).send("functions.invokeFunction",s).then((e=>{if(e.code)i(null,e);else{let l=e.data.response_data;if(a)i(null,{result:l,requestId:e.requestId});else try{l=JSON.parse(e.data.response_data),i(null,{result:l,requestId:e.requestId})}catch(t){i(new In({message:"response data must be json"}))}}return i.promise})).catch((e=>{i(e)})),i.promise},Oi={timeout:15e3,persistence:"session"},Ri={};class Li{constructor(e){this.config=e||this.config,this.authObj=void 0}init(e){switch(Kn.adapter||(this.requestClient=new Kn.adapter.reqClass({timeout:e.timeout||5e3,timeoutMsg:`请求在${(e.timeout||5e3)/1e3}s内未完成，已中断`})),this.config=__spreadValues(__spreadValues({},Oi),e),!0){case this.config.timeout>6e5:console.warn("timeout大于可配置上限[10分钟]，已重置为上限数值"),this.config.timeout=6e5;break;case this.config.timeout<100:console.warn("timeout小于可配置下限[100ms]，已重置为下限数值"),this.config.timeout=100}return new Li(this.config)}auth({persistence:e}={}){if(this.authObj)return this.authObj;const t=e||Kn.adapter.primaryStorage||Oi.persistence;var l;return t!==this.config.persistence&&(this.config.persistence=t),function(e){const{env:t}=e;Xn[t]=new Zn(e),ei[t]=new Zn(__spreadProps(__spreadValues({},e),{persistence:"local"}))}(this.config),l=this.config,wi[l.env]=new yi(l),this.authObj=new _i(this.config),this.authObj}on(e,t){return ni.apply(this,[e,t])}off(e,t){return ri.apply(this,[e,t])}callFunction(e,t){return Pi.apply(this,[e,t])}deleteFile(e,t){return Bi.apply(this,[e,t])}getTempFileURL(e,t){return Ti.apply(this,[e,t])}downloadFile(e,t){return Ai.apply(this,[e,t])}uploadFile(e,t){return Si.apply(this,[e,t])}getUploadMetadata(e,t){return Ii.apply(this,[e,t])}registerExtension(e){Ri[e.name]=e}async invokeExtension(e,t){const l=Ri[e];if(!l)throw new In({message:`扩展${e} 必须先注册`});return await l.invoke(t,this)}useAdapters(e){const{adapter:t,runtime:l}=function(e){const t=(l=e,"[object Array]"===Object.prototype.toString.call(l)?e:[e]);var l;for(const a of t){const{isMatch:e,genAdapter:t,runtime:l}=a;if(e())return{adapter:t(),runtime:l}}}(e)||{};t&&(Kn.adapter=t),l&&(Kn.runtime=l)}}var Fi=new Li;function qi(e,t,l){void 0===l&&(l={});var a=/\?/.test(t),o="";for(var n in l)""===o?!a&&(t+="?"):o+="&",o+=n+"="+encodeURIComponent(l[n]);return/^http(s)?:\/\//.test(t+=o)?t:""+e+t}class zi{post(e){const{url:t,data:l,headers:a}=e;return new Promise(((e,o)=>{On.request({url:qi("https:",t),data:l,method:"POST",header:a,success(t){e(t)},fail(e){o(e)}})}))}upload(e){return new Promise(((t,l)=>{const{url:a,file:o,data:n,headers:i,fileType:r}=e,s=On.uploadFile({url:qi("https:",a),name:"file",formData:Object.assign({},n),filePath:o,fileType:r,header:i,success(e){const l={statusCode:e.statusCode,data:e.data||{}};200===e.statusCode&&n.success_action_status&&(l.statusCode=parseInt(n.success_action_status,10)),t(l)},fail(e){l(new Error(e.errMsg||"uploadFile:fail"))}});"function"==typeof e.onUploadProgress&&s&&"function"==typeof s.onProgressUpdate&&s.onProgressUpdate((t=>{e.onUploadProgress({loaded:t.totalBytesSent,total:t.totalBytesExpectedToSend})}))}))}}const Ui={setItem(e,t){On.setStorageSync(e,t)},getItem:e=>On.getStorageSync(e),removeItem(e){On.removeStorageSync(e)},clear(){On.clearStorageSync()}};var Mi={genAdapter:function(){return{root:{},reqClass:zi,localStorage:Ui,primaryStorage:"local"}},isMatch:function(){return!0},runtime:"uni_app"};Fi.useAdapters(Mi);const Wi=Fi,$i=Wi.init;Wi.init=function(e){e.env=e.spaceId;const t=$i.call(this,e);t.config.provider="tencent",t.config.spaceId=e.spaceId;const l=t.auth;return t.auth=function(e){const t=l.call(this,e);return["linkAndRetrieveDataWithTicket","signInAnonymously","signOut","getAccessToken","getLoginState","signInWithTicket","getUserInfo"].forEach((e=>{t[e]=Sn(t[e]).bind(t)})),t},t.customAuth=t.auth,t};var Qi=Wi;function ji(e){return e&&ji(e.__v_raw)||e}function Hi(){return{token:On.getStorageSync("uni_id_token")||On.getStorageSync("uniIdToken"),tokenExpired:On.getStorageSync("uni_id_token_expired")}}function Ki({token:e,tokenExpired:t}={}){e&&On.setStorageSync("uni_id_token",e),t&&On.setStorageSync("uni_id_token_expired",t)}var Gi=class extends Fn{getAccessToken(){return new Promise(((e,t)=>{const l="Anonymous_Access_token";this.setAccessToken(l),e(l)}))}setupRequest(e,t){const l=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),a={"Content-Type":"application/json"};"auth"!==t&&(l.token=this.accessToken,a["x-basement-token"]=this.accessToken),a["x-serverless-sign"]=An(l,this.config.clientSecret);const o=Tn();a["x-client-info"]=encodeURIComponent(JSON.stringify(o));const{token:n}=Hi();return a["x-client-token"]=n,{url:this.config.requestUrl,method:"POST",data:l,dataType:"json",header:JSON.parse(JSON.stringify(a))}}uploadFileToOSS({url:e,formData:t,name:l,filePath:a,fileType:o,onUploadProgress:n}){return new Promise(((i,r)=>{const s=this.adapter.uploadFile({url:e,formData:t,name:l,filePath:a,fileType:o,success(e){e&&e.statusCode<400?i(e):r(new In({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){r(new In({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof n&&s&&"function"==typeof s.onProgressUpdate&&s.onProgressUpdate((e=>{n({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}uploadFile({filePath:e,cloudPath:t,fileType:l="image",onUploadProgress:a}){if(!t)throw new In({code:"CLOUDPATH_REQUIRED",message:"cloudPath不可为空"});let o;return this.getOSSUploadOptionsFromPath({cloudPath:t}).then((t=>{const{url:n,formData:i,name:r}=t.result;o=t.result.fileUrl;const s={url:n,formData:i,name:r,filePath:e,fileType:l};return this.uploadFileToOSS(Object.assign({},s,{onUploadProgress:a}))})).then((()=>this.reportOSSUpload({cloudPath:t}))).then((t=>new Promise(((l,a)=>{t.success?l({success:!0,filePath:e,fileID:o}):a(new In({code:"UPLOAD_FAILED",message:"文件上传失败"}))}))))}deleteFile({fileList:e}){const t={method:"serverless.file.resource.delete",params:JSON.stringify({fileList:e})};return this.request(this.setupRequest(t))}getTempFileURL({fileList:e}={}){const t={method:"serverless.file.resource.getTempFileURL",params:JSON.stringify({fileList:e})};return this.request(this.setupRequest(t))}},Ji={init(e){const t=new Gi(e),l={signInAnonymously:function(){return t.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return l},t.customAuth=t.auth,t}};function Yi({data:e}){let t;t=Tn();const l=JSON.parse(JSON.stringify(e||{}));if(Object.assign(l,{clientInfo:t}),!l.uniIdToken){const{token:e}=Hi();e&&(l.uniIdToken=e)}return l}const Zi=[{rule:/fc_function_not_found|FUNCTION_NOT_FOUND/,content:"，云函数[{functionName}]在云端不存在，请检查此云函数名称是否正确以及该云函数是否已上传到服务空间",mode:"append"}];var Xi=/[\\^$.*+?()[\]{}|]/g,er=RegExp(Xi.source);function tr(e,t,l){return e.replace(new RegExp((a=t)&&er.test(a)?a.replace(Xi,"\\$&"):a,"g"),l);var a}function lr({functionName:e,result:t,logPvd:l}){if(this.config.debugLog&&t&&t.requestId){const a=JSON.stringify({spaceId:this.config.spaceId,functionName:e,requestId:t.requestId});console.log(`[${l}-request]${a}[/${l}-request]`)}}function ar(e){const t=e.callFunction,l=function(l){const a=l.name;l.data=Yi.call(e,{data:l.data});const o={aliyun:"aliyun",tencent:"tcb",tcb:"tcb"}[this.config.provider];return t.call(this,l).then((e=>(e.errCode=0,lr.call(this,{functionName:a,result:e,logPvd:o}),Promise.resolve(e))),(e=>(lr.call(this,{functionName:a,result:e,logPvd:o}),e&&e.message&&(e.message=function({message:e="",extraInfo:t={},formatter:l=[]}={}){for(let a=0;a<l.length;a++){const{rule:o,content:n,mode:i}=l[a],r=e.match(o);if(!r)continue;let s=n;for(let e=1;e<r.length;e++)s=tr(s,`{$${e}}`,r[e]);for(const e in t)s=tr(s,`{${e}}`,t[e]);return"replace"===i?s:e+s}return e}({message:`[${l.name}]: ${e.message}`,formatter:Zi,extraInfo:{functionName:a}})),Promise.reject(e))))};e.callFunction=function(e){let t;return t=l.call(this,e),Object.defineProperty(t,"result",{get:()=>(console.warn("当前返回结果为Promise类型，不可直接访问其result属性，详情请参考：https://uniapp.dcloud.net.cn/uniCloud/faq?id=promise"),{})}),t}}const or=Symbol("CLIENT_DB_INTERNAL");function nr(e,t){return e.then="DoNotReturnProxyWithAFunctionNamedThen",e._internalType=or,e.__v_raw=void 0,new Proxy(e,{get(e,l,a){if("_uniClient"===l)return null;if(l in e||"string"!=typeof l){const t=e[l];return"function"==typeof t?t.bind(e):t}return t.get(e,l,a)}})}function ir(e){return{on:(t,l)=>{e[t]=e[t]||[],e[t].indexOf(l)>-1||e[t].push(l)},off:(t,l)=>{e[t]=e[t]||[];const a=e[t].indexOf(l);-1!==a&&e[t].splice(a,1)}}}const rr=["db.Geo","db.command","command.aggregate"];function sr(e,t){return rr.indexOf(`${e}.${t}`)>-1}function cr(e){switch(an(e=ji(e))){case"array":return e.map((e=>cr(e)));case"object":return e._internalType===or||Object.keys(e).forEach((t=>{e[t]=cr(e[t])})),e;case"regexp":return{$regexp:{source:e.source,flags:e.flags}};case"date":return{$date:e.toISOString()};default:return e}}function dr(e){return e&&e.content&&e.content.$method}class ur{constructor(e,t,l){this.content=e,this.prevStage=t||null,this.udb=null,this._database=l}toJSON(){let e=this;const t=[e.content];for(;e.prevStage;)e=e.prevStage,t.push(e.content);return{$db:t.reverse().map((e=>({$method:e.$method,$param:cr(e.$param)})))}}getAction(){const e=this.toJSON().$db.find((e=>"action"===e.$method));return e&&e.$param&&e.$param[0]}getCommand(){return{$db:this.toJSON().$db.filter((e=>"action"!==e.$method))}}get isAggregate(){let e=this;for(;e;){const t=dr(e),l=dr(e.prevStage);if("aggregate"===t&&"collection"===l||"pipeline"===t)return!0;e=e.prevStage}return!1}get isCommand(){let e=this;for(;e;){if("command"===dr(e))return!0;e=e.prevStage}return!1}get isAggregateCommand(){let e=this;for(;e;){const t=dr(e),l=dr(e.prevStage);if("aggregate"===t&&"command"===l)return!0;e=e.prevStage}return!1}get count(){if(!this.isAggregate)return function(){return this._send("count",Array.from(arguments))};const e=this;return function(){return mr({$method:"count",$param:cr(Array.from(arguments))},e,this._database)}}get remove(){if(!this.isCommand)return function(){return this._send("remove",Array.from(arguments))};const e=this;return function(){return mr({$method:"remove",$param:cr(Array.from(arguments))},e,this._database)}}get(){return this._send("get",Array.from(arguments))}add(){return this._send("add",Array.from(arguments))}update(){return this._send("update",Array.from(arguments))}end(){return this._send("end",Array.from(arguments))}get set(){if(!this.isCommand)return function(){throw new Error("JQL禁止使用set方法")};const e=this;return function(){return mr({$method:"set",$param:cr(Array.from(arguments))},e,this._database)}}_send(e,t){const l=this.getAction(),a=this.getCommand();return a.$db.push({$method:e,$param:cr(t)}),this._database._callCloudFunction({action:l,command:a})}}function mr(e,t,l){return nr(new ur(e,t,l),{get(e,t){let a="db";return e&&e.content&&(a=e.content.$method),sr(a,t)?mr({$method:t},e,l):function(){return mr({$method:t,$param:cr(Array.from(arguments))},e,l)}}})}function pr({path:e,method:t}){return class{constructor(){this.param=Array.from(arguments)}toJSON(){return{$newDb:[...e.map((e=>({$method:e}))),{$method:t,$param:this.param}]}}}}class vr extends class{constructor({uniClient:e={}}={}){this._uniClient=e,this._authCallBacks={},this._dbCallBacks={},e.isDefault&&(this._dbCallBacks=un("_globalUniCloudDatabaseCallback")),this.auth=ir(this._authCallBacks),Object.assign(this,ir(this._dbCallBacks)),this.env=nr({},{get:(e,t)=>({$env:t})}),this.Geo=nr({},{get:(e,t)=>pr({path:["Geo"],method:t})}),this.serverDate=pr({path:[],method:"serverDate"}),this.RegExp=pr({path:[],method:"RegExp"})}getCloudEnv(e){if("string"!=typeof e||!e.trim())throw new Error("getCloudEnv参数错误");return{$env:e.replace("$cloudEnv_","")}}_callback(e,t){const l=this._dbCallBacks;l[e]&&l[e].forEach((e=>{e(...t)}))}_callbackAuth(e,t){const l=this._authCallBacks;l[e]&&l[e].forEach((e=>{e(...t)}))}multiSend(){const e=Array.from(arguments),t=e.map((e=>{const t=e.getAction(),l=e.getCommand();if("getTemp"!==l.$db[l.$db.length-1].$method)throw new Error("multiSend只支持子命令内使用getTemp");return{action:t,command:l}}));return this._callCloudFunction({multiCommand:t,queryList:e})}}{_callCloudFunction({action:e,command:t,multiCommand:l,queryList:a}){function o(e,t){if(l&&a)for(let l=0;l<a.length;l++){const o=a[l];o.udb&&"function"==typeof o.udb.setResult&&(t?o.udb.setResult(t):o.udb.setResult(e.result.dataList[l]))}}const n=this;function i(e){return n._callback("error",[e]),fn(gn("database","fail"),e).then((()=>fn(gn("database","complete"),e))).then((()=>(o(null,e),_n(wn,{type:En,content:e}),Promise.reject(e))))}const r=fn(gn("database","invoke")),s=this._uniClient;return r.then((()=>s.callFunction({name:"DCloud-clientDB",type:"CLIENT_DB",data:{action:e,command:t,multiCommand:l}}))).then((e=>{const{code:t,message:l,token:a,tokenExpired:n,systemInfo:r=[]}=e.result;if(r)for(let o=0;o<r.length;o++){const{level:e,message:t,detail:l}=r[o],a=console["app"===rn&&"warn"===e?"error":e]||console.log;let n="[System Info]"+t;l&&(n=`${n}\n详细信息：${l}`),a(n)}if(t)return i(new In({code:t,message:l,requestId:e.requestId}));e.result.errCode=e.result.code,e.result.errMsg=e.result.message,a&&n&&(Ki({token:a,tokenExpired:n}),this._callbackAuth("refreshToken",[{token:a,tokenExpired:n}]),this._callback("refreshToken",[{token:a,tokenExpired:n}]),_n(Cn,{token:a,tokenExpired:n}));const s=[{prop:"affectedDocs",tips:"affectedDocs不再推荐使用，请使用inserted/deleted/updated/data.length替代"},{prop:"code",tips:"code不再推荐使用，请使用errCode替代"},{prop:"message",tips:"message不再推荐使用，请使用errMsg替代"}];for(let o=0;o<s.length;o++){const{prop:t,tips:l}=s[o];if(t in e.result){const a=e.result[t];Object.defineProperty(e.result,t,{get:()=>(console.warn(l),a)})}}return c=e,fn(gn("database","success"),c).then((()=>fn(gn("database","complete"),c))).then((()=>(o(c,null),_n(wn,{type:En,content:c}),Promise.resolve(c))));var c}),(e=>(/fc_function_not_found|FUNCTION_NOT_FOUND/g.test(e.message)&&console.warn("clientDB未初始化，请在web控制台保存一次schema以开启clientDB"),i(new In({code:e.code||"SYSTEM_ERROR",message:e.message,requestId:e.requestId})))))}}const hr="token无效，跳转登录页面",fr="token过期，跳转登录页面",gr={TOKEN_INVALID_TOKEN_EXPIRED:fr,TOKEN_INVALID_INVALID_CLIENTID:hr,TOKEN_INVALID:hr,TOKEN_INVALID_WRONG_TOKEN:hr,TOKEN_INVALID_ANONYMOUS_USER:hr},yr={"uni-id-token-expired":fr,"uni-id-check-token-failed":hr,"uni-id-token-not-exist":hr,"uni-id-check-device-feature-failed":hr};function wr(e,t){let l="";return l=e?`${e}/${t}`:t,l.replace(/^\//,"")}function Nr(e=[],t=""){const l=[],a=[];return e.forEach((e=>{!0===e.needLogin?l.push(wr(t,e.path)):!1===e.needLogin&&a.push(wr(t,e.path))})),{needLoginPage:l,notNeedLoginPage:a}}function Cr(e="",t={}){if(!e)return!1;if(!(t&&t.list&&t.list.length))return!1;const l=t.list,a=e.split("?")[0].replace(/^\//,"");return l.some((e=>e.pagePath===a))}const Er=!!Zo.uniIdRouter,{loginPage:br,routerNeedLogin:Dr,resToLogin:Vr,needLoginPage:kr,notNeedLoginPage:xr,loginPageInTabBar:_r}=function({pages:e=[],subPackages:t=[],uniIdRouter:l={},tabBar:a={}}=Zo){const{loginPage:o,needLogin:n=[],resToLogin:i=!0}=l,{needLoginPage:r,notNeedLoginPage:s}=Nr(e),{needLoginPage:c,notNeedLoginPage:d}=function(e=[]){const t=[],l=[];return e.forEach((e=>{const{root:a,pages:o=[]}=e,{needLoginPage:n,notNeedLoginPage:i}=Nr(o,a);t.push(...n),l.push(...i)})),{needLoginPage:t,notNeedLoginPage:l}}(t);return{loginPage:o,routerNeedLogin:n,resToLogin:i,needLoginPage:[...r,...c],notNeedLoginPage:[...s,...d],loginPageInTabBar:Cr(o,a)}}();function Sr(e){const t=function(e){const t=getCurrentPages(),l=t[t.length-1].route,a=e.charAt(0),o=e.split("?")[0];if("/"===a)return o;const n=o.replace(/^\//,"").split("/"),i=l.split("/");i.pop();for(let r=0;r<n.length;r++){const e=n[r];".."===e?i.pop():"."!==e&&i.push(e)}return""===i[0]&&i.shift(),i.join("/")}(e).replace(/^\//,"");return!(xr.indexOf(t)>-1)&&(kr.indexOf(t)>-1||Dr.some((t=>{return l=e,new RegExp(t).test(l);var l})))}function Ir(e,t){return"/"!==e.charAt(0)&&(e="/"+e),t?e.indexOf("?")>-1?e+`&uniIdRedirectUrl=${encodeURIComponent(t)}`:e+`?uniIdRedirectUrl=${encodeURIComponent(t)}`:e}function Br(){const e=["navigateTo","redirectTo","reLaunch","switchTab"];for(let t=0;t<e.length;t++){const l=e[t];uni.addInterceptor(l,{invoke(e){const{token:t,tokenExpired:a}=Hi();let o;if(t){if(a<Date.now()){const e="uni-id-token-expired";o={errCode:e,errMsg:yr[e]}}}else{const e="uni-id-check-token-failed";o={errCode:e,errMsg:yr[e]}}if(Sr(e.url)&&o){if(o.uniIdRedirectUrl=e.url,Vn(Nn).length>0)return setTimeout((()=>{_n(Nn,o)}),0),e.url="",!1;if(!br)return e;const t=Ir(br,o.uniIdRedirectUrl);if(_r){if("navigateTo"===l||"redirectTo"===l)return setTimeout((()=>{uni.switchTab({url:t})})),!1}else if("switchTab"===l)return setTimeout((()=>{uni.navigateTo({url:t})})),!1;e.url=t}return e}})}}function Tr(){this.onResponse((e=>{const{type:t,content:l}=e;let a=!1;switch(t){case"cloudobject":a=function(e){const{errCode:t}=e;return t in yr}(l);break;case"clientdb":a=function(e){const{errCode:t}=e;return t in gr}(l)}a&&function(e={}){const t=Vn(Nn),l=getCurrentPages(),a=l[l.length-1],o=a&&a.$page&&a.$page.fullPath;if(t.length>0)return _n(Nn,Object.assign({uniIdRedirectUrl:o},e));br&&uni.navigateTo({url:Ir(br,o)})}(l)}))}function Ar(e){e.onNeedLogin=function(e){kn(Nn,e)},e.offNeedLogin=function(e){xn(Nn,e)},Er&&(un("uni-cloud-status").needLoginInit||(un("uni-cloud-status").needLoginInit=!0,function t(){const l=getCurrentPages();l&&l[0]?Br.call(e):setTimeout((()=>{t()}),30)}(),Vr&&Tr.call(e)))}let Pr;const Or="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Rr=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;function Lr(){const e=Hi().token||"",t=e.split(".");if(!e||3!==t.length)return{uid:null,role:[],permission:[],tokenExpired:0};let l;try{l=JSON.parse((a=t[1],decodeURIComponent(Pr(a).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))))}catch(o){throw new Error("获取当前用户信息出错，详细错误信息为："+o.message)}var a;return l.tokenExpired=1e3*l.exp,delete l.exp,delete l.iat,l}Pr="function"!=typeof atob?function(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!Rr.test(e))throw new Error("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");var t;e+="==".slice(2-(3&e.length));for(var l,a,o="",n=0;n<e.length;)t=Or.indexOf(e.charAt(n++))<<18|Or.indexOf(e.charAt(n++))<<12|(l=Or.indexOf(e.charAt(n++)))<<6|(a=Or.indexOf(e.charAt(n++))),o+=64===l?String.fromCharCode(t>>16&255):64===a?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return o}:atob;var Fr=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Xo((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const l="chooseAndUploadFile:ok",a="chooseAndUploadFile:fail";function o(e,t){return e.tempFiles.forEach(((e,l)=>{e.name||(e.name=e.path.substring(e.path.lastIndexOf("/")+1)),t&&(e.fileType=t),e.cloudPath=Date.now()+"_"+l+e.name.substring(e.name.lastIndexOf("."))})),e.tempFilePaths||(e.tempFilePaths=e.tempFiles.map((e=>e.path))),e}function n(e,t,{onChooseFile:a,onUploadProgress:o}){return t.then((e=>{if(a){const t=a(e);if(void 0!==t)return Promise.resolve(t).then((t=>void 0===t?e:t))}return e})).then((t=>!1===t?{errMsg:l,tempFilePaths:[],tempFiles:[]}:function(e,t,a=5,o){(t=Object.assign({},t)).errMsg=l;const n=t.tempFiles,i=n.length;let r=0;return new Promise((l=>{for(;r<a;)s();function s(){const a=r++;if(a>=i)return void(!n.find((e=>!e.url&&!e.errMsg))&&l(t));const c=n[a];e.uploadFile({filePath:c.path,cloudPath:c.cloudPath,fileType:c.fileType,onUploadProgress(e){e.index=a,e.tempFile=c,e.tempFilePath=c.path,o&&o(e)}}).then((e=>{c.url=e.fileID,a<i&&s()})).catch((e=>{c.errMsg=e.errMsg||e.message,a<i&&s()}))}}))}(e,t,5,o)))}t.initChooseAndUploadFile=function(e){return function(t={type:"all"}){return"image"===t.type?n(e,function(e){const{count:t,sizeType:l,sourceType:n=["album","camera"],extension:i}=e;return new Promise(((e,r)=>{uni.chooseImage({count:t,sizeType:l,sourceType:n,extension:i,success(t){e(o(t,"image"))},fail(e){r({errMsg:e.errMsg.replace("chooseImage:fail",a)})}})}))}(t),t):"video"===t.type?n(e,function(e){const{camera:t,compressed:l,maxDuration:n,sourceType:i=["album","camera"],extension:r}=e;return new Promise(((e,s)=>{uni.chooseVideo({camera:t,compressed:l,maxDuration:n,sourceType:i,extension:r,success(t){const{tempFilePath:l,duration:a,size:n,height:i,width:r}=t;e(o({errMsg:"chooseVideo:ok",tempFilePaths:[l],tempFiles:[{name:t.tempFile&&t.tempFile.name||"",path:l,size:n,type:t.tempFile&&t.tempFile.type||"",width:r,height:i,duration:a,fileType:"video",cloudPath:""}]},"video"))},fail(e){s({errMsg:e.errMsg.replace("chooseVideo:fail",a)})}})}))}(t),t):n(e,function(e){const{count:t,extension:l}=e;return new Promise(((e,n)=>{let i=uni.chooseFile;if("undefined"!=typeof wx&&"function"==typeof wx.chooseMessageFile&&(i=wx.chooseMessageFile),"function"!=typeof i)return n({errMsg:a+" 请指定 type 类型，该平台仅支持选择 image 或 video。"});i({type:"all",count:t,extension:l,success(t){e(o(t))},fail(e){n({errMsg:e.errMsg.replace("chooseFile:fail",a)})}})}))}(t),t)}}})));function qr(e){return{props:{localdata:{type:Array,default:()=>[]},options:{type:[Object,Array],default:()=>({})},spaceInfo:{type:Object,default:()=>({})},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1}},data:()=>({mixinDatacomLoading:!1,mixinDatacomHasMore:!1,mixinDatacomResData:[],mixinDatacomErrorMessage:"",mixinDatacomPage:{}}),created(){this.mixinDatacomPage={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch((()=>{var e=[];return["pageCurrent","pageSize","localdata","collection","action","field","orderby","where","getont","getcount","gettree","groupby","groupField","distinct"].forEach((t=>{e.push(this[t])})),e}),((e,t)=>{if("manual"===this.loadtime)return;let l=!1;const a=[];for(let o=2;o<e.length;o++)e[o]!==t[o]&&(a.push(e[o]),l=!0);e[0]!==t[0]&&(this.mixinDatacomPage.current=this.pageCurrent),this.mixinDatacomPage.size=this.pageSize,this.onMixinDatacomPropsChange(l,a)}))},methods:{onMixinDatacomPropsChange(e,t){},mixinDatacomEasyGet({getone:e=!1,success:t,fail:l}={}){this.mixinDatacomLoading||(this.mixinDatacomLoading=!0,this.mixinDatacomErrorMessage="",this.mixinDatacomGet().then((l=>{this.mixinDatacomLoading=!1;const{data:a,count:o}=l.result;this.getcount&&(this.mixinDatacomPage.count=o),this.mixinDatacomHasMore=a.length<this.pageSize;const n=e?a.length?a[0]:void 0:a;this.mixinDatacomResData=n,t&&t(n)})).catch((e=>{this.mixinDatacomLoading=!1,this.mixinDatacomErrorMessage=e,l&&l(e)})))},mixinDatacomGet(t={}){let l=e.database(this.spaceInfo);const a=t.action||this.action;a&&(l=l.action(a));const o=t.collection||this.collection;l=Array.isArray(o)?l.collection(...o):l.collection(o);const n=t.where||this.where;n&&Object.keys(n).length&&(l=l.where(n));const i=t.field||this.field;i&&(l=l.field(i));const r=t.foreignKey||this.foreignKey;r&&(l=l.foreignKey(r));const s=t.groupby||this.groupby;s&&(l=l.groupBy(s));const c=t.groupField||this.groupField;c&&(l=l.groupField(c)),!0===(void 0!==t.distinct?t.distinct:this.distinct)&&(l=l.distinct());const d=t.orderby||this.orderby;d&&(l=l.orderBy(d));const u=void 0!==t.pageCurrent?t.pageCurrent:this.mixinDatacomPage.current,m=void 0!==t.pageSize?t.pageSize:this.mixinDatacomPage.size,p=void 0!==t.getcount?t.getcount:this.getcount,v=void 0!==t.gettree?t.gettree:this.gettree,h=void 0!==t.gettreepath?t.gettreepath:this.gettreepath,f={getCount:p},g={limitLevel:void 0!==t.limitlevel?t.limitlevel:this.limitlevel,startWith:void 0!==t.startwith?t.startwith:this.startwith};return v&&(f.getTree=g),h&&(f.getTreePath=g),l=l.skip(m*(u-1)).limit(m).get(f),l}}}}function zr(e){if(e.initUniCloudStatus&&"rejected"!==e.initUniCloudStatus)return;let t=Promise.resolve();t=new Promise(((e,t)=>{setTimeout((()=>{e()}),1)})),e.isReady=!1,e.isDefault=!1;const l=e.auth();e.initUniCloudStatus="pending",e.initUniCloud=t.then((()=>l.getLoginState())).then((e=>e?Promise.resolve():l.signInAnonymously())).then((()=>Promise.resolve())).then((({address:e,port:t}={})=>Promise.resolve())).then((()=>{e.isReady=!0,e.initUniCloudStatus="fulfilled"})).catch((t=>{console.error(t),e.initUniCloudStatus="rejected"}))}let Ur=new class{init(e){let t={};const l=false;switch(e.provider){case"tcb":case"tencent":t=Qi.init(Object.assign(e,{debugLog:l}));break;case"aliyun":t=qn.init(Object.assign(e,{debugLog:l}));break;case"private":t=Ji.init(Object.assign(e,{debugLog:l}));break;default:throw new Error("未提供正确的provider参数")}var a;return zr(t),t.reInit=function(){zr(this)},ar(t),function(e){const t=e.uploadFile;e.uploadFile=function(e){return t.call(this,e)}}(t),function(e){e.database=function(t){if(t&&Object.keys(t).length>0)return e.init(t).database();if(this._database)return this._database;const l=function(e,t={}){return nr(new e(t),{get:(e,t)=>sr("db",t)?mr({$method:t},null,e):function(){return mr({$method:t,$param:cr(Array.from(arguments))},null,e)}})}(vr,{uniClient:e});return this._database=l,l}}(t),(a=t).getCurrentUserInfo=Lr,a.chooseAndUploadFile=Fr.initChooseAndUploadFile(a),Object.assign(a,{get mixinDatacom(){return qr(a)}}),a.importObject=function(e){return function(t,l={}){l=function(e,t={}){return e.customUI=t.customUI||e.customUI,Object.assign(e.loadingOptions,t.loadingOptions),Object.assign(e.errorOptions,t.errorOptions),e}({customUI:!1,loadingOptions:{title:"加载中...",mask:!0},errorOptions:{type:"modal",retry:!1}},l);const{customUI:o,loadingOptions:n,errorOptions:i}=l,r=!o;return new Proxy({},{get:(l,o)=>async function l(...s){let c;r&&uni.showLoading({title:n.title,mask:n.mask});try{c=await e.callFunction({name:t,type:"OBJECT",data:{method:o,params:s}})}catch(a){c={result:a}}const{errCode:d,errMsg:u,newToken:m}=c.result||{};if(r&&uni.hideLoading(),m&&m.token&&m.tokenExpired&&(Ki(m),_n(Cn,__spreadValues({},m))),d){if(r)if("toast"===i.type)uni.showToast({title:u,icon:"none"});else{if("modal"!==i.type)throw new Error(`Invalid errorOptions.type: ${i.type}`);{const{confirm:e}=await async function({title:e,content:t,showCancel:l,cancelText:a,confirmText:o}={}){return new Promise(((n,i)=>{uni.showModal({title:e,content:t,showCancel:l,cancelText:a,confirmText:o,success(e){n(e)},fail(){n({confirm:!1,cancel:!0})}})}))}({title:"提示",content:u,showCancel:i.retry,cancelText:"取消",confirmText:i.retry?"重试":"确定"});if(i.retry&&e)return l(...s)}}const e=new In({code:d,message:u,requestId:c.requestId});throw e.detail=c.result,_n(wn,{type:Dn,content:e}),e}return _n(wn,{type:Dn,content:c.result}),c.result}})}}(a),["callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","chooseAndUploadFile"].forEach((e=>{if(!t[e])return;const l=t[e];t[e]=function(){return t.reInit(),l.apply(t,Array.from(arguments))},t[e]=Sn(t[e],e).bind(t)})),t.init=this.init,t}};(()=>{{const e=sn;let t={};if(1===e.length)t=e[0],Ur=Ur.init(t),Ur.isDefault=!0;else{const t=["auth","callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","database","getCurrentUSerInfo","importObject"];let l;l=e&&e.length>0?"应用有多个服务空间，请通过uniCloud.init方法指定要使用的服务空间":"应用未关联服务空间，请在uniCloud目录右键关联服务空间",t.forEach((e=>{Ur[e]=function(){return console.error(l),Promise.reject(new In({code:"SYS_ERR",message:l}))}}))}Object.assign(Ur,{get mixinDatacom(){return qr(Ur)}}),function(e){var t;(t=e).onResponse=function(e){kn(wn,e)},t.offResponse=function(e){xn(wn,e)},Ar(e),function(e){e.onRefreshToken=function(e){kn(Cn,e)},e.offRefreshToken=function(e){xn(Cn,e)}}(e)}(Ur),Ur.addInterceptor=vn,Ur.removeInterceptor=hn}})();var Mr=Ur;const Wr="chooseAndUploadFile:fail";function $r(e,t){return e.tempFiles.forEach(((e,l)=>{e.name||(e.name=e.path.substring(e.path.lastIndexOf("/")+1)),t&&(e.fileType=t),e.cloudPath=Date.now()+"_"+l+e.name.substring(e.name.lastIndexOf("."))})),e.tempFilePaths||(e.tempFilePaths=e.tempFiles.map((e=>e.path))),e}function Qr(e,t=5,l){const a=(e=JSON.parse(JSON.stringify(e))).length;let o=0,n=this;return new Promise((i=>{for(;o<t;)r();function r(){let t=o++;if(t>=a)return void(!e.find((e=>!e.url&&!e.errMsg))&&i(e));const s=e[t],c=n.files.findIndex((e=>e.uuid===s.uuid));s.url="",delete s.errMsg,Mr.uploadFile({filePath:s.path,cloudPath:s.cloudPath,fileType:s.fileType,onUploadProgress:e=>{e.index=c,l&&l(e)}}).then((e=>{s.url=e.fileID,s.index=c,t<a&&r()})).catch((e=>{s.errMsg=e.errMsg||e.message,s.index=c,t<a&&r()}))}}))}function jr(e,{onChooseFile:t,onUploadProgress:l}){return e.then((e=>{if(t){const l=t(e);if(void 0!==l)return Promise.resolve(l).then((t=>void 0===t?e:t))}return e})).then((e=>!1===e?{errMsg:"chooseAndUploadFile:ok",tempFilePaths:[],tempFiles:[]}:e))}function Hr(e={type:"all"}){return"image"===e.type?jr(function(e){const{count:t,sizeType:l=["original","compressed"],sourceType:a=["album","camera"],extension:o}=e;return new Promise(((e,n)=>{uni.chooseImage({count:t,sizeType:l,sourceType:a,extension:o,success(t){e($r(t,"image"))},fail(e){n({errMsg:e.errMsg.replace("chooseImage:fail",Wr)})}})}))}(e),e):"video"===e.type?jr(function(e){const{camera:t,compressed:l,maxDuration:a,sourceType:o=["album","camera"],extension:n}=e;return new Promise(((e,i)=>{uni.chooseVideo({camera:t,compressed:l,maxDuration:a,sourceType:o,extension:n,success(t){const{tempFilePath:l,duration:a,size:o,height:n,width:i}=t;e($r({errMsg:"chooseVideo:ok",tempFilePaths:[l],tempFiles:[{name:t.tempFile&&t.tempFile.name||"",path:l,size:o,type:t.tempFile&&t.tempFile.type||"",width:i,height:n,duration:a,fileType:"video",cloudPath:""}]},"video"))},fail(e){i({errMsg:e.errMsg.replace("chooseVideo:fail",Wr)})}})}))}(e),e):jr(function(e){const{count:t,extension:l}=e;return new Promise(((e,a)=>{let o=uni.chooseFile;if("undefined"!=typeof wx&&"function"==typeof wx.chooseMessageFile&&(o=wx.chooseMessageFile),"function"!=typeof o)return a({errMsg:Wr+" 请指定 type 类型，该平台仅支持选择 image 或 video。"});o({type:"all",count:t,extension:l,success(t){e($r(t))},fail(e){a({errMsg:e.errMsg.replace("chooseFile:fail",Wr)})}})}))}(e),e)}const Kr=e=>{const t=e.lastIndexOf("."),l=e.length;return{name:e.substring(0,t),ext:e.substring(t+1,l)}},Gr=e=>{if(Array.isArray(e))return e;return e.replace(/(\[|\])/g,"").split(",")},Jr=async(e,t="image")=>{let l,a;void 0!==e.name&&(l=Kr(e.name),a=l.ext.toLowerCase());let o={name:e.name,uuid:e.uuid,extname:a||"",cloudPath:e.cloudPath,fileType:e.fileType,url:e.path||e.path,size:e.size,image:{},path:e.path,video:{}};if("image"===t){const t=await(n=e.path,new Promise(((e,t)=>{uni.getImageInfo({src:n,success(t){e(t)},fail(e){t(e)}})})));delete o.video,o.image.width=t.width,o.image.height=t.height,o.image.location=t.path}else delete o.image;var n;return o};const Yr={components:{uploadImage:l({emits:["uploadFiles","choose","delFile"],props:{filesList:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},disablePreview:{type:Boolean,default:!1},limit:{type:[Number,String],default:9},imageStyles:{type:Object,default:()=>({width:"auto",height:"auto",border:{}})},delIcon:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1}},computed:{styles(){return Object.assign({width:"auto",height:"auto",border:{}},this.imageStyles)},boxStyle(){const{width:e="auto",height:t="auto"}=this.styles;let l={};"auto"===t?"auto"!==e?(l.height=this.value2px(e),l["padding-top"]=0):l.height=0:(l.height=this.value2px(t),l["padding-top"]=0),l.width="auto"===e?"auto"!==t?this.value2px(t):"33.3%":this.value2px(e);let a="";for(let o in l)a+=`${o}:${l[o]};`;return a},borderStyle(){let{border:e}=this.styles,t={};if("boolean"==typeof e)t.border=e?"1px #eee solid":"none";else{let l=e&&e.width||1;l=this.value2px(l);let a=e&&e.radius||3;a=this.value2px(a),t={"border-width":l,"border-style":e&&e.style||"solid","border-color":e&&e.color||"#eee","border-radius":a}}let l="";for(let a in t)l+=`${a}:${t[a]};`;return l}},methods:{uploadFiles(e,t){this.$emit("uploadFiles",e)},choose(){this.$emit("choose")},delFile(e){this.$emit("delFile",e)},prviewImage(e,t){let l=[];1===Number(this.limit)&&this.disablePreview&&!this.disabled&&this.$emit("choose"),this.disablePreview||(this.filesList.forEach((e=>{l.push(e.url)})),uni.previewImage({urls:l,current:t}))},value2px:e=>("number"==typeof e?e+="px":-1===e.indexOf("%")&&(e=-1!==e.indexOf("px")?e:e+"px"),e)}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-file-picker__container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.filesList,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"file-picker__box",key:l,style:e.normalizeStyle(i.boxStyle)},[e.createElementVNode("view",{class:"file-picker__box-content",style:e.normalizeStyle(i.borderStyle)},[e.createElementVNode("image",{class:"file-image",src:t.url,mode:"aspectFill",onClick:e.withModifiers((e=>i.prviewImage(t,l)),["stop"])},null,8,["src","onClick"]),a.delIcon&&!a.readonly?(e.openBlock(),e.createElementBlock("view",{key:0,class:"icon-del-box",onClick:e.withModifiers((e=>i.delFile(l)),["stop"])},[e.createElementVNode("view",{class:"icon-del"}),e.createElementVNode("view",{class:"icon-del rotate"})],8,["onClick"])):e.createCommentVNode("",!0),t.progress&&100!==t.progress||0===t.progress?(e.openBlock(),e.createElementBlock("view",{key:1,class:"file-picker__progress"},[e.createElementVNode("progress",{class:"file-picker__progress-item",percent:-1===t.progress?0:t.progress,"stroke-width":"4",backgroundColor:t.errMsg?"#ff5a5f":"#EBEBEB"},null,8,["percent","backgroundColor"])])):e.createCommentVNode("",!0),t.errMsg?(e.openBlock(),e.createElementBlock("view",{key:2,class:"file-picker__mask",onClick:e.withModifiers((e=>i.uploadFiles(t,l)),["stop"])}," 点击重试 ",8,["onClick"])):e.createCommentVNode("",!0)],4)],4)))),128)),a.filesList.length<a.limit&&!a.readonly?(e.openBlock(),e.createElementBlock("view",{key:0,class:"file-picker__box",style:e.normalizeStyle(i.boxStyle)},[e.createElementVNode("view",{class:"file-picker__box-content is-add",style:e.normalizeStyle(i.borderStyle),onClick:l[0]||(l[0]=(...e)=>i.choose&&i.choose(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:"icon-add"}),e.createElementVNode("view",{class:"icon-add rotate"})]),!0)],4)],4)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-dfbc4d34"]]),uploadFile:l({emits:["uploadFiles","getFileUrl","choose","delFile"],props:{filesList:{type:Array,default:()=>[]},delIcon:{type:Boolean,default:!0},limit:{type:[Number,String],default:9},showType:{type:String,default:""},listStyles:{type:Object,default:()=>({border:!0,dividline:!0,borderStyle:{}})},readonly:{type:Boolean,default:!1}},computed:{list(){let e=[];return this.filesList.forEach((t=>{e.push(t)})),e},styles(){return Object.assign({border:!0,dividline:!0,"border-style":{}},this.listStyles)},borderStyle(){let{borderStyle:e,border:t}=this.styles,l={};if(t){let t=e&&e.width||1;t=this.value2px(t);let a=e&&e.radius||5;a=this.value2px(a),l={"border-width":t,"border-style":e&&e.style||"solid","border-color":e&&e.color||"#eee","border-radius":a}}else l.border="none";let a="";for(let o in l)a+=`${o}:${l[o]};`;return a},borderLineStyle(){let e={},{borderStyle:t}=this.styles;if(t&&t.color&&(e["border-color"]=t.color),t&&t.width){let l=t&&t.width||1,a=t&&t.style||0;"number"==typeof l?l+="px":l=l.indexOf("px")?l:l+"px",e["border-width"]=l,"number"==typeof a?a+="px":a=a.indexOf("px")?a:a+"px",e["border-top-style"]=a}let l="";for(let a in e)l+=`${a}:${e[a]};`;return l}},methods:{getFileUrl(e){this.$emit("getFileUrl",{item:e})},uploadFiles(e,t){this.$emit("uploadFiles",{item:e,index:t})},choose(){this.$emit("choose")},delFile(e){this.$emit("delFile",e)},value2px:e=>("number"==typeof e?e+="px":e=-1!==e.indexOf("px")?e:e+"px",e)}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-file-picker__files"},[a.readonly?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"files-button",onClick:l[0]||(l[0]=(...e)=>i.choose&&i.choose(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)])),i.list.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-file-picker__lists is-text-box",style:e.normalizeStyle(i.borderStyle)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.list,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-file-picker__lists-box",{"files-border":0!==l&&i.styles.dividline}]),key:l,style:e.normalizeStyle(0!==l&&i.styles.dividline&&i.borderLineStyle)},[e.createElementVNode("view",{class:"uni-file-picker__item",onClick:e.withModifiers((e=>i.getFileUrl(t)),["stop"])},[e.createElementVNode("view",{class:"files__name"},e.toDisplayString(t.name),1),a.delIcon&&!a.readonly?(e.openBlock(),e.createElementBlock("view",{key:0,class:"icon-del-box icon-files",onClick:e=>i.delFile(l)},[e.createElementVNode("view",{class:"icon-del icon-files"}),e.createElementVNode("view",{class:"icon-del rotate"})],8,["onClick"])):e.createCommentVNode("",!0)],8,["onClick"]),t.progress&&100!==t.progress||0===t.progress?(e.openBlock(),e.createElementBlock("view",{key:0,class:"file-picker__progress"},[e.createElementVNode("progress",{class:"file-picker__progress-item",percent:-1===t.progress?0:t.progress,"stroke-width":"4",backgroundColor:t.errMsg?"#ff5a5f":"#EBEBEB"},null,8,["percent","backgroundColor"])])):e.createCommentVNode("",!0),"error"===t.status?(e.openBlock(),e.createElementBlock("view",{key:1,class:"file-picker__mask",onClick:e.withModifiers((e=>i.uploadFiles(t,l)),["stop"])}," 点击重试 ",8,["onClick"])):e.createCommentVNode("",!0)],6)))),128))],4)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-9fe5f8a0"]])},emits:["select","success","fail","progress","delete","update:modelValue","input","change"],props:{modelValue:{type:[Array,Object],default:()=>[]},disabled:{type:Boolean,default:!1},disablePreview:{type:Boolean,default:!1},delIcon:{type:Boolean,default:!0},autoUpload:{type:Boolean,default:!0},limit:{type:[Number,String],default:9},mode:{type:String,default:"grid"},fileMediatype:{type:String,default:"image"},fileExtname:{type:[Array,String],default:()=>[]},title:{type:String,default:""},listStyles:{type:Object,default:()=>({border:!0,dividline:!0,borderStyle:{}})},imageStyles:{type:Object,default:()=>({width:"auto",height:"auto"})},readonly:{type:Boolean,default:!1},returnType:{type:String,default:"array"},sizeType:{type:Array,default:()=>["original","compressed"]}},data:()=>({files:[],localValue:[]}),watch:{modelValue:{handler(e,t){this.setValue(e,t)},immediate:!0}},computed:{filesList(){let e=[];return this.files.forEach((t=>{e.push(t)})),e},showType(){return"image"===this.fileMediatype?this.mode:"list"},limitLength(){return"object"===this.returnType?1:this.limit?this.limit:1}},created(){Mr.config&&Mr.config.provider||(this.noSpace=!0,Mr.chooseAndUploadFile=Hr),this.form=this.getForm("uniForms"),this.formItem=this.getForm("uniFormsItem"),this.form&&this.formItem&&this.formItem.name&&(this.rename=this.formItem.name,this.form.inputChildrens.push(this))},methods:{clearFiles(e){0===e||e?this.files.splice(e,1):(this.files=[],this.$nextTick((()=>{this.setEmit()}))),this.$nextTick((()=>{this.setEmit()}))},upload(){let e=[];this.files.forEach(((t,l)=>{"ready"!==t.status&&"error"!==t.status||e.push(Object.assign({},t))})),this.uploadFiles(e)},async setValue(e,t){const l=async e=>{let t="";return t=e.fileID?e.fileID:e.url,/cloud:\/\/([\w.]+\/?)\S*/.test(t)&&(e.fileID=t,e.url=await this.getTempFileURL(t)),e.url&&(e.path=e.url),e};if("object"===this.returnType)e?await l(e):e={};else{e||(e=[]);for(let t=0;t<e.length;t++){let a=e[t];await l(a)}}this.localValue=e,this.form&&this.formItem&&!this.is_reset&&(this.is_reset=!1,this.formItem.setValue(this.localValue));let a=Object.keys(e).length>0?e:[];this.files=[].concat(a)},choose(){this.disabled||(this.files.length>=Number(this.limitLength)&&"grid"!==this.showType&&"array"===this.returnType?uni.showToast({title:`您最多选择 ${this.limitLength} 个文件`,icon:"none"}):this.chooseFiles())},chooseFiles(){const e=Gr(this.fileExtname);"image"!==this.fileMediatype?"video"!==this.fileMediatype?(uni.showToast({title:"当前平台仅支持上传图片",icon:"none"}),uni.chooseImage({count:this.limit,extension:e,success:e=>{this.chooseFileCallback(e).catch((e=>i("error","at components/uni-file-picker/components/uni-file-picker/uni-file-picker.vue:438",e)))},fail:e=>{i("log","at components/uni-file-picker/components/uni-file-picker/uni-file-picker.vue:441","选择失败",e)},complete:()=>{}})):uni.chooseVideo({count:this.limit,extension:e,success:e=>{this.chooseFileCallback(e).catch((e=>i("error","at components/uni-file-picker/components/uni-file-picker/uni-file-picker.vue:395",e)))},fail:e=>{i("log","at components/uni-file-picker/components/uni-file-picker/uni-file-picker.vue:398","选择失败",e)},complete:()=>{}}):uni.chooseImage({count:this.limit,extension:e,success:e=>{this.chooseFileCallback(e).catch((e=>i("error","at components/uni-file-picker/components/uni-file-picker/uni-file-picker.vue:381",e)))},fail:e=>{i("log","at components/uni-file-picker/components/uni-file-picker/uni-file-picker.vue:384","选择失败",e)},complete:()=>{}})},async chooseFileCallback(e){const t=Gr(this.fileExtname);(1===Number(this.limitLength)&&this.disablePreview&&!this.disabled||"object"===this.returnType)&&(this.files=[]);let{filePaths:l,files:a}=((e,t)=>{let l=[],a=[];if(!t||0===t.length)return{filePaths:l,files:a};for(const o of e.tempFiles){if(void 0!==o.name){const e=Kr(o.name).ext.toLowerCase();if(-1===t.indexOf(e))continue}a.push(o),l.push(o.path)}return a.length!==e.tempFiles.length&&uni.showToast({title:`当前选择了${e.tempFiles.length}个文件 ，${e.tempFiles.length-a.length} 个文件格式不正确`,icon:"none",duration:5e3}),{filePaths:l,files:a}})(e,t);t&&t.length>0||(l=e.tempFilePaths,a=e.tempFiles);let o=[];for(let n=0;n<a.length&&!(this.limitLength-this.files.length<=0);n++){a[n].uuid=Date.now();let e=await Jr(a[n],this.fileMediatype);e.progress=0,e.status="ready",this.files.push(e),o.push(__spreadProps(__spreadValues({},e),{file:a[n]}))}this.$emit("select",{tempFiles:o,tempFilePaths:l}),e.tempFiles=a,this.autoUpload&&!this.noSpace||(e.tempFiles=[])},uploadFiles(e){e=[].concat(e),Qr.call(this,e,5,(e=>{this.setProgress(e,e.index,!0)})).then((e=>{this.setSuccessAndError(e)})).catch((e=>{i("log","at components/uni-file-picker/components/uni-file-picker/uni-file-picker.vue:527",e)}))},async setSuccessAndError(e,t){let l=[],a=[],o=[],n=[];for(let i=0;i<e.length;i++){const t=e[i],r=t.uuid?this.files.findIndex((e=>e.uuid===t.uuid)):t.index;if(-1===r||!this.files)break;if("request:fail"===t.errMsg)this.files[r].url=t.path,this.files[r].status="error",this.files[r].errMsg=t.errMsg,a.push(this.files[r]),n.push(this.files[r].url);else{this.files[r].errMsg="",this.files[r].fileID=t.url;/cloud:\/\/([\w.]+\/?)\S*/.test(t.url)?this.files[r].url=await this.getTempFileURL(t.url):this.files[r].url=t.url,this.files[r].status="success",this.files[r].progress+=1,l.push(this.files[r]),o.push(this.files[r].fileID)}}l.length>0&&(this.setEmit(),this.$emit("success",{tempFiles:this.backObject(l),tempFilePaths:o})),a.length>0&&this.$emit("fail",{tempFiles:this.backObject(a),tempFilePaths:n})},setProgress(e,t,l){this.files.length;const a=Math.round(100*e.loaded/e.total);let o=t;l||(o=this.files.findIndex((t=>t.uuid===e.tempFile.uuid))),-1!==o&&this.files[o]&&(this.files[o].progress=a-1,this.$emit("progress",{index:o,progress:parseInt(a),tempFile:this.files[o]}))},delFile(e){this.$emit("delete",{tempFile:this.files[e],tempFilePath:this.files[e].url}),this.files.splice(e,1),this.$nextTick((()=>{this.setEmit()}))},getFileUrl({item:e}){this.$emit("change",{format:e.extname,url:e.FileUrl})},getFileExt(e){const t=e.lastIndexOf("."),l=e.length;return{name:e.substring(0,t),ext:e.substring(t+1,l)}},setEmit(){let e=[];"object"===this.returnType?(e=this.backObject(this.files)[0],this.localValue=e||null):(e=this.backObject(this.files),this.localValue||(this.localValue=[]),this.localValue=[...e]),this.$emit("update:modelValue",this.localValue)},backObject(e){let t=[];return e.forEach((e=>{t.push({extname:e.extname,fileType:e.fileType,image:e.image,name:e.name,path:e.path,size:e.size,fileID:e.fileID,url:e.url})})),t},async getTempFileURL(e){e={fileList:[].concat(e)};return(await Mr.getTempFileURL(e)).fileList[0].tempFileURL||""},getForm(e="uniForms"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t}}};var Zr=l(Yr,[["render",function(t,l,a,o,n,i){const r=e.resolveComponent("upload-image"),s=e.resolveComponent("upload-file");return e.openBlock(),e.createElementBlock("view",{class:"uni-file-picker"},[a.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-file-picker__header"},[e.createElementVNode("text",{class:"file-title"},e.toDisplayString(a.title),1),e.createElementVNode("text",{class:"file-count"},e.toDisplayString(i.filesList.length)+"/"+e.toDisplayString(i.limitLength),1)])):e.createCommentVNode("",!0),"image"===a.fileMediatype&&"grid"===i.showType?(e.openBlock(),e.createBlock(r,{key:1,readonly:a.readonly,"image-styles":a.imageStyles,"files-list":i.filesList,limit:i.limitLength,disablePreview:a.disablePreview,delIcon:a.delIcon,onUploadFiles:i.uploadFiles,onChoose:i.choose,onDelFile:i.delFile},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:"is-add"},[e.createElementVNode("view",{class:"icon-add"}),e.createElementVNode("view",{class:"icon-add rotate"})])]),!0)])),_:3},8,["readonly","image-styles","files-list","limit","disablePreview","delIcon","onUploadFiles","onChoose","onDelFile"])):e.createCommentVNode("",!0),"image"!==a.fileMediatype||"grid"!==i.showType?(e.openBlock(),e.createBlock(s,{key:2,readonly:a.readonly,"list-styles":a.listStyles,"files-list":i.filesList,showType:i.showType,delIcon:a.delIcon,onUploadFiles:i.uploadFiles,onChoose:i.choose,onDelFile:i.delFile,onGetFileUrl:i.getFileUrl},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("button",{class:"select-file-btn",type:"primary",size:"mini"}," 选择文件 ")]),!0)])),_:3},8,["readonly","list-styles","files-list","showType","delIcon","onUploadFiles","onChoose","onDelFile","onGetFileUrl"])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-4ec2fda5"]]);function Xr(e){return e.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}))}var es=l({components:{UniFilePicker:Zr},setup(){const t=e.ref(null),l=e.ref(!0),a=yl();let{info:o,pictures:n}=a.state.asset;const i=o.ID,r=e.reactive(Xr(n));return{imgs:r,asset:o,cancel:function(){S()},save:function(){q(),be.editPicture({Basic:{ID:i},EditType:1,AssetPics:r}).then((e=>{et(lt.assetPictureBack).then((()=>S()))})).finally((()=>z()))},select:function({tempFilePaths:t}){q(),be.uploadImage(t).then((t=>{l.value=!1;const a=Xr(t);r.push(...a),e.nextTick((()=>{l.value=!0}))})).finally((()=>z()))},filePicker:t,isImg:l,deleteImg:function({tempFile:t}){const a=r.findIndex((e=>e===t));r.splice(a,1),l.value=!1,e.nextTick((()=>{l.value=!0}))}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-section"),ue),c=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("scroll-view",{class:"top","scroll-y":!0},[e.createVNode(s,{title:"基本信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产编码："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Code),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产名称："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Name),1)])])])),_:1}),e.createVNode(s,{title:"资产图片",type:"line"},{default:e.withCtx((()=>[o.isImg?(e.openBlock(),e.createBlock(c,{key:0,ref:"filePicker",modelValue:o.imgs,"onUpdate:modelValue":l[0]||(l[0]=e=>o.imgs=e),"file-mediatype":"image","file-extname":"jpg,jpeg,png",mode:"grid",onSelect:o.select,"auto-upload":!1,limit:30,onDelete:o.deleteImg},null,8,["modelValue","onSelect","onDelete"])):e.createCommentVNode("",!0)])),_:1})]),e.createElementVNode("view",{class:"below"},[e.createElementVNode("button",{class:"button",onClick:l[1]||(l[1]=(...e)=>o.save&&o.save(...e)),type:"primary"},"保 存"),e.createElementVNode("button",{class:"button cancel",onClick:l[2]||(l[2]=(...e)=>o.cancel&&o.cancel(...e))},"取 消")])],64)}],["__scopeId","data-v-69fa68d6"]]),ts={en:{"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"loading...","uni-load-more.contentnomore":"No more data"},"zh-Hans":{"uni-load-more.contentdown":"上拉显示更多","uni-load-more.contentrefresh":"正在加载...","uni-load-more.contentnomore":"没有更多数据了"},"zh-Hant":{"uni-load-more.contentdown":"上拉顯示更多","uni-load-more.contentrefresh":"正在加載...","uni-load-more.contentnomore":"沒有更多數據了"}};let ls;setTimeout((()=>{ls=uni.getSystemInfoSync().platform}),16);const{t:as}=el(ts);var os=l({name:"UniLoadMore",emits:["clickLoadMore"],props:{status:{type:String,default:"more"},showIcon:{type:Boolean,default:!0},iconType:{type:String,default:"auto"},iconSize:{type:Number,default:24},color:{type:String,default:"#777777"},contentText:{type:Object,default:()=>({contentdown:"",contentrefresh:"",contentnomore:""})},showText:{type:Boolean,default:!0}},data:()=>({webviewHide:!1,platform:ls,imgBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzlBMzU3OTlEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzlBMzU3OUFEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDOUEzNTc5N0Q5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDOUEzNTc5OEQ5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pt+ALSwAAA6CSURBVHja1FsLkFZVHb98LM+F5bHL8khA1iSeiyQBCRM+YGqKUnnJTDLGI0BGZlKDIU2MMglUiDApEZvSsZnQtBRJtKwQNKQMFYeRDR10WOLd8ljYXdh+v8v5fR3Od+797t1dnOnO/Ofce77z+J//+b/P+ZqtXbs2sJ9MJhNUV1cHJ06cCJo3bx7EPc2aNcvpy7pWrVoF+/fvDyoqKoI2bdoE9fX1F7TjN8a+EXBn/fkfvw942Tf+wYMHg9mzZwfjxo0LDhw4EPa1x2MbFw/fOGfPng1qa2tzcCkILsLDydq2bRsunpOTMM7TD/W/tZDZhPdeKD+yGxHhdu3aBV27dg3OnDlzMVANMheLAO3btw8KCwuDmpoaX5OxbgUIMEq7K8IcPnw4KCsrC/r37x8cP378/4cAXAB3vqSkJMuiDhTkw+XcuXNhOWbMmKBly5YhUT8xArhyFvP0BfwRsAuwxJZJsm/nzp2DTp06he/OU+cZ64K6o0ePBkOHDg2GDx8e6gEbJ5Q/NHNuAJQ1hgBeHUDlR7nVTkY8rQAvAi4z34vR/mPs1FoRsaCgIJThI0eOBC1atEiFGGV+5MiRoS45efJkqFjJFXV1dQuA012m2WcwTw98fy6CqBdsaiIO4CScrGPHjvk4odhavPquRtFWXEC25VgkREKOCh/qDSq+vn37htzD/mZTOmOc5U7zKzBPEedygWshcDyWvs30igAbU+6oyMgJBCFhwQE0fccxN60Ay9iebbjoDh06hMowjQxT4fXq1SskArmHZpkArvixp/kWzHdMeArExSJEaiXIjjRjRJ4DaAGWpibLzXN3Fm1vA5teBgh3j1Rv3bp1YgKwPdmf2p9zcyNYYgPKMfY0T5f5nNYdw158nJ8QawW4CLKwiOBSEgO/hok2eBydR+3dYH+PLxA5J8Vv0KBBwenTp0P2JWAx6+yFEBfs8lMY+y0SWMBNI9E4ThKi58VKTg3FQZS1RQF1cz27eC0QHMu+3E0SkUowjhVt5VdaWhp07949ZHv2Qd1EjDXM2cla1M0nl3GxAs3J9yREzyTdFVKVFOaE9qRA8GM0WebRuo9JGZKA7Mv2SeS/Z8+eoQ9BArMfFrLGo6jvxbhHbJZnKX2Rzz1O7QhJJ9Cs2ZMaWIyq/zhdeqPNfIoHd58clIQD+JSXl4dKlyIAuBdVXZwFVWKspSSoxE++h8x4k3uCnEhE4I5KwRiFWGOU0QWKiCYLbdoRMRKAu2kQ9vkfLU6dOhX06NEjlH+yMRZSinnuyWnYosVcji8CEA/6Cg2JF+IIUBqnGKUTCNwtwBN4f89RiK1R96DEgO2o0NDmtEdvVFdVVYV+P3UAPUEs6GFwV3PHmXkD4vh74iDFJysVI/MlaQhwKeBNTLYX5VuA8T4/gZxA4MRGFxDB6R7OmYPfyykGRJbyie+XnGYnQIC/coH9+vULiYrxrkL9ZA9+0ykaHIfEpM7ge8TiJ2CsHYwyMfafAF1yCGBHYIbCVDjDjKt7BeB51D+LgQa6OkG7IDYEEtvQ7lnXLKLtLdLuJBpE4gPUXcW2+PkZwOex+4cGDhwYDBkyRL7/HFcEwUGPo/8uWRUpYnfxGHco8HkewLHLyYmAawAPuIFZxhOpDfJQ8gbUv41yORAptMWBNr6oqMhWird5+u+iHmBb2nhjDV7HWBNQTgK8y11l5NetWzc5ULscAtSj7nbNI0skhWeUZCc0W4nyH/jO4Vz0u1IeYhbk4AiwM6tjxIWByHsoZ9qcIBPJd/y+DwPfBESOmCa/QF3WiZHucLlEDpNxcNhmheEOPgdQNx6/VZFQzFZ5TN08AHXQt2Ii3EdyFuUsPtTcGPhW5iMiCNELvz+Gdn9huG4HUJaW/w3g0wxV0XaG7arG2WeKiUWYM4Y7GO5ezshTARbbWGw/DvXkpp/ivVvE0JVoMxN4rpGzJMhE5Pl+xlATsDIqikP9F9D2z3h9nOksEUFhK+qO4rcPkoalMQ/HqJLIyb3F3JdjrCcw1yZ8joyJLR5gCo54etlag7qIoeNh1N1BRYj3DTFJ0elotxPlVzkGuYAmL0VSJVGAJA41c4Z6A3BzTLfn0HYwYKEI6CUAMzZEWvLsIcQOo1AmmyyM72nHJCfYsogflGV6jEk9vyQZXSuq6w4c16NsGcGZbwOPr+H1RkOk2LEzjNepxQkihHSCQ4ynAYNRx2zMKV92CQMWqj8J0BRE8EShxRFN6YrfCRhC0x3r/Zm4IbQCcmJoV0kMamllccR6FjHqUC5F2R/wS2dcymOlfAKOS4KmzQb5cpNC2MC7JhVn5wjXoJ44rYhLh8n0eXOCorJxa7POjbSlCGVczr34/RsAmrcvo9s+wGp3tzVhntxiXiJ4nvEYb4FJkf0O8HocAePmLvCxnL0AORraVekJk6TYjDabRVXfRE2lCN1h6ZQRN1+InUbsCpKwoBZHh0dODN9JBCUffItXxEavTQkUtnfTVAplCWL3JISz29h4NjotnuSsQKJCk8dF+kJR6RARjrqFVmfPnj3ZbK8cIJ0msd6jgHPGtfVTQ8VLmlvh4mct9sobRmPic0DyDQQnx/NlfYUgyz59+oScsH379pAwXABD32nTpoUHIToESeI5mnbE/UqDdyLcafEBf2MCqgC7NwxIbMREJQ0g4D4sfJwnD+AmRrII05cfMWJE+L1169bQr+fip06dGp4oJ83lmYd5wj/EmMa4TaHivo4EeCguYZBnkB5g2aWA69OIEnUHOaGysjIYMGBAMGnSpODYsWPZwCpFmm4lNq+4gSLQA7jcX8DwtjEyRC8wjabnXEx9kfWnTJkSJkAo90xpJVV+FmcVNeYAF5zWngS4C4O91MBxmAv8blLEpbjI5sz9MTdAhcgkCT1RO8mZkAjfiYpTEvStAS53Uw1vAiUGgZ3GpuQEYvoiBqlIan7kSDHnTwJQFNiPu0+5VxCVYhcZIjNrdXUDdp+Eq5AZ3Gkg8QAyVZRZIk4Tl4QAbF9cXJxNYZMAtAokgs4BrNxEpCtteXg7DDTMDKYNSuQdKsnJBek7HxewvxaosWxLYXtw+cJp18217wql4aKCfBNoEu0O5VU+PhctJ0YeXD4C6JQpyrlpSLTojpGGGN5YwNziChdIZLk4lvLcFJ9jMX3QdiImY9bmGQU+TRUL5CHITTRlgF8D9ouD1MfmLoEPl5xokIumZ2cfgMpHt47IW9N64Hsh7wQYYjyIugWuF5fCqYncXRd5vPMWyizzvhi/32+nvG0dZc9vR6fZOu0md5e+uC408FvKSIOZwXlGvxPv95izA2Vtvg1xKFWARI+vMX66HUhpQQb643uW1bSjuTWyw2SBvDrBvjFic1eGGlz5esq3ko9uSIlBRqPuFcCv8F4WIcN12nVaBd0SaYwI6PDDImR11JkqgHcPmQssjxIn6bUshygDFJUTxPMpHk+jfjPgupgdnYV2R/g7xSjtpah8RJBewhwf0gGK6XI92u4wXFEU40afJ4DN4h5LcAd+40HI3JgJecuT0c062W0i2hQJUTcxan3/CMW1PF2K6bbA+Daz4xRs1D3Br1Cm0OihKCqizW78/nXAF/G5TXrEcVzaNMH6CyMswqsAHqDyDLEyou8lwOXnKF8DjI6KjV3KzMBiXkDH8ij/H214J5A596ekrZ3F0zXlWeL7+P5eUrNo3/QwC15uxthuzidy7DzKRwEDaAViiDgKbTbz7CJnzo0bN7pIfIiid8SuPwn25o3QCmpnyjlZkyxPP8EomCJzrGb7GJMx7tNsq4MT2xMUYaiErZOluTzKsnz3gwCeCZyVRZJfYplNEokEjwrPtxlxjeYAk+F1F74VAzPxQRNYYdtpOUvWs8J1sGhBJMNsb7igN8plJs1eSmLIhLKE4rvaCX27gOhLpLOsIzJ7qn/i+wZzcvSOZ23/du8TZjwV8zHIXoP4R3ifBxiFz1dcVpa3aPntPE+c6TmIWE9EtcMmAcPdWAhYhAXxcLOQi9L1WhD1Sc8p1d2oL7XGiRKp8F4A2i8K/nfI+y/gsTDJ/YC/8+AD5Uh04KHiGl+cIFPnBDDrPMjwRGkLXyxO4VGbfQWnDH2v0bVWE3C9QOXlepbgjEfIJQI6XDG3z5ahD9cw2pS78ipB85wyScNTvsVzlzzhL8/jRrnmVjfFJK/m3m4nj9vbgQTguT8XZTjsm672R5uJKEaQmBI/c58gyus8ZDagLpEVSJBIyHp4jn++xqPV71OgQgJYEWOtZ/haxRtKmWOBu8xdBLftWltsY84zE6WIEy/eIOWL+BaayMx+KHtL7EAkqdNDLiEXmEMUHniedtJqg9HmZtfvt26vNi0BdG3Ft3g8ZOf7PAu59TxtzivLNIekyi+wD1i8CuUiD9FXAa8C+/xS3JPmZnomyc7H+fb4/Se0bk41Fel621r4cgVxbq91V4jVqwB7HTe2M7jgB+QWHavZkDRPmZcASoZEmBx6i75bGjPcMdL4/VKGFAGWZkGzPG0XAbdL9A81G5LOmUnC9hHKJeO7dcUMjblSl12867ElFTtaGl20xvvLGPdVz/8TVuU7y0x1PG7vtNg24oz9Uo/Z412++VFWI7Fcog9tu9Lm6gvRmIPv9x1xmQAu6RDkXtbOtlGEmpgD5Nvnyc0dcv0EE6cfdi1HmhMf9wDF3k3gtRvEedhxjpgfqPb9PU9iEJHnyOUA7bQUXh6kq/D7l2iTjWv7XOD530BDr8jIrus+srXjt4MzumJMHuTsBa63YKE1+RR5lBjEikCCnWKWiHdzOgKO+nRIBAF88za/IFmJ3eMZov4CYxGBabcpGL8EYx+SeMXJeRwHNsV/h+vdxeuhEpN3ZyNY78Gm2fknJxVGhyjixPiQvVkNzT1elD9Py/aTAL64Hb9vcYmC9zfdXdT/C1LeGbg4rnBaAihDFJH12W5ulfNCNe/xTsP3bp8ikzJs5BF+5PNfAQYAPaseTdsEcaYAAAAASUVORK5CYII="}),computed:{iconSnowWidth(){return 2*(Math.floor(this.iconSize/24)||1)},contentdownText(){return this.contentText.contentdown||as("uni-load-more.contentdown")},contentrefreshText(){return this.contentText.contentrefresh||as("uni-load-more.contentrefresh")},contentnomoreText(){return this.contentText.contentnomore||as("uni-load-more.contentnomore")}},mounted(){var e=getCurrentPages(),t=e[e.length-1].$getAppWebview();t.addEventListener("hide",(()=>{this.webviewHide=!0})),t.addEventListener("show",(()=>{this.webviewHide=!1}))},methods:{onClick(){this.$emit("clickLoadMore",{detail:{status:this.status}})}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-load-more",onClick:l[0]||(l[0]=(...e)=>i.onClick&&i.onClick(...e))},[!n.webviewHide&&("circle"===a.iconType||"auto"===a.iconType&&"android"===n.platform)&&"loading"===a.status&&a.showIcon?(e.openBlock(),e.createElementBlock("view",{key:0,style:e.normalizeStyle({width:a.iconSize+"px",height:a.iconSize+"px"}),class:"uni-load-more__img uni-load-more__img--android-MP"},[e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:a.color,borderTopWidth:a.iconSize/12})},null,4),e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:a.color,borderTopWidth:a.iconSize/12})},null,4),e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:a.color,borderTopWidth:a.iconSize/12})},null,4)],4)):!n.webviewHide&&"loading"===a.status&&a.showIcon?(e.openBlock(),e.createElementBlock("view",{key:1,style:e.normalizeStyle({width:a.iconSize+"px",height:a.iconSize+"px"}),class:"uni-load-more__img uni-load-more__img--ios-H5"},[e.createElementVNode("image",{src:n.imgBase64,mode:"widthFix"},null,8,["src"])],4)):e.createCommentVNode("",!0),a.showText?(e.openBlock(),e.createElementBlock("text",{key:2,class:"uni-load-more__text",style:e.normalizeStyle({color:a.color})},e.toDisplayString("more"===a.status?i.contentdownText:"loading"===a.status?i.contentrefreshText:i.contentnomoreText),5)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-5298def7"]]),ns={props:{localdata:{type:[Array,Object],default:()=>[]},spaceInfo:{type:Object,default:()=>({})},collection:{type:String,default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},getone:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},manual:{type:Boolean,default:!1},value:{type:[Array,String,Number],default:()=>[]},modelValue:{type:[Array,String,Number],default:()=>[]},preload:{type:Boolean,default:!1},stepSearh:{type:Boolean,default:!0},selfField:{type:String,default:""},parentField:{type:String,default:""},multiple:{type:Boolean,default:!1},map:{type:Object,default:()=>({text:"text",value:"value"})}},data(){return{loading:!1,errorMessage:"",loadMore:{contentdown:"",contentrefresh:"",contentnomore:""},dataList:[],selected:[],selectedIndex:0,page:{current:this.pageCurrent,size:this.pageSize,count:0}}},computed:{isLocaldata(){return!this.collection.length},postField(){let e=[this.field];return this.parentField&&e.push(`${this.parentField} as parent_value`),e.join(",")},dataValue(){return(Array.isArray(this.modelValue)?this.modelValue.length>0:null!==this.modelValue||void 0!==this.modelValue)?this.modelValue:this.value},hasValue(){return"number"==typeof this.dataValue||null!=this.dataValue&&this.dataValue.length>0}},created(){this.$watch((()=>{var e=[];return["pageCurrent","pageSize","spaceInfo","value","modelValue","localdata","collection","action","field","orderby","where","getont","getcount","gettree"].forEach((t=>{e.push(this[t])})),e}),((e,t)=>{for(let l=2;l<e.length&&e[l]==t[l];l++);e[0]!=t[0]&&(this.page.current=this.pageCurrent),this.page.size=this.pageSize,this.onPropsChange()})),this._treeData=[]},methods:{onPropsChange(){this._treeData=[]},getCommand(e={}){let t=Mr.database(this.spaceInfo);const l=e.action||this.action;l&&(t=t.action(l));const a=e.collection||this.collection;t=t.collection(a);const o=e.where||this.where;o&&Object.keys(o).length&&(t=t.where(o));const n=e.field||this.field;n&&(t=t.field(n));const i=e.orderby||this.orderby;i&&(t=t.orderBy(i));const r=void 0!==e.pageCurrent?e.pageCurrent:this.page.current,s=void 0!==e.pageSize?e.pageSize:this.page.size,c={getCount:void 0!==e.getcount?e.getcount:this.getcount,getTree:void 0!==e.gettree?e.gettree:this.gettree};return e.getTreePath&&(c.getTreePath=e.getTreePath),t=t.skip(s*(r-1)).limit(s).get(c),t},getNodeData(e){this.loading||(this.loading=!0,this.getCommand({field:this.postField,where:this._pathWhere()}).then((t=>{this.loading=!1,this.selected=t.result.data,e&&e()})).catch((e=>{this.loading=!1,this.errorMessage=e})))},getTreePath(e){this.loading||(this.loading=!0,this.getCommand({field:this.postField,getTreePath:{startWith:`${this.selfField}=='${this.dataValue}'`}}).then((t=>{this.loading=!1;let l=[];this._extractTreePath(t.result.data,l),this.selected=l,e&&e()})).catch((e=>{this.loading=!1,this.errorMessage=e})))},loadData(){this.isLocaldata?this._processLocalData():null==this.dataValue?this.stepSearh?this._loadNodeData((e=>{this._treeData=e,this._updateBindData()})):this._loadAllData((e=>{this._treeData=[],this._extractTree(e,this._treeData,null),this._updateBindData()})):this._loadNodeData((e=>{this._treeData=e,this._updateBindData(),this._updateSelected()}))},_loadAllData(e){this.loading||(this.loading=!0,this.getCommand({field:this.postField,gettree:!0,startwith:`${this.selfField}=='${this.dataValue}'`}).then((t=>{this.loading=!1,e(t.result.data),this.onDataChange()})).catch((e=>{this.loading=!1,this.errorMessage=e})))},_loadNodeData(e,t){this.loading||(this.loading=!0,this.getCommand({field:this.postField,where:t||this._postWhere(),pageSize:500}).then((t=>{this.loading=!1,e(t.result.data),this.onDataChange()})).catch((e=>{this.loading=!1,this.errorMessage=e})))},_pathWhere(){let e=[],t=this._getParentNameByField();return t&&e.push(`${t} == '${this.dataValue}'`),this.where?`(${this.where}) && (${e.join(" || ")})`:e.join(" || ")},_postWhere(){let e=[],t=this.selected,l=this.parentField;if(l&&e.push(`${l} == null || ${l} == ""`),t.length)for(var a=0;a<t.length-1;a++)e.push(`${l} == '${t[a].value}'`);let o=[];return this.where&&o.push(`(${this.where})`),e.length&&o.push(`(${e.join(" || ")})`),o.join(" && ")},_nodeWhere(){let e=[],t=this.selected;return t.length&&e.push(`${this.parentField} == '${t[t.length-1].value}'`),this.where?`(${this.where}) && (${e.join(" || ")})`:e.join(" || ")},_getParentNameByField(){const e=this.field.split(",");let t=null;for(let l=0;l<e.length;l++){const a=e[l].split("as");if(!(a.length<2)&&"value"===a[1].trim()){t=a[0].trim();break}}return t},_isTreeView(){return this.parentField&&this.selfField},_updateSelected(){var e=this.dataList,t=this.selected;let l=this.map.text,a=this.map.value;for(var o=0;o<t.length;o++)for(var n=t[o].value,i=e[o],r=0;r<i.length;r++){var s=i[r];if(s[a]===n){t[o].text=s[l];break}}},_updateBindData(e){const{dataList:t,hasNodes:l}=this._filterData(this._treeData,this.selected);let a=!1===this._stepSearh&&!l;return e&&(e.isleaf=a),this.dataList=t,this.selectedIndex=t.length-1,!a&&this.selected.length<t.length&&this.selected.push({value:null,text:"请选择"}),{isleaf:a,hasNodes:l}},_filterData(e,t){let l=[],a=!0;l.push(e.filter((e=>null===e.parent_value||void 0===e.parent_value||""===e.parent_value)));for(let i=0;i<t.length;i++){var o=t[i].value,n=e.filter((e=>e.parent_value===o));n.length?l.push(n):a=!1}return{dataList:l,hasNodes:a}},_extractTree(e,t,l){let a=this.map.value;for(let o=0;o<e.length;o++){let n=e[o],i={};for(let e in n)"children"!==e&&(i[e]=n[e]);null!=l&&""!==l&&(i.parent_value=l),t.push(i);let r=n.children;r&&this._extractTree(r,t,n[a])}},_extractTreePath(e,t){for(let l=0;l<e.length;l++){let a=e[l],o={};for(let e in a)"children"!==e&&(o[e]=a[e]);t.push(o);let n=a.children;n&&this._extractTreePath(n,t)}},_findNodePath(e,t,l=[]){let a=this.map.text,o=this.map.value;for(let n=0;n<t.length;n++){let i=t[n],r=i.children,s=i[a],c=i[o];if(l.push({value:c,text:s}),c===e)return l;if(r){const t=this._findNodePath(e,r,l);if(t.length)return t}l.pop()}return[]},_processLocalData(){this._treeData=[],this._extractTree(this.localdata,this._treeData);var e=this.dataValue;void 0!==e&&(Array.isArray(e)&&"object"==typeof(e=e[e.length-1])&&e[this.map.value]&&(e=e[this.map.value]),this.selected=this._findNodePath(e,this.localdata))}}};const is={name:"UniDataPicker",emits:["popupopened","popupclosed","nodeclick","input","change","update:modelValue"],mixins:[ns],components:{DataPickerView:l({name:"UniDataPickerView",emits:["nodeclick","change","datachange","update:modelValue"],mixins:[ns],props:{managedMode:{type:Boolean,default:!1},ellipsis:{type:Boolean,default:!0}},data:()=>({}),created(){this.managedMode||this.$nextTick((()=>{this.load()}))},methods:{onPropsChange(){this._treeData=[],this.selectedIndex=0,this.load()},load(){this.isLocaldata?this.loadData():this.dataValue.length&&this.getTreePath((e=>{this.loadData()}))},handleSelect(e){this.selectedIndex=e},handleNodeClick(e,t,l){if(e.disable)return;const a=this.dataList[t][l],o=a[this.map.text],n=a[this.map.value];if(t<this.selected.length-1?(this.selected.splice(t,this.selected.length-t),this.selected.push({text:o,value:n})):t===this.selected.length-1&&this.selected.splice(t,1,{text:o,value:n}),a.isleaf)return void this.onSelectedChange(a,a.isleaf);const{isleaf:i,hasNodes:r}=this._updateBindData();(this._isTreeView()||r)&&(!this.isLocaldata||r&&!i)?i||r?this.onSelectedChange(a,!1):this._loadNodeData((e=>{e.length?(this._treeData.push(...e),this._updateBindData(a)):a.isleaf=!0,this.onSelectedChange(a,a.isleaf)}),this._nodeWhere()):this.onSelectedChange(a,!0)},updateData(e){this._treeData=e.treeData,this.selected=e.selected,this._treeData.length?this._updateBindData():this.loadData()},onDataChange(){this.$emit("datachange")},onSelectedChange(e,t){t&&this._dispatchEvent(),e&&this.$emit("nodeclick",e)},_dispatchEvent(){this.$emit("change",this.selected.slice(0))}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-load-more"),os);return e.openBlock(),e.createElementBlock("view",{class:"uni-data-pickerview"},[e.createElementVNode("scroll-view",{class:"selected-area","scroll-x":"true","scroll-y":"false","show-scrollbar":!1},[e.createElementVNode("view",{class:"selected-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.selected,((l,o)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[l.text?(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["selected-item",{"selected-item-active":o==t.selectedIndex,"selected-item-text-overflow":a.ellipsis}]),key:o,onClick:e=>i.handleSelect(o)},[e.createElementVNode("text",{class:""},e.toDisplayString(l.text),1)],10,["onClick"])):e.createCommentVNode("",!0)],64)))),256))])]),e.createElementVNode("view",{class:"tab-c"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.dataList,((l,a)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[a==t.selectedIndex?(e.openBlock(),e.createElementBlock("scroll-view",{class:"list",key:a,"scroll-y":!0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l,((l,o)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["item",{"is-disabled":!!l.disable}]),key:o,onClick:e=>i.handleNodeClick(l,a,o)},[e.createElementVNode("text",{class:"item-text item-text-overflow"},e.toDisplayString(l[t.map.text]),1),t.selected.length>a&&l[t.map.value]==t.selected[a].value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"check"})):e.createCommentVNode("",!0)],10,["onClick"])))),128))])):e.createCommentVNode("",!0)],64)))),256)),t.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-cover"},[e.createVNode(s,{class:"load-more",contentText:t.loadMore,status:"loading"},null,8,["contentText"])])):e.createCommentVNode("",!0),t.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-message"},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(t.errorMessage),1)])):e.createCommentVNode("",!0)])])}],["__scopeId","data-v-732b142e"]])},props:{options:{type:[Object,Array],default:()=>({})},popupTitle:{type:String,default:"请选择"},placeholder:{type:String,default:"请选择"},heightMobile:{type:String,default:""},readonly:{type:Boolean,default:!1},clearIcon:{type:Boolean,default:!0},border:{type:Boolean,default:!0},split:{type:String,default:"/"},ellipsis:{type:Boolean,default:!0}},data:()=>({isOpened:!1,inputSelected:[]}),created(){this.form=this.getForm("uniForms"),this.formItem=this.getForm("uniFormsItem"),this.formItem&&this.formItem.name&&(this.rename=this.formItem.name,this.form.inputChildrens.push(this)),this.$nextTick((()=>{this.load()}))},methods:{clear(){this.inputSelected.splice(0),this._dispatchEvent([])},onPropsChange(){this._treeData=[],this.selectedIndex=0,this.load()},load(){this.readonly?this._processReadonly(this.localdata,this.dataValue):this.isLocaldata?(this.loadData(),this.inputSelected=this.selected.slice(0)):this.parentField||this.selfField||!this.hasValue?this.hasValue&&this.getTreePath((()=>{this.inputSelected=this.selected.slice(0)})):this.getNodeData((()=>{this.inputSelected=this.selected.slice(0)}))},getForm(e="uniForms"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t},show(){this.isOpened=!0,setTimeout((()=>{this.$refs.pickerView.updateData({treeData:this._treeData,selected:this.selected,selectedIndex:this.selectedIndex})}),200),this.$emit("popupopened")},hide(){this.isOpened=!1,this.$emit("popupclosed")},handleInput(){this.readonly||this.show()},handleClose(e){this.hide()},onnodeclick(e){this.$emit("nodeclick",e)},ondatachange(e){this._treeData=this.$refs.pickerView._treeData},onchange(e){this.hide(),this.inputSelected=e,this._dispatchEvent(e)},_processReadonly(e,t){if(e.findIndex((e=>e.children))>-1){let e;return Array.isArray(t)?(e=t[t.length-1],"object"==typeof e&&e.value&&(e=e.value)):e=t,void(this.inputSelected=this._findNodePath(e,this.localdata))}if(!this.hasValue)return void(this.inputSelected=[]);let l=[];for(let n=0;n<t.length;n++){var a=t[n],o=e.find((e=>e.value==a));o&&l.push(o)}l.length&&(this.inputSelected=l)},_filterForArray(e,t){var l=[];for(let n=0;n<t.length;n++){var a=t[n],o=e.find((e=>e.value==a));o&&l.push(o)}return l},_dispatchEvent(e){let t={};if(e.length){for(var l=new Array(e.length),a=0;a<e.length;a++)l[a]=e[a].value;t=e[e.length-1]}else t.value="";this.formItem&&this.formItem.setValue(t.value),this.$emit("input",t.value),this.$emit("update:modelValue",t.value),this.$emit("change",{detail:{value:e}})}}};var rs=l(is,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-load-more"),os),c=r(e.resolveDynamicComponent("uni-icons"),fe),d=e.resolveComponent("data-picker-view");return e.openBlock(),e.createElementBlock("view",{class:"uni-data-tree"},[e.createElementVNode("view",{class:"uni-data-tree-input",onClick:l[1]||(l[1]=(...e)=>i.handleInput&&i.handleInput(...e))},[e.renderSlot(t.$slots,"default",{options:a.options,data:n.inputSelected,error:t.errorMessage},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["input-value",{"input-value-border":a.border}])},[t.errorMessage?(e.openBlock(),e.createElementBlock("text",{key:0,class:"selected-area error-text"},e.toDisplayString(t.errorMessage),1)):t.loading&&!n.isOpened?(e.openBlock(),e.createElementBlock("view",{key:1,class:"selected-area"},[e.createVNode(s,{class:"load-more",contentText:t.loadMore,status:"loading"},null,8,["contentText"])])):n.inputSelected.length?(e.openBlock(),e.createElementBlock("scroll-view",{key:2,class:"selected-area","scroll-x":"true"},[e.createElementVNode("view",{class:"selected-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.inputSelected,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"selected-item",key:l},[e.createElementVNode("text",null,e.toDisplayString(t.text),1),l<n.inputSelected.length-1?(e.openBlock(),e.createElementBlock("text",{key:0,class:"input-split-line"},e.toDisplayString(a.split),1)):e.createCommentVNode("",!0)])))),128))])])):(e.openBlock(),e.createElementBlock("text",{key:3,class:"selected-area placeholder"},e.toDisplayString(a.placeholder),1)),a.clearIcon&&!a.readonly&&n.inputSelected.length?(e.openBlock(),e.createElementBlock("view",{key:4,class:"icon-clear",onClick:l[0]||(l[0]=e.withModifiers(((...e)=>i.clear&&i.clear(...e)),["stop"]))},[e.createVNode(c,{type:"clear",color:"#e1e1e1",size:"14"})])):e.createCommentVNode("",!0),a.clearIcon&&n.inputSelected.length||a.readonly?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:5,class:"arrow-area"},[e.createElementVNode("view",{class:"input-arrow"})]))],2)]),!0)]),n.isOpened?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-data-tree-cover",onClick:l[2]||(l[2]=(...e)=>i.handleClose&&i.handleClose(...e))})):e.createCommentVNode("",!0),n.isOpened?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-data-tree-dialog"},[e.createElementVNode("view",{class:"uni-popper__arrow"}),e.createElementVNode("view",{class:"dialog-caption"},[e.createElementVNode("view",{class:"title-area"},[e.createElementVNode("text",{class:"dialog-title"},e.toDisplayString(a.popupTitle),1)]),e.createElementVNode("view",{class:"dialog-close",onClick:l[3]||(l[3]=(...e)=>i.handleClose&&i.handleClose(...e))},[e.createElementVNode("view",{class:"dialog-close-plus","data-id":"close"}),e.createElementVNode("view",{class:"dialog-close-plus dialog-close-rotate","data-id":"close"})])]),e.createVNode(d,{class:"picker-view",ref:"pickerView",modelValue:t.dataValue,"onUpdate:modelValue":l[4]||(l[4]=e=>t.dataValue=e),localdata:t.localdata,preload:t.preload,collection:t.collection,field:t.field,orderby:t.orderby,where:t.where,"step-searh":t.stepSearh,"self-field":t.selfField,"parent-field":t.parentField,"managed-mode":!0,map:t.map,ellipsis:a.ellipsis,onChange:i.onchange,onDatachange:i.ondatachange,onNodeclick:i.onnodeclick},null,8,["modelValue","localdata","preload","collection","field","orderby","where","step-searh","self-field","parent-field","map","ellipsis","onChange","onDatachange","onNodeclick"])])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-752b717d"]]);let ss={};ss={data:()=>({is_show:"none"}),watch:{show(e){this.is_show=this.show}},created(){this.swipeaction=this.getSwipeAction(),void 0!==this.swipeaction.children&&this.swipeaction.children.push(this)},mounted(){this.is_show=this.show},methods:{closeSwipe(e){this.autoClose&&this.swipeaction.closeOther(this)},change(e){this.$emit("change",e.open),this.is_show!==e.open&&(this.is_show=e.open)},appTouchStart(e){const{clientX:t}=e.changedTouches[0];this.clientX=t,this.timestamp=(new Date).getTime()},appTouchEnd(e,t,l,a){const{clientX:o}=e.changedTouches[0];let n=Math.abs(this.clientX-o),i=(new Date).getTime()-this.timestamp;n<40&&i<300&&this.$emit("click",{content:l,index:t,position:a})},onClickForPC(e,t,l){}}};var cs=e=>{(e.$wxs||(e.$wxs=[])).push("wxsswipe"),(e.$wxsModules||(e.$wxsModules={})).wxsswipe="13d3b3b0"},ds=e=>{(e.$renderjs||(e.$renderjs=[])).push("renderswipe"),(e.$renderjsModules||(e.$renderjsModules={})).renderswipe="5a1e922e"};const us={mixins:[ss,{},{}],emits:["click","change"],props:{show:{type:String,default:"none"},disabled:{type:Boolean,default:!1},autoClose:{type:Boolean,default:!0},threshold:{type:Number,default:20},leftOptions:{type:Array,default:()=>[]},rightOptions:{type:Array,default:()=>[]}},unmounted(){this.__isUnmounted=!0,this.uninstall()},methods:{uninstall(){this.swipeaction&&this.swipeaction.children.forEach(((e,t)=>{e===this&&this.swipeaction.children.splice(t,1)}))},getSwipeAction(e="uniSwipeAction"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t}}};cs(us),ds(us);var ms=l(us,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"uni-swipe"},[e.createElementVNode("view",{class:"uni-swipe_box","change:prop":t.wxsswipe.showWatch,prop:t.is_show,"data-threshold":a.threshold,"data-disabled":a.disabled,onTouchstart:l[2]||(l[2]=(...e)=>t.wxsswipe.touchstart&&t.wxsswipe.touchstart(...e)),onTouchmove:l[3]||(l[3]=(...e)=>t.wxsswipe.touchmove&&t.wxsswipe.touchmove(...e)),onTouchend:l[4]||(l[4]=(...e)=>t.wxsswipe.touchend&&t.wxsswipe.touchend(...e))},[e.createElementVNode("view",{class:"uni-swipe_button-group button-group--left"},[e.renderSlot(t.$slots,"left",{},(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.leftOptions,((a,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,style:e.normalizeStyle({backgroundColor:a.style&&a.style.backgroundColor?a.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:l[0]||(l[0]=(...e)=>t.appTouchStart&&t.appTouchStart(...e)),onTouchend:e=>t.appTouchEnd(e,o,a,"left"),onClick:e.withModifiers((e=>t.onClickForPC(o,a,"left")),["stop"])},[e.createElementVNode("text",{class:"uni-swipe_button-text",style:e.normalizeStyle({color:a.style&&a.style.color?a.style.color:"#FFFFFF",fontSize:a.style&&a.style.fontSize?a.style.fontSize:"16px"})},e.toDisplayString(a.text),5)],44,["onTouchend","onClick"])))),128))]),!0)]),e.createElementVNode("view",{class:"uni-swipe_text--center"},[e.renderSlot(t.$slots,"default",{},void 0,!0)]),e.createElementVNode("view",{class:"uni-swipe_button-group button-group--right"},[e.renderSlot(t.$slots,"right",{},(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.rightOptions,((a,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,style:e.normalizeStyle({backgroundColor:a.style&&a.style.backgroundColor?a.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:l[1]||(l[1]=(...e)=>t.appTouchStart&&t.appTouchStart(...e)),onTouchend:e=>t.appTouchEnd(e,o,a,"right"),onClick:e.withModifiers((e=>t.onClickForPC(o,a,"right")),["stop"])},[e.createElementVNode("text",{class:"uni-swipe_button-text",style:e.normalizeStyle({color:a.style&&a.style.color?a.style.color:"#FFFFFF",fontSize:a.style&&a.style.fontSize?a.style.fontSize:"16px"})},e.toDisplayString(a.text),5)],44,["onTouchend","onClick"])))),128))]),!0)])],40,["change:prop","prop","data-threshold","data-disabled"])])}],["__scopeId","data-v-79d0199e"]]);var ps=l({name:"uniSwipeAction",data:()=>({}),created(){this.children=[]},methods:{resize(){},closeAll(){this.children.forEach((e=>{e.is_show="none"}))},closeOther(e){this.openItem&&this.openItem!==e&&(this.openItem.is_show="none"),this.openItem=e}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",null,[e.renderSlot(t.$slots,"default")])}]]);var vs=new class extends Ee{constructor(){super("RequestDraw")}requestDrawGetByID(e){return this.request("/Bill/RequestDraw/GetByID",{ID:e})}requestDrawSaveDraft(e){return this.request("/Bill/RequestDraw/SaveDraft",e)}requestDrawDelete(e){return this.request("/Bill/RequestDraw/Delete",{ID:e})}requestDrawList({qst:e,pageNo:t,pageSize:l,billCode:a,requestDrawEmployeeName:o,startRequestDrawDate:n,endRequestDrawDate:i,goodsCode:r,goodsName:s,assetCategoryIDs:c,brand:d,spec:u,model:m,IsClosed:p}){const v={IsSetNumber:!0,ShowMode:0,Sort:1,BillCode:a,RequestDrawEmployeeName:o,StartRequestDrawDate:n,EndRequestDrawDate:i,GoodsCode:r,GoodsName:s,AssetCategoryIDs:c,Brand:d,Spec:u,Model:m,IsClosed:p,PageNO:t,PageSize:l||20,QST:e};return this.request("/Bill/RequestDraw/List",v)}getById(e){return this.request("/Asset/GetByID",{ID:e,Visibility:1})}goodsList(e){return this.request("/BasicData/Goods/List",{PageEnable:2,QST:e,PageNO:1,PageSize:10,AssetCategoryIDs:null})}};var hs=new class extends ae{dictionaryGetByCode(e){return this.request("/Dictionary/GetByCode",e)}};var fs=new class extends Ee{preStartFlow(e,t){const l=`/Bill/${e}/PreStartFlow`;return this.request(l,{ID:t})}startFlow(e,t){const l=`/Bill/${e}/StartFlow`;return this.request(l,t)}prevApproval(e,t){const l=`/Bill/${e}/PrevApproval`;return this.request(l,{ID:t})}submitApproval(e,t){const l=`/Bill/${e}/SubmitApproval`;return this.request(l,t)}getFlowTrail(e,t){const l=`/Bill/${e}/GetFlowTrail`;return this.request(l,{ID:t})}};var gs=new class extends Je{preStartFlow(e,t){const l=`/Bill/${e}/PreStartFlow`;return this.request(l,{ID:t})}startFlow(e,t){const l=`/Bill/${e}/StartFlow`;return this.request(l,t)}prevApproval(e,t){const l=`/Bill/${e}/PrevApproval`;return this.request(l,{ID:t})}submitApproval(e,t){const l=`/Bill/${e}/SubmitApproval`;return this.request(l,t)}getFlowTrail(e,t){const l=`/Bill/${e}/GetFlowTrail`;return this.request(l,{ID:t})}};var ys=l({emits:["closeDialog","approveStartConfirm"],components:{"cj-uni-data-select":l({name:"uni-stat-select",mixins:[Mr.mixinDatacom||{}],data:()=>({showSelector:!1,current:"",mixinDatacomResData:[],apps:[],channels:[]}),props:{localdata:{type:Array,default:()=>[]},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},placeholder:{type:String,default:"请选择"},emptyTips:{type:String,default:"无选项"},clear:{type:Boolean,default:!0},defItem:{type:Number,default:0}},created(){this.last=`${this.collection}_last_selected_option_value`,this.collection&&!this.localdata.length&&this.mixinDatacomEasyGet()},computed:{typePlaceholder(){const e={"opendb-stat-app-versions":"版本","opendb-app-channels":"渠道","opendb-app-list":"应用"}[this.collection];return e?"请选择"+e:"请选择"}},watch:{localdata:{immediate:!0,handler(e,t){Array.isArray(e)&&!t&&(this.mixinDatacomResData=e)}},modelValue(){this.initDefVal()},mixinDatacomResData:{immediate:!0,handler(e){e.length&&this.initDefVal()}}},methods:{initDefVal(){let e="";if(this.value||0===this.value)e=this.value;else if(this.modelValue||0===this.modelValue)e=this.modelValue;else{let t;if(this.collection&&(t=uni.getStorageSync(this.last)),t||0===t)e=t;else{let t="";this.defItem>0&&this.defItem<this.mixinDatacomResData.length&&(t=this.mixinDatacomResData[this.defItem-1].value),e=t}this.emit(e)}const t=this.mixinDatacomResData.find((t=>t.value===e));this.current=t?this.formatItemName(t):""},clearVal(){this.emit(""),this.collection&&uni.removeStorageSync(this.last)},change(e){this.showSelector=!1,this.current=this.formatItemName(e),this.emit(e.value)},emit(e){this.$emit("change",e),this.$emit("input",e),this.$emit("update:modelValue",e),this.collection&&uni.setStorageSync(this.last,e)},toggleSelector(){this.showSelector=!this.showSelector},formatItemName(e){let{text:t,value:l,channel_code:a}=e;return a=a?`(${a})`:"",this.collection.indexOf("app-list")>0?`${t}(${l})`:t||`未命名${a}`}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock("view",{class:"uni-stat__select"},[a.label?(e.openBlock(),e.createElementBlock("span",{key:0,class:"uni-label-text hide-on-phone"},e.toDisplayString(a.label+"："),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass({"uni-stat__actived":n.current}),style:{width:"100%"}},[e.createElementVNode("view",{class:"uni-select"},[e.createElementVNode("view",{class:"uni-select__input-box",onClick:l[0]||(l[0]=(...e)=>i.toggleSelector&&i.toggleSelector(...e))},[n.current?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select__input-text"},e.toDisplayString(n.current),1)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-select__input-text uni-select__input-placeholder"},e.toDisplayString(i.typePlaceholder),1)),n.current&&a.clear?(e.openBlock(),e.createBlock(s,{key:2,type:"clear",color:"#e1e1e1",size:"18",onClick:i.clearVal},null,8,["onClick"])):(e.openBlock(),e.createBlock(s,{key:3,type:n.showSelector?"top":"bottom",size:"14",color:"#999"},null,8,["type"]))]),n.showSelector?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select--mask",onClick:l[1]||(l[1]=(...e)=>i.toggleSelector&&i.toggleSelector(...e))})):e.createCommentVNode("",!0),n.showSelector?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-select__selector"},[e.createElementVNode("view",{class:"uni-popper__arrow"}),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"uni-select__selector-scroll"},[0===n.mixinDatacomResData.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select__selector-empty"},[e.createElementVNode("text",null,e.toDisplayString(a.emptyTips),1)])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(n.mixinDatacomResData,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-select__selector-item",key:l,onClick:e=>i.change(t)},[e.createElementVNode("text",null,e.toDisplayString(i.formatItemName(t)),1)],8,["onClick"])))),128))])])):e.createCommentVNode("",!0)])],2)])}],["__scopeId","data-v-b041d9be"]])},props:{approverOption:{type:Array,default:()=>[]},approvalProcessData:{type:Object,required:!0}},setup(t,l){const a=e.ref(null),o=e.ref([]);return e.onMounted((()=>{a.value.open()})),{approveStartUpDialog:a,approveStartConfirm:function(){t.approverOption.length>1&&0==o.value.length?F("请选择审批人"):l.emit("approveStartConfirm",o.value)},approverChange:function(e){o.value=t.approverOption.filter((t=>t.EmployeeID==e)),i("log","at components/startApprovalProcess/startApprovalProcess.vue:78",o.value)},employeeID:o,close:function(){l.emit("closeDialog")}}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("cj-uni-data-select"),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl);return e.openBlock(),e.createBlock(d,{ref:"approveStartUpDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"启动审批流",onConfirm:o.approveStartConfirm,onClose:o.close},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("view",null,e.toDisplayString(a.approvalProcessData.nextActivityName),1)]),e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批人员："),e.createElementVNode("view",{class:"select"},[a.approverOption.length>1?(e.openBlock(),e.createBlock(s,{key:0,clear:!1,modelValue:a.approvalProcessData.employeeID,"onUpdate:modelValue":l[0]||(l[0]=e=>a.approvalProcessData.employeeID=e),localdata:a.approverOption,onChange:o.approverChange},null,8,["modelValue","localdata","onChange"])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(a.approvalProcessData.employeeName),1)],64))])])])])),_:1},8,["onConfirm","onClose"])])),_:1},512)}],["__scopeId","data-v-f9a5eb4e"]]);const ws={name:"uniDataChecklist",mixins:[Mr.mixinDatacom||{}],emits:["input","update:modelValue","change"],props:{mode:{type:String,default:"default"},multiple:{type:Boolean,default:!1},value:{type:[Array,String,Number],default:()=>""},modelValue:{type:[Array,String,Number],default:()=>""},localdata:{type:Array,default:()=>[]},min:{type:[Number,String],default:""},max:{type:[Number,String],default:""},wrap:{type:Boolean,default:!1},icon:{type:String,default:"left"},selectedColor:{type:String,default:""},selectedTextColor:{type:String,default:""},emptyText:{type:String,default:"暂无数据"},disabled:{type:Boolean,default:!1},map:{type:Object,default:()=>({text:"text",value:"value"})}},watch:{localdata:{handler(e){this.range=e,this.dataList=this.getDataList(this.getSelectedValue(e))},deep:!0},mixinDatacomResData(e){this.range=e,this.dataList=this.getDataList(this.getSelectedValue(e))},value(e){this.dataList=this.getDataList(e),this.is_reset||(this.is_reset=!1,this.formItem&&this.formItem.setValue(e))},modelValue(e){this.dataList=this.getDataList(e),this.is_reset||(this.is_reset=!1,this.formItem&&this.formItem.setValue(e))}},data:()=>({dataList:[],range:[],contentText:{contentdown:"查看更多",contentrefresh:"加载中",contentnomore:"没有更多"},isLocal:!0,styles:{selectedColor:"#2979ff",selectedTextColor:"#666"},isTop:0}),computed:{dataValue(){return""===this.value?this.modelValue:(this.modelValue,this.value)}},created(){this.form=this.getForm("uniForms"),this.formItem=this.getForm("uniFormsItem"),this.formItem&&(this.isTop=6,this.formItem.name&&(this.is_reset||(this.is_reset=!1,this.formItem.setValue(this.dataValue)),this.rename=this.formItem.name,this.form.inputChildrens.push(this))),this.localdata&&0!==this.localdata.length?(this.isLocal=!0,this.range=this.localdata,this.dataList=this.getDataList(this.getSelectedValue(this.range))):this.collection&&(this.isLocal=!1,this.loadData())},methods:{loadData(){this.mixinDatacomGet().then((e=>{this.mixinDatacomResData=e.result.data,0===this.mixinDatacomResData.length?(this.isLocal=!1,this.mixinDatacomErrorMessage=this.emptyText):this.isLocal=!0})).catch((e=>{this.mixinDatacomErrorMessage=e.message}))},getForm(e="uniForms"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t},chagne(e){const t=e.detail.value;let l={value:[],data:[]};if(this.multiple)this.range.forEach((e=>{t.includes(e[this.map.value]+"")&&(l.value.push(e[this.map.value]),l.data.push(e))}));else{const e=this.range.find((e=>e[this.map.value]+""===t));e&&(l={value:e[this.map.value],data:e})}this.formItem&&this.formItem.setValue(l.value),this.$emit("input",l.value),this.$emit("update:modelValue",l.value),this.$emit("change",{detail:l}),this.multiple?this.dataList=this.getDataList(l.value,!0):this.dataList=this.getDataList(l.value)},getDataList(e){let t=JSON.parse(JSON.stringify(this.range)),l=[];return this.multiple&&(Array.isArray(e)||(e=[])),t.forEach(((t,a)=>{if(t.disabled=t.disable||t.disabled||!1,this.multiple)if(e.length>0){let l=e.find((e=>e===t[this.map.value]));t.selected=void 0!==l}else t.selected=!1;else t.selected=e===t[this.map.value];l.push(t)})),this.setRange(l)},setRange(e){let t=e.filter((e=>e.selected)),l=Number(this.min)||0,a=Number(this.max)||"";return e.forEach(((o,n)=>{if(this.multiple){if(t.length<=l){void 0!==t.find((e=>e[this.map.value]===o[this.map.value]))&&(o.disabled=!0)}if(t.length>=a&&""!==a){void 0===t.find((e=>e[this.map.value]===o[this.map.value]))&&(o.disabled=!0)}}this.setStyles(o,n),e[n]=o})),e},setStyles(e,t){e.styleBackgroud=this.setStyleBackgroud(e),e.styleIcon=this.setStyleIcon(e),e.styleIconText=this.setStyleIconText(e),e.styleRightIcon=this.setStyleRightIcon(e)},getSelectedValue(e){if(!this.multiple)return this.dataValue;let t=[];return e.forEach((e=>{e.selected&&t.push(e[this.map.value])})),this.dataValue&&this.dataValue.length>0?this.dataValue:t},setStyleBackgroud(e){let t={},l=this.selectedColor?this.selectedColor:"#2979ff";"list"!==this.mode&&(t["border-color"]=e.selected?l:"#DCDFE6"),"tag"===this.mode&&(t["background-color"]=e.selected?l:"#f5f5f5");let a="";for(let o in t)a+=`${o}:${t[o]};`;return a},setStyleIcon(e){let t={},l="",a=this.selectedColor?this.selectedColor:"#2979ff";t["background-color"]=e.selected?a:"#fff",t["border-color"]=e.selected?a:"#DCDFE6",!e.selected&&e.disabled&&(t["background-color"]="#F2F6FC",t["border-color"]=e.selected?a:"#DCDFE6");for(let o in t)l+=`${o}:${t[o]};`;return l},setStyleIconText(e){let t={},l="",a=this.selectedColor?this.selectedColor:"#2979ff";"tag"===this.mode?t.color=e.selected?this.selectedTextColor?this.selectedTextColor:"#fff":"#666":t.color=e.selected?this.selectedTextColor?this.selectedTextColor:a:"#666",!e.selected&&e.disabled&&(t.color="#999");for(let o in t)l+=`${o}:${t[o]};`;return l},setStyleRightIcon(e){let t={},l="";"list"===this.mode&&(t["border-color"]=e.selected?this.styles.selectedColor:"#DCDFE6");for(let a in t)l+=`${a}:${t[a]};`;return l}}};var Ns=l(ws,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-load-more"),os);return e.openBlock(),e.createElementBlock("view",{class:"uni-data-checklist",style:e.normalizeStyle({"margin-top":n.isTop+"px"})},[n.isLocal?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[a.multiple?(e.openBlock(),e.createElementBlock("checkbox-group",{key:0,class:e.normalizeClass(["checklist-group",{"is-list":"list"===a.mode||a.wrap}]),onChange:l[0]||(l[0]=(...e)=>i.chagne&&i.chagne(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.dataList,((t,l)=>(e.openBlock(),e.createElementBlock("label",{class:e.normalizeClass(["checklist-box",["is--"+a.mode,t.selected?"is-checked":"",a.disabled||t.disabled?"is-disable":"",0!==l&&"list"===a.mode?"is-list-border":""]]),style:e.normalizeStyle(t.styleBackgroud),key:l},[e.createElementVNode("checkbox",{class:"hidden",hidden:"",disabled:a.disabled||!!t.disabled,value:t[a.map.value]+"",checked:t.selected},null,8,["disabled","value","checked"]),"tag"!==a.mode&&"list"!==a.mode||"list"===a.mode&&"left"===a.icon?(e.openBlock(),e.createElementBlock("view",{key:0,class:"checkbox__inner",style:e.normalizeStyle(t.styleIcon)},[e.createElementVNode("view",{class:"checkbox__inner-icon"})],4)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["checklist-content",{"list-content":"list"===a.mode&&"left"===a.icon}])},[e.createElementVNode("text",{class:"checklist-text",style:e.normalizeStyle(t.styleIconText)},e.toDisplayString(t[a.map.text]),5),"list"===a.mode&&"right"===a.icon?(e.openBlock(),e.createElementBlock("view",{key:0,class:"checkobx__list",style:e.normalizeStyle(t.styleBackgroud)},null,4)):e.createCommentVNode("",!0)],2)],6)))),128))],34)):(e.openBlock(),e.createElementBlock("radio-group",{key:1,class:e.normalizeClass(["checklist-group",{"is-list":"list"===a.mode,"is-wrap":a.wrap}]),onChange:l[1]||(l[1]=(...e)=>i.chagne&&i.chagne(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.dataList,((t,l)=>(e.openBlock(),e.createElementBlock("label",{class:e.normalizeClass(["checklist-box",["is--"+a.mode,t.selected?"is-checked":"",a.disabled||t.disabled?"is-disable":"",0!==l&&"list"===a.mode?"is-list-border":""]]),style:e.normalizeStyle(t.styleBackgroud),key:l},[e.createElementVNode("radio",{class:"hidden",hidden:"",disabled:a.disabled||t.disabled,value:t[a.map.value]+"",checked:t.selected},null,8,["disabled","value","checked"]),"tag"!==a.mode&&"list"!==a.mode||"list"===a.mode&&"left"===a.icon?(e.openBlock(),e.createElementBlock("view",{key:0,class:"radio__inner",style:e.normalizeStyle(t.styleBackgroud)},[e.createElementVNode("view",{class:"radio__inner-icon",style:e.normalizeStyle(t.styleIcon)},null,4)],4)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["checklist-content",{"list-content":"list"===a.mode&&"left"===a.icon}])},[e.createElementVNode("text",{class:"checklist-text",style:e.normalizeStyle(t.styleIconText)},e.toDisplayString(t[a.map.text]),5),"list"===a.mode&&"right"===a.icon?(e.openBlock(),e.createElementBlock("view",{key:0,style:e.normalizeStyle(t.styleRightIcon),class:"checkobx__list"},null,4)):e.createCommentVNode("",!0)],2)],6)))),128))],34))],64)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-data-loading"},[t.mixinDatacomErrorMessage?(e.openBlock(),e.createElementBlock("text",{key:1},e.toDisplayString(t.mixinDatacomErrorMessage),1)):(e.openBlock(),e.createBlock(s,{key:0,status:"loading",iconType:"snow",iconSize:18,"content-text":n.contentText},null,8,["content-text"]))]))],4)}],["__scopeId","data-v-72c4702a"]]);var Cs=l({emits:["closeDialog","confirmApproval"],props:{approvalProcessData:{type:Object,required:!0}},setup(t,l){const a=e.ref(null),o=e.ref(1),n=e.ref(t.approvalProcessData.refuseType),i=e.ref("");return e.onMounted((()=>{a.value.open()})),{approveDialog:a,approvalType:o,refuseType:n,remark:i,approvalConfirm:function(){o.value||n.value||0==t.approvalProcessData.supportedStrategies.length?o.value||i.value?l.emit("confirmApproval",{approvalType:o.value,refuseType:n.value,remark:i.value}):F("请输入审批意见"):F("请选择处理方式")},close:function(){l.emit("closeDialog")}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-data-checkbox"),Ns),c=r(e.resolveDynamicComponent("uni-easyinput"),Ie),d=r(e.resolveDynamicComponent("uni-popup-dialog"),al),u=r(e.resolveDynamicComponent("uni-popup"),dl);return e.openBlock(),e.createBlock(u,{ref:"approveDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(d,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"单据审批",onConfirm:o.approvalConfirm,onClose:o.close},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批结果："),e.createElementVNode("view",null,[e.createVNode(s,{modelValue:o.approvalType,"onUpdate:modelValue":l[0]||(l[0]=e=>o.approvalType=e),localdata:a.approvalProcessData.approvalTypeOption},null,8,["modelValue","localdata"])])]),1!=o.approvalType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"approve-type"},[a.approvalProcessData.supportedStrategies.length?(e.openBlock(),e.createElementBlock("text",{key:0}," 处理方式： ")):e.createCommentVNode("",!0),e.createElementVNode("view",null,[e.createVNode(s,{modelValue:o.refuseType,"onUpdate:modelValue":l[1]||(l[1]=e=>o.refuseType=e),localdata:a.approvalProcessData.supportedStrategies},null,8,["modelValue","localdata"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"approve-opinion approve-type"},[e.createElementVNode("text",null,"审批意见："),e.createElementVNode("view",null,[e.createVNode(c,{type:"textarea",modelValue:o.remark,"onUpdate:modelValue":l[2]||(l[2]=e=>o.remark=e),placeholder:"请输入内容"},null,8,["modelValue"])])]),1==o.approvalType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"approve-footer approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(a.approvalProcessData.nextActivityName),1)])):e.createCommentVNode("",!0)])])),_:1},8,["onConfirm","onClose"])])),_:1},512)}],["__scopeId","data-v-66f1e071"]]);var Es=l({name:"UniSegmentedControl",emits:["clickItem"],props:{current:{type:Number,default:0},values:{type:Array,default:()=>[]},activeColor:{type:String,default:"#2979FF"},styleType:{type:String,default:"button"}},data:()=>({currentIndex:0}),watch:{current(e){e!==this.currentIndex&&(this.currentIndex=e)}},created(){this.currentIndex=this.current},methods:{_onClick(e){this.currentIndex!==e&&(this.currentIndex=e,this.$emit("clickItem",{currentIndex:e}))}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass([["text"===a.styleType?"segmented-control--text":"segmented-control--button"],"segmented-control"]),style:e.normalizeStyle({borderColor:"text"===a.styleType?"":a.activeColor})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.values,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass([["text"===a.styleType?"":"segmented-control__item--button",l===n.currentIndex&&"button"===a.styleType?"segmented-control__item--button--active":"",0===l&&"button"===a.styleType?"segmented-control__item--button--first":"",l===a.values.length-1&&"button"===a.styleType?"segmented-control__item--button--last":""],"segmented-control__item"]),key:l,style:e.normalizeStyle({backgroundColor:l===n.currentIndex&&"button"===a.styleType?a.activeColor:"",borderColor:l===n.currentIndex&&"text"===a.styleType||"button"===a.styleType?a.activeColor:"transparent"}),onClick:e=>i._onClick(l)},[e.createElementVNode("view",null,[e.createElementVNode("text",{style:e.normalizeStyle({color:l===n.currentIndex?"text"===a.styleType?a.activeColor:"#fff":"text"===a.styleType?"#000":a.activeColor}),class:e.normalizeClass(["segmented-control__text","text"===a.styleType&&l===n.currentIndex?"segmented-control__item--text":""])},e.toDisplayString(t),7)])],14,["onClick"])))),128))],6)}],["__scopeId","data-v-1a6776e9"]]);const bs="close",Ds={props:{title:String},emits:[bs],setup:(e,t)=>({close:function(e){t.emit(bs,e)}})};var Vs=l(Ds,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al);return e.openBlock(),e.createElementBlock("view",{class:"_uni-popup-cancel-dialog-internal"},[e.createVNode(s,{type:"info","before-close":!0,cancelText:"取消",confirmText:"",title:a.title,onClose:o.close},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},void 0,!0)])),_:3},8,["title","onClose"])])}],["__scopeId","data-v-26a4fce2"]]);const ks={props:{processTrackApprovalTask:{type:Array,default:()=>[]},processTrackApprovalLog:{type:Array,default:()=>[]}},emits:["closeDialog"],setup(t,l){const a=e.ref(null),o=e.ref(0),n=e.ref("");return e.onMounted((()=>{a.value.open()})),uni.getSystemInfo({success:e=>{n.value=e.windowHeight}}),{processTrackDialog:a,processTrackCurrent:o,close:function(){l.emit("closeDialog")},processTrackClickItem:function(e){o.value!=e.currentIndex&&(o.value=e.currentIndex)},windowHeights:n}}};var xs=l({components:{ProcessTrack:l(ks,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-segmented-control"),Es),c=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),d=r(e.resolveDynamicComponent("uni-popup"),dl);return e.openBlock(),e.createBlock(d,{ref:"processTrackDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{title:"流程轨迹",onClose:o.close},{default:e.withCtx((()=>[e.createElementVNode("view",{style:e.normalizeStyle(`height:${o.windowHeights/3}px`)},[e.createElementVNode("view",{class:"process_track_tab"},[e.createVNode(s,{current:o.processTrackCurrent,values:["待办任务","流转日志"],"style-type":"text","active-color":"#007aff",onClickItem:o.processTrackClickItem},null,8,["current","onClickItem"])]),0==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track_content"},[a.processTrackApprovalTask.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track"},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"当前节点："),e.createElementVNode("view",null,e.toDisplayString(a.processTrackApprovalTask[0].FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"创建时间："),e.createElementVNode("view",null,e.toDisplayString(a.processTrackApprovalTask[0].CreatedTime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"接收者："),e.createElementVNode("view",null,e.toDisplayString(a.processTrackApprovalTask[0].ApprovalEmployeeName),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0),1==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"process_track_content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.processTrackApprovalLog,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"process_track process_dividing_line",key:l},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"节点名称："),e.createElementVNode("view",null,e.toDisplayString(t.FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批人："),e.createElementVNode("view",null,e.toDisplayString(t.OperaterEmployeeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批时间："),e.createElementVNode("view",null,e.toDisplayString(t.OperationDatetime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批结果："),e.createElementVNode("view",null,e.toDisplayString(t.OperationType),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批意见："),e.createElementVNode("view",null,e.toDisplayString(t.ApprovalComment),1)])])))),128)),a.processTrackApprovalLog.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0)],4)])),_:1},8,["onClose"])])),_:1},512)}],["__scopeId","data-v-3e480897"]]),StartApprovalProcess:ys,Approval:Cs},emits:["save","delete","getById","jumpList","scrollToTop","scrollToFooter","keyword"],props:{type:{},bill:{type:Object,required:!0},billType:{type:String,required:!0},autoStart:{type:Boolean,required:!0},consumable:{type:Boolean,default:!1},nonEditable:{type:Boolean,default:!1}},setup(t,l){e.watch((()=>t.autoStart),(e=>{e&&v()}));var a={};e.onMounted((()=>{a=t.consumable?gs:fs}));const o=e.ref(null),n=e.ref(null),i=e.ref(null),r=e.ref(null),s=e.ref(null),c=e.ref([]),d=e.ref([]),u=e.ref({startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),m=e.ref({activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}),p=e.ref([]);function v(){q(),u.value.enablingApproval=!1,a.preStartFlow(t.billType,t.bill.id).then((({ActivityID:e,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:r,NextActivityCandidaters:s})=>{if(m.value.activityID=e,m.value.activityName=l,m.value.activityType=a,m.value.nextActivityID=o,m.value.nextActivityName=n,m.value.nextActivityType=r,1!=s.length&&null!=s)m.value.employeeID=null,m.value.employeeName="";else{const{EmployeeID:e,EmployeeName:t}=s[0];m.value.employeeID=e||null,m.value.employeeName=t||""}m.value.nextActivityCandidaters=s,p.value=s.map((e=>(e.text=e.EmployeeName,e.value=e.EmployeeID,e))),i.value=!0,1==s.length&&t.bill.IsStart||2==r&&t.bill.IsStart?h():z()})).catch((()=>z()))}function h(e){q();const o={ID:t.bill.id,ActivityName:m.value.activityName,ActivityID:m.value.activityID,ActivityType:m.value.activityType,NextActivityName:m.value.nextActivityName,NextActivityID:m.value.nextActivityID,NextActivityType:m.value.nextActivityType,CandidateApprovers:e||m.value.nextActivityCandidaters};a.startFlow(t.billType,o).then((async({ID:e})=>{u.value.startFlow=!1,await A(3e3),f(),await l.emit("getById",e),i.value=!1})).catch((()=>z()))}function f(){m.value={activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}}function g(){l.emit("scrollToTop")}function y(){l.emit("scrollToFooter")}return{deleteDialog:n,approveStartUpDialog:i,approveDialog:r,processTrackDialog:s,processTrackApprovalLog:c,processTrackApprovalTask:d,approvalProcessData:m,approverOption:p,approveStartConfirm:h,approveConfirm:function(e){!function({approvalType:e,refuseType:o,remark:n}){q();const i={ID:t.bill.id,IsPass:e,Remark:n,SupportedStrategies:o,IsAdditionalApproval:!1,AdditionalApprovalEmployeeId:null,ActivityName:m.value.activityName,ActivityID:m.value.activityID,ActivityType:m.value.activityType,NextActivityName:m.value.nextActivityName,NextActivityID:m.value.nextActivityID,NextActivityType:m.value.nextActivityType,CandidateApprovers:m.value.nextActivityCandidaters};a.submitApproval(t.billType,i).then((({ID:e})=>{u.value.startFlow=!1;let t=setTimeout((()=>{f(),l.emit("getById",e),r.value=!1,clearTimeout(t)}),3e3)})).catch((()=>z()))}(e)},handleSaveDraft:function(e){l.emit("save",e)},billDelete:function(){n.value.open()},approvalShow:function(){q(),u.value.enablingApproval=!0,a.prevApproval(t.billType,t.bill.id).then((e=>{const{ActivityID:t,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:s,SupportedStrategies:c}=e[0];m.value.activityID=t,m.value.activityName=l,m.value.activityType=a,m.value.nextActivityID=o,m.value.nextActivityName=n,m.value.nextActivityType=i;const{EmployeeID:d,EmployeeName:u}=null!=s?s[0]:[];m.value.employeeID=null!=s?d:"",m.value.employeeName=null!=s?u:"",m.value.approvalType=1,m.value.refuseType=null!=c&&c.length>0?c[0]:null,m.value.remark="",m.value.nextActivityCandidaters=s,m.value.supportedStrategies=null!=c?c.map((e=>({text:1==e?"打回":2==e?"拒绝":"退回",value:e}))):[],r.value=!0})).finally((()=>z()))},enablingApprovalShow:v,processTrack:function(){q(),a.getFlowTrail(t.billType,t.bill.id).then((({ApprovalLog:e,ApprovalTask:t})=>{c.value=e.reverse(),d.value=t,s.value=!0})).finally((()=>z()))},jumpList:function(){l.emit("jumpList")},sign:function(){const e=function(e){let l="";if(t.consumable){if("RequestDraw"===e)l=207}else switch(e){case"RequestDraw":l=100;break;case"Draw":l=101;break;case"DrawBack":l=102;break;case"Transform":l=103;break;case"RequestDiscard":l=106;break;case"Discard":l=107}return l}(t.billType);uni.navigateTo({url:`/pages/system/signConfirm/signConfirm?type=1&key=${e}&billID=${t.bill.id}`})},deleteDialogConfirm:function(){l.emit("delete")},scrollToTop:g,scrollToFooter:y,fab:o,fabPattern:Rt,fabContent:Lt,fabTrigger:function({index:e}){switch(e){case 0:l.emit("scan");break;case 1:l.emit("keyword");break;case 2:g();break;case 3:y()}o.value.close()}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=e.resolveComponent("StartApprovalProcess"),u=e.resolveComponent("Approval"),m=e.resolveComponent("ProcessTrack"),p=r(e.resolveDynamicComponent("uni-icons"),fe),v=r(e.resolveDynamicComponent("uni-fab"),ul);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"deleteDialog",class:"deleteDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base",type:"error",cancelText:"取消",confirmText:"确认",title:"删除单据",onConfirm:o.deleteDialogConfirm},null,8,["onConfirm"])])),_:1},512),o.approveStartUpDialog?(e.openBlock(),e.createBlock(d,{key:0,approverOption:o.approverOption,approvalProcessData:o.approvalProcessData,onApproveStartConfirm:o.approveStartConfirm,onCloseDialog:l[0]||(l[0]=e=>o.approveStartUpDialog=!1)},null,8,["approverOption","approvalProcessData","onApproveStartConfirm"])):e.createCommentVNode("",!0),o.approveDialog?(e.openBlock(),e.createBlock(u,{key:1,approvalProcessData:o.approvalProcessData,onConfirmApproval:o.approveConfirm,onCloseDialog:l[1]||(l[1]=e=>o.approveDialog=!1)},null,8,["approvalProcessData","onConfirmApproval"])):e.createCommentVNode("",!0),o.processTrackDialog?(e.openBlock(),e.createBlock(m,{key:2,onCloseDialog:l[2]||(l[2]=e=>o.processTrackDialog=!1),processTrackApprovalTask:o.processTrackApprovalTask,processTrackApprovalLog:o.processTrackApprovalLog},null,8,["processTrackApprovalTask","processTrackApprovalLog"])):e.createCommentVNode("",!0),a.nonEditable?(e.openBlock(),e.createElementBlock("view",{key:3,class:"scroll_to"},[e.createElementVNode("view",{onClick:l[3]||(l[3]=(...e)=>o.scrollToTop&&o.scrollToTop(...e))},[e.createVNode(p,{type:"arrow-up",color:"#fff",size:"30"}),e.createElementVNode("br")]),e.createElementVNode("view",{onClick:l[4]||(l[4]=(...e)=>o.scrollToFooter&&o.scrollToFooter(...e))},[e.createVNode(p,{type:"arrow-down",color:"#fff",size:"30"}),e.createElementVNode("br")])])):e.createCommentVNode("",!0),a.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:4,class:"bill_operation_button"},[e.createVNode(v,{ref:"fab",pattern:o.fabPattern,content:o.fabContent,horizontal:"right",vertical:"bottom",direction:"horizontal",onTrigger:o.fabTrigger},null,8,["pattern","content","onTrigger"])])),e.createElementVNode("view",{class:"bill-footer-btn"},[e.createElementVNode("view",{class:"jump_list"},[a.type?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(p,{key:0,onClick:o.jumpList,type:"bars",color:"#007aff",size:"35"},null,8,["onClick"]))]),e.createElementVNode("view",null,[1==a.bill.status||null==a.bill.status?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:l[5]||(l[5]=e=>o.handleSaveDraft(0))},[e.createElementVNode("text",{class:"text-overflow"},"保存草稿")])):e.createCommentVNode("",!0),1==a.bill.status?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:l[6]||(l[6]=(...e)=>o.billDelete&&o.billDelete(...e))},[e.createElementVNode("text",{class:"uni-icon-delete text-overflow"},"删除草稿")])):e.createCommentVNode("",!0),1==a.bill.status||null==a.bill.status?(e.openBlock(),e.createElementBlock("button",{key:2,onClick:l[7]||(l[7]=e=>o.handleSaveDraft(1)),type:"primary",class:"uni-icon-submit"},[e.createElementVNode("text",{class:"text-overflow",style:{color:"#fff"}},"提交")])):e.createCommentVNode("",!0),a.bill.IsApproval?(e.openBlock(),e.createElementBlock("button",{key:3,onClick:l[8]||(l[8]=(...e)=>o.approvalShow&&o.approvalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"},"审批")])):e.createCommentVNode("",!0),a.bill.IsStart&&a.bill.startFlow?(e.openBlock(),e.createElementBlock("button",{key:4,onClick:l[9]||(l[9]=(...e)=>o.enablingApprovalShow&&o.enablingApprovalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"}," 启动审批流 ")])):e.createCommentVNode("",!0),a.bill.FlowPath?(e.openBlock(),e.createElementBlock("button",{key:5,onClick:l[10]||(l[10]=(...e)=>o.processTrack&&o.processTrack(...e))},[e.createElementVNode("text",{class:"text-overflow"},"流程轨迹")])):e.createCommentVNode("",!0),7==a.bill.status?(e.openBlock(),e.createElementBlock("button",{key:6,onClick:l[11]||(l[11]=(...e)=>o.sign&&o.sign(...e))},[e.createElementVNode("text",null,"签字")])):e.createCommentVNode("",!0)])])],64)}],["__scopeId","data-v-c5d047f8"]]);const _s={image:"jpg,jpeg,png",video:"mp4,mov,wmv,avi",all:"jpg,jpeg,png,7z,rar,zip,doc,docx,xls,xlsx,ppt,pptx,txt,pdf,mp4,mov,wmv,avi"};const Ss={components:{UniFilePicker:Zr},props:{nonEditable:{type:Boolean,default:!1},option:{type:Array,default:()=>[]}},emits:["change"],setup(t,l){const a=e.ref([]),o=e.ref(!0);return e.watch(a.value,(e=>{l.emit("change",e)})),e.watch((()=>t.option),(e=>{a.value=t.option})),{files:a,isfiles:o,select:function({tempFilePaths:t}){q(),be.uploadAttachment(t).then((t=>{o.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));a.value.push(...l),e.nextTick((()=>{o.value=!0}))})).finally((()=>z()))},deletefile:function({tempFile:t}){const l=a.value.findIndex((e=>e===t));a.value.splice(l,1),o.value=!1,e.nextTick((()=>{o.value=!0}))},fileExtType:_s,viewAttachmentContent:zt}}};var Is=l(Ss,[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("uni-file-picker"),c=r(e.resolveDynamicComponent("uni-section"),ue);return e.openBlock(),e.createBlock(c,{title:"附件",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[o.isfiles?(e.openBlock(),e.createBlock(s,{key:0,ref:"filePicker",limit:9,disabled:a.nonEditable,"del-icon":!a.nonEditable,"file-mediatype":"all","file-extname":o.fileExtType.all,mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[0]||(l[0]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:o.deletefile,onChange:o.viewAttachmentContent,title:a.nonEditable?"":"最多选择9个附件"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"unload_attachment_button"},[a.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,type:"primary"},"上传附件"))])])),_:1},8,["disabled","del-icon","file-extname","modelValue","onSelect","onDelete","onChange","title"])):e.createCommentVNode("",!0),o.files.length<1?(e.openBlock(),e.createElementBlock("view",{key:1,class:"nothing",style:e.normalizeStyle(`height:calc(100% - ${a.nonEditable?0:86}px)`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)])])),_:1})}]]);const Bs={components:{BillEnclosure:Is,BillFooterBtn:xs},props:{id:String,type:String},setup({id:t,type:l}){const a=e.ref(""),o=e.ref({id:null,status:null,isSubmit:null,code:"",applyPersonnel:{text:h("UserName"),value:h("EmployeeID")},applyCorp:{text:h("OrgName"),value:h("OrgID")},applyDateTime:{hint:"请选择申领日期",value:$l()},applyReason:{hint:"请选择申领原因",text:"",value:null},remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),n=e.ref({name:"",brand:"",spec:"",model:"",qty:1}),i=e.ref([]),r=e.ref([]),s=e.ref(null),c=e.ref([]),d=e.ref(null),u=e.ref("none"),m=e.ref(null),p=e.ref(""),v=e.ref(null),f=e.ref(null),g=e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),y=e.ref(null),w=e.ref(!1),N=e.ref(""),C=e.ref([]),E=e.ref(!1),b=e.ref("");function V(e){q(),vs.goodsList(e).then((({Items:e})=>{c.value=e.map((e=>(e.checked=!1,e))),c.value.length<1?F("未查询到可用资产资料"):d.value.open()})).finally((()=>z()))}function x(e){p.value=e?"新增":"编辑",m.value.open()}function _(){n.value.name="",n.value.brand="",n.value.spec="",n.value.model="",n.value.qty=1,f.value=null,m.value.close()}function I(){y.value.close()}function B(){let e={};e.ID=o.value.id,e.AddOrEdit=o.value.id?2:1,e.IsSubmit=!!o.value.isSubmit,e.RequestDate=o.value.applyDateTime.value,e.RequestDrawReason=o.value.applyReason.value,e.RequesterEmployeeID=o.value.applyPersonnel.value,e.RequesterEmployeeName=o.value.applyPersonnel.text,e.RequesterOrgID=o.value.applyCorp.value,e.RequesterOrgName=o.value.applyCorp.text,e.RequesterOrgNameCN=o.value.applyCorp.text,e.RequesterOrgNameEN=o.value.applyCorp.text,e.Remark=o.value.remark,e.Details=r.value.map(((e,t)=>{let l=e;return l.Sequence=t+1,l})),e.Attachments=C.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),vs.requestDrawSaveDraft(e).then((({Code:e,ID:t})=>{T(t).then((()=>{o.value.IsStart&&(w.value=!0)})),I()})).finally((()=>z()))}function T(e){return q(),vs.requestDrawGetByID(e).then((({BillID:e,Status:t,Code:a,RequestDate:n,RequesterEmployeeID:i,RequesterEmployeeName:s,RequesterOrgID:c,RequesterOrgNameCN:d,RequestDrawReason:u,RequestDrawReasonText:m,Remark:p,Details:v,Attachments:h,FlowInfo:f})=>{o.value.id=e,o.value.status=t,o.value.code=a,o.value.applyDateTime.value=n?n.substring(0,10):"",o.value.applyPersonnel.value=i,o.value.applyPersonnel.text=s,o.value.applyCorp.value=c,o.value.applyCorp.text=d,o.value.applyReason.value=u,o.value.applyReason.text=m,o.value.remark=p,r.value=v,C.value=h.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),E.value=1!=o.value.status&&null!=o.value.status,o.value.IsApproval=f.IsApproval,o.value.IsStart=1!=t&&!f.IsStart&&f.IsEnabledFlow,o.value.FlowPath=1!=t&&f.IsStart&&f.IsEnabledFlow||f.IsSendBack,w.value=!1,l&&"mywork"==l&&!o.value.IsApproval&&et(lt.billDetailBack).then((()=>S()))})).finally((()=>z()))}let A=e.computed((()=>{let e=0;for(let t=0;t<r.value.length;t++)e+=parseInt(r.value[t].qty);return e}));hs.dictionaryGetByCode("D006").then((({Items:e})=>{i.value=e.map((e=>({text:e.ItemText,value:e.ID})))})),t&&T(t),tt(lt.signBack,(()=>T(o.value.id))),uni.getSystemInfo({success:e=>{b.value=e.windowHeight}});let P=e.computed((()=>{let e,t;return(b.value-60)/2>225?(e=225,t=b.value-285):e=t=(b.value-60)/2,{header:e,content:t}}));return{type:l,IsScroll:P,bill:o,billDetail:r,remarkVal:a,rowDetail:n,applyReasonOption:i,applyReasonHandle:function(e){o.value.applyReason.text=i.value.filter((t=>t.value==e))[0].text,o.value.applyReason.value=e},uniSwipeActionItemRightOptions:Ot,isOpened:u,uniSwipeChange:function(e,t){r.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(r.value.splice(t,1),L("移除成功"))},inputDialog:m,openEditDetailDalog:x,dialogRemarkInputConfirm:function(e){o.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:v,openRemarkDialog:function(){a.value=o.value.remark,v.value.open()},editDetailConfirm:function(e){if(n.value.name)if(n.value.qty){if(!/^\+?[1-9][0-9]*$/.test(n.value.qty))return void F("请输入正确的数量");if(null==f.value){const e={Name:n.value.name,Brand:n.value.brand,Spec:n.value.spec,Model:n.value.model,Qty:parseInt(n.value.qty),isOpened:"none"};r.value.push(e)}else r.value[f.value].Name=n.value.name,r.value[f.value].Brand=n.value.brand,r.value[f.value].Spec=n.value.spec,r.value[f.value].Model=n.value.model,r.value[f.value].Qty=parseInt(n.value.qty);_()}else F("请输入数量");else F("请输入资产名称")},editDetailClose:function(){_()},editBillDetail:function(e){if(E&&null!==o.value.status&&1!=o.value.status)return;f.value=e;const{Name:t,Brand:l,Spec:a,Model:i,Qty:s}=r.value[e];n.value.name=t,n.value.brand=l,n.value.spec=a,n.value.model=i,n.value.qty=s,x(0)},deleteDialogConfirm:function(){q(),vs.requestDrawDelete(o.value.id).then((()=>{et(lt.requestDrawDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:_,handleSaveDraft:function(e){if(o.value.isSubmit=e,o.value.applyDateTime.value){if(o.value.applyReason.value)return r.value.length<1?(N.value="listDetail",void F("请添加资产信息")):void(o.value.isSubmit?y.value.open():B());F("请选择申领原因")}else F("请选择申领日期")},submitDialog:y,submitMsgType:g,submitDialogConfirm:B,submitDialogClose:I,editInfoTitle:p,billDetailNumber:A,editGetByID:T,nonEditable:E,autoStart:w,jumpList:function(){k("/subcontract/asset/requestDraw/requestDrawList")},windowHeights:b,scanCodeDialog:s,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?V(t):F("无效的检索条件")},addQuery:V,serachGoodsList:c,goodsDialog:d,goodsDialogConfirm:function(){let e=c.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(r.value.filter((t=>t.GoodsID==e[l].ID)).length<1){let t={ID:null};t.DetailID=e[l].DetailID,t.GoodsID=e[l].ID,t.Code=e[l].Code,t.Name=e[l].Name,t.GoodInfo=[{ID:e[l].ID,Name:e[l].Name,Code:e[l].Code}],t.AssetCategoryName=e[l].AssetCategoryName,t.Brand=e[l].Brand,t.Spec=e[l].Spec,t.Model=e[l].Model,t.isOpened="none",t.Qty=1,r.value.push(t)}else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}d.value.close(),c.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=c.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{V(R(e))}})},applyDateTimeChange:({detail:{value:e}})=>{E.value||(o.value.applyDateTime.value=e)},removeInput:function(e){if("applyDateTime"!=e){if("applyPersonnel"==e)return o.value.applyPersonnel.text="",o.value.applyPersonnel.value=null,o.value.applyCorp.text="",void(o.value.applyCorp.value=null);if("remark"!=e)return"applyReason"==e?(o.value.applyReason.text="",void(o.value.applyReason.value=null)):void 0;o.value.remark=""}else o.value.applyDateTime.value=""},personnelSelect:function(e){tt(lt.employeeSelectBack,(({ID:t,Name:l,OrgID:a,OrgName:n})=>{o.value[e].value=t,o.value[e].text=l,o.value.applyCorp.value=a,o.value.applyCorp.text=n})),k(`pages/selector/system/employee?&multiple=0&ids=${o.value[e].value}`)},files:C,toIndex:N,filesChange:function(e){C.value=e}}}};var Ts=l(Bs,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-easyinput"),Ie),p=r(e.resolveDynamicComponent("uni-icons"),fe),v=r(e.resolveDynamicComponent("uni-data-picker"),rs),h=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),f=r(e.resolveDynamicComponent("uni-swipe-action"),ps),g=r(e.resolveDynamicComponent("uni-section"),ue),y=e.resolveComponent("BillEnclosure"),w=e.resolveComponent("BillFooterBtn");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"goodsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{title:"选择资产资料",type:"info","before-close":!0,onClose:l[0]||(l[0]=e=>o.goodsDialog.close()),onConfirm:o.goodsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachGoodsList,(({ID:t,Name:l,Code:a,AssetCategoryName:n,Brand:i,Spec:r,Model:s,checked:c})=>(e.openBlock(),e.createBlock(d,{key:t},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资料编码："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(s),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,t)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:c},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"edit_detail_content"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.name),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.brand),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.spec),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.model),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"数量：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createVNode(m,{border:!1,maxlength:"10",type:"number",modelValue:o.rowDetail.qty,"onUpdate:modelValue":l[1]||(l[1]=e=>o.rowDetail.qty=e),placeholder:"请输入数量"},null,8,["modelValue"]),e.createElementVNode("text",{class:"required"},"*")])])),_:1})])),_:1})])])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"资产资料搜索",value:"",placeholder:"资产资料编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["onConfirm"])])),_:1},512),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1}),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"申领日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("picker",{mode:"date",onChange:l[2]||(l[2]=(...e)=>o.applyDateTimeChange&&o.applyDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.applyDateTime.value?"content_effective":""])},e.toDisplayString(o.bill.applyDateTime.value?o.bill.applyDateTime.value:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.applyDateTime.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[3]||(l[3]=e=>o.removeInput("applyDateTime")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"申领人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.applyPersonnel.value?"content_effective":""]),onClick:l[4]||(l[4]=e=>o.personnelSelect("applyPersonnel"))},e.toDisplayString(o.bill.applyPersonnel.value?o.bill.applyPersonnel.text:"请选择人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.applyPersonnel.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[5]||(l[5]=e=>o.removeInput("applyPersonnel")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"申领原因：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[o.nonEditable?(e.openBlock(),e.createElementBlock("text",{key:1,class:e.normalizeClass(["item_text_content",o.bill.applyReason.value?"content_effective":""])},e.toDisplayString(o.bill.applyReason.value?o.bill.applyReason.text:"请选择申领原因"),3)):(e.openBlock(),e.createBlock(v,{key:0,class:"data-picker-request-draw",placeholder:"请选择申领原因",border:!1,"clear-icon":!1,localdata:o.applyReasonOption,onInput:o.applyReasonHandle,modelValue:o.bill.applyReason.value,"onUpdate:modelValue":l[6]||(l[6]=e=>o.bill.applyReason.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.applyReason.value?"content_effective":""])},e.toDisplayString(o.bill.applyReason.value?o.bill.applyReason.text:"请选择申领原因"),3)])),_:1},8,["localdata","onInput","modelValue"]))])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.applyReason.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[7]||(l[7]=e=>o.removeInput("applyReason")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.remark?"content_effective":""]),onClick:l[8]||(l[8]=e=>o.nonEditable?null:o.openRemarkDialog())},e.toDisplayString(o.bill.remark?o.bill.remark:"请输入备注信息"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[9]||(l[9]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill_detail_scroll",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),onScroll:l[10]||(l[10]=e=>o.toIndex=""),"scroll-into-view":o.toIndex,"scroll-with-animation":!0,"scroll-y":""},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(g,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(h,{disabled:o.nonEditable,"right-options":o.uniSwipeActionItemRightOptions,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.GoodsID,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["detail_content_item",o.nonEditable?"disabled_color":""]),style:e.normalizeStyle(l+1==o.billDetail.length?"margin-bottom:0px":""),onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("text",{class:"content_item_title",selectable:""},"资产名称："+e.toDisplayString(t.Name),1),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(t.Brand),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(t.Qty),1)])],14,["onClick"])])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1}),o.billDetail.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:"height:100%"}," 暂 无 数 据 ")):e.createCommentVNode("",!0)])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(y,{option:o.files,onChange:o.filesChange,nonEditable:o.nonEditable},null,8,["option","onChange","nonEditable"])],44,["scroll-into-view"]),e.createVNode(w,{type:o.type,billType:"RequestDraw",bill:o.bill,nonEditable:o.nonEditable,autoStart:o.autoStart,onJumpList:o.jumpList,onSave:o.handleSaveDraft,onDelete:o.deleteDialogConfirm,onScrollToTop:l[11]||(l[11]=e=>o.toIndex="listDetail"),onScrollToFooter:l[12]||(l[12]=e=>o.toIndex="example"),onScan:l[13]||(l[13]=e=>o.scan()),onKeyword:l[14]||(l[14]=e=>o.scanCodeDialog.open()),onGetById:l[15]||(l[15]=e=>o.editGetByID(e))},null,8,["type","bill","nonEditable","autoStart","onJumpList","onSave","onDelete"])],64)}]]);var As=l({name:"UniDrawer",components:{},emits:["change"],props:{mode:{type:String,default:""},mask:{type:Boolean,default:!0},maskClick:{type:Boolean,default:!0},width:{type:Number,default:220}},data:()=>({visibleSync:!1,showDrawer:!1,rightMode:!1,watchTimer:null,drawerWidth:220}),created(){uni.getSystemInfo({success:e=>{this.drawerWidth=e.windowWidth}}),this.rightMode="right"===this.mode},methods:{clear(){},close(e){("mask"!==e||this.maskClick)&&this.visibleSync&&this._change("showDrawer","visibleSync",!1)},open(){this.visibleSync||this._change("visibleSync","showDrawer",!0)},_change(e,t,l){this[e]=l,this.watchTimer&&clearTimeout(this.watchTimer),this.watchTimer=setTimeout((()=>{this[t]=l,this.$emit("change",l)}),l?50:300)}}},[["render",function(t,l,a,o,n,i){return n.visibleSync?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass([{"uni-drawer--visible":n.showDrawer},"uni-drawer"]),onTouchmove:l[1]||(l[1]=e.withModifiers(((...e)=>i.clear&&i.clear(...e)),["stop","prevent"]))},[e.createElementVNode("view",{class:e.normalizeClass(["uni-drawer__mask",{"uni-drawer__mask--visible":n.showDrawer&&a.mask}]),onClick:l[0]||(l[0]=e=>i.close("mask"))},null,2),e.createElementVNode("view",{class:e.normalizeClass(["uni-drawer__content",{"uni-drawer--right":n.rightMode,"uni-drawer--left":!n.rightMode,"uni-drawer__content--visible":n.showDrawer}]),style:e.normalizeStyle({width:n.drawerWidth+"px"})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)],34)):e.createCommentVNode("",!0)}],["__scopeId","data-v-ebee8d16"]]);var Ps=l({components:{DrawerAdvancedSearch:As,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(""),d=e.ref(null),u=e.ref({applyCode:{hint:"申领单号",value:null},applyPersonnel:{hint:"申领人员",value:null},applyDateStart:{hint:"申领日期起",value:null},applyDateEnd:{hint:"申领日期止",value:null},code:{hint:"资产资料编码",value:null},name:{hint:"资产名称",value:null},brand:{hint:"品牌",value:null},spec:{hint:"规格",value:null},model:{hint:"型号",value:null},category:{hint:"资产分类",name:"",value:[]},IsEnd:{hint:"是否结束",name:"",value:null,options:[{text:"全部",value:"0"},{text:"是",value:"1"},{text:"否",value:"2"}]}}),m=e.ref(null),v=e.ref(""),h=e.ref("");async function f(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await vs.requestDrawList({qst:t.value,pageNo:l,billCode:u.value.applyCode.value,requestDrawEmployeeName:u.value.applyPersonnel.value,startRequestDrawDate:u.value.applyDateStart.value,EndRequestDrawDate:u.value.applyDateEnd.value,goodsCode:u.value.code.value,goodsName:u.value.name.value,assetCategoryIDs:u.value.category.value,brand:u.value.brand.value,spec:u.value.spec.value,model:u.value.model.value,IsClosed:"0"==u.value.IsEnd.value?"":"1"==u.value.IsEnd.value});a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function g(){return l=1,f()}return f(),tt(lt.requestDrawDetailBack,g),uni.getSystemInfo({success:e=>{v.value=e.windowWidth,h.value=e.windowHeight}}),p((()=>{g()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:g,itemClick:function(e){k(`/subcontract/asset/requestDraw/requestDraw?id=${e}&type=list`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,f())},windowWidths:v,windowHeights:h,advancedInputVal:s,advancedInputKey:c,advancedInputDialog:d,advancedSearch:u,openAdvancedInputDialog:function(e){s.value=u.value[e].value,c.value=e,d.value.open()},removeAdvancedInput:function(e){if("applyCode"!=e&&"applyPersonnel"!=e&&"applyDateStart"!=e&&"applyDateEnd"!=e&&"code"!=e&&"name"!=e&&"brand"!=e&&"spec"!=e&&"model"!=e)return"category"==e?(u.value[e].value=[],void(u.value[e].name=null)):"IsEnd"==e?(u.value[e].value=null,void(u.value[e].name=null)):void 0;u.value[e].value=null},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{u.value[e].value=R(t)}})},conditionReset:function(){u.value.applyCode.value=null,u.value.applyPersonnel.value=null,u.value.applyDateStart.value=null,u.value.applyDateEnd.value=null,u.value.code.value=null,u.value.name.value=null,u.value.brand.value=null,u.value.spec.value=null,u.value.model.value=null,u.value.category.value=[],u.value.category.name=null,u.value.IsEnd.value=null,u.value.IsEnd.name=null},advancedInputConfirm:function(e){u.value[c.value].value=e},categorySelect:function(e){tt(lt.assetCategorySelectBack,(({ids:e,names:t})=>{u.value.category.value=e,u.value.category.name=t})),k(`pages/selector/asset/category?isLast=0&multiple=1&ids=${u.value.category.value}`)},conditionSearchPopup:m,applyDateTimeChange:({detail:{value:e}},t)=>{u.value[t].value=e},IsEndChange:function(e){u.value.IsEnd.name=u.value.IsEnd.options.filter((t=>t.value==e))[0].text,u.value.IsEnd.value=e},querySearch:function(){g(),m.value.close()},billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-list"),Ne),h=e.resolveComponent("DrawerAdvancedSearch"),f=e.resolveComponent("AnchorPointAndQty"),g=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(h,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:o.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-100}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"申领单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.applyCode.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("applyCode"))},e.toDisplayString(o.advancedSearch.applyCode.value?o.advancedSearch.applyCode.value:"申领单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.applyCode.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("applyCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[2]||(l[2]=e=>o.scanInput("applyCode")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"申领人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.applyPersonnel.value?"content_effective":""]),onClick:l[3]||(l[3]=e=>o.openAdvancedInputDialog("applyPersonnel"))},e.toDisplayString(o.advancedSearch.applyPersonnel.value?o.advancedSearch.applyPersonnel.value:"申领人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.applyPersonnel.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[4]||(l[4]=e=>o.removeAdvancedInput("applyPersonnel")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{color:"red",type:"scan",size:"16",style:{opacity:"0"}})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"申领日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[5]||(l[5]=e=>o.applyDateTimeChange(e,"applyDateStart"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.applyDateStart.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.applyDateStart.value?o.advancedSearch.applyDateStart.value:"申领日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.applyDateStart.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("applyDateStart")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"申领日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[7]||(l[7]=e=>o.applyDateTimeChange(e,"applyDateEnd"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.applyDateEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.applyDateEnd.value?o.advancedSearch.applyDateEnd.value:"申领日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.applyDateEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[8]||(l[8]=e=>o.removeAdvancedInput("applyDateEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产资料编码：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.code.value?"content_effective":""]),onClick:l[9]||(l[9]=e=>o.openAdvancedInputDialog("code"))},e.toDisplayString(o.advancedSearch.code.value?o.advancedSearch.code.value:"资产资料编码"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.code.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[10]||(l[10]=e=>o.removeAdvancedInput("code")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[11]||(l[11]=e=>o.scanInput("code")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.name.value?"content_effective":""]),onClick:l[12]||(l[12]=e=>o.openAdvancedInputDialog("name"))},e.toDisplayString(o.advancedSearch.name.value?o.advancedSearch.name.value:"名称"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.name.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[13]||(l[13]=e=>o.removeAdvancedInput("name")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.brand.value?"content_effective":""]),onClick:l[14]||(l[14]=e=>o.openAdvancedInputDialog("brand"))},e.toDisplayString(o.advancedSearch.brand.value?o.advancedSearch.brand.value:"品牌"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.brand.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[15]||(l[15]=e=>o.removeAdvancedInput("brand")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.spec.value?"content_effective":""]),onClick:l[16]||(l[16]=e=>o.openAdvancedInputDialog("spec"))},e.toDisplayString(o.advancedSearch.spec.value?o.advancedSearch.spec.value:"规格"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.spec.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[17]||(l[17]=e=>o.removeAdvancedInput("spec")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.model.value?"content_effective":""]),onClick:l[18]||(l[18]=e=>o.openAdvancedInputDialog("model"))},e.toDisplayString(o.advancedSearch.model.value?o.advancedSearch.model.value:"型号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.model.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[19]||(l[19]=e=>o.removeAdvancedInput("model")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产分类：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.category.value.length>0?"content_effective":""]),onClick:l[20]||(l[20]=e.withModifiers((e=>o.categorySelect("category")),["stop"]))},e.toDisplayString(o.advancedSearch.category.value.length>0?o.advancedSearch.category.name:"资产分类"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.category.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[21]||(l[21]=e=>o.removeAdvancedInput("category")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"是否结束：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{class:"data-picker-request-draw",placeholder:"是否结束",border:!1,"clear-icon":!1,localdata:o.advancedSearch.IsEnd.options,onInput:o.IsEndChange,modelValue:o.advancedSearch.IsEnd.value,"onUpdate:modelValue":l[22]||(l[22]=e=>o.advancedSearch.IsEnd.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.IsEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.IsEnd.value?o.advancedSearch.IsEnd.name:"是否结束"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.IsEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[23]||(l[23]=e=>o.removeAdvancedInput("IsEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[24]||(l[24]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[25]||(l[25]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[26]||(l[26]=e=>o.conditionSearchPopup.close())},"关闭")])])])),_:1},8,["width"]),e.createVNode(f,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[27]||(l[27]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(g,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[28]||(l[28]=e=>o.qst=e),placeholder:"单号",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[29]||(l[29]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[30]||(l[30]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({Status:t,StatusText:l,BillCode:a,BillDateTime:n,BillerEmployeeName:i,RequestDate:r,RequesterEmployeeName:s,RequestOrgName:c,RequestReasonText:d,IsClosedText:u,ID:m,Remark:p})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:m,onClick:e=>o.itemClick(m)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(l),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(l),1),e.createElementVNode("text",null,"申领人员："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申领日期："+e.toDisplayString(r?r.substring(0,10):""),1),e.createElementVNode("text",null,"申领部门："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申领原因："+e.toDisplayString(d),1),e.createElementVNode("text",null,"是否结束："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(i),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(p),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[31]||(l[31]=e=>o.conditionSearchPopup.open())},"高级搜索")])],64)}]]);var Os=new class extends Ee{assetGetByID(e){return this.request("/Asset/GetByID",{ID:e,Visibility:1})}requestRepairSubmit(e,t,l){const a={AssetId:e,AssetPics:l,RequestReason:t};return this.request("/Bill/RequestRepair/Submit",a)}repairList(e,t){const l={PageNO:t,PageSize:20,QST:e};return this.request("/Bill/Repair/List",l)}assetListQueryByBillType(e){const t={BillType:8,Conditions:[],PageNO:1,PageSize:10,QST:e};return this.request("/Asset/List/QueryByBillType",t)}};var Rs=l({components:{AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(null),c=yl(),d=e.ref(null),u=e.ref([]);async function m(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await Os.repairList(t.value,l);a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function v(){return l=1,m()}function h(e){e?(q(),Os.assetListQueryByBillType(e).then((({Items:e})=>{u.value=e,u.value.length<1?F("暂未查询到可用资产"):d.value.open()})).finally((()=>z()))):F("无效数据,请重新检索")}m(),tt(lt.repairRequestDetailBack,v),p((()=>{v()}));const f=e.ref("");return uni.getSystemInfo({success:e=>{f.value=e.windowHeight}}),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:v,itemClick:function(e){const t=o.value.filter((t=>t.AssetID==e));c.commit("repairRecord/setrepairRecordInfo",t),k("../record/list")},fastRepair:function(){uni.scanCode({success(e){h(R(e.result))},fail(){}})},assetDialog:d,assetDialogList:u,assetDialogClose:function(){d.value.close()},serachAssetInfo:h,jumpRepair:function(e){d.value.close(),k(`subcontract/asset/repair/request/repairRequestDetail?id=${e}`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,m())},manualInput:s,inputkeyword:function(){s.value.open()},searchQuery:function(e){h(e)},windowHeights:f}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("AnchorPointAndQty"),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl),u=r(e.resolveDynamicComponent("uni-list-item"),we),m=r(e.resolveDynamicComponent("uni-list"),Ne),p=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),v=r(e.resolveDynamicComponent("uni-easyinput"),Ie),h=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(s,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-115,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createElementVNode("view",{class:"manualInput"},[e.createVNode(d,{ref:"manualInput",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{mode:"input",title:"输入编码检索",placeholder:"输入编码检索",onConfirm:o.searchQuery},null,8,["onConfirm"])])),_:1},512)]),e.createVNode(d,{ref:"assetDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(p,{title:"选择资产",onClose:o.assetDialogClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(m,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetDialogList,(({ID:t,Code:l,AssetStatusText:a,Name:n,CategoryName:i,LocationName:r})=>(e.openBlock(),e.createBlock(u,{key:t,onClick:e=>o.jumpRepair(t),link:""},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},"资产编码："+e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产状态："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产名称："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"存放位置："+e.toDisplayString(r),1)])])])])),_:2},1032,["onClick"])))),128))])),_:1})],4)])),_:1},8,["onClose"])])),_:1},512),e.createVNode(v,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[1]||(l[1]=e=>o.qst=e),placeholder:"编码/名称",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-115}px`),onScrolltolower:l[2]||(l[2]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[3]||(l[3]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({AssetCategoryName:t,LocationName:l,RequestCode:a,RequestRepairDatetime:n,Model:i,Qty:r,AssetCode:s,OperatorEmployeeName:c,AssetName:d,Brand:u,Space:m,AssetID:p,RequestReason:v})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:p,onClick:e=>o.itemClick(p)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold"},e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",{selectable:""},"报修单号："+e.toDisplayString(a),1),e.createElementVNode("text",{selectable:""},"资产编码："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"报修人员："+e.toDisplayString(c),1),e.createElementVNode("text",null,"报修日期："+e.toDisplayString(n?n.substring(0,10):""),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(u),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(i),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"资产分类："),e.createElementVNode("text",null,e.toDisplayString(t),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(l),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-115}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"list_footer_button"},[e.createElementVNode("view",{class:"center",onClick:l[4]||(l[4]=(...e)=>o.inputkeyword&&o.inputkeyword(...e))},[e.createVNode(h,{type:"compose",color:"#2979ff",size:"26"}),e.createElementVNode("text",null,"手动输入报修")]),e.createElementVNode("view",{class:"center",onClick:l[5]||(l[5]=(...e)=>o.fastRepair&&o.fastRepair(...e))},[e.createVNode(h,{type:"scan",color:"#2979ff",size:"26"}),e.createElementVNode("text",null,"扫码查询报修")])])],64)}]]);const Ls={components:{UniFilePicker:Zr},props:{id:String},setup({id:t}){const l=e.ref({}),a=e.ref([]),o=e.ref(!0),n=e.ref(""),i=e.ref("");return q(),Os.assetGetByID(t).then((({Asset:e})=>{l.value=e,l.value.AssetPictureUrl=l.value.AssetPictureUrl?D(e.AssetPictureUrl):"/static/images/zw.png"})).finally((()=>z())),uni.getSystemInfo({success:e=>{i.value=e.windowHeight}}),{assetInfo:l,repairConfirm:function(){n.value?(q(),Os.requestRepairSubmit(t,n.value,a.value).then((()=>{L("报修成功"),et(lt.repairRequestDetailBack).then((()=>S()))})).finally((()=>z()))):F("请输入报修原因")},repairReason:n,repairCancel:function(){S()},windowHeights:i,previewSingleImg:function(e){"/static/images/zw.png"!=l.value.AssetPictureUrl&&Pt(l.value.AssetPictureUrl)},files:a,isfiles:o,select:function({tempFilePaths:t}){q(),be.uploadImage(t).then((t=>{o.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));a.value.push(...l),e.nextTick((()=>{o.value=!0}))})).finally((()=>z()))},deletefile:function({tempFile:t}){const l=a.value.findIndex((e=>e===t));a.value.splice(l,1),o.value=!1,e.nextTick((()=>{o.value=!0}))}}}};var Fs=l(Ls,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-section"),ue),c=r(e.resolveDynamicComponent("uni-list-item"),we),d=r(e.resolveDynamicComponent("uni-easyinput"),Ie),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("view",{class:"content",style:e.normalizeStyle(`height:${o.windowHeights-10}px`)},[e.createElementVNode("view",{class:"content_region"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-140}px`),"scroll-y":""},[e.createVNode(s,{title:"资产信息",type:"line"}),e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(c,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item"},[e.createElementVNode("view",{class:"list-item-header"},[e.createElementVNode("view",null,[e.createElementVNode("img",{src:o.assetInfo.AssetPictureUrl,onClick:l[0]||(l[0]=(...e)=>o.previewSingleImg&&o.previewSingleImg(...e)),alt:""},null,8,["src"])]),e.createElementVNode("view",null,[e.createElementVNode("view",null,[e.createTextVNode("资产编码："),e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.Code),1)]),e.createElementVNode("view",null,[e.createTextVNode("原编码："),e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.OriginalCode),1)]),e.createElementVNode("view",null,[e.createTextVNode("设备序列号："),e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.SN),1)]),e.createElementVNode("view",null,"资产状态："+e.toDisplayString(o.assetInfo.AssetStatusText),1),e.createElementVNode("view",null,"资产名称："+e.toDisplayString(o.assetInfo.Name),1)])])])])),_:1}),e.createVNode(c,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"width-fill"},[e.createElementVNode("view",{class:"list-item-colum"},[e.createElementVNode("view",null,"品牌："+e.toDisplayString(o.assetInfo.Brand),1),e.createElementVNode("view",null,"规格："+e.toDisplayString(o.assetInfo.Space),1)]),e.createElementVNode("view",{class:"list-item-colum"},[e.createElementVNode("view",null,"型号："+e.toDisplayString(o.assetInfo.Model),1),e.createElementVNode("view",null,"计量单位："+e.toDisplayString(o.assetInfo.Unit),1)]),e.createElementVNode("view",{class:"list-item-colum"},[e.createElementVNode("view",null,"管理部门："+e.toDisplayString(o.assetInfo.KAOName),1),e.createElementVNode("view",null,"管理人员："+e.toDisplayString(o.assetInfo.KAEName),1)]),e.createElementVNode("view",{class:"list-item-colum"},[e.createElementVNode("view",null,"使用部门："+e.toDisplayString(o.assetInfo.UAOName),1),e.createElementVNode("view",null,"使用人员："+e.toDisplayString(o.assetInfo.UAEName),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("view",null,"资产分类："+e.toDisplayString(o.assetInfo.CategoryName),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("view",null,"存放位置："+e.toDisplayString(o.assetInfo.LocationName),1)])])])),_:1}),e.createVNode(c,null,{header:e.withCtx((()=>[e.createElementVNode("text",{class:"list-item-title"},"报修原因：")])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item-textarea"},[e.createVNode(d,{type:"textarea",onFocus:t.textareaFocus,onBlur:t.textareaBlur,modelValue:o.repairReason,"onUpdate:modelValue":l[1]||(l[1]=e=>o.repairReason=e),maxlength:"400",autoHeight:"",placeholder:"请输入报修原因"},null,8,["onFocus","onBlur","modelValue"])])])),_:1})])),_:1}),e.createVNode(s,{title:"资产图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(m,{ref:"filePicker",limit:9,"file-mediatype":"image","file-extname":"jpg,jpeg,png",mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[2]||(l[2]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:o.deletefile},null,8,["modelValue","onSelect","onDelete"])])),_:1})],4)])],4),e.createElementVNode("view",{class:"colum_confirm_cancel"},[e.createElementVNode("button",{type:"primary",onClick:l[3]||(l[3]=(...e)=>o.repairConfirm&&o.repairConfirm(...e))},"确定"),e.createElementVNode("button",{onClick:l[4]||(l[4]=(...e)=>o.repairCancel&&o.repairCancel(...e))},"取消")])],64)}],["__scopeId","data-v-8eb92992"]]);var qs=new class extends Ee{borrowListByCode(e){const t={BillType:4,PageSize:10,PageNO:1,QST:e,Conditions:[]};return this.request("/Asset/List/QueryByBillType",t)}borrowList(e,t){const l={BillType:4,PageSize:20,PageNO:t,QST:e,Conditions:[]};return this.request("/Asset/List/QueryByBillType",l)}returnQuickly(e,t){const l={AssetID:e,BorrowerEmployeeID:t};return this.request("/Bill/Return/Quickly",l)}returnList(e){const t={BillType:5,Conditions:[],PageNO:1,PageSize:10,QST:e};return this.request("/Asset/List/QueryByBillType",t)}borrowQuickly(e,t,l){const a={AssetID:e,BorrowerEmployeeID:t,PlanedReturnDate:l};return this.request("/Bill/Borrow/Quickly",a)}};var zs=l({setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]);function n(){q(),qs.borrowList(t.value,l).then((({PageCount:e,Items:t})=>{a=e,o.value=1===l?t:o.value.concat(t),uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()})).finally((()=>z()))}function i(){l=1,n()}uni.showNavigationBarLoading(),n(),p((()=>{i()}));const r=e.ref("");return uni.getSystemInfo({success:e=>{r.value=e.windowHeight}}),{qst:t,list:o,refreshList:i,itemClick:function(e){k(`subcontract/asset/assetInfo/assetView?id=${e}&handle=1`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,n())},windowHeights:r}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-easyinput"),Ie),c=r(e.resolveDynamicComponent("uni-list-item"),we),d=r(e.resolveDynamicComponent("uni-list"),Ne);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(s,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[0]||(l[0]=e=>o.qst=e),placeholder:"编码/名称",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("scroll-view",{class:"can-borrow-list",style:e.normalizeStyle(`height:${o.windowHeights-36}px`),onScrolltolower:l[1]||(l[1]=(...e)=>o.reachBottom&&o.reachBottom(...e)),"scroll-y":""},[e.createVNode(d,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({AssertStatusText:t,Code:l,Name:a,LocationName:n,AssetCategoryName:i,SN:r,SapCorpName:s,AssertAttributeText:d,Qty:u,ID:m})=>(e.openBlock(),e.createBlock(c,{link:"",key:m,onClick:e=>o.itemClick(m)},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item"},[e.createElementVNode("text",{class:"list-item-title",selectable:""},e.toDisplayString(a),1),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"资产状态："+e.toDisplayString(t),1),e.createElementVNode("text",{selectable:""},"资产编码："+e.toDisplayString(l),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(i),1),e.createElementVNode("text",null,"存放位置："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{selectable:""},"设备序列号："+e.toDisplayString(r),1),e.createElementVNode("text",null,"SAP公司："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"资产性质："+e.toDisplayString(d),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(u),1)])])])),_:2},1032,["onClick"])))),128))])),_:1})],36)],64)}],["__scopeId","data-v-05f3bea2"]]);var Us=l({props:{id:String},setup({id:t}){const l=e.ref({name:h("UserName"),value:h("EmployeeID")}),a=e.ref({hint:"请选择归还日期",value:""});const o=e.ref(null),n=e.ref([]);function i(e){e?(q(),qs.borrowListByCode(e).then((({Items:e})=>{n.value=e,n.value.length<1?F("暂未查询到可用资产"):o.value.open()})).finally((()=>z()))):F("无效数据,请重新检索")}function r(){o.value.close()}const s=e.ref({id:null,code:"",name:"",categoryName:"",locationName:"",brand:"",spec:"",model:"",assetPics:[]});const c=e.ref(null);function d(){c.value.close()}const u=e.ref("");return uni.getSystemInfo({success:e=>{u.value=e.windowHeight}}),t&&(q(),be.getById(t).then((({Asset:e,AssetPics:t})=>{const{ID:l,Code:a,Name:o,CategoryName:n,LocationName:i,Brand:r,Spec:c,Model:d}=e;s.value.id=l,s.value.code=a,s.value.name=o,s.value.categoryName=n,s.value.locationName=i,s.value.brand=r,s.value.spec=c,s.value.model=d,null!=t&&t.length>0?s.value.assetPics=t.map(((e,t)=>(e.FileUrl=D(e.FileUrl),e))):s.value.assetPics=[{FileUrl:"/static/images/zw.png"}]})).finally((()=>z()))),{returnPersonnel:l,returnDate:a,retrievalAsset:function(){uni.scanCode({success(e){i(R(e.result))},fail(){}})},availableAssetInfo:i,assetDialog:o,assetDialogList:n,assetDialogClose:r,windowHeights:u,selectAsset:function(e){q(),be.getById(e).then((({Asset:e,AssetPics:t})=>{const{ID:l,Code:a,Name:o,AssetCategoryName:n,LocationName:i,Brand:r,Spec:c,Model:d}=e;s.value.id=l,s.value.code=a,s.value.name=o,s.value.categoryName=n,s.value.locationName=i,s.value.brand=r,s.value.spec=c,s.value.model=d,s.value.assetPics=t,null!=t&&t.length>0?s.value.assetPics=s.value.assetPics.map(((e,t)=>(e.FileUrl=D(e.FileUrl),e))):s.value.assetPics=[{FileUrl:"/static/images/zw.png"}]})).finally((()=>z())),r()},assetInfo:s,borrowSubmit:function(){a.value.value?s.value.id?c.value.open():F("请检索借用资产"):F("请选择归还日期")},submitDialog:c,submitDialogConfirm:function(){q(),qs.borrowQuickly(s.value.id,l.value.value,a.value.value).then((()=>{L("借用成功"),s.value={},a.value.value="",d(),z(),et(lt.borrowBack).then((()=>S()))})).finally((()=>z()))},submitDialogClose:d,goBack:function(){S()},previewImg:function(e){(e||"/static/images/zw.png"!=s.value.assetPics[e].FileUrl)&&At(s.value.assetPics.map((e=>e.FileUrl)),e)},removeInput:function(e){"returnDate"==e?a.value.value="":s.value={id:null,code:"",name:"",categoryName:"",locationName:"",brand:"",spec:"",model:"",assetPics:[]}},returnDateChange:({detail:{value:e}})=>{a.value.value=e}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),p=r(e.resolveDynamicComponent("uni-section"),ue),v=r(e.resolveDynamicComponent("uni-icons"),fe),h=r(e.resolveDynamicComponent("uni-grid-item"),me),f=r(e.resolveDynamicComponent("uni-grid"),ve);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"submitDialog",class:"submit-dialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:"info",cancelText:"取消",confirmText:"确认",content:"确认借用资产?",onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"assetDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(m,{title:"选择资产",onClose:o.assetDialogClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetDialogList,(({ID:t,Code:l,AssertStatusText:a,Name:n,AssetCategoryName:i,LocationName:r})=>(e.openBlock(),e.createBlock(d,{key:t,link:""},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item",onClick:e=>o.selectAsset(t)},[e.createElementVNode("text",{class:"retrieval_item_title"},"资产编码："+e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产状态："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产名称："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"存放位置："+e.toDisplayString(r),1)])],8,["onClick"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onClose"])])),_:1},512),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"content_list",style:e.normalizeStyle(`height:${o.windowHeights-150}px`)},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-150}px`),"scroll-y":""},[e.createVNode(p,{title:"资产信息",type:"line"}),e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"借用人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.returnPersonnel.name),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"预计归还日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("picker",{mode:"date",onChange:l[0]||(l[0]=(...e)=>o.returnDateChange&&o.returnDateChange(...e))},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.returnDate.value?o.returnDate.value:"请选择日期"),1)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[o.returnDate.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[1]||(l[1]=e=>o.removeInput("returnDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"资产编码：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.code?o.assetInfo.code:"请扫码查询"),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.assetInfo.code?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[e.createVNode(v,{onClick:l[2]||(l[2]=e=>o.removeInput("code")),type:"close",size:"16"})])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content_delete_icon"},[e.createElementVNode("view",null,[e.createVNode(v,{onClick:o.retrievalAsset,color:"blue",type:"scan",size:"16"},null,8,["onClick"])])]))])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"资产名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.name),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"资产分类：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.categoryName),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.locationName),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.brand),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.spec),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.model),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})]),e.createVNode(p,{title:"资产图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(f,{column:3,highlight:!0},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetInfo.assetPics,((t,l)=>(e.openBlock(),e.createBlock(h,{key:t.ID},{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",src:t.FileUrl,mode:"scaleToFill",onClick:e=>o.previewImg(l)},null,8,["src","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})],4)],4)]),e.createElementVNode("view",{class:"colum_confirm_cancel"},[e.createElementVNode("button",{type:"primary",onClick:l[3]||(l[3]=(...e)=>o.borrowSubmit&&o.borrowSubmit(...e))},"借用"),e.createElementVNode("button",{onClick:l[4]||(l[4]=(...e)=>o.goBack&&o.goBack(...e))},"取消")])],64)}],["__scopeId","data-v-33eb9967"]]);var Ms=l({setup(){const t=e.ref({name:h("UserName"),value:h("EmployeeID")});const l=e.ref(null),a=e.ref([]);function o(e){e?(q(),qs.returnList(e).then((({Items:e})=>{a.value=e,a.value.length<1?F("暂未查询到可用资产"):l.value.open()})).finally((()=>z()))):F("无效数据,请重新检索")}function n(){l.value.close()}const i=e.ref({id:null,code:"",name:"",categoryName:"",locationName:"",brand:"",space:"",model:""});const r=e.ref(null);function s(){r.value.close()}function c(){S()}const d=e.ref("");return uni.getSystemInfo({success:e=>{d.value=e.windowHeight}}),{returnPersonnel:t,retrievalAsset:function(){uni.scanCode({success(e){o(R(e.result))},fail(){}})},availableAssetInfo:o,assetDialog:l,assetDialogList:a,assetDialogClose:n,windowHeights:d,selectAsset:function(e){const{ID:t,Code:l,Name:o,CategoryName:r,LocationName:s,Brand:c,Spec:d,Model:u,AssetPics:m}=a.value.filter((t=>t.ID==e))[0];i.value.id=t,i.value.code=l,i.value.name=o,i.value.categoryName=r,i.value.locationName=s,i.value.brand=c,i.value.spec=d,i.value.model=u,i.value.assetPics=m,null!=m&&m.length>0?i.value.assetPics=i.value.assetPics.map(((e,t)=>(e.FileUrl=D(e.FileUrl),e))):i.value.assetPics=[{FileUrl:"/static/images/zw.png"}],n()},assetInfo:i,borrowSubmit:function(){i.value.id?r.value.open():F("请检索归还资产")},submitDialog:r,submitDialogConfirm:function(){q(),qs.returnQuickly(i.value.id,t.value.value).then((()=>{L("归还成功"),i.value={},s(),z(),c()})).finally((()=>z()))},submitDialogClose:s,goBack:c,previewImg:function(e){(e||"/static/images/zw.png"!=i.value.assetPics[e].FileUrl)&&At(i.value.assetPics.map((e=>e.FileUrl)),e)},removeInput:function(){i.value={id:null,code:"",name:"",categoryName:"",locationName:"",brand:"",spec:"",model:"",assetPics:[]}}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),p=r(e.resolveDynamicComponent("uni-section"),ue),v=r(e.resolveDynamicComponent("uni-icons"),fe),h=r(e.resolveDynamicComponent("uni-grid-item"),me),f=r(e.resolveDynamicComponent("uni-grid"),ve);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:"info",cancelText:"取消",confirmText:"确认",content:"确认归还资产?",onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"assetDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(m,{title:"选择资产",onClose:o.assetDialogClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetDialogList,(({ID:t,Code:l,AssertStatusText:a,Name:n,AssetCategoryName:i,LocationName:r})=>(e.openBlock(),e.createBlock(d,{key:t,link:""},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item",onClick:e=>o.selectAsset(t)},[e.createElementVNode("text",{class:"retrieval_item_title"},"资产编码："+e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产状态："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产名称："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"存放位置："+e.toDisplayString(r),1)])],8,["onClick"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onClose"])])),_:1},512),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"content_list",style:e.normalizeStyle(`height:${o.windowHeights-150}px`)},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-150}px`),"scroll-y":""},[e.createVNode(p,{title:"资产信息",type:"line"}),e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"归还人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.returnPersonnel.name),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"资产编码：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.code?o.assetInfo.code:"请扫码查询"),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.assetInfo.code?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[e.createVNode(v,{onClick:l[0]||(l[0]=e=>o.removeInput("code")),type:"close",size:"16"})])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content_delete_icon"},[e.createElementVNode("view",null,[e.createVNode(v,{onClick:o.retrievalAsset,color:"blue",type:"scan",size:"16"},null,8,["onClick"])])]))])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"资产名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.name),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"资产分类：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.categoryName),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.locationName),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.brand),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.spec),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content"},[e.createElementVNode("text",null,e.toDisplayString(o.assetInfo.model),1)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})]),e.createVNode(p,{title:"资产图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(f,{column:3,highlight:!0},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetInfo.assetPics,((t,l)=>(e.openBlock(),e.createBlock(h,{key:t.ID},{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",src:t.FileUrl,mode:"scaleToFill",onClick:e=>o.previewImg(l)},null,8,["src","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})],4)],4)]),e.createElementVNode("view",{class:"colum_confirm_cancel"},[e.createElementVNode("button",{type:"primary",onClick:l[1]||(l[1]=(...e)=>o.borrowSubmit&&o.borrowSubmit(...e))},"归还"),e.createElementVNode("button",{onClick:l[2]||(l[2]=(...e)=>o.goBack&&o.goBack(...e))},"取消")])],64)}],["__scopeId","data-v-012266fc"]]);var Ws=new class extends Ee{employeeList(e){return this.request("/Inventory/EmployeeTask/Mine/WaitingProcess/ListByEmployee",{PageNO:1,PageSize:10,QST:e,Type:"phone"})}manageUserList(e){return this.request("/Inventory/List",{QST:e,Title:e,PageSize:999,PageNO:1,Type:"phone"})}detailByEmployee(e){return this.request("/Inventory/EmployeeTask/Mine/WaitingProcess/DetailByEmployee",e)}submitEmployeeTask(e,t,l){return this.request("/Inventory/EmployeeTask/Mine/WaitingProcess/SubmitByEmployee",{TaskID:e,EmployeeTaskID:t,Assets:l})}inventoryCorpTaskDetail(e,t){let l="/Inventory/CorpTask/Detail";return"1"==t&&(l="/Inventory/CorpTask/Detail"),"2"==t&&(l="/Inventory/EmployeeTask/Detail",e.EmployeeSummary=""),"3"==t&&(l="/Inventory/GroupTask/Detail",e.ShowMode=2),"4"==t&&(l="/Inventory/SpotInventory/Detail"),this.request(l,e)}inventoryGetAssetByCode(e,t){const l={TaskId:e,PageNO:1,PageSize:10,Code:t};return this.request("/Inventory/GetAssetByCode",l)}pDAInventorySubmitCheckAsset(e,t,l,a,o,n,i,r){const s={SubmitTaskAssetDTO:{AssetId:e,AssetPics:t,Id:l,LocationCode:"",Qty:a,Remark:o,StockCheckConfirmDesc:n,StockStatus:i,TaskId:r,UAOCode:""}};return this.request("/PDA/Inventory/SubmitCheckAsset",s)}pDAInventoryAssetRegister(e,t,l,a,o,n,i,r,s,c,d){const u={AssetPictures:e,InventoryTaskAsset:{CorpID:t,AssetId:null,TaskId:l,OriginalCode:n,Name:a,Code:o,Brand:i,Spec:r,Model:s,Qty:c,ActualQty:c,StockCheckStatus:5,StockCheckDesc:d}};return this.request("/PDA/Inventory/AssetRegister",u)}};var $s=l({components:{AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(0);async function c(){q(),uni.showNavigationBarLoading();const{PageCount:e,Items:i,TotalRecordQty:r}=await Ws.employeeList(t.value,l);a=e,o.value=1===l?i:o.value.concat(i),n.value=r,z(),uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}return c(),tt(lt.employeeInvDetailBack,c),uni.getSystemInfo({success:e=>{s.value=e.windowHeight}}),p((()=>{l=1,c()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},search:c,itemClick:function(e,t,l,a){k(`./detail?id=${e}&code=${l}&employeeTaskID=${a}&title=${t=decodeURIComponent(t)}`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),showErrorToast("暂无更多数据")):(++l,c())},windowHeights:s}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("AnchorPointAndQty"),c=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(s,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(c,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[1]||(l[1]=e=>o.qst=e),placeholder:"盘点主题/盘点单号",onIconClick:o.search,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.search,onClear:o.search},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-46}px`),onScrolltolower:l[2]||(l[2]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[3]||(l[3]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({Title:t,WaitingCheck:l,AlreadyCheck:a,BillerEmployeeName:n,BillDatetime:i,TaskCode:r,TaskID:s,AllQty:c,EmployeeTaskID:d})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:s,onClick:e=>o.itemClick(s,t,r,d)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold"},e.toDisplayString(t),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",{selectable:""},"盘点单号："+e.toDisplayString(r),1),e.createElementVNode("text",null,"待盘人数："+e.toDisplayString(l),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"应盘人数："+e.toDisplayString(c),1),e.createElementVNode("text",null,"实盘人数："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"创建人："+e.toDisplayString(n),1),e.createElementVNode("text",null,"创建时间："+e.toDisplayString(i),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])])],64)}],["__scopeId","data-v-f418ce54"]]);var Qs=l({components:{AnchorPointAndQty:Tt},props:{id:String,code:String,title:String,employeeTaskID:String},setup({id:t,employeeTaskID:l}){const a=e.ref([]),o=e.ref(0),n=e.ref(""),r=e.ref(0),s=yl(),c={ok:"正常",lack:"缺失"},d=e.ref(null),u=e.ref(null),m=e.ref(0);function p(e){s.commit("inventory/setEmployeeItem",e),k("./stockConfirm")}function v(e){if(""==e)return void F("资产编码为空");const t=a.value.filter((t=>t.Code===e));0!==t.length?p(t[0]):F(`【${e}】在当前盘点任务中不存在`)}function h(){q(),Ws.submitEmployeeTask(t,l,a.value).then((()=>{et(lt.employeeInvDetailBack).then((()=>S()))})).finally((()=>z()))}return q(),Ws.detailByEmployee(t).then((e=>{a.value=e})).finally((()=>z())),uni.getSystemInfo({success:e=>{i("log","at subcontract/asset/inventory/employee/detail.vue:194",e),m.value=e.windowHeight}}),tt(lt.employeeStockConfirmBack,(function(e,t,l,a){e.StockConfirmResultText=t===e.Qty?c.ok:c.lack,e.ActualQty=t,e.StockCheckDesc=l,e.AssetPics=a})),{list:a,toIndex:n,totalQty:o,scroll:function({detail:e}){r.value=e.scrollTop,n.value=""},scrollTopDistance:r,itemClick:function(e){k(`subcontract/asset/assetInfo/assetView?id=${e}&type=list`)},stockConfirm:p,getColor:function(e){return e===c.ok?"success-background":"warning-background"},confirmResult:c,inputCodeDialog:d,inputCodeConfirm:v,scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{v(R(e))}})},save:h,saveDialog:u,saveDialogConfirm:function(){h()},previewFiles:function(e,t){At(e.map((e=>D(e.FileUrl))),t)},getFileUrl:D,windowHeights:m}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("AnchorPointAndQty"),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl),u=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(s,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(d,{ref:"saveDialog",class:"saveDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base",type:"info",cancelText:"取消",confirmText:"确认",title:"盘点结束",content:"保存后，视为资产盘点结束；未盘点到的资产视为缺失。确定要保存吗？",onConfirm:o.saveDialogConfirm},null,8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"inputCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{mode:"input",title:"输入资产编码检索资产",value:"",placeholder:"输入资产编码",onConfirm:o.inputCodeConfirm},null,8,["onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",{class:"title-left bold"},[e.createElementVNode("text",{class:"text-ellipsis title-left-width",selectable:""}," 盘点单号："+e.toDisplayString(a.code),1),e.createElementVNode("text",{class:"text-ellipsis title-left-width",selectable:""}," 盘点主题："+e.toDisplayString(a.title),1)]),e.createElementVNode("view",{class:"title-right"},[e.createElementVNode("view",null,"条数："+e.toDisplayString(o.list.length),1),e.createElementVNode("button",{type:"primary",class:"center",onClick:l[1]||(l[1]=e=>o.saveDialog.open())}," 保存 ")])]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-138}px`),onScrolltolower:l[2]||(l[2]=(...e)=>t.reachBottom&&t.reachBottom(...e)),onScroll:l[3]||(l[3]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({TaskAssetID:t,Code:l,Name:a,OriginalCode:n,Brand:i,Spec:r,Model:s,Qty:c,ActualQty:d,AssetPics:u,StockCheckDesc:m,AssetPictureUrl:p,KAOName:v,KAEName:h,UAOName:f,UAEName:g,LocationName:y,StockConfirmResultText:w,InventoryModel:N},C)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:t,onClick:e=>o.itemClick(t)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold"},e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",{selectable:""},"资产编码："+e.toDisplayString(l),1),e.createElementVNode("text",{selectable:""},"原编码："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"管理部门："+e.toDisplayString(v),1),e.createElementVNode("text",null,"管理人员："+e.toDisplayString(h),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"使用部门："+e.toDisplayString(f),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(g),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(y),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("view",{class:"bold black-character confirm_results"},[e.createTextVNode(" 确认结果： "),e.createElementVNode("text",{style:{width:"50px"},class:e.normalizeClass(`confirm-tag ${o.getColor(w)}`)},e.toDisplayString(null!=w?w:o.confirmResult.lack),3)]),1===N?(e.openBlock(),e.createElementBlock("view",{key:0},[e.createElementVNode("button",{class:"btn-confirm center",onClick:e.withModifiers((e=>o.stockConfirm(o.list[C])),["stop"])}," 点击确认结果 ",8,["onClick"])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"实盘数："+e.toDisplayString(d),1),e.createElementVNode("text",null,"盘点说明："+e.toDisplayString(m),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-138}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"list_footer_button"},[e.createElementVNode("view",{class:"center",onClick:l[4]||(l[4]=e=>o.inputCodeDialog.open())},[e.createVNode(u,{type:"compose",color:"#2979ff",size:"26"}),e.createElementVNode("text",null,"手动输入编码")]),e.createElementVNode("view",{class:"center",onClick:l[5]||(l[5]=(...e)=>o.scan&&o.scan(...e))},[e.createVNode(u,{type:"scan",color:"#2979ff",size:"26"}),e.createElementVNode("text",null,"扫码查资产")])])],64)}],["__scopeId","data-v-858b2994"]]);const js={components:{UniFilePicker:Zr},setup(){var t;const l=yl().state.inventory.employee.item,a=e.reactive({actualQty:null!=(t=l.ActualQty)?t:l.Qty,stockCheckDesc:l.StockCheckDesc}),o=e.ref(null),n=e.reactive({actualQty:{rules:[{required:!0,errorMessage:"盘点数量必填"}]}}),r=e.ref(l.AssetPics.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e)))),s=e.ref(!0);const c=e.ref(0);return uni.getSystemInfo({success:e=>{c.value=e.windowHeight}}),{asset:l,cancel:function(){S()},save:function(){i("log","at subcontract/asset/inventory/employee/stockConfirm.vue:202",r.value),o.value.validate().then((()=>{Xe(lt.employeeStockConfirmBack,l,Number.parseInt(a.actualQty),a.stockCheckDesc,r.value),S()}))},formData:a,form:o,rules:n,files:r,isfiles:s,select:function({tempFilePaths:t}){q(),be.uploadImage(t).then((t=>{s.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));r.value.push(...l),e.nextTick((()=>{s.value=!0}))})).finally((()=>z()))},deletefile:function({tempFile:t}){const l=r.value.findIndex((e=>e===t));r.value.splice(l,1),s.value=!1,e.nextTick((()=>{s.value=!0}))},windowHeights:c}}};var Hs=l(js,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-section"),ue),c=r(e.resolveDynamicComponent("uni-easyinput"),Ie),d=r(e.resolveDynamicComponent("uni-forms-item"),Te),u=r(e.resolveDynamicComponent("uni-forms"),ze),m=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("view",{class:"content",style:e.normalizeStyle(`height:${o.windowHeights-10}px`)},[e.createElementVNode("view",{class:"content_region"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-140}px`),"scroll-y":!0},[e.createVNode(s,{title:"基本信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产编码："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Code),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"资产名称："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Name),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"原编码："),e.createElementVNode("view",null,e.toDisplayString(o.asset.OriginalCode),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"数量："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Qty),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"管理部门："),e.createElementVNode("view",null,e.toDisplayString(o.asset.KAOName),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"管理人员："),e.createElementVNode("view",null,e.toDisplayString(o.asset.KAEName),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"使用部门："),e.createElementVNode("view",null,e.toDisplayString(o.asset.UAOName),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"使用人员："),e.createElementVNode("view",null,e.toDisplayString(o.asset.UAEName),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"存放位置："),e.createElementVNode("view",null,e.toDisplayString(o.asset.LocationName),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"品牌："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Brand),1)])]),e.createElementVNode("view",{class:"row"},[e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"规格："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Spec),1)]),e.createElementVNode("view",{class:"col"},[e.createElementVNode("view",null,"型号："),e.createElementVNode("view",null,e.toDisplayString(o.asset.Model),1)])])])),_:1}),e.createVNode(s,{title:"实盘确认",type:"line"},{default:e.withCtx((()=>[e.createVNode(u,{ref:"form",modelValue:o.formData,rules:o.rules},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"form"},[e.createVNode(d,{label:"盘点数量",required:!0,name:"actualQty"},{default:e.withCtx((()=>[e.createVNode(c,{type:"number",focus:!0,modelValue:o.formData.actualQty,"onUpdate:modelValue":l[0]||(l[0]=e=>o.formData.actualQty=e),placeholder:"请输入盘点数量",maxlength:6},null,8,["modelValue"])])),_:1}),e.createVNode(d,{label:"盘点说明",name:"stockCheckDesc"},{default:e.withCtx((()=>[e.createVNode(c,{type:"textarea",modelValue:o.formData.stockCheckDesc,"onUpdate:modelValue":l[1]||(l[1]=e=>o.formData.stockCheckDesc=e),placeholder:"请输入盘点说明",maxlength:200,trim:"both"},null,8,["modelValue"])])),_:1})])])),_:1},8,["modelValue","rules"])])),_:1}),e.createVNode(s,{title:"资产图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(m,{ref:"filePicker",limit:9,"file-mediatype":"image","file-extname":"jpg,jpeg,png",mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[2]||(l[2]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:o.deletefile},null,8,["modelValue","onSelect","onDelete"])])),_:1})],4)])],4),e.createElementVNode("view",{class:"colum_confirm_cancel"},[e.createElementVNode("button",{onClick:l[3]||(l[3]=(...e)=>o.save&&o.save(...e)),type:"primary"},"确 定"),e.createElementVNode("button",{onClick:l[4]||(l[4]=(...e)=>o.cancel&&o.cancel(...e))},"取 消")])],64)}],["__scopeId","data-v-93750324"]]);var Ks=l({components:{AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref("");function c(){q(),Ws.manageUserList(t.value,l).then((({PageCount:e,Items:t,TotalRecordQty:i})=>{a=e,o.value=1===l?t:o.value.concat(t),n.value=i,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()})).finally((()=>z()))}function d(){l=1,c()}return uni.showNavigationBarLoading(),c(),uni.getSystemInfo({success:e=>{s.value=e.windowHeight}}),p((()=>{d()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:d,itemClick:function(e,t){k(`subcontract/asset/inventory/manageUser/detail?id=${e}&taskType=${t}`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,c())},windowHeights:s,billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("AnchorPointAndQty"),c=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(s,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-45,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(c,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[1]||(l[1]=e=>o.qst=e),placeholder:"主题名称",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-45}px`),onScrolltolower:l[2]||(l[2]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[3]||(l[3]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({Status:t,BillDatetime:l,StatusText:a,TaskTypeText:n,TaskType:i,BillerEmployeeName:r,TaskCode:s,Remark:c,Title:d,EndDate:u,TaskSummarys:m,ID:p})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:p,onClick:e=>o.itemClick(p,i)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(a),5),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"盘点主题："),e.createElementVNode("text",null,e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"状态："+e.toDisplayString(a),1),e.createElementVNode("text",null,"任务类型："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(r),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(l),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,[e.createTextVNode("应盘数量："),e.createElementVNode("text",{class:"all"},e.toDisplayString(m.All),1)]),e.createElementVNode("text",null,[e.createTextVNode("实盘数量："),e.createElementVNode("text",{class:"actualQty"},e.toDisplayString(m.ActualQty),1)])]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,[e.createTextVNode("待盘数量："),e.createElementVNode("text",{class:"waitingCheck"},e.toDisplayString(m.WaitingCheck),1)]),e.createElementVNode("text",null,[e.createTextVNode("已盘数量："),e.createElementVNode("text",{class:"alreadyCheck"},e.toDisplayString(m.AlreadyCheck),1)])]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"盘点说明："),e.createElementVNode("text",null,e.toDisplayString(c),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-45}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])])],64)}],["__scopeId","data-v-6ef0ab80"]]);const Gs={components:{AnchorPointAndQty:Tt},props:{id:String,taskType:String},setup({id:t,taskType:l}){const a=e.ref(["待盘(0)","已盘(0)","盘盈(0)"]),o=e.ref(0),n=e.ref({text:"默认排序",value:0}),i=e.ref([{text:"默认排序",value:0},{text:"编码排序",value:1},{text:"编码倒序",value:2},{text:"购置日期正序",value:3},{text:"购置日期倒序",value:4},{text:"登记日期正序",value:5},{text:"登记日期倒序",value:6}]);let r=1,s=-1;const c=e.ref([]);let d=1,u=-1;const m=e.ref([]);let v=1,h=-1;const f=e.ref([]),g=e.ref(0),y=e.ref(""),w=e.ref(0),N=e.ref(0),C=e.ref({}),E=e.ref(null),b=yl(),D=e.ref(""),V=e.ref(0),x=e.ref(0);function _(){return 0==o.value?r=1:1==o.value?d=1:v=1,e.nextTick((()=>{y.value="scrollTop"})),S()}async function S(){q();try{const e=0==o.value?2:1==o.value?3:4;let i={QST:D.value,ID:t,InventoryAssetSummary:e,PageNO:1,PageSize:10,SortPropertyID:n.value.value};const{PageCount:p,Detail:y,Items:w,Summarys:E,TotalRecordQty:b}=await Ws.inventoryCorpTaskDetail(i,l),V=3==l?y:w;2==e?(s=p,c.value=1===r?V:c.value.concat(V),N.value=c.value.length):3==e?(u=p,m.value=1===d?V:m.value.concat(V),N.value=m.value.length):(h=p,f.value=1===v?V:f.value.concat(V),N.value=f.value.length),C.value=E,a.value=[`待盘(${E.WaitingCheck})`,`已盘(${E.AlreadyCheck})`,`盘盈(${E.Profit})`],g.value=b,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function I(e){q(),Ws.inventoryGetAssetByCode(t,e).then((e=>{e?(E.value.close(),B(e)):F("暂未查询到可用资产")})).finally((()=>z()))}function B(e){b.commit("inventory/setmanageUserItem",e),k(`subcontract/asset/inventory/manageUser/inventoryConfirm?id=${t}`)}return p((()=>{_()})),S(),tt(lt.inventoryConfirmDetailBack,_),tt(lt.registerDetailBack,_),uni.getSystemInfo({success:e=>{x.value=e.windowHeight}}),{qst:D,switchTab:function(t){o.value!==t.currentIndex&&(o.value=t.currentIndex,0==o.value?r=1:1==o.value?d=1:v=1,e.nextTick((()=>{y.value="scrollTop"})),S())},tabVal:a,tabIndex:o,sortTypeText:n,sortTypeOption:i,sortTypeChange:function(e){n.value.text=i.value[e].text,n.value.value=e,_()},listWaitingCheck:c,listAlreadyCheck:m,listProfit:f,summarys:C,totalQty:g,toIndex:y,scrollTopDistance:w,scroll:function({detail:e}){w.value=e.scrollTop,y.value=""},listLength:N,reachBottom:function(){0==o.value?r>=s?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++r,S()):1==o.value?d>=u?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++d,S()):v>=h?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++v,S())},inputCodeDialog:E,inputCodeConfirm:function(e){e?I(e):F("请输入资产编码")},keyWordSearch:I,refreshList:_,scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{I(R(e))}})},JumpLink:B,inventoryRegister:function(){k(`subcontract/asset/inventory/manageUser/register?id=${t}&checkstatus=3`)},itemClick:function(e){k(`subcontract/asset/assetInfo/assetView?id=${e}`)},scrollTop:V,windowHeights:x}}};var Js=l(Gs,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=e.resolveComponent("AnchorPointAndQty"),u=r(e.resolveDynamicComponent("uni-easyinput"),Ie),m=r(e.resolveDynamicComponent("uni-segmented-control"),Es),p=r(e.resolveDynamicComponent("uni-icons"),fe),v=r(e.resolveDynamicComponent("uni-data-picker"),rs);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"输入资产编码检索资产","before-close":!0,value:"",placeholder:"输入资产编码",onConfirm:o.inputCodeConfirm,onClose:l[0]||(l[0]=e=>o.inputCodeDialog.close())},null,8,["onConfirm"])])),_:1},512),e.createVNode(d,{qty:o.listLength,totalQty:o.totalQty,bottom:120,scrollAreaHeight:o.windowHeights-156,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[1]||(l[1]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createElementVNode("view",{class:"keyword"},[e.createVNode(u,{prefixIcon:"search",placeholder:"编码/原编码/名称",onIconClick:o.refreshList,confirmType:"search",trim:"both",modelValue:o.qst,"onUpdate:modelValue":l[2]||(l[2]=e=>o.qst=e),inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["onIconClick","modelValue","onConfirm","onClear"])]),e.createVNode(m,{current:o.tabIndex,values:o.tabVal,"style-type":"text","active-color":0===o.tabIndex?"#d70000":1===o.tabIndex?"#7ecc21":"#db5200",onClickItem:o.switchTab},null,8,["current","values","active-color","onClickItem"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-196}px`),onScrolltolower:l[3]||(l[3]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[4]||(l[4]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),0===o.tabIndex?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(o.listWaitingCheck,(({StockCheckStatus:l,StockCheckStatusText:a,Name:n,Code:i,OriginalCode:r,KAOName:s,KAEName:c,UAOName:d,UAEName:u,AssetCategoryName:m,LocationName:p,AssetID:v})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:t.ID,onClick:e=>o.itemClick(v)},[e.createElementVNode("view",{class:"inventory-list-title"},[e.createElementVNode("view",{class:"item-name"},[e.createElementVNode("text",{selectable:""},e.toDisplayString(n),1)]),e.createElementVNode("view",{style:{"border-color":"#d70000"}},[e.createElementVNode("view",{class:"inventory_status",style:{color:"#d70000"}},[e.createElementVNode("text",{selectable:""},e.toDisplayString(a),1)])])]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(i),1),e.createElementVNode("text",null,"原编码："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"管理部门："+e.toDisplayString(s),1),e.createElementVNode("text",null,"管理人员："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"使用部门："+e.toDisplayString(d),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"资产分类："),e.createElementVNode("text",null,e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(p),1)])],8,["onClick"])))),128)):e.createCommentVNode("",!0),1===o.tabIndex?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(o.listAlreadyCheck,(({StockCheckStatus:l,StockCheckStatusText:a,Name:n,Code:i,OriginalCode:r,KAOName:s,KAEName:c,UAOName:d,UAEName:u,AssetCategoryName:m,LocationName:p,AssetID:v})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:t.ID,onClick:e=>o.itemClick(v)},[e.createElementVNode("view",{class:"inventory-list-title"},[e.createElementVNode("view",{class:"item-name"},[e.createElementVNode("text",{selectable:""},e.toDisplayString(n),1)]),e.createElementVNode("view",{style:{"border-color":"#7ecc21"}},[e.createElementVNode("view",{class:"inventory_status",style:{color:"#7ecc21"}},[e.createElementVNode("text",{selectable:""},e.toDisplayString(a),1)])])]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(i),1),e.createElementVNode("text",null,"原编码："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"管理部门："+e.toDisplayString(s),1),e.createElementVNode("text",null,"管理人员："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"使用部门："+e.toDisplayString(d),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"资产分类："),e.createElementVNode("text",null,e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(p),1)])],8,["onClick"])))),128)):e.createCommentVNode("",!0),2===o.tabIndex?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(o.listProfit,(({StockCheckStatus:l,StockCheckStatusText:a,Name:n,Code:i,OriginalCode:r,KAOName:s,KAEName:c,UAOName:d,UAEName:u,AssetCategoryName:m,LocationName:p,AssetID:v})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:t.ID,onClick:e=>o.itemClick(v)},[e.createElementVNode("view",{class:"inventory-list-title"},[e.createElementVNode("view",{class:"item-name"},[e.createElementVNode("text",{selectable:""},e.toDisplayString(n),1)]),e.createElementVNode("view",{style:{"border-color":"#db5200"}},[e.createElementVNode("view",{class:"inventory_status",style:{color:"#db5200"}},[e.createElementVNode("text",{selectable:""},e.toDisplayString(a),1)])])]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(i),1),e.createElementVNode("text",null,"原编码："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"管理部门："+e.toDisplayString(s),1),e.createElementVNode("text",null,"管理人员："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"使用部门："+e.toDisplayString(d),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"资产分类："),e.createElementVNode("text",null,e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(p),1)])],8,["onClick"])))),128)):e.createCommentVNode("",!0),o.listLength<1?(e.openBlock(),e.createElementBlock("view",{key:3,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-196}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"header-type"},[e.createElementVNode("view",null,[e.createVNode(v,{border:!1,"clear-icon":!1,onInput:o.sortTypeChange,localdata:o.sortTypeOption,modelValue:o.sortTypeText.value,"onUpdate:modelValue":l[5]||(l[5]=e=>o.sortTypeText.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("view",{class:"sort-text"},[e.createElementVNode("view",null,e.toDisplayString(o.sortTypeText.text),1),e.createVNode(p,{type:"bottom",color:"#4a74e7",size:"14"})])])),_:1},8,["onInput","localdata","modelValue"])]),0===o.tabIndex?(e.openBlock(),e.createElementBlock("view",{key:0}," 数量："+e.toDisplayString(o.summarys.WaitingCheck),1)):e.createCommentVNode("",!0),1===o.tabIndex?(e.openBlock(),e.createElementBlock("view",{key:1}," 数量："+e.toDisplayString(o.summarys.AlreadyCheck),1)):e.createCommentVNode("",!0),2===o.tabIndex?(e.openBlock(),e.createElementBlock("view",{key:2}," 数量："+e.toDisplayString(o.summarys.Profit),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"list_footer_button"},[e.createElementVNode("view",{class:"center",onClick:l[6]||(l[6]=e=>o.inputCodeDialog.open())},[e.createVNode(p,{type:"compose",color:"#2979ff",size:"26"}),e.createElementVNode("text",null,"手动输入编码")]),e.createElementVNode("view",{class:"center",onClick:l[7]||(l[7]=(...e)=>o.scan&&o.scan(...e))},[e.createVNode(p,{type:"scan",color:"#2979ff",size:"26"}),e.createElementVNode("text",null,"扫码查资产")])]),2===o.tabIndex?(e.openBlock(),e.createElementBlock("view",{key:0,class:"asset-register",onClick:l[8]||(l[8]=(...e)=>o.inventoryRegister&&o.inventoryRegister(...e))},[e.createVNode(p,{type:"compose",size:"30",color:"#fff"}),e.createElementVNode("view",null,"盘点登记")])):e.createCommentVNode("",!0)],64)}],["__scopeId","data-v-077cc7ac"]]);const Ys={components:{UniFilePicker:Zr},props:{id:String},setup({id:t}){const l=yl(),a=e.ref([]),o=e.ref(!0),n=l.state.inventory.manageUser.item;i("log","at subcontract/asset/inventory/manageUser/inventoryConfirm.vue:235",n);const r=n.Asset,s=e.ref(n.ActualQty?n.ActualQty:n.Qty),c=e.ref(""),d=e.ref(""),u=e.ref(null),m=e.ref(null),p=e.ref(null),v=e.ref({text:"",value:null}),h=e.ref([{text:"转移",value:3},{text:"盘盈(转移)",value:4},{text:"盘盈(资产登记)",value:5}]);let f=e.computed((()=>r.Qty!=s.value||(v.value={text:"",value:null},!1)));const g=e.ref("");return uni.getSystemInfo({success:e=>{g.value=e.windowHeight}}),i("log","at subcontract/asset/inventory/manageUser/inventoryConfirm.vue:349",r),{data:n,assetInfo:r,files:a,isfiles:o,select:function({tempFilePaths:t}){q(),be.uploadImage(t).then((t=>{o.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));a.value.push(...l),e.nextTick((()=>{o.value=!0}))})).finally((()=>z()))},deletefile:function({tempFile:t}){const l=a.value.findIndex((e=>e===t));a.value.splice(l,1),o.value=!1,e.nextTick((()=>{o.value=!0}))},qty:s,explain:c,confirmExplain:d,inventoryQty:u,inventoryExplain:m,inventoryConfirmExplain:p,inventoryQtyConfirm:function(e){""!=e?s.value=e:F("请输入数量")},inventoryExplainConfirm:function(e){c.value=e},inventoryConfirmExplainConfirm:function(e){d.value=e},firmOffer:v,firmOfferOption:h,firmOfferChange:function(e){v.value.text=h.value.filter((t=>t.value==e))[0].text,v.value.value=e},isCheck:f,saveSubmit:function(){if(!v.value.value&&s.value!=n.Qty)return void F("请选择实盘情况");q();const e=s.value==n.Qty?"1":s.value<n.Qty?"6":v.value.value;Ws.pDAInventorySubmitCheckAsset(r.ID,a.value,n.ID,s.value,c.value,d.value,e,t).then((()=>{L("盘点成功"),et(lt.inventoryConfirmDetailBack).then((()=>S()))})).finally((()=>z()))},windowHeights:g}}};var Zs=l(Ys,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=e.resolveComponent("uni-file-picker"),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-list"),Ne);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inventoryQty",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"盘点数量",value:o.qty,placeholder:"请输入盘点数量",onConfirm:o.inventoryQtyConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inventoryExplain",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"盘点说明",value:o.explain,placeholder:"请输入盘点说明",onConfirm:o.inventoryExplainConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inventoryConfirmExplain",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"盘点确认说明",value:o.confirmExplain,placeholder:"请输入盘点确认说明",onConfirm:o.inventoryConfirmExplainConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"asset-content",style:e.normalizeStyle(`height:${1!=o.assetInfo.Qty?o.windowHeights-246:o.windowHeights-201}px`)},[e.createVNode(d,{title:"基本信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"list-column"},[e.createElementVNode("view",{class:"list-item-title"},"资产名称："+e.toDisplayString(o.assetInfo.Name),1),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"资产编码："+e.toDisplayString(o.assetInfo.Code),1),e.createElementVNode("view",null,"原编码："+e.toDisplayString(o.assetInfo.OriginalCode),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"设备序列号："+e.toDisplayString(o.assetInfo.SN),1),e.createElementVNode("view",null,"资产分类："+e.toDisplayString(o.assetInfo.CategoryName),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"品牌："+e.toDisplayString(o.assetInfo.Brand),1),e.createElementVNode("view",null,"规格："+e.toDisplayString(o.assetInfo.Spec),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"型号："+e.toDisplayString(o.assetInfo.Model),1),e.createElementVNode("view",null,"计量单位："+e.toDisplayString(o.assetInfo.Unit),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"购置日期："+e.toDisplayString(o.assetInfo.DateOfPurchase?o.assetInfo.DateOfPurchase.substring(0,10):""),1),e.createElementVNode("view",null,"资产用途："+e.toDisplayString(o.assetInfo.AssetPurposeText),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"取得方式："+e.toDisplayString(o.assetInfo.AcquireWayText),1),e.createElementVNode("view",null,"资产性质："+e.toDisplayString(o.assetInfo.AssetAttributeText),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"资产状态："+e.toDisplayString(o.assetInfo.AssetStatusText),1),e.createElementVNode("view",null,"供应商："+e.toDisplayString(o.assetInfo.SupplierName),1)])])])),_:1}),e.createVNode(d,{title:"使用信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"list-column"},[e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"使用情况："+e.toDisplayString(o.assetInfo.AssetUsages),1),e.createElementVNode("view",null,"管理部门："+e.toDisplayString(o.assetInfo.KAOName),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"使用部门："+e.toDisplayString(o.assetInfo.UAOName),1),e.createElementVNode("view",null,"使用人员："+e.toDisplayString(o.assetInfo.UAEName),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"存放位置："+e.toDisplayString(o.assetInfo.LocationName),1),e.createElementVNode("view",null,"领用日期："+e.toDisplayString(o.assetInfo.DatetimeOfUse),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"过保日期："+e.toDisplayString(o.assetInfo.ExpiredDateOfMaintenance),1),e.createElementVNode("view",null,"使用期至："+e.toDisplayString(o.assetInfo.ExpiredDateOfUsage),1)])])])),_:1}),e.createVNode(d,{title:"财务信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"list-column"},[e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"发票号码："+e.toDisplayString(o.assetInfo.InvoiceNumber),1),e.createElementVNode("view",null,"开票日期："+e.toDisplayString(o.assetInfo.DateOfInvoice),1)])])])),_:1}),e.createVNode(d,{title:"图片上传",type:"line"},{default:e.withCtx((()=>[o.isfiles?(e.openBlock(),e.createBlock(u,{key:0,ref:"filePicker",limit:5,"file-mediatype":"image","file-extname":"jpg,jpeg,png",mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[0]||(l[0]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:o.deletefile,title:"最多选择5个图片"},null,8,["modelValue","onSelect","onDelete"])):e.createCommentVNode("",!0)])),_:1})],4),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("view",{class:"uni_list"},[e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,{disabled:1==o.data.Qty},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"盘点数量：")])])),footer:e.withCtx((()=>[e.createElementVNode("text",{class:"info-item-text",onClick:l[1]||(l[1]=e=>1==o.data.Qty?null:o.inventoryQty.open())},e.toDisplayString(o.qty?o.qty:"请输入盘点说明"),1)])),_:1},8,["disabled"]),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"盘点说明：")])])),footer:e.withCtx((()=>[e.createElementVNode("text",{class:"info-item-text",onClick:l[2]||(l[2]=e=>o.inventoryExplain.open())},e.toDisplayString(o.explain?o.explain:"请输入盘点说明"),1)])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"盘点确认说明：")])])),footer:e.withCtx((()=>[e.createElementVNode("text",{class:"info-item-text",onClick:l[3]||(l[3]=e=>o.inventoryConfirmExplain.open())},e.toDisplayString(o.confirmExplain?o.confirmExplain:"请输入盘点确认说明"),1)])),_:1}),1!=o.data.Qty?(e.openBlock(),e.createBlock(m,{key:0,disabled:!o.isCheck},{header:e.withCtx((()=>[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"盘点情况：")])])),footer:e.withCtx((()=>[o.isCheck?(e.openBlock(),e.createBlock(p,{key:0,border:!1,"clear-icon":!1,onInput:o.firmOfferChange,localdata:o.firmOfferOption,modelValue:o.firmOffer.value,"onUpdate:modelValue":l[4]||(l[4]=e=>o.firmOffer.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.firmOffer.text?o.firmOffer.text:"请选择实盘情况"),1)])),_:1},8,["onInput","localdata","modelValue"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"info-item-text"},e.toDisplayString(o.firmOffer.text?o.firmOffer.text:"请选择实盘情况"),1))])),_:1},8,["disabled"])):e.createCommentVNode("",!0)])),_:1}),e.createElementVNode("view",{class:"submit-button"},[e.createElementVNode("button",{type:"primary",class:"uni-icon-submit",onClick:l[5]||(l[5]=(...e)=>o.saveSubmit&&o.saveSubmit(...e))},[e.createElementVNode("text",{style:{color:"#fff"}},"提交")])])])])],64)}],["__scopeId","data-v-56ae0409"]]);const Xs={components:{UniFilePicker:Zr},props:{id:String,checkstatus:String},setup({id:t,checkstatus:l}){const a=e.ref([]),o=e.ref(!0),n=e.ref([{text:"资产名称",placeholder:"请输入资产名称",value:""},{text:"资产编码",placeholder:"请输入资产编码",value:""},{text:"原编码",placeholder:"请扫描/输入原编码",value:""},{text:"品牌",placeholder:"请输入品牌",value:""},{text:"规格",placeholder:"请输入规格",value:""},{text:"型号",placeholder:"请输入型号",value:""},{text:"数量",placeholder:"请输入数量",value:""},{text:"盘点说明",placeholder:"请输入盘点说明",value:""}]),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(null),d=e.ref(null);return{files:a,isfiles:o,select:function({tempFilePaths:t}){q(),be.uploadImage(t).then((t=>{o.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));a.value.push(...l),e.nextTick((()=>{o.value=!0}))})).finally((()=>z()))},deletefile:function({tempFile:t}){const l=a.value.findIndex((e=>e===t));a.value.splice(l,1),o.value=!1,e.nextTick((()=>{o.value=!0}))},registerList:n,inputDialog:c,editInfo:function(e){r.value=e,n.value[e].value&&(i.value=n.value[e].value),s.value=n.value[e].text,c.value.open()},editVal:i,title:s,dialogInputConfirm:function(e){if(6==r.value){if(!/^\+?[1-9][0-9]*$/.test(e))return void F("请输入正确的数量")}n.value[r.value].value=e,i.value="",c.value.close()},submitDialogConfirm:function(){q(),Ws.pDAInventoryAssetRegister(a.value,h("CorpID"),t,n.value[0].value,n.value[1].value,n.value[2].value,n.value[3].value,n.value[4].value,n.value[5].value,n.value[6].value,n.value[7].value).then((e=>{d.value.close(),L("登记成功"),et(lt.registerDetailBack).then((()=>S()))})).finally((()=>z()))},scanCode:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{n.value[2].value=R(e)}})},saveSubmit:function(){n.value[0].value?n.value[7].value?d.value.open():F("请输入盘点说明"):F("请输入资产名称")},submitDialog:d,cancel:function(){S()}}}};var ec=l(Xs,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-icons"),fe),u=r(e.resolveDynamicComponent("uni-list-item"),we),m=r(e.resolveDynamicComponent("uni-list"),Ne),p=e.resolveComponent("uni-file-picker"),v=r(e.resolveDynamicComponent("uni-section"),ue);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:`请输入${o.title}`,value:o.editVal,placeholder:"请输入信息","before-close":!0,onConfirm:o.dialogInputConfirm,onClose:l[0]||(l[0]=e=>o.inputDialog.close())},null,8,["title","value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submit-dialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:"info",cancelText:"取消",confirmText:"确认",content:"确认登记资产信息？",onConfirm:o.submitDialogConfirm,onClose:l[1]||(l[1]=e=>o.submitDialog.close())},null,8,["onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"uni_list"},[e.createVNode(m,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.registerList,((t,l)=>(e.openBlock(),e.createBlock(u,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[0==l||7==l?(e.openBlock(),e.createElementBlock("text",{key:0,class:"checka"},"*")):e.createCommentVNode("",!0),0==l||7==l?(e.openBlock(),e.createElementBlock("text",{key:1,class:"slot-box"},e.toDisplayString(t.text)+"：",1)):(e.openBlock(),e.createElementBlock("text",{key:2,class:e.normalizeClass(0==l||7==l?"slot-box":"slot-box ensp")},e.toDisplayString(t.text)+"：",3))])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-footer"},[e.createElementVNode("text",{class:"info-item-text",onClick:e=>o.editInfo(l)},e.toDisplayString(t.value?t.value:t.placeholder),9,["onClick"]),e.createElementVNode("view",{class:"san-code"},[2==l?(e.openBlock(),e.createBlock(d,{key:0,onClick:o.scanCode,type:"scan",size:"15",style:{"margin-left":"10px"}},null,8,["onClick"])):e.createCommentVNode("",!0)])])])),_:2},1024)))),256))])),_:1}),e.createVNode(v,{title:"图片上传",type:"line"},{default:e.withCtx((()=>[o.isfiles?(e.openBlock(),e.createBlock(p,{key:0,ref:"filePicker",limit:5,"file-mediatype":"image","file-extname":"jpg,jpeg,png",mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[2]||(l[2]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:o.deletefile,title:""},null,8,["modelValue","onSelect","onDelete"])):e.createCommentVNode("",!0)])),_:1})]),e.createElementVNode("view",{class:"submit-button"},[e.createElementVNode("button",{type:"primary",class:"uni-icon-submit",onClick:l[3]||(l[3]=(...e)=>o.saveSubmit&&o.saveSubmit(...e))},[e.createElementVNode("text",{style:{color:"#fff"}},"提交")]),e.createElementVNode("button",{onClick:l[4]||(l[4]=(...e)=>o.cancel&&o.cancel(...e))},[e.createElementVNode("text",{style:{color:"#444"}},"取消")])])],64)}],["__scopeId","data-v-07812c92"]]);var tc=l({emits:["closeDialog","confirm"],components:{DrawerAdvancedSearch:As},props:{show:{type:Boolean,default:!1}},setup(t,l){const a=e.ref(null),o=e.ref(null),n=e.ref(""),i=e.ref(""),r=e.ref({name:{hint:"资产名称",value:null},code:{hint:"资产编码",value:null},originalCode:{hint:"原编码",value:null},sn:{hint:"序列号",value:null},brand:{hint:"品牌",value:null},spec:{hint:"规格",value:null},model:{hint:"型号",value:null},category:{hint:"资产分类",name:null,value:[]},assetAttribute:{hint:"资产性质",name:null,value:null,options:[]},supplier:{hint:"供应商",name:null,value:[]},acquireWay:{hint:"取得方式",name:null,value:null,options:[]},dateOfPurchaseStart:{hint:"购置日期(开始)",value:null},dateOfPurchaseEnd:{hint:"购置日期(结束)",value:null},registerDateStart:{hint:"登记日期(开始)",value:null},registerDateEnd:{hint:"登记日期(结束)",value:null},kAO:{hint:"管理部门",name:null,value:[]},kAE:{hint:"管理人员",name:null,value:[]},uAO:{hint:"使用部门",name:null,value:[]},uAE:{hint:"使用人员",name:null,value:[]},location:{hint:"存放位置",name:null,value:[]},corp:{hint:"所属公司",name:null,value:[]},usage:{hint:"使用情况",name:null,value:null,options:[]},status:{hint:"资产状态",name:null,value:null,options:[]},kAEName:{hint:"管理人员姓名",value:null},uAEName:{hint:"使用人员姓名",value:null}}),s=e.ref(null),c=e.ref("");function d(e){let t="";switch(e){case"name":t="Name";break;case"code":t="Code";break;case"originalCode":t="OriginalCode";break;case"sn":t="SN";break;case"brand":t="Brand";break;case"spec":t="Spec";break;case"model":t="Model";break;case"category":t="AssetCategoryID";break;case"assetAttribute":t="AssetAttributeID";break;case"supplier":t="SupplierID";break;case"acquireWay":t="AcquireWayID";break;case"dateOfPurchaseStart":case"dateOfPurchaseEnd":t="DateOfPurchase";break;case"registerDateStart":case"registerDateEnd":t="RegisterDatetime";break;case"kAO":t="KAOID";break;case"kAE":t="KAEID";break;case"uAO":t="UAOID";break;case"uAE":t="UAEID";break;case"location":t="LocationID";break;case"corp":t="CorpID";break;case"usage":t="AssetUsage";break;case"status":t="AssetStatus";break;case"kAEName":t="KAENameText";break;case"uAEName":t="UAENameText"}return t}return c.value=se==ne?185:95,uni.getSystemInfo({success:e=>{s.value=e.windowHeight}}),be.assetGetOptions().then((({AssetEnums:e})=>{const{AcquireWay:t,AssetAttribute:l,AssetStatuses:a,AssetUsage:o}=e;r.value.acquireWay.options=t.map((e=>({text:e.Value,value:e.Key}))),r.value.assetAttribute.options=l.map((e=>({text:e.Value,value:e.Key}))),r.value.status.options=a.map((e=>({text:e.Value,value:e.Key}))),r.value.usage.options=o.map((e=>({text:e.Value,value:e.Key})))})),e.watch((()=>t.show),(e=>{e?a.value.open():a.value.close()})),{windowHeights:s,bottomHeight:c,conditionSearchPopup:a,advancedSearch:r,openAdvancedInputDialog:function(e){n.value=r.value[e].value,i.value=e,o.value.open()},removeAdvancedInput:function(e){"category"==e||"supplier"==e||"corp"==e||"kAO"==e||"kAE"==e||"uAO"==e||"uAE"==e||"corp"==e||"location"==e?(r.value[e].value=[],r.value[e].name=null):"assetAttrbute"==e||"acquireWay"==e||"usage"==e||"status"==e?(r.value[e].value=null,r.value[e].name=null):r.value[e].value=null},categorySelect:function(e){tt(lt.assetCategorySelectBack,(({ids:t,names:l})=>{r.value[e].value=t,r.value[e].name=l})),k(`pages/selector/asset/category?isLast=0&multiple=1&ids=${r.value[e].value}`)},corpDeptSelect:function(e){tt(lt.deptSelectBack,(({ids:t,names:l})=>{r.value[e].value=t,r.value[e].name=l}));const t=r.value[e].value;k(`pages/selector/system/corpDept?multiple=1&type=${"corp"==e?2:null}&ids=${t}`)},locationSelect:function(){tt(lt.locationSelectBack,(({ids:e,names:t})=>{r.value.location.value=e,r.value.location.name=t})),k(`pages/selector/asset/location?isLast=0&multiple=1&ids=${r.value.location.value}`)},personnelSelect:function(e){tt(lt.employeeSelectBack,(({ids:t,names:l})=>{r.value[e].value=t,r.value[e].name=l})),k(`pages/selector/system/employee?&multiple=1&ids=${r.value[e].value}`)},supplierSelect:function(e){tt(lt.supplierSelectBack,(({ids:t,names:l})=>{r.value[e].value=t,r.value[e].name=l})),k(`pages/selector/asset/supplier?isLast=0&multiple=1&ids=${r.value[e].value}`)},advancedInputVal:n,advancedInputKey:i,advancedInputDialog:o,advancedInputConfirm:function(e){r.value[i.value].value=e.trim()},conditionReset:function(){const e=r.value;e.name.value=null,e.code.value=null,e.originalCode.value=null,e.sn.value=null,e.brand.value=null,e.spec.value=null,e.model.value=null,e.category.name=null,e.category.value=[],e.assetAttribute.value=null,e.supplier.name=null,e.supplier.value=[],e.acquireWay.name=null,e.acquireWay.value=null,e.dateOfPurchaseStart.value=null,e.dateOfPurchaseEnd.value=null,e.registerDateStart.value=null,e.registerDateEnd.value=null,e.kAO.name=null,e.kAO.value=[],e.kAE.name=null,e.kAE.value=[],e.uAO.name=null,e.uAO.value=[],e.uAE.name=null,e.uAE.value=[],e.location.name=null,e.location.value=[],e.corp.name=null,e.corp.value=[],e.usage.name=null,e.usage.value=null,e.status.name=null,e.status.value=null,e.kAEName.value=null,e.uAEName.value=null},inputChange:function(e,t){r.value[t].value=e,r.value[t].name=r.value[t].options.filter((t=>t.value==e))[0].text},close:function(){l.emit("closeDialog")},dateTimeChange:({detail:{value:e}},t)=>{r.value[t].value=e},querySearch:function(){const e=r.value;let t=[];for(let l in e)if(e[l].value&&e[l].value.constructor==Array&&e[l].value.length>0){const a=e[l].value.map((e=>({Value:e})));t.push({AssetPropertyCode:d(l),Operator:7,Values:a})}else e[l].value&&e[l].value.constructor!=Array&&("dateOfPurchaseStart"==l||"registerDateStart"==l?t.push({AssetPropertyCode:d(l),Operator:4,Values:[{Value:e[l].value}]}):"dateOfPurchaseEnd"==l||"registerDateEnd"==l?t.push({AssetPropertyCode:d(l),Operator:6,Values:[{Value:e[l].value}]}):t.push({AssetPropertyCode:d(l),Operator:7,Values:[{Value:e[l].value}]}));l.emit("confirm",t)},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{r.value[e].value=t}})}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-list"),Ne),h=e.resolveComponent("DrawerAdvancedSearch");return e.openBlock(),e.createBlock(h,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:t.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-o.bottomHeight}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.name.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("name"))},e.toDisplayString(o.advancedSearch.name.value?o.advancedSearch.name.value:"请输入资产名称"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.name.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("name")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产编码：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.code.value?"content_effective":""]),onClick:l[2]||(l[2]=e=>o.openAdvancedInputDialog("code"))},e.toDisplayString(o.advancedSearch.code.value?o.advancedSearch.code.value:"请扫描/输入资产编码"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.code.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[3]||(l[3]=e=>o.removeAdvancedInput("code")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[4]||(l[4]=e=>o.scanInput("code")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"原编码：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.originalCode.value?"content_effective":""]),onClick:l[5]||(l[5]=e=>o.openAdvancedInputDialog("originalCode"))},e.toDisplayString(o.advancedSearch.originalCode.value?o.advancedSearch.originalCode.value:"请扫描/输入原编码"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.originalCode.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("originalCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[7]||(l[7]=e=>o.scanInput("originalCode")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"序列号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.sn.value?"content_effective":""]),onClick:l[8]||(l[8]=e=>o.openAdvancedInputDialog("sn"))},e.toDisplayString(o.advancedSearch.sn.value?o.advancedSearch.sn.value:"请扫描/输入序列号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.sn.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[9]||(l[9]=e=>o.removeAdvancedInput("sn")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[10]||(l[10]=e=>o.scanInput("sn")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.brand.value?"content_effective":""]),onClick:l[11]||(l[11]=e=>o.openAdvancedInputDialog("brand"))},e.toDisplayString(o.advancedSearch.brand.value?o.advancedSearch.brand.value:"请输入品牌"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.brand.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[12]||(l[12]=e=>o.removeAdvancedInput("brand")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.spec.value?"content_effective":""]),onClick:l[13]||(l[13]=e=>o.openAdvancedInputDialog("spec"))},e.toDisplayString(o.advancedSearch.spec.value?o.advancedSearch.spec.value:"请输入规格"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.spec.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[14]||(l[14]=e=>o.removeAdvancedInput("spec")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.model.value?"content_effective":""]),onClick:l[15]||(l[15]=e=>o.openAdvancedInputDialog("model"))},e.toDisplayString(o.advancedSearch.model.value?o.advancedSearch.model.value:"请输入型号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.model.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[16]||(l[16]=e=>o.removeAdvancedInput("model")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产分类：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.category.value.length>0?"content_effective":""]),onClick:l[17]||(l[17]=e.withModifiers((e=>o.categorySelect("category")),["stop"]))},e.toDisplayString(o.advancedSearch.category.value.length>0?o.advancedSearch.category.name:"请输入资产分类"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.category.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[18]||(l[18]=e=>o.removeAdvancedInput("category")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产性质：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{border:!1,"clear-icon":!1,localdata:o.advancedSearch.assetAttribute.options,onInput:l[19]||(l[19]=e=>o.inputChange(e,"assetAttribute")),modelValue:o.advancedSearch.assetAttribute.value,"onUpdate:modelValue":l[20]||(l[20]=e=>o.advancedSearch.assetAttribute.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.assetAttribute.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.assetAttribute.value?o.advancedSearch.assetAttribute.name:"请输入资产性质"),3)])),_:1},8,["localdata","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.assetAttribute.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[21]||(l[21]=e=>o.removeAdvancedInput("assetAttribute")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"供应商：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 116px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.supplier.value.length>0?"content_effective":""]),onClick:l[22]||(l[22]=e.withModifiers((e=>o.supplierSelect("supplier")),["stop"]))},e.toDisplayString(o.advancedSearch.supplier.value.length>0?o.advancedSearch.supplier.name:"请输入供应商"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.supplier.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[23]||(l[23]=e=>o.removeAdvancedInput("supplier")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"取得方式：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{border:!1,"clear-icon":!1,localdata:o.advancedSearch.acquireWay.options,onInput:l[24]||(l[24]=e=>o.inputChange(e,"acquireWay")),modelValue:o.advancedSearch.acquireWay.value,"onUpdate:modelValue":l[25]||(l[25]=e=>o.advancedSearch.acquireWay.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.acquireWay.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.acquireWay.value?o.advancedSearch.acquireWay.name:"请输入取得方式"),3)])),_:1},8,["localdata","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.acquireWay.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[26]||(l[26]=e=>o.removeAdvancedInput("acquireWay")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"购置日期(开始)：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[27]||(l[27]=e=>o.dateTimeChange(e,"dateOfPurchaseStart"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.dateOfPurchaseStart.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.dateOfPurchaseStart.value?o.advancedSearch.dateOfPurchaseStart.value:"请输入购置日期(开始)"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.dateOfPurchaseStart.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[28]||(l[28]=e=>o.removeAdvancedInput("dateOfPurchaseStart")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"购置日期(结束)：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[29]||(l[29]=e=>o.dateTimeChange(e,"dateOfPurchaseEnd"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.dateOfPurchaseEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.dateOfPurchaseEnd.value?o.advancedSearch.dateOfPurchaseEnd.value:"请输入购置日期(结束)"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.dateOfPurchaseEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[30]||(l[30]=e=>o.removeAdvancedInput("dateOfPurchaseEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"登记日期(开始)：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[31]||(l[31]=e=>o.dateTimeChange(e,"registerDateStart"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.registerDateStart.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.registerDateStart.value?o.advancedSearch.registerDateStart.value:"请输入登记日期(开始)"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.registerDateStart.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[32]||(l[32]=e=>o.removeAdvancedInput("registerDateStart")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"登记日期(结束)：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[33]||(l[33]=e=>o.dateTimeChange(e,"registerDateEnd"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.registerDateEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.registerDateEnd.value?o.advancedSearch.registerDateEnd.value:"请输入登记日期(结束)"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.registerDateEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[34]||(l[34]=e=>o.removeAdvancedInput("registerDateEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"管理部门：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.kAO.value.length>0?"content_effective":""]),onClick:l[35]||(l[35]=e.withModifiers((e=>o.corpDeptSelect("kAO")),["stop"]))},e.toDisplayString(o.advancedSearch.kAO.value.length>0?o.advancedSearch.kAO.name:"请输入管理部门"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.kAO.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[36]||(l[36]=e=>o.removeAdvancedInput("kAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"管理人员：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.kAE.value.length>0?"content_effective":""]),onClick:l[37]||(l[37]=e.withModifiers((e=>o.personnelSelect("kAE")),["stop"]))},e.toDisplayString(o.advancedSearch.kAE.value.length>0?o.advancedSearch.kAE.name:"请输入管理人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.kAE.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[38]||(l[38]=e=>o.removeAdvancedInput("kAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用部门：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.uAO.value.length>0?"content_effective":""]),onClick:l[39]||(l[39]=e.withModifiers((e=>o.corpDeptSelect("uAO")),["stop"]))},e.toDisplayString(o.advancedSearch.uAO.value.length>0?o.advancedSearch.uAO.name:"请输入使用部门"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.uAO.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[40]||(l[40]=e=>o.removeAdvancedInput("uAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用人员：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.uAE.value.length>0?"content_effective":""]),onClick:l[41]||(l[41]=e.withModifiers((e=>o.personnelSelect("uAE")),["stop"]))},e.toDisplayString(o.advancedSearch.uAE.value.length>0?o.advancedSearch.uAE.name:"请输入使用人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.uAE.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[42]||(l[42]=e=>o.removeAdvancedInput("uAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.location.value.length>0?"content_effective":""]),onClick:l[43]||(l[43]=e.withModifiers((e=>o.locationSelect("location")),["stop"]))},e.toDisplayString(o.advancedSearch.location.value.length>0?o.advancedSearch.location.name:"请输入存放位置"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.location.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[44]||(l[44]=e=>o.removeAdvancedInput("location")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"所属公司：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.corp.value.length>0?"content_effective":""]),onClick:l[45]||(l[45]=e.withModifiers((e=>o.corpDeptSelect("corp")),["stop"]))},e.toDisplayString(o.advancedSearch.corp.value.length>0?o.advancedSearch.corp.name:"请输入所属公司"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.corp.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[46]||(l[46]=e=>o.removeAdvancedInput("corp")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用情况：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{placeholder:"请输入使用情况",border:!1,"clear-icon":!1,localdata:o.advancedSearch.usage.options,onInput:l[47]||(l[47]=e=>o.inputChange(e,"usage")),modelValue:o.advancedSearch.usage.value,"onUpdate:modelValue":l[48]||(l[48]=e=>o.advancedSearch.usage.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.usage.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.usage.value?o.advancedSearch.usage.name:"使用情况"),3)])),_:1},8,["localdata","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.usage.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[49]||(l[49]=e=>o.removeAdvancedInput("usage")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产状态：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{border:!1,"clear-icon":!1,localdata:o.advancedSearch.status.options,onInput:l[50]||(l[50]=e=>o.inputChange(e,"status")),modelValue:o.advancedSearch.status.value,"onUpdate:modelValue":l[51]||(l[51]=e=>o.advancedSearch.status.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.status.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.status.value?o.advancedSearch.status.name:"请输入资产状态"),3)])),_:1},8,["localdata","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.status.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[52]||(l[52]=e=>o.removeAdvancedInput("status")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"管理人员名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.kAEName.value?"content_effective":""]),onClick:l[53]||(l[53]=e=>o.openAdvancedInputDialog("kAEName"))},e.toDisplayString(o.advancedSearch.kAEName.value?o.advancedSearch.kAEName.value:"请输入名称"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.kAEName.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[54]||(l[54]=e=>o.removeAdvancedInput("kAEName")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用人员名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.uAEName.value?"content_effective":""]),onClick:l[55]||(l[55]=e=>o.openAdvancedInputDialog("uAEName"))},e.toDisplayString(o.advancedSearch.uAEName.value?o.advancedSearch.uAEName.value:"请输入名称"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.uAEName.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[56]||(l[56]=e=>o.removeAdvancedInput("uAEName")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[57]||(l[57]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[58]||(l[58]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[59]||(l[59]=(...e)=>o.close&&o.close(...e))},"关闭")])])])),_:1},8,["width"])}]]);var lc=l({components:{advancedSearch:tc,AnchorPointAndQty:Tt},setup(){const t=e.ref(!1),l=e.ref("");let a=1,o=-1;const n=e.ref([]),r=e.ref(0),s=e.ref(""),c=e.ref(0),d=e.ref(""),u=e.ref(0);function m(e){q(),be.assetListQuery(l.value,a,e).then((({PageCount:e,Items:t,TotalRecordQty:l})=>{o=e,n.value=1===a?t:n.value.concat(t),r.value=l,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()})).finally((()=>z()))}function v(){a=1,m()}return d.value=se==ne?165:95,uni.showNavigationBarLoading(),m(),uni.getSystemInfo({success:e=>{i("log","at subcontract/asset/assetList/list.vue:175",e),u.value=e.windowHeight}}),p((()=>{v()})),{showAdvancedSearch:t,qst:l,list:n,totalQty:r,toIndex:s,scrollTopDistance:c,scroll:function({detail:e}){c.value=e.scrollTop,s.value=""},refreshList:v,itemClick:function(e){k(`subcontract/asset/assetInfo/assetView?id=${e}&handle=1`)},reachBottom:function(){a>=o?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++a,m())},windowHeights:u,bottomHeight:d,advancedConfirm:function(e){t.value=!1,a=1,m(e)},assetStatusColor:qt}}},[["render",function(t,l,a,o,n,i){const s=e.resolveComponent("AnchorPointAndQty"),c=r(e.resolveDynamicComponent("advancedSearch"),tc),d=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(s,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(c,{show:o.showAdvancedSearch,onConfirm:o.advancedConfirm,onCloseDialog:l[1]||(l[1]=e=>o.showAdvancedSearch=!1)},null,8,["show","onConfirm"]),e.createVNode(d,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[2]||(l[2]=e=>o.qst=e),placeholder:"编码/原编码/名称",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[3]||(l[3]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[4]||(l[4]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({AssetStatus:t,AssetStatusText:l,Code:a,Name:n,UAEName:i,UAOName:r,OriginalCode:s,SN:c,CategoryName:d,AssetUsageText:u,LocationName:m,KAOName:p,KAEName:v,ID:h})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:h,onClick:e=>o.itemClick(h)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.assetStatusColor(t))},e.toDisplayString(l),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",{selectable:""},"资产编码："+e.toDisplayString(a),1),e.createElementVNode("text",null,"资产状态："+e.toDisplayString(l),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",{selectable:""},"原编码："+e.toDisplayString(s),1),e.createElementVNode("text",{selectable:""},"设备序列号："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"管理人员："+e.toDisplayString(v),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"管理部门："),e.createElementVNode("text",null,e.toDisplayString(p),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"使用部门："),e.createElementVNode("text",null,e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"资产分类："),e.createElementVNode("text",null,e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(m),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[5]||(l[5]=e=>o.showAdvancedSearch=!0)},"高级搜索")])],64)}]]);var ac=new class extends Ee{drawGetByID(e){return this.request("/Bill/Draw/GetByID",{ID:e})}drawSaveDraft(e){return this.request("/Bill/Draw/SaveDraft",e)}drawDelete(e){return this.request("/Bill/Draw/Delete",{ID:e})}drawList({qst:e,pageNo:t,billCode:l,drawEndDate:a,drawBeginDate:o,drawAssetOrgIDs:n,drawAssetEmployeeIDs:i,assetCode:r,assetName:s,assetCategory:c,brand:d,spec:u,model:m}){const p={ShowMode:0,Sort:1,PageNO:t,PageSize:20,QST:e,BillCode:l,DrawBeginDate:o,DrawEndDate:a,DrawAssetOrgIDs:n,DrawAssetEmployeeIDs:i,AssetCode:r,AssetName:s,AssetCategoryIDs:c,Brand:d,Spec:u,Model:m};return this.request("/Bill/Draw/List",p)}getById(e){return this.request("/Asset/GetByID",{ID:e,Visibility:1})}assetListQueryByBillType(e){const t={QST:e,PageSize:10,PageNo:1,BillType:1};return this.request("/Asset/List/QueryByBillType",t)}};const oc={components:{BillEnclosure:Is,BillFooterBtn:xs},props:{id:String,type:String},onNavigationBarButtonTap(e){k("/subcontract/asset/requestDraw/requestDrawList")},setup({id:t,type:l}){const a=e.ref({id:null,status:null,isSubmit:null,code:"",drawAssetEmployee:{text:h("UserName"),value:h("EmployeeID")},drawAssetOrg:{text:h("OrgName"),value:h("OrgID")},drawAssetDate:{hint:"请选择发放日期",value:$l()},requestDrawBillCode:{hint:"关联申请单号",code:"",value:""},isClosedRequestDraw:{hint:"结束申领",value:!1},remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),o=e.ref({name:"",brand:"",spec:"",model:"",qty:0,kAO:{hint:"管理部门",name:"",value:null},kAE:{hint:"管理人员",name:"",value:null},location:{hint:"存放位置",name:"",value:null},isPublicAsset:{hint:"是否公共资产",value:!1},uAO:{hint:"使用部门",name:"",value:null},uAE:{hint:"使用人员",name:"",value:null}}),n=e.ref([]),r=e.ref(null),s=e.ref(""),c=e.ref("none"),d=e.ref(null),u=e.ref(""),m=e.ref(null),p=e.ref([]),v=e.ref(null),f=e.ref(null),g=e.ref(null),y=e.ref(""),w=e.ref(null),N=e.ref([]),C=e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),E=e.ref(null),b=e.ref(!1),V=e.ref(!1),x=e.ref(""),_=e.ref([]),I=e.ref("");function B(e){s.value=e?"新增":"编辑",r.value.open()}function T(){o.value.kAO.value=null,o.value.kAO.name=null,o.value.kAE.value=null,o.value.kAE.name=null,o.value.location.value=null,o.value.location.name=null,o.value.isPublicAsset.value=!1,o.value.uAO.value=null,o.value.uAO.name=null,o.value.uAE.value=null,o.value.uAE.name=null,d.value=null,r.value.close()}function A(){E.value.close()}function P(){let e={};e.ID=a.value.id,e.BillCode=a.value.code,e.CommitType=a.value.id?1:0,e.IsSubmit=!!a.value.isSubmit,e.DrawAssetDate=a.value.drawAssetDate.value,e.DrawAssetEmployeeID=a.value.drawAssetEmployee.value,e.DrawAssetEmployeeName=a.value.drawAssetEmployee.text,e.DrawAssetOrgID=a.value.drawAssetOrg.value,e.DrawAssetOrgNameCN=a.value.drawAssetOrg.text,e.DrawAssetOrgNameEN=a.value.drawAssetOrg.text,e.RequestDrawID=a.value.requestDrawBillCode.value,e.RequestDrawCode=a.value.requestDrawBillCode.code,e.IsClosedRequestDraw=a.value.isClosedRequestDraw.value,e.Remark=a.value.remark,e.Details=n.value.map(((e,t)=>{let l=e;return l.Sequence=t+1,l})),e.Attachments=_.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),ac.drawSaveDraft(e).then((({Code:e,ID:t})=>{O(t).then((()=>{a.value.IsStart&&(V.value=!0)})),A()})).finally((()=>z()))}function O(e){return q(),ac.drawGetByID(e).then((({ID:e,Status:t,BillCode:o,DrawAssetDate:i,DrawAssetEmployeeID:r,DrawAssetEmployeeName:s,DrawAssetOrgID:c,DrawAssetOrgNameCN:d,RequestDrawID:u,RequestDrawCode:m,IsClosedRequestDraw:p,Remark:v,Details:h,Attachments:f,FlowInfo:g})=>{a.value.id=e,a.value.status=t,a.value.code=o,a.value.drawAssetDate.value=i?i.substring(0,10):"",a.value.drawAssetEmployee.value=r,a.value.drawAssetEmployee.text=s,a.value.drawAssetOrg.value=c,a.value.drawAssetOrg.text=d,a.value.requestDrawBillCode.value=u,a.value.requestDrawBillCode.code=m,a.value.isClosedRequestDraw.value=p,a.value.remark=v,n.value=h,_.value=f.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),b.value=1!=a.value.status&&null!=a.value.status,a.value.IsApproval=g.IsApproval,a.value.IsStart=1!=t&&!g.IsStart&&g.IsEnabledFlow,a.value.FlowPath=1!=t&&g.IsStart&&g.IsEnabledFlow||g.IsSendBack,V.value=!1,l&&"mywork"==l&&!a.value.IsApproval&&et(lt.billDetailBack).then((()=>S()))})).finally((()=>z()))}let U=e.computed((()=>{let e=0;for(let t=0;t<n.value.length;t++)e+=parseInt(n.value[t].qty);return e}));function M(e){q(),vs.requestDrawList({qst:e,pageNo:1,pageSize:5}).then((({Items:e})=>{if(e&&e.length<1)F("未检索到可用数据");else{if(e&&1==e.length)return a.value.requestDrawBillCode.code=e[0].BillCode,void(a.value.requestDrawBillCode.value=e[0].ID);p.value=e,v.value.open()}})).finally((()=>z()))}function W(e){q(),ac.assetListQueryByBillType(e).then((({Items:e})=>{N.value=e.map((e=>(e.checked=!1,e))),N.value.length<1?F("未查询到可用资产资料"):w.value.open()})).finally((()=>z()))}t&&O(t),uni.getSystemInfo({success:e=>{I.value=e.windowHeight}});let $=e.computed((()=>{let e,t;return(I.value-60)/2>270?(e=270,t=I.value-330):e=t=(I.value-60)/2,{header:e,content:t}}));return{type:l,IsScroll:$,bill:a,keyword:function(){y.value="",g.value.open()},billDetail:n,rowDetail:o,uniSwipeActionItemRightOptions:Ot,isOpened:c,uniSwipeChange:function(e,t){n.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(n.value.splice(t,1),L("移除成功"))},inputDialog:r,openEditDetailDalog:B,remarkVal:u,dialogRemarkInputConfirm:function(e){a.value.remark=e.trim()},inputRemarkDialog:m,openRemarkDialog:function(){u.value=a.value.remark,m.value.open()},editDetailConfirm:function(e){o.value.kAO.value?o.value.location.value?(n.value[d.value].NewKAOID=o.value.kAO.value,n.value[d.value].NewKAOName=o.value.kAO.name,n.value[d.value].NewKAONameCN=o.value.kAO.name,n.value[d.value].NewKAONameEN=o.value.kAO.name,n.value[d.value].NewKAEID=o.value.kAE.value,n.value[d.value].NewKAEName=o.value.kAE.name,n.value[d.value].NewLocationID=o.value.location.value,n.value[d.value].NewLocationName=o.value.location.name,n.value[d.value].NewLocationNameCN=o.value.location.name,n.value[d.value].NewLocationNameEN=o.value.location.name,n.value[d.value].IsPublicAsset=o.value.isPublicAsset.value,n.value[d.value].NewUAOID=o.value.uAO.value,n.value[d.value].NewUAOName=o.value.uAO.name,n.value[d.value].NewUAONameCN=o.value.uAO.name,n.value[d.value].NewUAONameEN=o.value.uAO.name,n.value[d.value].NewUAEID=o.value.uAE.value,n.value[d.value].NewUAEName=o.value.uAE.name,T()):F("存放位置不能为空"):F("管理部门不能为空")},editDetailClose:function(){T()},editBillDetail:function(e){if(b&&null!==a.value.status&&1!=a.value.status)return;d.value=e;const{NewKAOID:t,NewKAOName:l,NewKAEID:i,NewKAEName:r,NewLocationID:s,NewLocationName:c,IsPublicAsset:u,NewUAOID:m,NewUAOName:p,NewUAEID:v,NewUAEName:h}=n.value[e];o.value.kAO.value=t,o.value.kAO.name=l,o.value.kAE.value=i,o.value.kAE.name=r,o.value.location.value=s,o.value.location.name=c,o.value.isPublicAsset.value=u,o.value.uAO.value=m,o.value.uAO.name=p,o.value.uAE.value=v,o.value.uAE.name=h,B(0)},deleteDialogConfirm:function(){q(),ac.drawDelete(a.value.id).then((()=>{et(lt.drawDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:T,handleSaveDraft:function(e){if(a.value.isSubmit=e,a.value.drawAssetDate.value){if(a.value.drawAssetEmployee.value)return n.value.length<1?(x.value="listDetail",void F("请添加资产信息")):void(a.value.isSubmit?E.value.open():P());F("请选择发放人员")}else F("请选择发放日期")},submitDialog:E,submitMsgType:C,submitDialogConfirm:P,submitDialogClose:A,editInfoTitle:s,billDetailNumber:U,editGetByID:O,nonEditable:b,jumpList:function(){k("/subcontract/asset/draw/drawList")},windowHeights:I,drawAssetDateChange:({detail:{value:e}})=>{b.value||(a.value.drawAssetDate.value=e)},removeInput:function(e){return"drawAssetDate"==e?(a.value[e].value=null,void(a.value[e].text=null)):"drawAssetEmployee"==e?(a.value[e].value=null,a.value[e].text=null,a.value.drawAssetOrg.value=null,void(a.value.drawAssetOrg.text=null)):("requestDrawBillCode"==e&&(a.value[e].value=null,a.value[e].code=null),void("remark"!=e||(a.value[e]="")))},removeEditDetailInputInfo:function(e){o.value[e].value=null,o.value[e].name=null},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{M(R(e))}})},requestBillCode:M,requestBillCodeList:p,inputRequestBillCodeDialog:f,openRequestBillCodeDialog:function(){f.value.open()},dialogRequestBillCodeInputConfirm:function(e){""!=e.trim()?M(e):F("无效的检索条件")},requestBillCodeListDialog:v,selectRequisitionNo:function({ID:e,BillCode:t}){a.value.requestDrawBillCode.code=t,a.value.requestDrawBillCode.value=e,v.value.close()},scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{W(R(e))}})},addQuery:W,searchCodeVal:y,scanCodeDialog:g,dialogsearchCodeValConfirm:function(e){""!=e.trim()?W(e):F("无效的检索条件")},searchAssetList:N,assetDialog:w,checkBoxChange:function(e,t){let l=e.detail.value,a=N.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},assetDialogConfirm:function(){let e=N.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(n.value.filter((t=>t.AssetID==e[l].ID)).length<1){i("log","at subcontract/asset/draw/drawDetail.vue:1223",e[l]);let t={ID:null};t.AssetID=e[l].ID,t.Name=e[l].Name,t.AssetInfo=[{ID:e[l].ID,Code:e[l].Code,Name:e[l].Name}],t.Code=e[l].Code,t.OriginalCode=e[l].OriginalCode,t.OriginalAmount=e[l].OriginalAmount,t.OriginalKAOID=e[l].KAOID,t.OriginalLocationID=e[l].LocationID,t.NewKAOID=e[l].KAOID,t.NewKAOName=e[l].KAOName,t.NewKAONameCN=e[l].KAONameCN,t.NewKAONameEN=e[l].KAONameEN,t.NewKAEID=e[l].KAEID,t.NewKAEName=e[l].KAEName,t.NewLocationID=e[l].LocationID,t.NewLocationName=e[l].LocationName,t.NewLocationNameCN=e[l].LocationName,t.NewLocationNameEN=e[l].LocationName,t.IsPublicAsset=!1,t.NewUAOID=e[l].UAOID,t.NewUAOName=e[l].UAOName,t.NewUAONameCN=e[l].UAOName,t.NewUAONameEN=e[l].UAOName,t.NewUAEID=e[l].UAEID,t.NewUAEName=e[l].UAEName,t.CategoryID=e[l].AssetCategoryID,t.CategoryName=e[l].CategoryName,t.CategoryNameCN=e[l].CategoryNameCN,t.CategoryNameEN=e[l].CategoryNameEN,t.Brand=e[l].Brand,t.Spec=e[l].Spec,t.Model=e[l].Model,t.Qty=e[l].Qty,t.isOpened="none",n.value.push(t)}else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}w.value.close(),N.value=[]},isPublicAssetSwitchChange:function(e){o.value.isPublicAsset.value=e.value,e.value&&(o.value.uAE.value=null,o.value.uAE.name="")},switchChange:function(e){a.value.isClosedRequestDraw.value=e.value},locationSelect:function(e){tt(lt.locationSelectBack,(({id:t,label:l})=>{o.value[e].value=t,o.value[e].name=l})),k(`pages/selector/asset/location?isLast=1&multiple=0&ids=${o.value[e].value}`)},corpDeptSelect:function(e){tt(lt.deptSelectBack,(({id:t,label:l})=>{o.value[e].value=t,o.value[e].name=l})),k(`pages/selector/system/corpDept?multiple=0&ids=${o.value[e].value}`)},personnelSelect:function(e){if("kAE"==e&&!o.value.kAO.value)return void F("请先选择管理部门");if("uAE"==e&&!o.value.uAO.value)return void F("请先选择使用部门");tt(lt.employeeSelectBack,(({ID:t,Name:l,OrgID:n,OrgName:i})=>{"drawAssetEmployee"==e?(a.value[e].value=t,a.value[e].text=l,a.value.drawAssetOrg.value=n,a.value.drawAssetOrg.text=i):(o.value[e].value=t,o.value[e].name=l)}));let t=null;t="drawAssetEmployee"==e?a.value[e].value:o.value[e].value;let l="";"kAE"==e?l=o.value.kAO.value:"uAE"==e&&(l=o.value.uAO.value),k(`pages/selector/system/employee?&multiple=0&corpID=${l}&ids=${t}`)},files:_,filesChange:function(e){_.value=e},toIndex:x,autoStart:V}}};var nc=l(oc,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),p=r(e.resolveDynamicComponent("uni-icons"),fe),v=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),h=r(e.resolveDynamicComponent("uni-swipe-action"),ps),f=r(e.resolveDynamicComponent("uni-section"),ue),g=e.resolveComponent("BillEnclosure"),y=e.resolveComponent("BillFooterBtn");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inputRequestBillCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"申领单号",value:"",placeholder:"单号/申领人员",onConfirm:o.dialogRequestBillCodeInputConfirm},null,8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"资产搜索",value:o.searchCodeVal,placeholder:"编码/原编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"requestBillCodeListDialog",class:"requestBillCodeListDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(m,{title:"选择申领单号",type:"info","before-close":!0,onClose:l[0]||(l[0]=e=>o.requestBillCodeListDialog.close())},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"request-bill-code",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.requestBillCodeList,(l=>(e.openBlock(),e.createBlock(d,{key:t.ID,link:"",onClick:e=>o.selectRequisitionNo(l)},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"asset-dialog-list"},[e.createElementVNode("view",{class:"list-item"},[e.createElementVNode("text",{class:"list-item-column-title"},e.toDisplayString(l.BillCode),1),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"申领日期："+e.toDisplayString(l.RequestDate),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"申领部门："+e.toDisplayString(l.RequestOrgName),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"申领人员："+e.toDisplayString(l.RequesterEmployeeName),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"申领原因："+e.toDisplayString(l.RequestReasonText),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"是否结束："+e.toDisplayString(l.IsClosedText),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"制单人："+e.toDisplayString(l.BillerEmployeeName),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"制单时间："+e.toDisplayString(l.BillDateTime),1)])])])])),_:2},1032,["onClick"])))),128))])),_:1})],4)])),_:1})])),_:1},512),e.createVNode(c,{ref:"assetDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{title:"选择资产",type:"info","before-close":!0,onClose:l[1]||(l[1]=e=>o.assetDialog.close()),onConfirm:o.assetDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.searchAssetList,(({ID:t,Name:l,Code:a,AssetCategoryName:n,Brand:i,Spec:r,Model:s,checked:c})=>(e.openBlock(),e.createBlock(d,{key:t},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资料编码："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(s),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,t)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:c},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createVNode(u,{class:"add-edit-dialog"},{default:e.withCtx((()=>[e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"管理部门：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text edit-info-width",o.rowDetail.kAO.value?"info-item-color":""]),onClick:l[2]||(l[2]=e.withModifiers((e=>o.corpDeptSelect("kAO")),["stop"]))},e.toDisplayString(o.rowDetail.kAO.value?o.rowDetail.kAO.name:"请选择"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-icon-del"},[e.createElementVNode("view",null,[o.rowDetail.kAO.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[3]||(l[3]=e=>o.removeEditDetailInputInfo("kAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"管理人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text edit-info-width",o.rowDetail.kAE.value?"info-item-color":""]),onClick:l[4]||(l[4]=e=>o.personnelSelect("kAE"))},e.toDisplayString(o.rowDetail.kAE.value?o.rowDetail.kAE.name:"请选择"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-icon-del"},[e.createElementVNode("view",null,[o.rowDetail.kAE.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[5]||(l[5]=e=>o.removeEditDetailInputInfo("kAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text edit-info-width",o.rowDetail.location.value?"info-item-color":""]),onClick:l[6]||(l[6]=e.withModifiers((e=>o.locationSelect("location")),["stop"]))},e.toDisplayString(o.rowDetail.location.value?o.rowDetail.location.name:"请选择"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-icon-del"},[e.createElementVNode("view",null,[o.rowDetail.location.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[7]||(l[7]=e=>o.removeEditDetailInputInfo("location")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])),_:1}),e.createVNode(d,{"show-switch":!0,switchChecked:o.rowDetail.isPublicAsset.value,onSwitchChange:o.isPublicAssetSwitchChange},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"是否公共资产：")])])),_:1},8,["switchChecked","onSwitchChange"]),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"使用部门：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text edit-info-width",o.rowDetail.uAO.value?"info-item-color":""]),onClick:l[8]||(l[8]=e.withModifiers((e=>o.corpDeptSelect("uAO")),["stop"]))},e.toDisplayString(o.rowDetail.uAO.value?o.rowDetail.uAO.name:"请选择"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-icon-del"},[e.createElementVNode("view",null,[o.rowDetail.uAO.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[9]||(l[9]=e=>o.removeEditDetailInputInfo("uAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])),_:1}),e.createVNode(d,{disabled:o.rowDetail.isPublicAsset.value},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"使用人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text edit-info-width",o.rowDetail.uAE.value?"info-item-color":""]),onClick:l[10]||(l[10]=e=>o.personnelSelect("uAE"))},e.toDisplayString(o.rowDetail.uAE.value?o.rowDetail.uAE.name:"请选择"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-icon-del"},[e.createElementVNode("view",null,[o.rowDetail.uAE.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[11]||(l[11]=e=>o.removeEditDetailInputInfo("uAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])),_:1},8,["disabled"])])),_:1})])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},e.renderList(2,(t=>e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")]))),64))])])),_:1}),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"发放日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["item_text_content",o.bill.drawAssetDate.value?"content_effective":""])},[e.createElementVNode("picker",{mode:"date",onChange:l[12]||(l[12]=(...e)=>o.drawAssetDateChange&&o.drawAssetDateChange(...e))},[e.createElementVNode("text",null,e.toDisplayString(o.bill.drawAssetDate.value?o.bill.drawAssetDate.value:"请选择日期"),1)],32)],2)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.drawAssetDate.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[13]||(l[13]=e=>o.removeInput("drawAssetDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])),o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"发放人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.drawAssetEmployee.value?"content_effective":""]),onClick:l[14]||(l[14]=e=>o.personnelSelect("drawAssetEmployee"))},e.toDisplayString(o.bill.drawAssetEmployee.value?o.bill.drawAssetEmployee.text:"请选择人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.drawAssetEmployee.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[15]||(l[15]=e=>o.removeInput("drawAssetEmployee")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])),o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"关联申请单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.requestDrawBillCode.value?"content_effective":""]),onClick:l[16]||(l[16]=e=>o.nonEditable?null:o.openRequestBillCodeDialog())},e.toDisplayString(o.bill.requestDrawBillCode.value?o.bill.requestDrawBillCode.code:"关联申请单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.requestDrawBillCode.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[17]||(l[17]=e=>o.removeInput("requestDrawBillCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[e.createVNode(p,{onClick:l[18]||(l[18]=e=>o.scanInput("requestDrawBillCode")),type:"scan",size:"16"})])])])])),_:1},8,["disabled"]),e.createVNode(d,{"show-switch":!0,switchChecked:o.bill.isClosedRequestDraw.value,onSwitchChange:o.switchChange,disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"结束申领：")])])),_:1},8,["switchChecked","onSwitchChange","disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.remark?"content_effective":""]),onClick:l[19]||(l[19]=e=>o.nonEditable?null:o.openRemarkDialog())},e.toDisplayString(o.bill.remark?o.bill.remark:"请输入备注信息"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[20]||(l[20]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])),o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill_detail_scroll",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),onScroll:l[21]||(l[21]=e=>o.toIndex=""),"scroll-into-view":o.toIndex,"scroll-with-animation":!0,"scroll-y":""},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(f,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[e.createVNode(h,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,(({Code:t,Name:l,CategoryName:a,OriginalCode:n,OriginalAmount:i,NewKAOName:r,NewKAEName:s,NewUAOName:c,NewUAEName:d,NewLocationName:u,IsPublicAsset:m,Brand:p,Spec:h,Model:f,Qty:g,isOpened:y,AssetID:w},N)=>(e.openBlock(),e.createBlock(v,{disabled:o.nonEditable,"right-options":o.uniSwipeActionItemRightOptions,show:y,"auto-close":!1,onChange:e=>o.uniSwipeChange(N),key:w,onClick:e=>o.uniSwipeClick(e,N)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["detail_content_item",o.nonEditable?"disabled_color":""]),style:e.normalizeStyle(N+1==o.billDetail.length?"margin-bottom:0px":""),onClick:e.withModifiers((e=>o.editBillDetail(N)),["stop"])},[e.createElementVNode("text",{class:"content_item_title"},"资产名称："+e.toDisplayString(l),1),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(t),1),e.createElementVNode("text",null,"资产分类："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"原编码："+e.toDisplayString(n),1),e.createElementVNode("text",null,"原值："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"管理部门："+e.toDisplayString(r),1),e.createElementVNode("text",null,"管理人员："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"使用部门："+e.toDisplayString(c),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"存放位置："+e.toDisplayString(u),1),e.createElementVNode("text",null,"是否公共资产："+e.toDisplayString(m?"是":"否"),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(p),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(h),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(f),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(g),1)])],14,["onClick"])])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1}),o.billDetail.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:"height:100%"}," 暂 无 数 据 ")):e.createCommentVNode("",!0)])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(g,{option:o.files,onChange:o.filesChange,nonEditable:o.nonEditable},null,8,["option","onChange","nonEditable"])],44,["scroll-into-view"]),e.createVNode(y,{type:o.type,billType:"Draw",bill:o.bill,nonEditable:o.nonEditable,autoStart:o.autoStart,onJumpList:o.jumpList,onSave:o.handleSaveDraft,onDelete:o.deleteDialogConfirm,onScrollToTop:l[22]||(l[22]=e=>o.toIndex="listDetail"),onScrollToFooter:l[23]||(l[23]=e=>o.toIndex="example"),onScan:l[24]||(l[24]=e=>o.scan()),onKeyword:l[25]||(l[25]=e=>o.keyword()),onGetById:l[26]||(l[26]=e=>o.editGetByID(e))},null,8,["type","bill","nonEditable","autoStart","onJumpList","onSave","onDelete"])],64)}],["__scopeId","data-v-7a7fb196"]]);var ic=l({components:{DrawerAdvancedSearch:As,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(""),d=e.ref(null),u=e.ref({billCode:{hint:"发放单号",value:null},drawBeginDate:{hint:"发放日期起",value:null},drawEndDate:{hint:"申领日期止",value:null},drawAssetOrg:{hint:"发放部门",name:"",value:[]},drawAssetEmployee:{hint:"发放人员",name:"",value:[]},assetCode:{hint:"资产编码",value:null},assetName:{hint:"资产名称",value:null},assetCategory:{hint:"资产分类",value:[]},brand:{hint:"品牌",value:null},spec:{hint:"规格",value:null},model:{hint:"型号",value:null}}),m=e.ref(null),v=e.ref(""),h=e.ref("");async function f(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await ac.drawList({qst:t.value,pageNo:l,billCode:u.value.billCode.value,drawBeginDate:u.value.drawBeginDate.value,drawEndDate:u.value.drawEndDate.value,drawAssetOrgIDs:u.value.drawAssetOrg.value,drawAssetEmployeeIDs:u.value.drawAssetEmployee.value,assetCode:u.value.assetCode.value,assetName:u.value.assetName.value,assetCategory:u.value.assetCategory.value,brand:u.value.brand.value,spec:u.value.spec.value,model:u.value.model.value});a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function g(){return l=1,f()}return f(),tt(lt.drawDetailBack,g),uni.getSystemInfo({success:e=>{v.value=e.windowWidth,h.value=e.windowHeight}}),p((()=>{g()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:g,itemClick:function(e){k(`subcontract/asset/draw/drawDetail?id=${e}&type=list`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,f())},windowWidths:v,windowHeights:h,advancedInputVal:s,advancedInputKey:c,advancedInputDialog:d,advancedSearch:u,openAdvancedInputDialog:function(e){s.value=u.value[e].value,c.value=e,d.value.open()},removeAdvancedInput:function(e){return"drawAssetOrg"==e||"drawAssetEmployee"==e||"assetCategory"==e?(u.value[e].name=null,void(u.value[e].value=[])):void(u.value[e].value=null)},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{u.value[e].value=R(t)}})},conditionReset:function(){u.value.billCode.value=null,u.value.drawBeginDate.value=null,u.value.drawEndDate.value=null,u.value.drawAssetOrg.value=[],u.value.drawAssetEmployee.value=[],u.value.assetCode.value=null,u.value.assetName.value=null,u.value.assetCategory.value=[],u.value.brand.value=null,u.value.spec.value=null,u.value.model.value=null},advancedInputConfirm:function(e){u.value[c.value].value=e},conditionSearchPopup:m,applyDateTimeChange:({detail:{value:e}},t)=>{u.value[t].value=e},querySearch:function(){g(),m.value.close()},corpDeptSelect:function(e){tt(lt.deptSelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/system/corpDept?multiple=1&ids=${u.value[e].value}`)},personnelSelect:function(e){tt(lt.employeeSelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/system/employee?&multiple=1&ids=${u.value[e].value}`)},categorySelect:function(e){tt(lt.assetCategorySelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/asset/category?isLast=0&multiple=1&ids=${u.value[e].value}`)},billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-list"),Ne),v=e.resolveComponent("DrawerAdvancedSearch"),h=e.resolveComponent("AnchorPointAndQty"),f=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(v,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:o.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-100}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(p,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"发放单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.billCode.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("billCode"))},e.toDisplayString(o.advancedSearch.billCode.value?o.advancedSearch.billCode.value:"发放单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.billCode.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("billCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[2]||(l[2]=e=>o.scanInput("billCode")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"发放日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[3]||(l[3]=e=>o.applyDateTimeChange(e,"drawBeginDate"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.drawBeginDate.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.drawBeginDate.value?o.advancedSearch.drawBeginDate.value:"发放日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.drawBeginDate.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[4]||(l[4]=e=>o.removeAdvancedInput("drawBeginDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"发放日期止：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[5]||(l[5]=e=>o.applyDateTimeChange(e,"drawEndDate"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.drawEndDate.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.drawEndDate.value?o.advancedSearch.drawEndDate.value:"发放日期止"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.drawEndDate.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("drawEndDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"发放部门：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.drawAssetOrg.value.length>0?"content_effective":""]),onClick:l[7]||(l[7]=e.withModifiers((e=>o.corpDeptSelect("drawAssetOrg")),["stop"]))},e.toDisplayString(o.advancedSearch.drawAssetOrg.value.length>0?o.advancedSearch.drawAssetOrg.name:"发放部门"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.drawAssetOrg.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[8]||(l[8]=e=>o.removeAdvancedInput("drawAssetOrg")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"发放人员：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.drawAssetEmployee.value.length>0?"content_effective":""]),onClick:l[9]||(l[9]=e=>o.personnelSelect("drawAssetEmployee"))},e.toDisplayString(o.advancedSearch.drawAssetEmployee.value.length>0?o.advancedSearch.drawAssetEmployee.name:"发放人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.drawAssetEmployee.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[10]||(l[10]=e=>o.removeAdvancedInput("drawAssetEmployee")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产编码：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.assetCode.value?"content_effective":""]),onClick:l[11]||(l[11]=e=>o.openAdvancedInputDialog("assetCode"))},e.toDisplayString(o.advancedSearch.assetCode.value?o.advancedSearch.assetCode.value:"资产编码"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.assetCode.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[12]||(l[12]=e=>o.removeAdvancedInput("assetCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[13]||(l[13]=e=>o.scanInput("assetCode")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.assetName.value?"content_effective":""]),onClick:l[14]||(l[14]=e=>o.openAdvancedInputDialog("assetName"))},e.toDisplayString(o.advancedSearch.assetName.value?o.advancedSearch.assetName.value:"资产名称"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.assetName.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[15]||(l[15]=e=>o.removeAdvancedInput("assetName")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"资产分类：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.assetCategory.value.length>0?"content_effective":""]),onClick:l[16]||(l[16]=e.withModifiers((e=>o.categorySelect("assetCategory")),["stop"]))},e.toDisplayString(o.advancedSearch.assetCategory.value.length>0?o.advancedSearch.assetCategory.name:"资产分类"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.assetCategory.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[17]||(l[17]=e=>o.removeAdvancedInput("assetCategory")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.brand.value?"content_effective":""]),onClick:l[18]||(l[18]=e=>o.openAdvancedInputDialog("brand"))},e.toDisplayString(o.advancedSearch.brand.value?o.advancedSearch.brand.value:"品牌"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.brand.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[19]||(l[19]=e=>o.removeAdvancedInput("brand")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.spec.value?"content_effective":""]),onClick:l[20]||(l[20]=e=>o.openAdvancedInputDialog("spec"))},e.toDisplayString(o.advancedSearch.spec.value?o.advancedSearch.spec.value:"规格"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.spec.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[21]||(l[21]=e=>o.removeAdvancedInput("spec")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.model.value?"content_effective":""]),onClick:l[22]||(l[22]=e=>o.openAdvancedInputDialog("model"))},e.toDisplayString(o.advancedSearch.model.value?o.advancedSearch.model.value:"型号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.model.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[23]||(l[23]=e=>o.removeAdvancedInput("model")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[24]||(l[24]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[25]||(l[25]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[26]||(l[26]=e=>o.conditionSearchPopup.close())},"关闭")])])])),_:1},8,["width"]),e.createVNode(h,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[27]||(l[27]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(f,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[28]||(l[28]=e=>o.qst=e),placeholder:"单号",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[29]||(l[29]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[30]||(l[30]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({BillStatus:t,BillStatusText:l,DrawAssetDate:a,DrawAssetOrgName:n,BillCode:i,BillDatetime:r,BillerEmployeeName:s,DrawAssetEmployeeName:c,ID:d,Remark:u})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:d,onClick:e=>o.itemClick(d)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(l),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(l),1),e.createElementVNode("text",null,"发放日期："+e.toDisplayString(a?a.substring(0,10):""),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"发放部门："+e.toDisplayString(n),1),e.createElementVNode("text",null,"发放人员："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(s),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(u),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[31]||(l[31]=e=>o.conditionSearchPopup.open())},"高级搜索")])],64)}]]);var rc=new class extends Ee{drawBackGetByID(e){return this.request("/Bill/DrawBack/GetByID",{ID:e})}drawBackSaveDraft(e){return this.request("/Bill/DrawBack/SaveDraft",e)}drawBackDelete(e){return this.request("/Bill/DrawBack/Delete",{ID:e})}drawBackList({qst:e,pageNo:t,billCode:l,drawBackBeginDate:a,drawBackEndDate:o}){const n={IsSetNumber:!0,ShowMode:0,Sort:1,PageNO:t,PageSize:20,QST:e,BillCode:l,DrawBackBeginDate:a,DrawBackEndDate:o};return this.request("/Bill/DrawBack/List",n)}assetListQueryByBillType(e){const t={QST:e,PageSize:10,PageNo:1,BillType:2};return this.request("/Asset/List/QueryByBillType",t)}};const sc={components:{BillEnclosure:Is,BillFooterBtn:xs},props:{id:String,type:String},onNavigationBarButtonTap(e){k("/subcontract/asset/requestDraw/requestDrawList")},setup({id:t,type:l}){const a=e.ref({id:null,status:null,isSubmit:null,code:"",drawBackEmployee:{text:h("UserName"),value:h("EmployeeID")},drawBackOrg:{text:h("OrgName"),value:h("OrgID")},drawBackDatetime:{hint:"请选择退库日期",value:$l()},NewLocation:{hint:"退库后存放位置",text:"",value:null},NewKAO:{hint:"退库后管理部门",text:"",value:null},NewKAE:{hint:"退库后管理人员",text:"",value:null},remark:"",IsStart:!1,startFlow:!0,IsApproval:!1,FlowPath:!1,enablingApproval:!1}),o=e.ref(""),n=e.ref([]),i=e.ref("none"),r=e.ref(null),s=e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),c=e.ref(null),d=e.ref(null),u=e.ref(""),m=e.ref(""),p=e.ref([]),v=e.ref(!1),f=e.ref(""),g=e.ref([]),y=e.ref(null),w=e.ref(!1);function N(){c.value.close()}function C(){let e={};e.ID=a.value.id,e.CommitType=a.value.id?1:0,e.IsSubmit=!!a.value.isSubmit,e.DrawBackEmployeeID=a.value.drawBackEmployee.value,e.DrawBackEmployeeName=a.value.drawBackEmployee.text,e.DrawBackOrgID=a.value.drawBackOrg.value,e.DrawBackOrgNameCN=a.value.drawBackOrg.text,e.drawBackDatetime=a.value.drawBackDatetime.value,e.NewLocationID=a.value.NewLocation.value,e.NewLocationNameCN=a.value.NewLocation.text,e.NewKAOID=a.value.NewKAO.value,e.NewKAONameCN=a.value.NewKAO.text,e.NewKAEID=a.value.NewKAE.value,e.NewKAEName=a.value.NewKAE.text,e.Remark=a.value.remark,e.Details=n.value.map(((e,t)=>{let l=e;return l.Sequence=t+1,l})),e.Attachments=p.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),rc.drawBackSaveDraft(e).then((({Code:e,ID:t})=>{E(t).then((()=>{a.value.IsStart&&(v.value=!0)})),N()})).finally((()=>z()))}function E(e){return q(),rc.drawBackGetByID(e).then((({ID:e,Status:t,BillCode:o,DrawBackDatetime:i,DrawBackEmployeeID:r,DrawBackEmployeeName:s,DrawBackOrgID:c,DrawBackOrgNameCN:d,NewLocationName:u,NewLocationID:m,NewKAOName:h,NewKAOID:f,NewKAEName:g,NewKAEID:y,Remark:N,Details:C,Attachments:E,FlowInfo:b})=>{a.value.id=e,a.value.status=t,a.value.code=o,a.value.drawBackDatetime.value=i?i.substring(0,10):"",a.value.drawBackEmployee.value=r,a.value.drawBackEmployee.text=s,a.value.drawBackOrg.value=c,a.value.drawBackOrg.text=d,a.value.NewLocation.text=u,a.value.NewLocation.value=m,a.value.NewKAO.text=h,a.value.NewKAO.value=f,a.value.NewKAE.text=g,a.value.NewKAE.value=y,a.value.remark=N,n.value=C,p.value=E.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),w.value=1!=a.value.status&&null!=a.value.status,a.value.IsApproval=b.IsApproval,a.value.IsStart=1!=t&&!b.IsStart&&b.IsEnabledFlow,a.value.FlowPath=1!=t&&b.IsStart&&b.IsEnabledFlow||b.IsSendBack,v.value=!1,l&&"mywork"==l&&!a.value.IsApproval&&et(lt.billDetailBack).then((()=>S()))})).finally((()=>z()))}let b=e.computed((()=>{let e=0;for(let t=0;t<n.value.length;t++)e+=parseInt(n.value[t].qty);return e}));function V(e){q(),rc.assetListQueryByBillType(e).then((({Items:e})=>{g.value=e.map((e=>(e.checked=!1,e))),g.value.length<1?F("未查询到可用资产资料"):y.value.open()})).finally((()=>z()))}t&&E(t),tt(lt.signBack,(()=>E(a.value.id))),uni.getSystemInfo({success:e=>{f.value=e.windowHeight}});let x=e.computed((()=>{let e,t;return(f.value-60)/2>315?(e=315,t=f.value-375):e=t=(f.value-60)/2,{header:e,content:t}}));return{type:l,IsScroll:x,bill:a,billDetail:n,uniSwipeActionItemRightOptions:Ot,isOpened:i,uniSwipeChange:function(e,t){n.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(n.value.splice(t,1),L("移除成功"))},dialogRemarkInputConfirm:function(e){a.value.remark=e.trim()},remarkVal:o,inputRemarkDialog:r,openRemarkDialog:function(){o.value=a.value.remark,r.value.open()},deleteDialogConfirm:function(){q(),rc.drawBackDelete(a.value.id).then((()=>{et(lt.drawBackDetailBack).then((()=>S()))})).finally((()=>z()))},handleSaveDraft:function(e){if(a.value.isSubmit=e,a.value.drawBackDatetime.value){if(a.value.drawBackEmployee.value)return n.value.length<1?(m.value="listDetail",void F("请添加资产信息")):void(a.value.isSubmit?c.value.open():C());F("请选择经办人")}else F("请选择退库日期")},submitDialog:c,submitMsgType:s,submitDialogConfirm:C,submitDialogClose:N,billDetailNumber:b,editGetByID:E,nonEditable:w,autoStart:v,jumpList:function(){k("/subcontract/asset/drawBack/drawBackList")},scanCodeDialog:d,searchCodeVal:u,serachAssetList:g,assetDialog:y,assetDialogConfirm:function(){let e=g.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(n.value.filter((t=>t.AssetID==e[l].ID)).length<1){let t={isOpened:"none"};t.AssetID=e[l].ID,t.ID=null,t.Name=e[l].Name,t.Code=e[l].Code,t.OriginalCode=e[l].OriginalCode,t.CategoryID=e[l].CategoryID,t.CategoryName=e[l].CategoryName,t.CategoryNameCN=e[l].CategoryNameCN,t.CategoryNameEN=e[l].CategoryNameEN,t.Brand=e[l].Brand,t.Spec=e[l].Spec,t.Model=e[l].Model,t.Qty=e[l].Qty,t.OriginalAmount=e[l].OriginalAmount,t.OriginalKAOID=e[l].KAOID,t.OriginalKAOName=e[l].KAOName,t.OriginalKAONameCN=e[l].KAONameCN,t.OriginalKAONameEN=e[l].KAONameEN,t.OriginalKAEID=e[l].KAEID,t.OriginalKAEName=e[l].KAEName,t.OriginalUAOID=e[l].UAOID,t.OriginalUAOName=e[l].UAOName,t.OriginalUAONameCN=e[l].UAONameCN,t.OriginalUAONameEN=e[l].UAONameEN,t.OriginalUAEID=e[l].UAEID,t.OriginalUAEName=e[l].UAEName,t.OriginalLocationID=e[l].LocationID,t.OriginalLocationName=e[l].LocationName,n.value.push(t)}else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}y.value.close(),g.value=[]},addQuery:V,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?V(t):F("无效的检索条件")},windowHeights:f,drawBackDatetimeChange:({detail:{value:e}})=>{w.value||(a.value.drawBackDatetime.value=e)},locationSelect:function(e){tt(lt.locationSelectBack,(({id:t,label:l})=>{a.value[e].value=t,a.value[e].text=l})),k(`pages/selector/asset/location?isLast=1&multiple=0&ids=${a.value[e].value}`)},corpDeptSelect:function(e){tt(lt.deptSelectBack,(({id:t,label:l})=>{a.value[e].value=t,a.value[e].text=l})),k(`pages/selector/system/corpDept?multiple=0&type=1&ids=${a.value[e].value}`)},checkBoxChange:function(e,t){let l=e.detail.value,a=g.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},removeInput:function(e){if("drawBackDatetime"!=e)return"drawBackEmployee"==e?(a.value.drawBackEmployee.text="",a.value.drawBackEmployee.value=null,a.value.drawBackOrg.text="",void(a.value.drawBackOrg.value=null)):"NewLocation"==e?(a.value.NewLocation.text="",void(a.value.NewLocation.value=null)):"NewKAO"==e?(a.value.NewKAO.text="",a.value.NewKAO.value=null,a.value.NewKAE.text="",void(a.value.NewKAE.value=null)):"NewKAE"==e?(a.value.NewKAE.text="",void(a.value.NewKAE.value=null)):void("remark"!=e||(a.value.remark=""));a.value.drawBackDatetime.value=""},personnelSelect:function(e){if("NewKAE"==e&&!a.value.NewKAO.value)return void F("请先选择管理部门");tt(lt.employeeSelectBack,(({ID:t,Name:l,OrgID:o,OrgName:n})=>{a.value[e].value=t,a.value[e].text=l,"drawBackEmployee"==e&&(a.value.drawBackOrg.value=o,a.value.drawBackOrg.text=n)}));const t=a.value[e].value;k(`pages/selector/system/employee?&multiple=0&corpID=${"NewKAE"==e?a.value.NewKAO.value:""}&ids=${t}`)},files:p,scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{V(R(e))}})},toIndex:m,filesChange:function(e){p.value=e}}}};var cc=l(sc,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-icons"),fe),p=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),v=r(e.resolveDynamicComponent("uni-swipe-action"),ps),h=r(e.resolveDynamicComponent("uni-section"),ue),f=e.resolveComponent("BillEnclosure"),g=e.resolveComponent("BillFooterBtn");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"资产搜索",value:o.searchCodeVal,placeholder:"编码/原编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"assetDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{title:"选择资产",type:"info","before-close":!0,onClose:l[0]||(l[0]=e=>o.assetDialog.close()),onConfirm:o.assetDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachAssetList,(({ID:t,Name:l,Code:a,CategoryName:n,Brand:i,Spec:r,Model:s,checked:c})=>(e.openBlock(),e.createBlock(d,{key:t},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(s),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,t)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:c},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1}),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"退库日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["item_text_content",o.bill.drawBackDatetime.value?"content_effective":""])},[e.createElementVNode("picker",{mode:"date",onChange:l[1]||(l[1]=(...e)=>o.drawBackDatetimeChange&&o.drawBackDatetimeChange(...e))},[e.createElementVNode("text",null,e.toDisplayString(o.bill.drawBackDatetime.value?o.bill.drawBackDatetime.value:"请选择日期"),1)],32)],2)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.drawBackDatetime.value?(e.openBlock(),e.createBlock(m,{key:0,onClick:l[2]||(l[2]=e=>o.removeInput("drawBackDatetime")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.drawBackEmployee.value?"content_effective":""]),onClick:l[3]||(l[3]=e=>o.personnelSelect("drawBackEmployee"))},e.toDisplayString(o.bill.drawBackEmployee.value?o.bill.drawBackEmployee.text:"请选择经办人"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.drawBackEmployee.value?(e.openBlock(),e.createBlock(m,{key:0,onClick:l[4]||(l[4]=e=>o.removeInput("drawBackEmployee")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"退库后存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewLocation.value?"content_effective":""]),onClick:l[5]||(l[5]=e=>o.locationSelect("NewLocation"))},e.toDisplayString(o.bill.NewLocation.value?o.bill.NewLocation.text:"请选择存放位置"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewLocation.value?(e.openBlock(),e.createBlock(m,{key:0,onClick:l[6]||(l[6]=e=>o.removeInput("NewLocation")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"退库后管理部门：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewKAO.value?"content_effective":""]),onClick:l[7]||(l[7]=e=>o.corpDeptSelect("NewKAO"))},e.toDisplayString(o.bill.NewKAO.value?o.bill.NewKAO.text:"请选择管理部门"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewKAO.value?(e.openBlock(),e.createBlock(m,{key:0,onClick:l[8]||(l[8]=e=>o.removeInput("NewKAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"退库后管理人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewKAE.value?"content_effective":""]),onClick:l[9]||(l[9]=e=>o.personnelSelect("NewKAE"))},e.toDisplayString(o.bill.NewKAE.value?o.bill.NewKAE.text:"请选择管理人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewKAE.value?(e.openBlock(),e.createBlock(m,{key:0,onClick:l[10]||(l[10]=e=>o.removeInput("NewKAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.remark?"content_effective":""]),onClick:l[11]||(l[11]=e=>o.nonEditable?null:o.openRemarkDialog())},e.toDisplayString(o.bill.remark?o.bill.remark:"请输入备注信息"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(m,{key:0,onClick:l[12]||(l[12]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill_detail_scroll",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),onScroll:l[13]||(l[13]=e=>o.toIndex=""),"scroll-into-view":o.toIndex,"scroll-with-animation":!0,"scroll-y":""},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(h,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[e.createVNode(v,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,(({AssetID:t,Code:l,Name:a,CategoryName:n,OriginalCode:i,OriginalAmount:r,OriginalKAOName:s,OriginalKAEName:c,OriginalUAOName:d,OriginalUAEName:u,OriginalLocationName:m,Brand:v,Spec:h,Model:f,Unit:g,Qty:y,isOpened:w},N)=>(e.openBlock(),e.createBlock(p,{disabled:o.nonEditable,"right-options":o.uniSwipeActionItemRightOptions,show:w,"auto-close":!1,onChange:e=>o.uniSwipeChange(N),key:t,onClick:e=>o.uniSwipeClick(e,N)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["detail_content_item",o.nonEditable?"disabled_color":""]),style:e.normalizeStyle(N+1==o.billDetail.length?"margin-bottom:0px":"")},[e.createElementVNode("text",{class:"content_item_title"},"资产名称："+e.toDisplayString(a),1),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(l),1),e.createElementVNode("text",null,"原编码："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1),e.createElementVNode("text",null,"存放位置："+e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"管理部门："+e.toDisplayString(s),1),e.createElementVNode("text",null,"管理人员："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"使用部门："+e.toDisplayString(d),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(v),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(h),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(f),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(y),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"原值："+e.toDisplayString(r),1)])],6)])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1}),o.billDetail.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:"height:100%"}," 暂 无 数 据 ")):e.createCommentVNode("",!0)])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(f,{option:o.files,onChange:o.filesChange,nonEditable:o.nonEditable},null,8,["option","onChange","nonEditable"])],44,["scroll-into-view"]),e.createVNode(g,{type:o.type,billType:"DrawBack",bill:o.bill,nonEditable:o.nonEditable,autoStart:o.autoStart,onJumpList:o.jumpList,onSave:o.handleSaveDraft,onDelete:o.deleteDialogConfirm,onScrollToTop:l[14]||(l[14]=e=>o.toIndex="listDetail"),onScrollToFooter:l[15]||(l[15]=e=>o.toIndex="example"),onScan:l[16]||(l[16]=e=>o.scan()),onKeyword:l[17]||(l[17]=e=>o.scanCodeDialog.open()),onGetById:l[18]||(l[18]=e=>o.editGetByID(e))},null,8,["type","bill","nonEditable","autoStart","onJumpList","onSave","onDelete"])],64)}]]);var dc=l({components:{DrawerAdvancedSearch:As,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(""),d=e.ref(null),u=e.ref({returnCode:{hint:"退库单号",value:null},returnDateStart:{hint:"退库日期起",value:null},returnDateEnd:{hint:"申领日期止",value:null}}),m=e.ref(null),v=e.ref(""),h=e.ref("");async function f(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await rc.drawBackList({qst:t.value,pageNo:l,billCode:u.value.returnCode.value,drawBackBeginDate:u.value.returnDateStart.value,drawBackEndDate:u.value.returnDateEnd.value});a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function g(){return l=1,f()}return f(),tt(lt.drawBackDetailBack,g),uni.getSystemInfo({success:e=>{v.value=e.windowWidth,h.value=e.windowHeight}}),p((()=>{g()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:g,itemClick:function(e){k(`/subcontract/asset/drawBack/drawBackDetail?id=${e}&type=list`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,f())},windowWidths:v,windowHeights:h,advancedInputVal:s,advancedInputKey:c,advancedInputDialog:d,advancedSearch:u,openAdvancedInputDialog:function(e){s.value=u.value[e].value,c.value=e,d.value.open()},removeAdvancedInput:function(e){"returnCode"!=e&&"returnDateStart"!=e&&"returnDateEnd"!=e||(u.value[e].value=null)},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{u.value[e].value=R(t)}})},conditionReset:function(){u.value.returnCode.value=null,u.value.returnDateStart.value=null,u.value.returnDateEnd.value=null},advancedInputConfirm:function(e){u.value[c.value].value=e},conditionSearchPopup:m,applyDateTimeChange:({detail:{value:e}},t)=>{u.value[t].value=e},querySearch:function(){g(),m.value.close()},billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-list"),Ne),v=e.resolveComponent("DrawerAdvancedSearch"),h=e.resolveComponent("AnchorPointAndQty"),f=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(v,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:o.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-100}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(p,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"退库单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.returnCode.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("returnCode"))},e.toDisplayString(o.advancedSearch.returnCode.value?o.advancedSearch.returnCode.value:"退库单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.returnCode.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("returnCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[2]||(l[2]=e=>o.scanInput("returnCode")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"退库日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[3]||(l[3]=e=>o.applyDateTimeChange(e,"returnDateStart"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.returnDateStart.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.returnDateStart.value?o.advancedSearch.returnDateStart.value:"退库日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.returnDateStart.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[4]||(l[4]=e=>o.removeAdvancedInput("returnDateStart")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"退库日期止：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[5]||(l[5]=e=>o.applyDateTimeChange(e,"returnDateEnd"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.returnDateEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.returnDateEnd.value?o.advancedSearch.returnDateEnd.value:"退库日期止"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.returnDateEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("returnDateEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[7]||(l[7]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[8]||(l[8]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[9]||(l[9]=e=>o.conditionSearchPopup.close())},"关闭")])])])),_:1},8,["width"]),e.createVNode(h,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[10]||(l[10]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(f,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[11]||(l[11]=e=>o.qst=e),placeholder:"单号",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[12]||(l[12]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[13]||(l[13]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({BillStatus:l,BillStatusText:a,DrawBackOrgName:n,BillCode:i,BillDatetime:r,BillerEmployeeName:s,DrawBackDatetime:c,DrawBackEmployeeName:d,NewKAOName:u,NewKAEName:m,NewLocationName:p,BillID:v,Remark:h})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:v,onClick:e=>o.itemClick(v)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(l))},e.toDisplayString(a),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(a),1),e.createElementVNode("text",null,"退库日期："+e.toDisplayString(c?c.substring(0,10):""),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"经办部门："+e.toDisplayString(n),1),e.createElementVNode("text",null,"经办人员："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"退库后管理部门："+e.toDisplayString(u),1),e.createElementVNode("text",null,"退库后管理人员："+e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"退库后存放位置："),e.createElementVNode("text",null,e.toDisplayString(p),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(s),1),e.createElementVNode("text",null,"制单部门："+e.toDisplayString(t.BillDateTime),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(h),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[14]||(l[14]=e=>o.conditionSearchPopup.open())},"高级搜索")])],64)}]]);var uc=new class extends Ee{discardGetByID(e){return this.request("/Bill/Discard/GetByID",{ID:e})}discardSaveDraft(e){return this.request("/Bill/Discard/SaveDraft",e)}discardDelete(e){return this.request("/Bill/Discard/Delete",{ID:e})}discardList({qst:e,pageNo:t,pageSize:l,billCode:a,handlerEmployeeIDs:o,discardBeginDate:n,discardEndDate:i,discardModeIDs:r}){const s={IsSetNumber:!0,ShowMode:0,Sort:1,BillCode:a,HandlerEmployeeIDs:o,DiscardBeginDate:n,DiscardEndDate:i,DiscardModeIDs:r,PageNO:t,PageSize:l||20,QST:e};return this.request("/Bill/Discard/List",s)}getById(e){return this.request("/Asset/GetByID",{ID:e,Visibility:1})}assetListQueryByBillType(e){const t={BillType:7,Conditions:[],PageNO:1,PageSize:10,QST:e};return this.request("/Asset/List/QueryByBillType",t)}};const mc={components:{BillEnclosure:Is,BillFooterBtn:xs},props:{id:String,type:String},setup({id:t,type:l}){const a=e.ref(""),o=e.ref({id:null,status:null,isSubmit:null,code:"",handlerEmployee:{text:h("UserName"),value:h("EmployeeID")},handlerOrgID:{text:h("OrgName"),value:h("OrgID")},discardDatetime:{hint:"请选择报废日期",value:$l()},cost:{hint:"处置成本",value:null},income:{hint:"处置收入",value:null},remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),n=e.ref(null),r=e.ref(null),s=e.ref(null),c=e.ref({name:"",code:"",disposalVal:"",disposalText:"",remarks:""}),d=e.ref([]),u=e.ref(null),m=e.ref("");let p=e.ref([]);const v=e.ref(null),f=e.ref("none"),g=e.ref(null),y=e.ref(""),w=e.ref(null),N=e.ref(null),C=e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),E=e.ref(null),b=e.ref(null),V=e.ref(null),x=e.ref([]),_=e.ref(""),I=e.ref([]),B=e.ref(!1),T=e.ref(!1),A=e.ref("");function P(e){q(),uc.assetListQueryByBillType(e).then((({Items:e})=>{p.value=e.map((e=>(e.checked=!1,e))),p.value.length<1?F("未查询到可用资产"):v.value.open()})).finally((()=>z()))}function O(e){y.value=e?"新增":"编辑",g.value.open()}function U(){c.value.name=null,c.value.code=null,c.value.disposalVal=null,c.value.disposalText=null,c.value.remarks=null,N.value=null,g.value.close()}function M(){E.value.close()}function W(){let e={};e.ID=o.value.id,e.CommitType=o.value.id?1:0,e.IsSubmit=!!o.value.isSubmit,e.DiscardDatetime=o.value.discardDatetime.value,e.HandlerEmployeeID=o.value.handlerEmployee.value,e.HandlerEmployeeName=o.value.handlerEmployee.text,e.HandlerOrgID=o.value.handlerOrgID.value,e.HandlerOrgNameCN=o.value.handlerOrgID.text,e.HandlerOrgNameEN=o.value.handlerOrgID.text,e.DiscardCost=o.value.cost.value,e.DiscardIncome=o.value.income.value,e.Remark=o.value.remark,e.Details=d.value.map(((e,t)=>{let l=e;return l.Sequence=t+1,l})),e.Attachments=I.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),uc.discardSaveDraft(e).then((({Code:e,ID:t})=>{$(t).then((()=>{o.value.IsStart&&(T.value=!0)})),M()})).finally((()=>z()))}function $(e){return q(),uc.discardGetByID(e).then((({ID:e,Status:t,BillCode:a,DiscardDatetime:n,HandlerEmployeeID:i,HandlerEmployeeName:r,HandlerOrgID:s,HandlerOrgNameCN:c,DiscardCost:u,DiscardIncome:m,Remark:p,Details:v,Attachments:h,FlowInfo:f})=>{o.value.id=e,o.value.status=t,o.value.code=a,o.value.discardDatetime.value=n?n.substring(0,10):"",o.value.handlerEmployee.value=i,o.value.handlerEmployee.text=r,o.value.handlerOrgID.value=s,o.value.handlerOrgID.text=c,o.value.cost.value=u,o.value.income.value=m,o.value.remark=p,d.value=v,I.value=h.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),B.value=1!=o.value.status&&null!=o.value.status,o.value.IsApproval=f.IsApproval,o.value.IsStart=1!=t&&!f.IsStart&&f.IsEnabledFlow,o.value.FlowPath=1!=t&&f.IsStart&&f.IsEnabledFlow||f.IsSendBack,T.value=!1,l&&"mywork"==l&&!o.value.IsApproval&&et(lt.billDetailBack).then((()=>S()))})).finally((()=>z()))}let Q=e.computed((()=>{let e=0;for(let t=0;t<d.value.length;t++)e+=parseInt(d.value[t].qty);return e}));hs.dictionaryGetByCode("D005").then((({Items:e})=>{x.value=e.map((e=>({text:e.ItemText,value:e.ID})));const{ID:t,ItemText:l}=e.filter((e=>e.IsDefaultItem))[0];b.value=t,V.value=l,i("log","at subcontract/asset/discard/detail.vue:856",b.value),i("log","at subcontract/asset/discard/detail.vue:857",V.value)})),t&&$(t),tt(lt.signBack,(()=>$(o.value.id))),uni.getSystemInfo({success:e=>{A.value=e.windowHeight}});let j=e.computed((()=>{let e,t;return(A.value-60)/2>270?(e=270,t=A.value-330):e=t=(A.value-60)/2,{header:e,content:t}}));return{type:l,IsScroll:j,bill:o,billDetail:d,remarkVal:a,rowDetail:c,uniSwipeActionItemRightOptions:Ot,isOpened:f,uniSwipeChange:function(e,t){d.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(d.value.splice(t,1),L("移除成功"))},inputDialog:g,openEditDetailDalog:O,dialogRemarkInputConfirm:function(e){o.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:w,openRemarkDialog:function(){a.value=o.value.remark,w.value.open()},editDetailConfirm:function(e){d.value[N.value].DiscardModeID=c.value.disposalVal,d.value[N.value].DiscardModeName=c.value.disposalText,d.value[N.value].DiscardModeNameCN=c.value.disposalText,d.value[N.value].DiscardModeNameEN=c.value.disposalText,d.value[N.value].DiscardDesc=c.value.remarks,U()},editDetailClose:function(){U()},editBillDetail:function(e){if(B&&null!==o.value.status&&1!=o.value.status)return;N.value=e;const{Name:t,Code:l,DiscardModeID:a,DiscardModeName:n,DiscardDesc:i}=d.value[e];c.value.name=t,c.value.code=l,c.value.disposalVal=a,c.value.disposalText=n,c.value.remarks=i,O(0)},deleteDialogConfirm:function(){q(),uc.discardDelete(o.value.id).then((()=>{et(lt.discardDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:U,handleSaveDraft:function(e){if(o.value.isSubmit=e,o.value.discardDatetime.value)if(o.value.handlerEmployee.value)if(o.value.cost.value){if(o.value.income.value)return d.value.length<1?(_.value="listDetail",void F("请添加资产信息")):void(o.value.isSubmit?E.value.open():W());F("请输入处置收入")}else F("请输入处置成本");else F("请选择经办人");else F("请选择报废日期")},submitDialog:E,submitMsgType:C,submitDialogConfirm:W,submitDialogClose:M,editInfoTitle:y,billDetailNumber:Q,editGetByID:$,nonEditable:B,jumpList:function(){k("/subcontract/asset/discard/list")},windowHeights:A,scanCodeDialog:u,searchCodeVal:m,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?P(t):F("无效的检索条件")},addQuery:P,serachAssetList:p,assetsDialog:v,assetsDialogConfirm:function(){let e=p.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(d.value.filter((t=>t.AssetID==e[l].ID)).length<1){let t={};t.AssetID=e[l].ID,t.ID=null,t.BillID=null,t.Name=e[l].Name,t.Code=e[l].Code,t.CategoryID=e[l].CategoryID,t.CategoryName=e[l].CategoryName,t.CategoryNameCN=e[l].CategoryNameCN,t.CategoryNameEN=e[l].CategoryNameEN,t.DiscardModeID=b.value,t.DiscardModeName=V.value,t.DiscardModeNameCN=V.value,t.DiscardModeNameEN=V.value,t.OriginalAmount=e[l].OriginalAmount,t.OriginalCode=e[l].OriginalCode,t.Brand=e[l].Brand,t.Spec=e[l].Spec,t.Model=e[l].Model,t.Qty=e[l].Qty,t.DiscardDesc=null,t.isOpened="none",t.Qty=1,d.value.push(t),i("log","at subcontract/asset/discard/detail.vue:928",d.value)}else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}v.value.close(),p.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=p.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{P(R(e))}})},applyDateTimeChange:({detail:{value:e}})=>{B.value||(o.value.discardDatetime.value=e)},removeInput:function(e){if("discardDatetime"!=e&&"cost"!=e&&"income"!=e)return"handlerEmployee"==e?(o.value.handlerEmployee.text="",o.value.handlerEmployee.value=null,o.value.handlerOrgID.text="",void(o.value.handlerOrgID.value=null)):void("remark"!=e||(o.value.remark=""));o.value[e].value=null},locationSelect:function(e){tt(lt.locationSelectBack,(({id:t,label:l})=>{o.value[e].value=t,o.value[e].text=l})),k(`pages/selector/asset/location?isLast=1&multiple=0&ids=${o.value[e].value}`)},corpDeptSelect:function(e){tt(lt.deptSelectBack,(({id:t,label:l})=>{o.value[e].value=t,o.value[e].text=l}));const t=o.value[e].value;k(`pages/selector/system/corpDept?multiple=0&type=${"NewCorp"==e?2:1}&ids=${t}`)},personnelSelect:function(e){if("NewKAE"==e&&!o.value.NewKAO.value)return void F("请先选择管理部门");tt(lt.employeeSelectBack,(({ID:t,Name:l,OrgID:a,OrgName:n})=>{o.value[e].value=t,o.value[e].text=l,"handlerEmployee"==e&&(o.value.handlerOrgID.value=a,o.value.handlerOrgID.text=n)}));const t=o.value[e].value;k(`pages/selector/system/employee?&multiple=0&corpID=${"NewKAE"==e?o.value.NewKAO.value:""}&ids=${t}`)},disposalType:x,scrappingReasonVal:b,disposalTypeChange:function(e){const{value:t,text:l}=x.value.filter((t=>t.value==e))[0];c.value.disposalVal=t,c.value.disposalText=l},inputAmountDialog:s,amountVal:n,amountInputKey:r,openAmountDialog:function(e){n.value=o.value[e].value,r.value=e,s.value.open()},dialogAmountInputConfirm:function(){if(!n.value)return void F("请输入金额");const e=parseFloat(n.value);o.value[r.value].value=e.toString()},files:I,filesChange:function(e){I.value=e},toIndex:_,autoStart:T}}};var pc=l(mc,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-easyinput"),Ie),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl),u=r(e.resolveDynamicComponent("uni-list-item"),we),m=r(e.resolveDynamicComponent("uni-list"),Ne),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-icons"),fe),h=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),f=r(e.resolveDynamicComponent("uni-swipe-action"),ps),g=r(e.resolveDynamicComponent("uni-section"),ue),y=e.resolveComponent("BillEnclosure"),w=e.resolveComponent("BillFooterBtn");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(d,{ref:"inputAmountDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info",title:"输入金额",onConfirm:o.dialogAmountInputConfirm},{default:e.withCtx((()=>[e.createVNode(s,{focus:"",border:!1,maxlength:"10",type:"number",modelValue:o.amountVal,"onUpdate:modelValue":l[0]||(l[0]=e=>o.amountVal=e),placeholder:"请输入金额"},null,8,["modelValue"])])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(d,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"assetsDialog",class:"assetsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{title:"选择资产",type:"info","before-close":!0,onClose:l[1]||(l[1]=e=>o.assetsDialog.close()),onConfirm:o.assetsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(m,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachAssetList,(({ID:t,Name:l,Code:a,CategoryName:n,Brand:i,Spec:r,Model:s,checked:c})=>(e.openBlock(),e.createBlock(u,{key:t},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资料编码："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(s),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,t)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:c},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(c,{"before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"edit_detail_content"},[e.createVNode(m,null,{default:e.withCtx((()=>[e.createVNode(u,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"编码：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.code),1)])])),_:1}),e.createVNode(u,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.name),1)])])),_:1}),e.createVNode(u,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"处置方式：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createVNode(p,{class:"data-picker-request-draw",placeholder:"请选择处置方式",border:!1,"clear-icon":!1,localdata:o.disposalType,onInput:o.disposalTypeChange,modelValue:o.rowDetail.disposalVal,"onUpdate:modelValue":l[2]||(l[2]=e=>o.rowDetail.disposalVal=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.rowDetail.disposalVal?"info-item-color":""])},e.toDisplayString(o.rowDetail.disposalVal?o.rowDetail.disposalText:"请选择处置方式"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),_:1}),e.createVNode(u,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"处置说明：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createVNode(s,{border:!1,maxlength:"10",type:"text",modelValue:o.rowDetail.remarks,"onUpdate:modelValue":l[3]||(l[3]=e=>o.rowDetail.remarks=e),placeholder:"请输入处置说明"},null,8,["modelValue"])])])),_:1})])),_:1})])])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{mode:"input",title:"资产搜索",value:o.searchCodeVal,placeholder:"编码/原编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"bill_header"},[e.createVNode(m,null,{default:e.withCtx((()=>[e.createVNode(u,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1}),e.createVNode(u,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"报废日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("picker",{mode:"date",onChange:l[4]||(l[4]=(...e)=>o.applyDateTimeChange&&o.applyDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.discardDatetime.value?"content_effective":""])},e.toDisplayString(o.bill.discardDatetime.value?o.bill.discardDatetime.value:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.discardDatetime.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[5]||(l[5]=e=>o.removeInput("discardDatetime")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(u,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.handlerEmployee.value?"content_effective":""]),onClick:l[6]||(l[6]=e=>o.personnelSelect("handlerEmployee"))},e.toDisplayString(o.bill.handlerEmployee.value?o.bill.handlerEmployee.text:"请选择人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.handlerEmployee.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[7]||(l[7]=e=>o.removeInput("handlerEmployee")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(u,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"处置成本：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.cost.value?"content_effective":""]),onClick:l[8]||(l[8]=e=>o.nonEditable?null:o.openAmountDialog("cost"))},e.toDisplayString(o.bill.cost.value?o.bill.cost.value:"请输入处置成本"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.cost.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[9]||(l[9]=e=>o.removeInput("cost")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(u,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"处置收入：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.income.value?"content_effective":""]),onClick:l[10]||(l[10]=e=>o.nonEditable?null:o.openAmountDialog("income"))},e.toDisplayString(o.bill.income.value?o.bill.income.value:"请输入处置收入"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.income.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[11]||(l[11]=e=>o.removeInput("income")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(u,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.remark?"content_effective":""]),onClick:l[12]||(l[12]=e=>o.nonEditable?null:o.openRemarkDialog())},e.toDisplayString(o.bill.remark?o.bill.remark:"请输入备注信息"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[13]||(l[13]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill_detail_scroll",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),onScroll:l[14]||(l[14]=e=>o.toIndex=""),"scroll-into-view":o.toIndex,"scroll-with-animation":!0,"scroll-y":""},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(g,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(h,{disabled:o.nonEditable,"right-options":o.uniSwipeActionItemRightOptions,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.index,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["detail_content_item",o.nonEditable?"disabled_color":""]),onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("text",{class:"content_item_title",selectable:""},"资产名称："+e.toDisplayString(t.Name),1),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",{selectable:""},"资产编码："+e.toDisplayString(t.Code),1),e.createElementVNode("text",null,"原编码："+e.toDisplayString(t.OriginalCode),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"原值："+e.toDisplayString(t.OriginalAmount),1),e.createElementVNode("text",null,"资产分类："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"处置方式："+e.toDisplayString(t.DiscardModeName),1),e.createElementVNode("text",null,"处置说明："+e.toDisplayString(t.DiscardDesc),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(t.Brand),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(t.Qty),1)])],10,["onClick"])])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1}),o.billDetail.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:"height:100%"}," 暂 无 数 据 ")):e.createCommentVNode("",!0)])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(y,{option:o.files,onChange:o.filesChange,nonEditable:o.nonEditable},null,8,["option","onChange","nonEditable"])],44,["scroll-into-view"]),e.createVNode(w,{type:o.type,billType:"Discard",bill:o.bill,nonEditable:o.nonEditable,autoStart:o.autoStart,onJumpList:o.jumpList,onSave:o.handleSaveDraft,onDelete:o.deleteDialogConfirm,onScrollToTop:l[15]||(l[15]=e=>o.toIndex="listDetail"),onScrollToFooter:l[16]||(l[16]=e=>o.toIndex="example"),onScan:l[17]||(l[17]=e=>o.scan()),onKeyword:l[18]||(l[18]=e=>o.scanCodeDialog.open()),onGetById:l[19]||(l[19]=e=>o.editGetByID(e))},null,8,["type","bill","nonEditable","autoStart","onJumpList","onSave","onDelete"])],64)}]]);var vc=l({components:{DrawerAdvancedSearch:As,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(""),d=e.ref(null),u=e.ref({code:{hint:"报废单号",value:null},handlerEmployee:{hint:"经办人",name:"",value:[]},discardBeginDate:{hint:"报废日期起",value:null},discardEndDate:{hint:"报废日期止",value:null},discardModel:{hint:"处置方式",name:"",value:null,options:[]}}),m=e.ref(null),v=e.ref(""),h=e.ref("");async function f(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await uc.discardList({qst:t.value,pageNo:l,billCode:u.value.code.value,handlerEmployeeIDs:u.value.handlerEmployee.value,discardBeginDate:u.value.discardBeginDate.value,discardEndDate:u.value.discardEndDate.value,discardModeIDs:u.value.discardModel.value?[u.value.discardModel.value]:[]});a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function g(){return l=1,f()}return hs.dictionaryGetByCode("D005").then((({Items:e})=>{u.value.discardModel.options=e.map((e=>({text:e.ItemText,value:e.ID})))})),f(),tt(lt.discardDetailBack,g),uni.getSystemInfo({success:e=>{v.value=e.windowWidth,h.value=e.windowHeight}}),p((()=>{g()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:g,itemClick:function(e){k(`/subcontract/asset/discard/detail?id=${e}&type=list`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,f())},windowWidths:v,windowHeights:h,advancedInputVal:s,advancedInputKey:c,advancedInputDialog:d,advancedSearch:u,openAdvancedInputDialog:function(e){s.value=u.value[e].value,c.value=e,d.value.open()},removeAdvancedInput:function(e){if("discardModel"==e)return u.value[e].value=null,void(u.value[e].text=null);"handlerEmployee"==e?(u.value[e].value=[],u.value[e].text=null):u.value[e].value=null},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{u.value[e].value=t}})},conditionReset:function(){u.value.code.value=null,u.value.handlerEmployee.name=null,u.value.handlerEmployee.value=[],u.value.discardBeginDate.value=null,u.value.discardEndDate.value=null,u.value.discardModel.value=null,u.value.discardModel.name=null},advancedInputConfirm:function(e){u.value[c.value].value=e},conditionSearchPopup:m,applyDateTimeChange:({detail:{value:e}},t)=>{u.value[t].value=e},querySearch:function(){g(),m.value.close()},personnelSelect:function(e){tt(lt.employeeSelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/system/employee?multiple=1&ids=${u.value[e].value}`)},discardReasonChange:function(e){u.value.discardModel.name=u.value.discardModel.options.filter((t=>t.value==e))[0].text,u.value.discardModel.value=e},billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-list"),Ne),h=e.resolveComponent("DrawerAdvancedSearch"),f=e.resolveComponent("AnchorPointAndQty"),g=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(h,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:o.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-100}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.code.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("code"))},e.toDisplayString(o.advancedSearch.code.value?o.advancedSearch.code.value:"报废单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.code.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("code")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[2]||(l[2]=e=>o.scanInput("code")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 96px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.handlerEmployee.value.length>0?"content_effective":""]),onClick:l[3]||(l[3]=e.withModifiers((e=>o.personnelSelect("handlerEmployee")),["stop"]))},e.toDisplayString(o.advancedSearch.handlerEmployee.value.length>0?o.advancedSearch.handlerEmployee.name:"选择人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.handlerEmployee.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[4]||(l[4]=e=>o.removeAdvancedInput("handlerEmployee")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{color:"red",type:"scan",size:"16",style:{opacity:"0"}})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[5]||(l[5]=e=>o.applyDateTimeChange(e,"discardBeginDate"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.discardBeginDate.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.discardBeginDate.value?o.advancedSearch.discardBeginDate.value:"报废日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.discardBeginDate.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("discardBeginDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[7]||(l[7]=e=>o.applyDateTimeChange(e,"discardEndDate"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.discardEndDate.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.discardEndDate.value?o.advancedSearch.discardEndDate.value:"报废日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.discardEndDate.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[8]||(l[8]=e=>o.removeAdvancedInput("discardEndDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废原因：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{class:"data-picker-request-draw",placeholder:"是否结束",border:!1,"clear-icon":!1,localdata:o.advancedSearch.discardModel.options,onInput:o.discardReasonChange,modelValue:o.advancedSearch.discardModel.value,"onUpdate:modelValue":l[9]||(l[9]=e=>o.advancedSearch.discardModel.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.discardModel.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.discardModel.value?o.advancedSearch.discardModel.name:"处置方式"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.discardModel.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[10]||(l[10]=e=>o.removeAdvancedInput("discardModel")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[11]||(l[11]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[12]||(l[12]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[13]||(l[13]=e=>o.conditionSearchPopup.close())},"关闭")])])])),_:1},8,["width"]),e.createVNode(f,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[14]||(l[14]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(g,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[15]||(l[15]=e=>o.qst=e),placeholder:"单号",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[16]||(l[16]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[17]||(l[17]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({Status:t,StatusTxt:l,BillCode:a,BillDatetime:n,BillerEmployeeName:i,DiscardDatetime:r,DiscardCost:s,DiscardIncome:c,ID:d,Remark:u})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:d,onClick:e=>o.itemClick(d)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(l),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(l),1),e.createElementVNode("text",null,"处置日期："+e.toDisplayString(r?r.substring(0,10):""),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"处置成本："+e.toDisplayString(s),1),e.createElementVNode("text",null,"处置收入："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(i),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(u),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[18]||(l[18]=e=>o.conditionSearchPopup.open())},"高级搜索")])],64)}]]);var hc=new class extends Ee{assetListQueryByBillType(e){const t={BillType:9,PageNO:1,PageSize:5,QST:e};return this.request("/Asset/List/QueryByBillType",t)}submitRepairInfo(e){return this.request("/Bill/Repair/Submit",e)}submitFalutTypeInfo(e){return this.request("/Asset/FaultType/Add",e)}getFalutTypeListByCategoryID(e){return this.request("/Asset/FaultType/ListByCategoryID",e)}};const fc={components:{UniFilePicker:Zr},setup(){const t=e.ref({keywords:null,result:{text:null,value:null,options:[{text:"已修复",value:1},{text:"待继续修复",value:2},{text:"不可修复",value:3}]},maintainer:{hint:"请输入维修方",value:null},repairPersonnel:{hint:"请输入维修人员",value:null},phone:{hint:"请输入联系电话",vlaue:null},cost:{hint:"请输入维修费用",value:null},repairDateTime:{hint:"请选择维修日期",value:null},faultType:{hint:"请选择故障类型",text:null,value:null,options:[{text:"测试数据1",value:1}]},repairReason:{hint:"请输入报修原因",value:null}}),l=e.ref(null),a=e.ref({}),o=e.ref([]),n=e.ref([]),r=e.ref(!0),s=e.ref([]);e.ref(null);const c=e.ref(null),d=e.ref(null),u=e.ref(null),m=e.ref(null),p=e.ref(null);function v(e){e&&(q(),hc.assetListQueryByBillType(e).then((({Items:e})=>{e.length&&(o.value=e,l.value.open())})).finally((()=>z())))}function h(){hc.getFalutTypeListByCategoryID({AssetCategoryID:a.value.AssetCategoryID}).then((e=>{const l=[];e.FaultType.forEach((e=>{l.push({text:e.Name,value:e.ID})})),t.value.faultType.options=l}))}uni.getSystemInfo({success:e=>{p.value=e.windowHeight}});let f=e.computed((()=>p.value-190));return{repairDateChange:({detail:{value:e}})=>{t.value.repairDateTime.value=e},repairInfo:t,IsScroll:f,refreshList:v,removeInput:function(e){"result"==e||"faultType"==e?(t.value[e].text=null,t.value[e].value=null):t.value[e].value=null},getFileUrl:D,goBack:function(){S()},repairChange:function(e){t.value.result.text=t.value.result.options.filter((t=>t.value==e))[0].text,t.value.result.value=e},select:function({tempFilePaths:t}){q(),be.uploadImage(t).then((t=>{r.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));n.value.push(...l),e.nextTick((()=>{r.value=!0}))})).finally((()=>z()))},deletefile:function({tempFile:t}){const l=n.value.findIndex((e=>e===t));n.value.splice(l,1),r.value=!1,e.nextTick((()=>{r.value=!0}))},assetPicture:s,repairPicsClick:function(e){Pt(e)},assetList:o,assetInfo:a,assetDialog:l,clickItem:function(e){a.value=e,h(),l.value.close()},submit:function(){if(!a.value.ID)return void F("请检索需要报修的资产");if(!t.value.result.value)return void F("请选择维修结果");if(!t.value.cost.value)return void F("请输入维修费用");if(!t.value.repairReason.value)return void F("请输入报修原因");const e={RelatedID:null,AssetID:a.value.ID,AssetOriginalAmount:a.value.OriginalAmount,RepairedResult:t.value.result.value,RepairCorp:t.value.maintainer.value,Repairer:t.value.repairPersonnel.value,RepairerTelephone:t.value.phone.value,RepairedCost:t.value.cost.value,RepairedDate:t.value.repairDateTime.value,FaultTypeID:t.value.faultType.value,RepairedDesc:t.value.repairReason.value,AssetPics:n.value};hc.submitRepairInfo(e).then((e=>{L("操作成功！"),S()}))},faultTypeChange:function(e){i("log","at subcontract/asset/repair/result/detail.vue:549",e),t.value.faultType.text=t.value.faultType.options.filter((t=>t.value==e))[0].text,t.value.faultType.value=e},addFaultType:u,inputDialog:m,inputKey:c,inputVal:d,addFaultTypeConfirm:function(e){hc.submitFalutTypeInfo({Name:e,AssetCategoryID:a.value.AssetCategoryID}).then((e=>{L("添加成功！"),h()}))},inputDialogConfirm:function(e){"cost"!=c.value||/(^[1-9]([0-9]+)?(\.[0-9]{1,2})?$)|(^(0){1}$)|(^[0-9]\.[0-9]([0-9])?$)/.test(e)?t.value[c.value].value=e:F("请输入正确的金额")},InputInformation:function(e){c.value=e,d.value=t.value[e].value,m.value.open()},scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{v(e)}})},windowHeights:p}}};var gc=l(fc,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),p=r(e.resolveDynamicComponent("uni-easyinput"),Ie),v=r(e.resolveDynamicComponent("uni-icons"),fe),h=r(e.resolveDynamicComponent("uni-section"),ue),f=r(e.resolveDynamicComponent("uni-grid-item"),me),g=r(e.resolveDynamicComponent("uni-grid"),ve),y=r(e.resolveDynamicComponent("uni-data-picker"),rs),w=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"addFaultType",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"添加故障类型",value:"",placeholder:"请输入故障类型",onConfirm:o.addFaultTypeConfirm},null,8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{mode:"input",title:"录入信息",value:o.inputVal,placeholder:"请输入信息",onConfirm:o.inputDialogConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"assetDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(m,{title:"选择资产",onClose:l[0]||(l[0]=e=>o.assetDialog.close())},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetList,((t,l)=>(e.openBlock(),e.createBlock(d,{key:l,onClick:e=>o.clickItem(t),link:""},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(t.Name),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资料编码："+e.toDisplayString(t.Code),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类 ："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(t.Brand),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1)])])])])),_:2},1032,["onClick"])))),128))])),_:1})],4)])),_:1})])),_:1},512),e.createElementVNode("view",{class:"nav-search"},[e.createVNode(p,{prefixIcon:"search",modelValue:o.repairInfo.keywords,"onUpdate:modelValue":l[1]||(l[1]=e=>o.repairInfo.keywords=e),placeholder:"编码/名称",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createVNode(v,{type:"scan",color:"#2979ff",size:"25",onClick:o.scan},null,8,["onClick"])]),e.createElementVNode("view",{class:"repair_content"},[e.createElementVNode("view",{class:"repair_item_content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll}px`),"scroll-y":""},[e.createVNode(h,{title:"资产信息",type:"line"}),e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp",selectable:""},"资产名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},e.toDisplayString(o.assetInfo.Name),1)])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp",selectable:""},"资产编码：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},e.toDisplayString(o.assetInfo.Code),1)])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp",selectable:""},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},e.toDisplayString(o.assetInfo.LocationName),1)])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp",selectable:""},"资产分类：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},e.toDisplayString(o.assetInfo.CategoryName),1)])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},e.toDisplayString(o.assetInfo.Brand),1)])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},e.toDisplayString(o.assetInfo.Spec),1)])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},e.toDisplayString(o.assetInfo.Model),1)])),_:1})])),_:1})]),e.createVNode(h,{title:"资产图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(g,{column:3},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.assetInfo.AssetPics,((t,l)=>(e.openBlock(),e.createBlock(f,null,{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",mode:"scaleToFill",src:o.getFileUrl(t.FileUrl),onClick:e=>o.repairPicsClick(o.getFileUrl(t.FileUrl))},null,8,["src","onClick"])])),_:2},1024)))),256)),null==o.assetInfo.AssetPics?(e.openBlock(),e.createBlock(f,{key:0},{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",src:"/static/images/zw.png",mode:""})])),_:1})):e.createCommentVNode("",!0)])),_:1})])),_:1}),e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"维修结果：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createVNode(y,{class:"data-picker-request-draw",placeholder:"请选择申领原因",border:!1,"clear-icon":!1,localdata:o.repairInfo.result.options,onInput:o.repairChange,modelValue:o.repairInfo.result.value,"onUpdate:modelValue":l[2]||(l[2]=e=>o.repairInfo.result.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.repairInfo.result.value?"content_effective":""])},e.toDisplayString(o.repairInfo.result.value?o.repairInfo.result.text:"请选择维修结果"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[!t.nonEditable&&o.repairInfo.result.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[3]||(l[3]=e=>o.removeInput("result")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"维修方：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.repairInfo.maintainer.value?"content_effective":""]),onClick:l[4]||(l[4]=e=>o.InputInformation("maintainer"))},e.toDisplayString(o.repairInfo.maintainer.value?o.repairInfo.maintainer.value:"请输入维修方"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[o.repairInfo.maintainer.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[5]||(l[5]=e=>o.removeInput("maintainer")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"维修人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.repairInfo.repairPersonnel.value?"content_effective":""]),onClick:l[6]||(l[6]=e=>o.InputInformation("repairPersonnel"))},e.toDisplayString(o.repairInfo.repairPersonnel.value?o.repairInfo.repairPersonnel.value:"请输入维修人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[o.repairInfo.repairPersonnel.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[7]||(l[7]=e=>o.removeInput("repairPersonnel")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"联系电话：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.repairInfo.phone.value?"content_effective":""]),onClick:l[8]||(l[8]=e=>o.InputInformation("phone"))},e.toDisplayString(o.repairInfo.phone.value?o.repairInfo.phone.value:"请输入联系电话"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[o.repairInfo.phone.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[9]||(l[9]=e=>o.removeInput("phone")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"维修费用：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.repairInfo.cost.value?"content_effective":""]),onClick:l[10]||(l[10]=e=>o.InputInformation("cost"))},e.toDisplayString(o.repairInfo.cost.value?o.repairInfo.cost.value:"请输入维修费用"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[o.repairInfo.cost.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[11]||(l[11]=e=>o.removeInput("cost")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"维修日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("picker",{mode:"date",onChange:l[12]||(l[12]=(...e)=>o.repairDateChange&&o.repairDateChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.repairInfo.repairDateTime.value?"content_effective":""])},e.toDisplayString(o.repairInfo.repairDateTime.value?o.repairInfo.repairDateTime.value:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[!t.nonEditable&&o.repairInfo.repairDateTime.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[13]||(l[13]=e=>o.removeInput("repairDateTime")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"故障类型：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createVNode(y,{class:"data-picker-request-draw",border:!1,"clear-icon":!1,localdata:o.repairInfo.faultType.options,onInput:o.faultTypeChange,modelValue:o.repairInfo.faultType.value,"onUpdate:modelValue":l[14]||(l[14]=e=>o.repairInfo.faultType.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.repairInfo.faultType.value?"content_effective":""])},e.toDisplayString(o.repairInfo.faultType.value?o.repairInfo.faultType.text:"请选择故障类型"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[o.repairInfo.faultType.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[15]||(l[15]=e=>o.removeInput("faultType")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content_delete_icon"},[e.createElementVNode("view",null,[o.assetInfo.AssetCategoryID>0?(e.openBlock(),e.createBlock(v,{key:0,color:"blue",type:"plusempty",onClick:l[16]||(l[16]=e=>o.addFaultType.open()),size:"16"})):e.createCommentVNode("",!0)])])])])),_:1})])),_:1})]),e.createElementVNode("view",{class:"reason"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"repair_reason"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"报修原因：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item-textarea"},[e.createVNode(p,{type:"textarea",modelValue:o.repairInfo.repairReason.value,"onUpdate:modelValue":l[17]||(l[17]=e=>o.repairInfo.repairReason.value=e),maxlength:"400",autoHeight:"",placeholder:"请输入报修原因"},null,8,["modelValue"])])])),_:1})])),_:1})]),e.createVNode(h,{title:"维修图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(w,{ref:"filePicker",limit:9,"file-mediatype":"image","file-extname":"jpg,jpeg,png",mode:"grid",modelValue:t.files,"onUpdate:modelValue":l[18]||(l[18]=e=>t.files=e),"auto-upload":!1,onSelect:o.select,onDelete:o.deletefile},null,8,["modelValue","onSelect","onDelete"])])),_:1})],4)])]),e.createElementVNode("view",{class:"colum_confirm_cancel"},[e.createElementVNode("button",{type:"primary",onClick:l[19]||(l[19]=e=>o.submit())},"确定"),e.createElementVNode("button",{type:"info",onClick:l[20]||(l[20]=e=>o.goBack())},"取消")])],64)}],["__scopeId","data-v-1adc05a4"]]);var yc=new class extends Ee{requestDiscardGetByID(e){return this.request("/Bill/RequestDiscard/GetByID",{ID:e})}requestDiscardSaveDraft(e){return this.request("/Bill/RequestDiscard/SaveDraft",e)}requestDiscardDelete(e){return this.request("/Bill/RequestDiscard/Delete",{ID:e})}requestDiscardList({qst:e,pageNo:t,pageSize:l,billCode:a,requestDiscardAssetEmployeeIDs:o,requestDiscardBeginDate:n,requestDiscardEndDate:i,discardReasonIDs:r}){const s={IsSetNumber:!0,ShowMode:0,Sort:1,BillCode:a,RequestDrawEmployeeName:o,RequestDiscardBeginDate:n,RequestDiscardEndDate:i,DiscardReasonIDs:r,PageNO:t,PageSize:l||20,QST:e};return this.request("/Bill/RequestDiscard/List",s)}getById(e){return this.request("/Asset/GetByID",{ID:e,Visibility:1})}assetListQueryByBillType(e){const t={BillType:6,Conditions:[],PageNO:1,PageSize:10,QST:e};return this.request("/Asset/List/QueryByBillType",t)}};const wc={components:{BillEnclosure:Is,BillFooterBtn:xs},props:{id:String,type:String},setup({id:t,type:l}){const a=e.ref(""),o=e.ref({id:null,status:null,isSubmit:null,code:"",handlerEmployee:{text:h("UserName"),value:h("EmployeeID")},handlerOrgID:{text:h("OrgName"),value:h("OrgID")},requestDiscardDatetime:{hint:"请选择报废日期",value:$l()},NewLocation:{hint:"存放位置",text:"",value:null},NewKAO:{hint:"管理部门",text:"",value:null},NewKAE:{hint:"管理人员",text:"",value:null},remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),n=e.ref({name:"",code:"",reasonVal:"",reasonText:"",remarks:""}),i=e.ref([]),r=e.ref(null),s=e.ref("");let c=e.ref([]);const d=e.ref(null),u=e.ref("none"),m=e.ref(null),p=e.ref(""),v=e.ref(null),f=e.ref(null),g=e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),y=e.ref(null),w=e.ref(null),N=e.ref(null),C=e.ref([]),E=e.ref(""),b=e.ref(!1),V=e.ref([]),x=e.ref("");function _(e){q(),yc.assetListQueryByBillType(e).then((({Items:e})=>{c.value=e.map((e=>(e.checked=!1,e))),c.value.length<1?F("未查询到可用资产"):d.value.open()})).finally((()=>z()))}function I(e){p.value=e?"新增":"编辑",m.value.open()}function B(){n.value.name=null,n.value.code=null,n.value.reasonVal=null,n.value.reasonText=null,n.value.remarks=null,f.value=null,m.value.close()}function T(){y.value.close()}function A(){let e={};e.ID=o.value.id,e.CommitType=o.value.id?1:0,e.IsSubmit=!!o.value.isSubmit,e.RequestDiscardDatetime=o.value.requestDiscardDatetime.value,e.HandlerEmployeeID=o.value.handlerEmployee.value,e.HandlerEmployeeName=o.value.handlerEmployee.text,e.HandlerOrgID=o.value.handlerOrgID.value,e.HandlerOrgNameCN=o.value.handlerOrgID.text,e.HandlerOrgNameEN=o.value.handlerOrgID.text,e.NewLocationID=o.value.NewLocation.value,e.NewLocationNameCN=o.value.NewLocation.text,e.NewLocationNameEN=o.value.NewLocation.text,e.NewKAOID=o.value.NewKAO.value,e.NewKAONameCN=o.value.NewKAO.text,e.NewKAONameEN=o.value.NewKAO.text,e.NewKAEID=o.value.NewKAE.value,e.NewKAEName=o.value.NewKAE.text,e.Remark=o.value.remark,e.Details=i.value.map(((e,t)=>{let l=e;return l.Sequence=t+1,l})),e.Attachments=V.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),yc.requestDiscardSaveDraft(e).then((({Code:e,ID:t})=>{O(t).then((()=>{o.value.IsStart&&(b.value=!0)})),T()})).finally((()=>z()))}let P=e.ref(!1);function O(e){return q(),yc.requestDiscardGetByID(e).then((({ID:e,Status:t,BillCode:a,RequestDiscardDatetime:n,HandlerEmployeeID:r,HandlerEmployeeName:s,HandlerOrgID:c,HandlerOrgNameCN:d,NewLocationID:u,NewLocationName:m,NewKAOID:p,NewKAOName:v,NewKAEID:h,NewKAEName:f,Remark:g,Details:y,Attachments:w,FlowInfo:N})=>{o.value.id=e,o.value.status=t,o.value.code=a,o.value.requestDiscardDatetime.value=n?n.substring(0,10):"",o.value.handlerEmployee.value=r,o.value.handlerEmployee.text=s,o.value.handlerOrgID.value=c,o.value.handlerOrgID.text=d,o.value.NewLocation.value=u,o.value.NewLocation.text=m,o.value.NewKAO.value=p,o.value.NewKAO.text=v,o.value.NewKAE.value=h,o.value.NewKAE.text=f,o.value.remark=g,i.value=y,V.value=w.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),P.value=1!=o.value.status&&null!=o.value.status,o.value.IsApproval=N.IsApproval,o.value.IsStart=1!=t&&!N.IsStart&&N.IsEnabledFlow,o.value.FlowPath=1!=t&&N.IsStart&&N.IsEnabledFlow||N.IsSendBack,b.value=!1,l&&"mywork"==l&&!o.value.IsApproval&&et(lt.billDetailBack).then((()=>S()))})).finally((()=>z()))}let U=e.computed((()=>{let e=0;for(let t=0;t<i.value.length;t++)e+=parseInt(i.value[t].qty);return e}));hs.dictionaryGetByCode("D004").then((({Items:e})=>{C.value=e.map((e=>({text:e.ItemText,value:e.ID})));const{ID:t,ItemText:l}=e.filter((e=>e.IsDefaultItem))[0];w.value=t,N.value=l})),t&&O(t),tt(lt.signBack,(()=>O(o.value.id))),uni.getSystemInfo({success:e=>{x.value=e.windowHeight}});let M=e.computed((()=>{let e,t;return(x.value-60)/2>315?(e=315,t=x.value-375):e=t=(x.value-60)/2,{header:e,content:t}}));return{type:l,IsScroll:M,bill:o,billDetail:i,remarkVal:a,rowDetail:n,uniSwipeActionItemRightOptions:Ot,isOpened:u,uniSwipeChange:function(e,t){i.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(i.value.splice(t,1),L("移除成功"))},inputDialog:m,openEditDetailDalog:I,dialogRemarkInputConfirm:function(e){o.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:v,openRemarkDialog:function(){a.value=o.value.remark,v.value.open()},editDetailConfirm:function(e){i.value[f.value].DiscardReasonID=n.value.reasonVal,i.value[f.value].DiscardReasonName=n.value.reasonText,i.value[f.value].DiscardReasonNameCN=n.value.reasonText,i.value[f.value].DiscardReasonNameEN=n.value.reasonText,i.value[f.value].RequestDesc=n.value.remarks,B()},editDetailClose:function(){B()},editBillDetail:function(e){if(P&&null!==o.value.status&&1!=o.value.status)return;f.value=e;const{Name:t,Code:l,DiscardReasonID:a,DiscardReasonName:r,RequestDesc:s}=i.value[e];n.value.name=t,n.value.code=l,n.value.reasonVal=a,n.value.reasonText=r,n.value.remarks=s,I(0)},deleteDialogConfirm:function(){q(),yc.requestDiscardDelete(o.value.id).then((()=>{et(lt.requestDiscardDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:B,handleSaveDraft:function(e){if(o.value.isSubmit=e,o.value.requestDiscardDatetime.value){if(o.value.handlerEmployee.value)return i.value.length<1?(E.value="listDetail",void F("请添加资产信息")):void(o.value.isSubmit?y.value.open():A());F("请选择经办人")}else F("请选择报废日期")},submitDialog:y,submitMsgType:g,submitDialogConfirm:A,submitDialogClose:T,editInfoTitle:p,billDetailNumber:U,editGetByID:O,nonEditable:P,jumpList:function(){k("/subcontract/asset/requestDiscard/list")},windowHeights:x,scanCodeDialog:r,searchCodeVal:s,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?_(t):F("无效的检索条件")},addQuery:_,serachAssetList:c,assetsDialog:d,assetsDialogConfirm:function(){let e=c.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(i.value.filter((t=>t.AssetID==e[l].ID)).length<1){let t={};t.AssetID=e[l].ID,t.ID=null,t.BillID=null,t.Name=e[l].Name,t.Code=e[l].Code,t.CategoryID=e[l].CategoryID,t.CategoryName=e[l].CategoryName,t.CategoryNameCN=e[l].CategoryNameCN,t.CategoryNameEN=e[l].CategoryNameEN,t.DiscardReasonID=w.value,t.DiscardReasonName=N.value,t.DiscardReasonNameCN=N.value,t.DiscardReasonNameEN=N.value,t.OriginalAmount=e[l].OriginalAmount,t.OriginalCode=e[l].OriginalCode,t.Brand=e[l].Brand,t.Spec=e[l].Spec,t.Model=e[l].Model,t.Qty=e[l].Qty,t.RequestDesc=null,t.isOpened="none",t.Qty=1,i.value.push(t)}else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}d.value.close(),c.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=c.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{_(R(e))}})},applyDateTimeChange:({detail:{value:e}})=>{P.value||(o.value.requestDiscardDatetime.value=e)},removeInput:function(e){if("requestDiscardDatetime"!=e){if("NewLocation"==e||"NewKAE"==e)return o.value[e].text="",void(o.value[e].value=null);if("NewKAO"==e&&(o.value[e].text="",o.value[e].value=null,o.value.NewKAE.text="",o.value.NewKAE.value=null),"handlerEmployee"==e)return o.value.handlerEmployee.text="",o.value.handlerEmployee.value=null,o.value.handlerOrgID.text="",void(o.value.handlerOrgID.value=null);"remark"!=e||(o.value.remark="")}else o.value.requestDiscardDatetime.value=""},locationSelect:function(e){tt(lt.locationSelectBack,(({id:t,label:l})=>{o.value[e].value=t,o.value[e].text=l})),k(`pages/selector/asset/location?isLast=1&multiple=0&ids=${o.value[e].value}`)},corpDeptSelect:function(e){tt(lt.deptSelectBack,(({id:t,label:l})=>{o.value[e].value=t,o.value[e].text=l}));const t=o.value[e].value;k(`pages/selector/system/corpDept?multiple=0&type=${"NewCorp"==e?2:1}&ids=${t}`)},personnelSelect:function(e){if("NewKAE"==e&&!o.value.NewKAO.value)return void F("请先选择管理部门");tt(lt.employeeSelectBack,(({ID:t,Name:l,OrgID:a,OrgName:n})=>{o.value[e].value=t,o.value[e].text=l,"handlerEmployee"==e&&(o.value.handlerOrgID.value=a,o.value.handlerOrgID.text=n)}));const t=o.value[e].value;k(`pages/selector/system/employee?&multiple=0&corpID=${"NewKAE"==e?o.value.NewKAO.value:""}&ids=${t}`)},scrappingReason:C,scrappingReasonVal:w,scrappingReasonChange:function(e){const{value:t,text:l}=C.value.filter((t=>t.value==e))[0];n.value.reasonVal=t,n.value.reasonText=l},files:V,filesChange:function(e){V.value=e},toIndex:E,autoStart:b}}};var Nc=l(wc,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-data-picker"),rs),p=r(e.resolveDynamicComponent("uni-easyinput"),Ie),v=r(e.resolveDynamicComponent("uni-icons"),fe),h=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),f=r(e.resolveDynamicComponent("uni-swipe-action"),ps),g=r(e.resolveDynamicComponent("uni-section"),ue),y=e.resolveComponent("BillEnclosure"),w=e.resolveComponent("BillFooterBtn");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"assetsDialog",class:"assetsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{title:"选择资产",type:"info","before-close":!0,onClose:l[0]||(l[0]=e=>o.assetsDialog.close()),onConfirm:o.assetsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachAssetList,(({ID:t,Name:l,Code:a,CategoryName:n,Brand:i,Spec:r,Model:s,checked:c})=>(e.openBlock(),e.createBlock(d,{key:t},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资料编码："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(s),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,t)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:c},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"edit_detail_content"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"编码：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.code),1)])])),_:1}),e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.name),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"报废原因：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createVNode(m,{class:"data-picker-request-draw",placeholder:"请选择报废原因",border:!1,"clear-icon":!1,localdata:o.scrappingReason,onInput:o.scrappingReasonChange,modelValue:o.rowDetail.reasonVal,"onUpdate:modelValue":l[1]||(l[1]=e=>o.rowDetail.reasonVal=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.reasonVal?o.rowDetail.reasonText:"请选择报废原因"),1)])),_:1},8,["localdata","onInput","modelValue"])])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"报废说明：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createVNode(p,{border:!1,maxlength:"10",type:"text",modelValue:o.rowDetail.remarks,"onUpdate:modelValue":l[2]||(l[2]=e=>o.rowDetail.remarks=e),placeholder:"请输入报废说明"},null,8,["modelValue"])])])),_:1})])),_:1})])])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"资产搜索",value:o.searchCodeVal,placeholder:"编码/原编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1}),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"报废日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("picker",{mode:"date",onChange:l[3]||(l[3]=(...e)=>o.applyDateTimeChange&&o.applyDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.requestDiscardDatetime.value?"content_effective":""])},e.toDisplayString(o.bill.requestDiscardDatetime.value?o.bill.requestDiscardDatetime.value:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.requestDiscardDatetime.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[4]||(l[4]=e=>o.removeInput("requestDiscardDatetime")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.handlerEmployee.value?"content_effective":""]),onClick:l[5]||(l[5]=e=>o.personnelSelect("handlerEmployee"))},e.toDisplayString(o.bill.handlerEmployee.value?o.bill.handlerEmployee.text:"请选择人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.handlerEmployee.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[6]||(l[6]=e=>o.removeInput("handlerEmployee")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"报废后存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewLocation.value?"content_effective":""]),onClick:l[7]||(l[7]=e=>o.locationSelect("NewLocation"))},e.toDisplayString(o.bill.NewLocation.value?o.bill.NewLocation.text:"请选择存放位置"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewLocation.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[8]||(l[8]=e=>o.removeInput("NewLocation")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"报废后管理部门：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewKAO.value?"content_effective":""]),onClick:l[9]||(l[9]=e=>o.corpDeptSelect("NewKAO"))},e.toDisplayString(o.bill.NewKAO.value?o.bill.NewKAO.text:"请选择管理部门"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewKAO.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[10]||(l[10]=e=>o.removeInput("NewKAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"报废后管理人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewKAE.value?"content_effective":""]),onClick:l[11]||(l[11]=e=>o.personnelSelect("NewKAE"))},e.toDisplayString(o.bill.NewKAE.value?o.bill.NewKAE.text:"请选择管理人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewKAE.value?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[12]||(l[12]=e=>o.removeInput("NewKAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.remark?"content_effective":""]),onClick:l[13]||(l[13]=e=>o.nonEditable?null:o.openRemarkDialog())},e.toDisplayString(o.bill.remark?o.bill.remark:"请输入备注信息"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(v,{key:0,onClick:l[14]||(l[14]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill_detail_scroll",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),onScroll:l[15]||(l[15]=e=>o.toIndex=""),"scroll-into-view":o.toIndex,"scroll-with-animation":!0,"scroll-y":""},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(g,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(h,{disabled:o.nonEditable,"right-options":o.uniSwipeActionItemRightOptions,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.AssetID,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["detail_content_item",o.nonEditable?"disabled_color":""]),style:e.normalizeStyle(l+1==o.billDetail.length?"margin-bottom:0px":""),onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("text",{class:"content_item_title",selectable:""},"资产名称："+e.toDisplayString(t.Name),1),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",{selectable:""},"资产编码："+e.toDisplayString(t.Code),1),e.createElementVNode("text",null,"原编码："+e.toDisplayString(t.OriginalCode),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"原值："+e.toDisplayString(t.OriginalAmount),1),e.createElementVNode("text",null,"资产分类："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"报废原因："+e.toDisplayString(t.DiscardReasonName),1),e.createElementVNode("text",null,"报废说明："+e.toDisplayString(t.RequestDesc),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(t.Brand),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(t.Qty),1)])],14,["onClick"])])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1}),o.billDetail.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:"height:100%"}," 暂 无 数 据 ")):e.createCommentVNode("",!0)])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(y,{option:o.files,onChange:o.filesChange,nonEditable:o.nonEditable},null,8,["option","onChange","nonEditable"])],44,["scroll-into-view"]),e.createVNode(w,{type:o.type,billType:"RequestDiscard",bill:o.bill,nonEditable:o.nonEditable,autoStart:o.autoStart,onJumpList:o.jumpList,onSave:o.handleSaveDraft,onDelete:o.deleteDialogConfirm,onScrollToTop:l[16]||(l[16]=e=>o.toIndex="listDetail"),onScrollToFooter:l[17]||(l[17]=e=>o.toIndex="example"),onScan:l[18]||(l[18]=e=>o.scan()),onKeyword:l[19]||(l[19]=e=>o.scanCodeDialog.open()),onGetById:l[20]||(l[20]=e=>o.editGetByID(e))},null,8,["type","bill","nonEditable","autoStart","onJumpList","onSave","onDelete"])],64)}]]);var Cc=l({components:{DrawerAdvancedSearch:As,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(""),d=e.ref(null),u=e.ref({code:{hint:"报废单号",value:null},handlerEmployee:{hint:"经办人",name:"",value:[]},requestDiscardBeginDate:{hint:"报废日期起",value:null},requestDiscardEndDate:{hint:"报废日期止",value:null},discardReason:{hint:"报废原因",name:"",value:null,options:[]}}),m=e.ref(null),v=e.ref(""),h=e.ref("");async function f(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await yc.requestDiscardList({qst:t.value,pageNo:l,billCode:u.value.code.value,requestDiscardAssetEmployeeIDs:u.value.handlerEmployee.value,requestDiscardBeginDate:u.value.requestDiscardBeginDate.value,requestDiscardEndDate:u.value.requestDiscardEndDate.value,discardReasonIDs:u.value.discardReason.value?[u.value.discardReason.value]:[]});a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function g(){return l=1,f()}return hs.dictionaryGetByCode("D004").then((({Items:e})=>{u.value.discardReason.options=e.map((e=>({text:e.ItemText,value:e.ID})))})),f(),tt(lt.requestDiscardDetailBack,g),uni.getSystemInfo({success:e=>{v.value=e.windowWidth,h.value=e.windowHeight}}),p((()=>{g()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:g,itemClick:function(e){k(`/subcontract/asset/requestDiscard/detail?id=${e}&type=list`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,f())},windowWidths:v,windowHeights:h,advancedInputVal:s,advancedInputKey:c,advancedInputDialog:d,advancedSearch:u,openAdvancedInputDialog:function(e){s.value=u.value[e].value,c.value=e,d.value.open()},removeAdvancedInput:function(e){if("discardReason"==e)return u.value[e].value=null,void(u.value[e].text=null);"handlerEmployee"==e?(u.value[e].value=[],u.value[e].text=null):u.value[e].value=null},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{u.value[e].value=t}})},conditionReset:function(){u.value.code.value=null,u.value.handlerEmployee.name=null,u.value.handlerEmployee.value=[],u.value.requestDiscardBeginDate.value=null,u.value.requestDiscardEndDate.value=null,u.value.discardReason.value=null,u.value.discardReason.name=null},advancedInputConfirm:function(e){u.value[c.value].value=e},conditionSearchPopup:m,applyDateTimeChange:({detail:{value:e}},t)=>{u.value[t].value=e},querySearch:function(){g(),m.value.close()},personnelSelect:function(e){tt(lt.employeeSelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/system/employee?multiple=1&ids=${u.value[e].value}`)},discardReasonChange:function(e){u.value.discardReason.name=u.value.discardReason.options.filter((t=>t.value==e))[0].text,u.value.discardReason.value=e},billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-list"),Ne),h=e.resolveComponent("DrawerAdvancedSearch"),f=e.resolveComponent("AnchorPointAndQty"),g=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(h,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:o.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-100}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.code.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("code"))},e.toDisplayString(o.advancedSearch.code.value?o.advancedSearch.code.value:"报废单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.code.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("code")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[2]||(l[2]=e=>o.scanInput("code")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 96px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.handlerEmployee.value.length>0?"content_effective":""]),onClick:l[3]||(l[3]=e.withModifiers((e=>o.personnelSelect("handlerEmployee")),["stop"]))},e.toDisplayString(o.advancedSearch.handlerEmployee.value.length>0?o.advancedSearch.handlerEmployee.name:"选择人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.handlerEmployee.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[4]||(l[4]=e=>o.removeAdvancedInput("handlerEmployee")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{color:"red",type:"scan",size:"16",style:{opacity:"0"}})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[5]||(l[5]=e=>o.applyDateTimeChange(e,"requestDiscardBeginDate"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.requestDiscardBeginDate.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.requestDiscardBeginDate.value?o.advancedSearch.requestDiscardBeginDate.value:"报废日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.requestDiscardBeginDate.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("requestDiscardBeginDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[7]||(l[7]=e=>o.applyDateTimeChange(e,"requestDiscardEndDate"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.requestDiscardEndDate.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.requestDiscardEndDate.value?o.advancedSearch.requestDiscardEndDate.value:"报废日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.requestDiscardEndDate.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[8]||(l[8]=e=>o.removeAdvancedInput("requestDiscardEndDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"报废原因：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{class:"data-picker-request-draw",placeholder:"是否结束",border:!1,"clear-icon":!1,localdata:o.advancedSearch.discardReason.options,onInput:o.discardReasonChange,modelValue:o.advancedSearch.discardReason.value,"onUpdate:modelValue":l[9]||(l[9]=e=>o.advancedSearch.discardReason.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.discardReason.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.discardReason.value?o.advancedSearch.discardReason.name:"报废原因"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.discardReason.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[10]||(l[10]=e=>o.removeAdvancedInput("discardReason")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[11]||(l[11]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[12]||(l[12]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[13]||(l[13]=e=>o.conditionSearchPopup.close())},"关闭")])])])),_:1},8,["width"]),e.createVNode(f,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[14]||(l[14]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(g,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[15]||(l[15]=e=>o.qst=e),placeholder:"单号",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[16]||(l[16]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[17]||(l[17]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({Status:t,StatusTxt:l,BillCode:a,BillDatetime:n,BillerEmployeeName:i,RequestDiscardDatetime:r,NewLocationName:s,NewKAOName:c,NewKAEName:d,ID:u,Remark:m})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:u,onClick:e=>o.itemClick(u)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(l),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(l),1),e.createElementVNode("text",null,"报废日期："+e.toDisplayString(r?r.substring(0,10):""),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"报废后管理部门："+e.toDisplayString(c),1),e.createElementVNode("text",null,"报废后管理人员："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"报废后存放位置："),e.createElementVNode("text",null,e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(i),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(m),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[18]||(l[18]=e=>o.conditionSearchPopup.open())},"高级搜索")])],64)}]]);var Ec=new class extends Ee{transformGetByID(e){return this.request("/Bill/Transform/GetByID",{ID:e})}transformSaveDraft(e){return this.request("/Bill/Transform/SaveDraft",e)}transformDelete(e){return this.request("/Bill/Transform/Delete",{BillID:e})}transformPreStartFlow(e){return this.request("/Bill/Transform/PreStartFlow",{ID:e})}transformStartFlow(e){return this.request("/Bill/Transform/StartFlow",e)}requestDrawGetFlowTrail(e){return this.request("/Bill/Transform/GetFlowTrail",{ID:e})}transformPrevApproval(e){return this.request("/Bill/Transform/PrevApproval",{ID:e})}transformSubmitApproval(e){return this.request("/Bill/Transform/SubmitApproval",e)}transformList({qst:e,pageNo:t,billCode:l,transformDateStart:a,transformDateEnd:o,transformReason:n,originalUAO:i,originalUAE:r,originalKAO:s,originalKAE:c,originalLocation:d,transferToUAO:u,transferToUAE:m,transferToKAO:p,transferToKAE:v,transferToLocation:h}){const f={IsSetNumber:!0,ShowMode:0,Sort:1,PageNO:t,PageSize:20,QST:e,BillCode:l,TransformBeginDate:a,TransformEndDate:o,TransferReasonIDs:n,OriginalUAOIDs:i,OriginalUAEIDs:r,OriginalKAOIDs:s,OriginalKAEIDs:c,OriginalLocationIDs:d,NewUAOIDs:u,NewUAEIDs:m,NewKAOIDs:p,NewKAEIDs:v,NewLocationIDs:h};return this.request("/Bill/Transform/List",f)}assetListQueryByBillType(e){const t={QST:e,PageSize:10,PageNo:1,BillType:3};return this.request("/Asset/List/QueryByBillType",t)}};const bc={components:{BillEnclosure:Is,BillFooterBtn:xs},props:{id:String,type:String},onNavigationBarButtonTap(e){k("/subcontract/asset/requestDraw/requestDrawList")},setup({id:t,type:l}){const a=e.ref({id:null,status:null,isSubmit:null,code:"",transferType:{hint:"转移类型",text:"",value:null,options:[{text:"公司内转移",value:1},{text:"跨公司转移",value:2}]},NewCorp:{hint:"所属公司",text:"",value:null},NewKAO:{hint:"管理部门",text:"",value:null},NewKAE:{hint:"管理人员",text:"",value:null},IsTransformToPublic:{hint:"公共资产",value:!1},NewUAO:{hint:"使用部门",text:"",value:null},NewUAE:{hint:"使用人员",text:"",value:null},NewLocation:{hint:"存放位置",text:"",value:null},applyReason:{hint:"转移原因",text:"",value:null},remark:"",IsStart:!1,startFlow:!0,IsApproval:!1,FlowPath:!1,enablingApproval:!1}),o=e.ref([]),n=e.ref(""),i=e.ref([]),r=e.ref("none"),s=e.ref(null),c=e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),d=e.ref(null),u=e.ref(null),m=e.ref(""),p=e.ref(""),v=e.ref([]),h=e.ref(!1),f=e.ref(""),g=e.ref([]),y=e.ref(null),w=e.ref(!1);function N(){d.value.close()}function C(){let e={};e.ID=a.value.id,e.CommitType=a.value.id?1:0,e.IsSubmit=!!a.value.isSubmit,e.TransformType=a.value.transferType.value,e.NewCorpID=a.value.NewCorp.value,e.NewCorpNameCN=a.value.NewCorp.text,e.NewCorpNameEN=a.value.NewCorp.text,e.NewKAOID=a.value.NewKAO.value,e.NewKAONameCN=a.value.NewKAO.text,e.NewKAONameEN=a.value.NewKAO.text,e.NewKAEID=a.value.NewKAE.value,e.NewKAEName=a.value.NewKAE.text,e.IsTransformToPublic=a.value.IsTransformToPublic.value,e.NewUAOID=a.value.NewUAO.value,e.NewUAONameCN=a.value.NewUAO.text,e.NewUAONameEN=a.value.NewUAO.text,e.NewUAEID=a.value.NewUAE.value,e.NewUAEName=a.value.NewUAE.text,e.NewLocationID=a.value.NewLocation.value,e.NewLocationNameCN=a.value.NewLocation.text,e.NewLocationNameEN=a.value.NewLocation.text,e.TransferReason=a.value.applyReason.value,e.Remark=a.value.remark,e.Details=i.value.map(((e,t)=>{let l=e;return l.Sequence=t+1,l})),e.Attachments=v.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),Ec.transformSaveDraft(e).then((({Code:e,ID:t})=>{E(t).then((()=>{a.value.IsStart&&(h.value=!0)})),N()})).finally((()=>z()))}function E(e){return q(),Ec.transformGetByID(e).then((({ID:e,Status:t,BillCode:o,TransformTypeText:n,TransformType:r,NewCorpID:s,NewCorpName:c,NewLocationName:d,NewLocationID:u,NewKAOName:m,NewKAOID:p,NewKAEName:f,NewKAEID:g,NewUAOName:y,NewUAOID:N,NewUAEName:C,NewUAEID:E,TransferReason:b,TransferReasonText:V,IsTransformToPublic:k,Remark:x,Details:_,Attachments:I,FlowInfo:B})=>{a.value.id=e,a.value.status=t,a.value.code=o,a.value.transferType.text=n,a.value.transferType.value=r,a.value.NewCorp.value=s,a.value.NewCorp.text=c,a.value.NewLocation.value=u,a.value.NewLocation.text=d,a.value.NewKAO.text=m,a.value.NewKAO.value=p,a.value.NewKAE.text=f,a.value.NewKAE.value=g,a.value.IsTransformToPublic.value=k,a.value.NewUAO.text=y,a.value.NewUAO.value=N,a.value.NewUAE.text=C,a.value.NewUAE.value=E,a.value.applyReason.value=b,a.value.applyReason.text=V,a.value.remark=x,i.value=_,v.value=I.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),w.value=1!=a.value.status&&null!=a.value.status,a.value.IsApproval=B.IsApproval,a.value.IsStart=1!=t&&!B.IsStart&&B.IsEnabledFlow,a.value.FlowPath=1!=t&&B.IsStart&&B.IsEnabledFlow||B.IsSendBack,h.value=!1,l&&"mywork"==l&&!a.value.IsApproval&&et(lt.billDetailBack).then((()=>S()))})).finally((()=>z()))}let b=e.computed((()=>{let e=0;for(let t=0;t<i.value.length;t++)e+=parseInt(i.value[t].qty);return e}));function V(e){q(),Ec.assetListQueryByBillType(e).then((({Items:e})=>{g.value=e.map((e=>(e.checked=!1,e))),g.value.length<1?F("未查询到可用资产资料"):y.value.open()})).finally((()=>z()))}hs.dictionaryGetByCode("D018").then((({Items:e})=>{o.value=e.map((e=>({text:e.ItemText,value:e.ID})))})),t&&E(t),tt(lt.signBack,(()=>E(a.value.id))),uni.getSystemInfo({success:e=>{f.value=e.windowHeight}});let x=e.computed((()=>{let e,t;return(f.value-60)/2>315?(e=315,t=f.value-375):e=t=(f.value-60)/2,{header:e,content:t}}));return{type:l,IsScroll:x,bill:a,applyReasonOption:o,applyReasonHandle:function(e){a.value.applyReason.text=o.value.filter((t=>t.value==e))[0].text,a.value.applyReason.value=e},billDetail:i,uniSwipeActionItemRightOptions:Ot,isOpened:r,uniSwipeChange:function(e,t){i.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(i.value.splice(t,1),L("移除成功"))},dialogRemarkInputConfirm:function(e){a.value.remark=e.trim(),n.value=e.trim()},remarkVal:n,inputRemarkDialog:s,openRemarkDialog:function(){n.value=a.value.remark,s.value.open()},deleteDialogConfirm:function(){q(),Ec.transformDelete(a.value.id).then((()=>{et(lt.transformDetailBack).then((()=>S()))})).finally((()=>z()))},handleSaveDraft:function(e){if(a.value.isSubmit=e,a.value.transferType.value)if(2!=a.value.transferType.value||a.value.NewCorp.value){if(a.value.applyReason.value)return i.value.length<1?(p.value="listDetail",void F("请添加资产信息")):void(a.value.isSubmit?d.value.open():C());F("请选择转移原因")}else F("请选择所属公司");else F("请选择申领类型")},submitDialog:d,submitMsgType:c,submitDialogConfirm:C,submitDialogClose:N,billDetailNumber:b,editGetByID:E,nonEditable:w,autoStart:h,jumpList:function(){k("/subcontract/asset/transform/list")},scanCodeDialog:u,searchCodeVal:m,serachAssetList:g,assetDialog:y,assetDialogConfirm:function(){let e=g.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(i.value.filter((t=>t.AssetID==e[l].ID)).length<1){let t={ID:null,isOpened:"none"};t.AssetID=e[l].ID,t.Name=e[l].Name,t.Code=e[l].Code,t.OriginalCode=e[l].OriginalCode,t.CategoryID=e[l].CategoryID,t.CategoryName=e[l].CategoryName,t.CategoryNameCN=e[l].CategoryNameCN,t.CategoryNameEN=e[l].CategoryNameEN,t.Brand=e[l].Brand,t.Spec=e[l].Spec,t.Model=e[l].Model,t.Qty=e[l].Qty,t.OriginalAmount=e[l].OriginalAmount,t.OriginalKAOID=e[l].KAOID,t.OriginalKAOName=e[l].KAOName,t.OriginalKAONameCN=e[l].KAONameCN,t.OriginalKAONameEN=e[l].KAONameEN,t.OriginalKAEID=e[l].KAEID,t.OriginalKAEName=e[l].KAEName,t.OriginalUAOID=e[l].UAOID,t.OriginalUAOName=e[l].UAOName,t.OriginalUAONameCN=e[l].UAONameCN,t.OriginalUAONameEN=e[l].UAONameEN,t.OriginalUAEID=e[l].UAEID,t.OriginalUAEName=e[l].UAEName,t.OriginalLocationID=e[l].LocationID,t.OriginalLocationName=e[l].LocationName,i.value.push(t)}else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}y.value.close(),g.value=[]},addQuery:V,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?V(t):F("无效的检索条件")},windowHeights:f,locationSelect:function(e){tt(lt.locationSelectBack,(({id:t,label:l})=>{a.value[e].value=t,a.value[e].text=l})),k(`pages/selector/asset/location?isLast=1&multiple=0&ids=${a.value[e].value}`)},corpDeptSelect:function(e,t){tt(lt.deptSelectBack,(({id:t,label:l})=>{a.value[e].value=t,a.value[e].text=l}));const l=a.value[e].value;k(`pages/selector/system/corpDept?multiple=0&type=${"NewCorp"==e?2:1}&ids=${l}&isPower=${t}`)},checkBoxChange:function(e,t){let l=e.detail.value,a=g.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},removeInput:function(e){return"NewCorp"==e||"NewLocation"==e||"NewKAE"==e||"NewUAE"==e||"applyReason"==e||"transferType"==e?(a.value[e].text="",void(a.value[e].value=null)):"NewKAO"==e?(a.value.NewKAO.text="",a.value.NewKAO.value=null,a.value.NewKAE.text="",void(a.value.NewKAE.value=null)):"NewUAO"==e?(a.value.NewUAO.text="",a.value.NewUAO.value=null,a.value.NewUAE.text="",void(a.value.NewUAE.value=null)):void("remark"!=e||(a.value.remark=""))},switchChange:function(e){a.value.IsTransformToPublic.value=e.value,e.value&&(a.value.NewUAE.value=null,a.value.NewUAE.text="")},transferTypeChange:function(e){a.value.transferType.text=a.value.transferType.options.filter((t=>t.value==e))[0].text,a.value.transferType.value=e,1==e&&(a.value.NewCorp.text="",a.value.NewCorp.value=null)},personnelSelect:function(e){if("NewKAE"==e&&!a.value.NewKAO.value)return void F("请先选择管理部门");if("NewUAE"==e&&!a.value.NewUAO.value)return void F("请先选择使用部门");tt(lt.employeeSelectBack,(({ID:t,Name:l})=>{a.value[e].value=t,a.value[e].text=l}));const t=a.value[e].value;k(`pages/selector/system/employee?&multiple=0&corpID=${"NewKAE"==e?a.value.NewKAO.value:"NewUAE"==e?a.value.NewUAO.value:""}&ids=${t}`)},files:v,filesChange:function(e){v.value=e},toIndex:p}}};var Dc=l(bc,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-data-picker"),rs),p=r(e.resolveDynamicComponent("uni-icons"),fe),v=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),h=r(e.resolveDynamicComponent("uni-swipe-action"),ps),f=r(e.resolveDynamicComponent("uni-section"),ue),g=e.resolveComponent("BillEnclosure"),y=e.resolveComponent("BillFooterBtn");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"资产搜索",value:o.searchCodeVal,placeholder:"编码/原编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"assetDialog",class:"assetDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{title:"选择资产",type:"info","before-close":!0,onClose:l[0]||(l[0]=e=>o.assetDialog.close()),onConfirm:o.assetDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachAssetList,(({ID:t,Name:l,Code:a,CategoryName:n,Brand:i,Spec:r,Model:s,checked:c})=>(e.openBlock(),e.createBlock(d,{key:t},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(s),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,t)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:c},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:""},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1}),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"申领类型：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[o.nonEditable?(e.openBlock(),e.createElementBlock("text",{key:1,class:e.normalizeClass(["item_text_content",o.bill.transferType.value?"content_effective":""])},e.toDisplayString(o.bill.transferType.value?o.bill.transferType.text:"请选择转移类型"),3)):(e.openBlock(),e.createBlock(m,{key:0,class:"data-picker-request-draw",placeholder:"请选择转移类型",border:!1,"clear-icon":!1,localdata:o.bill.transferType.options,onInput:o.transferTypeChange,modelValue:o.bill.transferType.value,"onUpdate:modelValue":l[1]||(l[1]=e=>o.bill.transferType.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.transferType.value?"content_effective":""])},e.toDisplayString(o.bill.transferType.value?o.bill.transferType.text:"请选择转移类型"),3)])),_:1},8,["localdata","onInput","modelValue"]))])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.transferType.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[2]||(l[2]=e=>o.removeInput("transferType")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:!!o.nonEditable||1==o.bill.transferType.value},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[2==o.bill.transferType.value?(e.openBlock(),e.createElementBlock("text",{key:0,class:"required"},"*")):e.createCommentVNode("",!0),e.createElementVNode("text",{class:e.normalizeClass(["item_label_color",2==o.bill.transferType.value?"":"ensp"])},"转移后所属公司：",2)])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewCorp.value?"content_effective":""]),onClick:l[3]||(l[3]=e=>o.corpDeptSelect("NewCorp",0))},e.toDisplayString(o.bill.NewCorp.value?o.bill.NewCorp.text:"请选择所属公司"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewCorp.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[4]||(l[4]=e=>o.removeInput("NewCorp")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"转移后存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewLocation.value?"content_effective":""]),onClick:l[5]||(l[5]=e=>o.locationSelect("NewLocation"))},e.toDisplayString(o.bill.NewLocation.value?o.bill.NewLocation.text:"请选择存放位置"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewLocation.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[6]||(l[6]=e=>o.removeInput("NewLocation")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"转移后管理部门：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewKAO.value?"content_effective":""]),onClick:l[7]||(l[7]=e=>o.corpDeptSelect("NewKAO",0))},e.toDisplayString(o.bill.NewKAO.value?o.bill.NewKAO.text:"请选择管理部门"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewKAO.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[8]||(l[8]=e=>o.removeInput("NewKAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"转移后管理人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewKAE.value?"content_effective":""]),onClick:l[9]||(l[9]=e=>o.personnelSelect("NewKAE"))},e.toDisplayString(o.bill.NewKAE.value?o.bill.NewKAE.text:"请选择管理人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewKAE.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[10]||(l[10]=e=>o.removeInput("NewKAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{"show-switch":!0,switchChecked:o.bill.IsTransformToPublic.value,onSwitchChange:o.switchChange,disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"公共资产：")])])),_:1},8,["switchChecked","onSwitchChange","disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"转移后使用部门：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewUAO.value?"content_effective":""]),onClick:l[11]||(l[11]=e=>o.corpDeptSelect("NewUAO",0))},e.toDisplayString(o.bill.NewUAO.value?o.bill.NewUAO.text:"请选择使用部门"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewUAO.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[12]||(l[12]=e=>o.removeInput("NewUAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),o.bill.IsTransformToPublic.value?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(d,{key:0,disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"转移后使用人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.NewUAE.value?"content_effective":""]),onClick:l[13]||(l[13]=e=>o.personnelSelect("NewUAE"))},e.toDisplayString(o.bill.NewUAE.value?o.bill.NewUAE.text:"请选择使用人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.NewUAE.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[14]||(l[14]=e=>o.removeInput("NewUAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"])),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"转移原因：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[o.nonEditable?(e.openBlock(),e.createElementBlock("text",{key:1,class:e.normalizeClass(["item_text_content",o.bill.applyReason.value?"content_effective":""])},e.toDisplayString(o.bill.applyReason.value?o.bill.applyReason.text:"请选择转移原因"),3)):(e.openBlock(),e.createBlock(m,{key:0,class:"data-picker-request-draw",placeholder:"请选择转移原因",border:!1,"clear-icon":!1,localdata:o.applyReasonOption,onInput:o.applyReasonHandle,modelValue:o.bill.applyReason.value,"onUpdate:modelValue":l[15]||(l[15]=e=>o.bill.applyReason.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.applyReason.value?"content_effective":""])},e.toDisplayString(o.bill.applyReason.value?o.bill.applyReason.text:"请选择转移原因"),3)])),_:1},8,["localdata","onInput","modelValue"]))])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.applyReason.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[16]||(l[16]=e=>o.removeInput("applyReason")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.remark?"content_effective":""]),onClick:l[17]||(l[17]=e=>o.nonEditable?null:o.openRemarkDialog())},e.toDisplayString(o.bill.remark?o.bill.remark:"请输入备注信息"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[18]||(l[18]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill_detail_scroll",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),onScroll:l[19]||(l[19]=e=>o.toIndex=""),"scroll-into-view":o.toIndex,"scroll-with-animation":!0,"scroll-y":""},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(f,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[e.createVNode(h,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,(({AssetID:t,Code:l,Name:a,CategoryName:n,OriginalCode:i,OriginalAmount:r,OriginalKAOName:s,OriginalUAOName:c,OriginalUAEName:d,OriginalLocationName:u,Brand:m,Spec:p,Model:h,Unit:f,Qty:g,isOpened:y},w)=>(e.openBlock(),e.createBlock(v,{disabled:o.nonEditable,"right-options":o.uniSwipeActionItemRightOptions,show:y,"auto-close":!1,onChange:e=>o.uniSwipeChange(w),key:t,onClick:e=>o.uniSwipeClick(e,w)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["detail_content_item",o.nonEditable?"disabled_color":""]),style:e.normalizeStyle(w+1==o.billDetail.length?"margin-bottom:0px":"")},[e.createElementVNode("text",{class:"content_item_title"},"资产名称："+e.toDisplayString(a),1),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"资产编码："+e.toDisplayString(l),1),e.createElementVNode("text",null,"原编码："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"资产分类："+e.toDisplayString(n),1),e.createElementVNode("text",null,"原存放位置："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"原管理部门："+e.toDisplayString(s),1),e.createElementVNode("text",null,"原使用部门："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"原使用人："+e.toDisplayString(d),1),e.createElementVNode("text",null,"原值："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(m),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(p),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(h),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(g),1)])],6)])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1}),o.billDetail.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:"height:100%"}," 暂 无 数 据 ")):e.createCommentVNode("",!0)])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(g,{option:o.files,onChange:o.filesChange,nonEditable:o.nonEditable},null,8,["option","onChange","nonEditable"])],44,["scroll-into-view"]),e.createVNode(y,{type:o.type,billType:"Transform",bill:o.bill,nonEditable:o.nonEditable,autoStart:o.autoStart,onJumpList:o.jumpList,onSave:o.handleSaveDraft,onDelete:o.deleteDialogConfirm,onScrollToTop:l[20]||(l[20]=e=>o.toIndex="listDetail"),onScrollToFooter:l[21]||(l[21]=e=>o.toIndex="example"),onScan:l[22]||(l[22]=e=>t.scan()),onKeyword:l[23]||(l[23]=e=>o.scanCodeDialog.open()),onGetById:l[24]||(l[24]=e=>o.editGetByID(e))},null,8,["type","bill","nonEditable","autoStart","onJumpList","onSave","onDelete"])],64)}]]);var Vc=l({components:{DrawerAdvancedSearch:As,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(""),d=e.ref(null),u=e.ref({billCode:{hint:"转移单号",value:null},transformDateStart:{hint:"转移日期起",value:null},transformDateEnd:{hint:"申领日期止",value:null},transformReason:{hint:"转移原因",name:"",value:null,options:[]},originalUAO:{hint:"原使用部门",name:"",value:[]},originalUAE:{hint:"原使用人员",name:"",value:[]},originalKAO:{hint:"原管理部门",name:"",value:[]},originalKAE:{hint:"原管理人员",name:"",value:[]},originalLocation:{hint:"原存放位置",name:"",value:[]},transferToUAO:{hint:"转移后使用部门",name:"",value:[]},transferToUAE:{hint:"转移后使用人员",name:"",value:[]},transferToKAO:{hint:"转移后管理部门",name:"",value:[]},transferToKAE:{hint:"转移后管理人员",name:"",value:[]},transferToLocation:{hint:"转移后存放位置",name:"",value:[]}}),m=e.ref(null),v=e.ref(""),h=e.ref("");async function f(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await Ec.transformList({qst:t.value,pageNo:l,billCode:u.value.billCode.value,transformDateStart:u.value.transformDateStart.value,transformDateEnd:u.value.transformDateEnd.value,transformReason:u.value.transformReason.value,originalUAO:u.value.originalUAO.value,originalUAE:u.value.originalUAE.value,originalKAO:u.value.originalKAO.value,originalKAE:u.value.originalKAE.value,originalLocation:u.value.originalLocation.value,transferToUAO:u.value.transferToUAO.value,transferToUAE:u.value.transferToUAE.value,transferToKAO:u.value.transferToKAO.value,transferToKAE:u.value.transferToKAE.value,transferToLocation:u.value.transferToLocation.value});a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function g(){return l=1,f()}return hs.dictionaryGetByCode("D018").then((({Items:e})=>{u.value.transformReason.options=e.map((e=>({text:e.ItemText,value:e.ID})))})),f(),tt(lt.transformDetailBack,g),uni.getSystemInfo({success:e=>{v.value=e.windowWidth,h.value=e.windowHeight}}),p((()=>{g()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:g,itemClick:function(e){k(`subcontract/asset/transform/detail?id=${e}&type=list`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,f())},windowWidths:v,windowHeights:h,advancedInputVal:s,advancedInputKey:c,advancedInputDialog:d,advancedSearch:u,openAdvancedInputDialog:function(e){s.value=u.value[e].value,c.value=e,d.value.open()},removeAdvancedInput:function(e){if("billCode"!=e&&"transformDateStart"!=e&&"transformDateEnd"!=e)return"transformReason"==e?(u.value[e].value=null,void(u.value[e].name=null)):"originalUAO"==e||"originalUAE"==e||"originalKAO"==e||"originalKAE"==e||"originalLocation"==e||"transferToUAO"==e||"transferToUAE"==e||"transferToKAO"==e||"transferToKAE"==e||"transferToLocation"==e?(u.value[e].value=[],void(u.value[e].name="")):void 0;u.value[e].value=null},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{u.value[e].value=R(t)}})},conditionReset:function(){u.value.billCode.value=null,u.value.transformDateStart.value=null,u.value.transformDateEnd.value=null,u.value.transformReason.value=null,u.value.transformReason.name=null,u.value.originalUAO.value=[],u.value.originalUAO.name=null,u.value.originalUAE.value=[],u.value.originalUAE.name=null,u.value.originalKAO.value=[],u.value.originalKAO.name=null,u.value.originalKAE.value=[],u.value.originalKAE.name=null,u.value.originalLocation.value=[],u.value.originalLocation.name=null,u.value.transferToUAO.value=[],u.value.transferToUAO.name=null,u.value.transferToUAE.value=[],u.value.transferToUAE.name=null,u.value.transferToKAO.value=[],u.value.transferToKAO.name=null,u.value.transferToKAE.value=[],u.value.transferToKAE.name=null,u.value.transferToLocation.value=[],u.value.transferToLocation.name=null},advancedInputConfirm:function(e){u.value[c.value].value=e},locationSelect:function(e){tt(lt.locationSelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/asset/location?isLast=0&multiple=1&ids=${u.value[e].value}`)},corpDeptSelect:function(e){tt(lt.deptSelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/system/corpDept?multiple=1&ids=${u.value[e].value}`)},conditionSearchPopup:m,applyDateTimeChange:({detail:{value:e}},t)=>{u.value[t].value=e},IsEndChange:function(e){u.value.transformReason.name=u.value.transformReason.options.filter((t=>t.value==e))[0].text,u.value.transformReason.value=e},querySearch:function(){g(),m.value.close()},personnelSelect:function(e){tt(lt.employeeSelectBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/system/employee?&multiple=1&ids=${u.value[e].value}`)},billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-list"),Ne),h=e.resolveComponent("DrawerAdvancedSearch"),f=e.resolveComponent("AnchorPointAndQty"),g=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(h,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:o.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-100}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"转移单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.billCode.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("billCode"))},e.toDisplayString(o.advancedSearch.billCode.value?o.advancedSearch.billCode.value:"转移单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.billCode.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("billCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[2]||(l[2]=e=>o.scanInput("billCode")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"转移日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[3]||(l[3]=e=>o.applyDateTimeChange(e,"transformDateStart"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.transformDateStart.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.transformDateStart.value?o.advancedSearch.transformDateStart.value:"转移日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transformDateStart.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[4]||(l[4]=e=>o.removeAdvancedInput("transformDateStart")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"转移日期止：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[5]||(l[5]=e=>o.applyDateTimeChange(e,"transformDateEnd"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.transformDateEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.transformDateEnd.value?o.advancedSearch.transformDateEnd.value:"转移日期止"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transformDateEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("transformDateEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"是否结束：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{class:"data-picker-request-draw",placeholder:"是否结束",border:!1,"clear-icon":!1,localdata:o.advancedSearch.transformReason.options,onInput:o.IsEndChange,modelValue:o.advancedSearch.transformReason.value,"onUpdate:modelValue":l[7]||(l[7]=e=>o.advancedSearch.transformReason.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.transformReason.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.transformReason.value?o.advancedSearch.transformReason.name:"是否结束"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transformReason.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[8]||(l[8]=e=>o.removeAdvancedInput("transformReason")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1}),e.createVNode(d,{title:"转移前",type:"line"}),e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用部门：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.originalUAO.value.length>0?"content_effective":""]),onClick:l[9]||(l[9]=e.withModifiers((e=>o.corpDeptSelect("originalUAO")),["stop"]))},e.toDisplayString(o.advancedSearch.originalUAO.value.length>0?o.advancedSearch.originalUAO.name:"原使用部门"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.originalUAO.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[10]||(l[10]=e=>o.removeAdvancedInput("originalUAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用人员：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.originalUAE.value.length>0?"content_effective":""]),onClick:l[11]||(l[11]=e=>o.personnelSelect("originalUAE"))},e.toDisplayString(o.advancedSearch.originalUAE.value.length>0?o.advancedSearch.originalUAE.name:"原使用人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.originalUAE.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[12]||(l[12]=e=>o.removeAdvancedInput("originalUAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"管理部门：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.originalKAO.value.length>0?"content_effective":""]),onClick:l[13]||(l[13]=e.withModifiers((e=>o.corpDeptSelect("originalKAO")),["stop"]))},e.toDisplayString(o.advancedSearch.originalKAO.value.length>0?o.advancedSearch.originalKAO.name:"原管理部门"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.originalKAO.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[14]||(l[14]=e=>o.removeAdvancedInput("originalKAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"管理人员：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.originalKAE.value.length>0?"content_effective":""]),onClick:l[15]||(l[15]=e=>o.personnelSelect("originalKAE"))},e.toDisplayString(o.advancedSearch.originalKAE.value.length>0?o.advancedSearch.originalKAE.name:"原管理人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.originalKAE.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[16]||(l[16]=e=>o.removeAdvancedInput("originalKAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.originalLocation.value.length>0?"content_effective":""]),onClick:l[17]||(l[17]=e.withModifiers((e=>o.locationSelect("originalLocation")),["stop"]))},e.toDisplayString(o.advancedSearch.originalLocation.value.length>0?o.advancedSearch.originalLocation.name:"原存放位置"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.originalLocation.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[18]||(l[18]=e=>o.removeAdvancedInput("originalLocation")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1})])),_:1}),e.createVNode(d,{title:"转移后",type:"line"}),e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用部门：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.transferToUAO.value.length>0?"content_effective":""]),onClick:l[19]||(l[19]=e.withModifiers((e=>o.corpDeptSelect("transferToUAO")),["stop"]))},e.toDisplayString(o.advancedSearch.transferToUAO.value.length>0?o.advancedSearch.transferToUAO.name:"转移后使用部门"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transferToUAO.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[20]||(l[20]=e=>o.removeAdvancedInput("transferToUAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"使用人员：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.transferToUAE.value.length>0?"content_effective":""]),onClick:l[21]||(l[21]=e=>o.personnelSelect("transferToUAE"))},e.toDisplayString(o.advancedSearch.transferToUAE.value.length>0?o.advancedSearch.transferToUAE.name:"转移后使用人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transferToUAE.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[22]||(l[22]=e=>o.removeAdvancedInput("transferToUAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"管理部门：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.transferToKAO.value.length>0?"content_effective":""]),onClick:l[23]||(l[23]=e.withModifiers((e=>o.corpDeptSelect("transferToKAO")),["stop"]))},e.toDisplayString(o.advancedSearch.transferToKAO.value.length>0?o.advancedSearch.transferToKAO.name:"转移后管理部门"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transferToKAO.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[24]||(l[24]=e=>o.removeAdvancedInput("transferToKAO")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"管理人员：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.transferToKAE.value.length>0?"content_effective":""]),onClick:l[25]||(l[25]=e=>o.personnelSelect("transferToKAE"))},e.toDisplayString(o.advancedSearch.transferToKAE.value.length>0?o.advancedSearch.transferToKAE.name:"转移后管理人员"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transferToKAE.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[26]||(l[26]=e=>o.removeAdvancedInput("transferToKAE")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"存放位置：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 130px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.transferToLocation.value.length>0?"content_effective":""]),onClick:l[27]||(l[27]=e.withModifiers((e=>o.locationSelect("transferToLocation")),["stop"]))},e.toDisplayString(o.advancedSearch.transferToLocation.value.length>0?o.advancedSearch.transferToLocation.name:"转移后存放位置"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.transferToLocation.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[28]||(l[28]=e=>o.removeAdvancedInput("transferToLocation")),type:"close",size:"16"})):e.createCommentVNode("",!0)])])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[29]||(l[29]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[30]||(l[30]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[31]||(l[31]=e=>o.conditionSearchPopup.close())},"关闭")])])])),_:1},8,["width"]),e.createVNode(f,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[32]||(l[32]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(g,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[33]||(l[33]=e=>o.qst=e),placeholder:"单号",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[34]||(l[34]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[35]||(l[35]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({Status:t,StatusTxt:l,NewCorpName:a,BillCode:n,BillDatetime:i,BillerEmployeeName:r,DrawBackDatetime:s,NewKAOName:c,NewKAEName:d,NewUAOName:u,NewUAEName:m,NewLocationName:p,ID:v,Remark:h})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:v,onClick:e=>o.itemClick(v)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(l),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(l),1),e.createElementVNode("text",null,"转移日期："+e.toDisplayString(i?i.substring(0,10):""),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"管理部门："+e.toDisplayString(c),1),e.createElementVNode("text",null,"管理人员："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"使用部门："+e.toDisplayString(u),1),e.createElementVNode("text",null,"使用人员："+e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"所属公司："),e.createElementVNode("text",null,e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"存放位置："),e.createElementVNode("text",null,e.toDisplayString(p),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(r),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(h),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[36]||(l[36]=e=>o.conditionSearchPopup.open())},"高级搜索")])],64)}]]);var kc=l({setup(){}},[["render",function(e,t,l,a,o,n){return"暂未开放，敬请期待"}]]);var xc=l({components:{UniFilePicker:Zr},props:{id:String},setup({id:t}){const l=e.ref(""),a=e.ref(""),o=e.ref([]),n=yl().state.repairRecord.detailInfo.data,i=n[0],r=n[0].ApplyRepairPics.map((e=>D(e.FileUrl))),s=n[0].RepairResultPics.map((e=>D(e.FileUrl)));return uni.getSystemInfo({success:e=>{a.value=e.windowHeight}}),{assetInfo:i,applyRepairPics:r,repairResultPics:s,repairReason:l,windowHeights:a,imgApplyRepairPicsClick:function(e){At(r,e)},imgRepairResultPicsClick:function(e){At(s,e)},files:o}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-list-item"),we),c=r(e.resolveDynamicComponent("uni-list"),Ne),d=r(e.resolveDynamicComponent("uni-grid-item"),me),u=r(e.resolveDynamicComponent("uni-grid"),ve),m=r(e.resolveDynamicComponent("uni-section"),ue);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(s,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"width-fill"},[e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,[e.createTextVNode("资产编码："),e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.AssetCode),1)]),e.createElementVNode("view",null,[e.createTextVNode("原编码："),e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.OriginalCode),1)])]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"资产名称："+e.toDisplayString(o.assetInfo.AssetName),1),e.createElementVNode("view",null,"资产分类："+e.toDisplayString(o.assetInfo.AssetCategoryName),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"管理部门："+e.toDisplayString(o.assetInfo.KAOName),1),e.createElementVNode("view",null,"管理人员："+e.toDisplayString(o.assetInfo.KAEName),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"使用部门："+e.toDisplayString(o.assetInfo.UAOName),1),e.createElementVNode("view",null,"使用人员："+e.toDisplayString(o.assetInfo.UAEName),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"存放位置："+e.toDisplayString(o.assetInfo.LocationName),1),e.createElementVNode("view",null,"品牌："+e.toDisplayString(o.assetInfo.Brand),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"规格："+e.toDisplayString(o.assetInfo.Space),1),e.createElementVNode("view",null,"型号："+e.toDisplayString(o.assetInfo.Model),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"数量："+e.toDisplayString(o.assetInfo.Qty),1),e.createElementVNode("view",null,"原值："+e.toDisplayString(o.assetInfo.OriginalAmountText),1)])])])),_:1}),e.createVNode(s,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"width-fill"},[e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,[e.createTextVNode("报修单号："),e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.RequestCode),1)]),e.createElementVNode("view",null,"报修人："+e.toDisplayString(o.assetInfo.OperatorEmployeeName),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"报修日期："+e.toDisplayString(o.assetInfo.RequestRepairDatetime),1),e.createElementVNode("view",{class:"list-item-warp"},"报修原因："+e.toDisplayString(o.assetInfo.RequestReason),1)])])])),_:1}),e.createVNode(s,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"width-fill"},[e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,[e.createTextVNode("维修单号："),e.createElementVNode("text",{selectable:""},e.toDisplayString(o.assetInfo.RepairCode),1)]),e.createElementVNode("view",null,"维修日期："+e.toDisplayString(o.assetInfo.RepairedDate),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"维修方："+e.toDisplayString(o.assetInfo.RepairCorp),1),e.createElementVNode("view",null,"维修人员："+e.toDisplayString(o.assetInfo.Repairer),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"维修费用："+e.toDisplayString(o.assetInfo.RepairedCostText),1),e.createElementVNode("view",null,"维修结果："+e.toDisplayString(o.assetInfo.RepairedResult),1)]),e.createElementVNode("view",{class:"list-item-content"},[e.createElementVNode("view",null,"故障类型："+e.toDisplayString(o.assetInfo.FaultName),1),e.createElementVNode("view",{class:"list-item-warp"},"维修说明："+e.toDisplayString(o.assetInfo.RepairedDesc),1)])])])),_:1})])),_:1}),e.createVNode(m,{title:"报修图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(u,{column:3},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.applyRepairPics,((t,l)=>(e.openBlock(),e.createBlock(d,null,{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",mode:"scaleToFill",src:t,onClick:e=>o.imgApplyRepairPicsClick(l)},null,8,["src","onClick"])])),_:2},1024)))),256)),o.applyRepairPics.length<1?(e.openBlock(),e.createBlock(d,{key:0},{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",src:"/static/images/zw.png",mode:""})])),_:1})):e.createCommentVNode("",!0)])),_:1})])),_:1}),e.createVNode(m,{title:"维修图片",type:"line"},{default:e.withCtx((()=>[e.createVNode(u,{column:3},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.repairResultPics,((t,l)=>(e.openBlock(),e.createBlock(d,null,{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",mode:"scaleToFill",src:t,onClick:e=>o.imgRepairResultPicsClick(l)},null,8,["src","onClick"])])),_:2},1024)))),256)),o.repairResultPics.length<1?(e.openBlock(),e.createBlock(d,{key:0},{default:e.withCtx((()=>[e.createElementVNode("image",{class:"fill",src:"/static/images/zw.png",mode:""})])),_:1})):e.createCommentVNode("",!0)])),_:1})])),_:1})],64)}],["__scopeId","data-v-62160ffa"]]);var _c=l({name:"uni-stat-select",mixins:[Mr.mixinDatacom||{}],data:()=>({showSelector:!1,current:"",mixinDatacomResData:[],apps:[],channels:[]}),props:{localdata:{type:Array,default:()=>[]},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},placeholder:{type:String,default:"请选择"},emptyTips:{type:String,default:"无选项"},clear:{type:Boolean,default:!0},defItem:{type:Number,default:0}},created(){this.last=`${this.collection}_last_selected_option_value`,this.collection&&!this.localdata.length&&this.mixinDatacomEasyGet()},computed:{typePlaceholder(){const e={"opendb-stat-app-versions":"版本","opendb-app-channels":"渠道","opendb-app-list":"应用"}[this.collection];return e?"请选择"+e:"请选择"}},watch:{localdata:{immediate:!0,handler(e,t){Array.isArray(e)&&!t&&(this.mixinDatacomResData=e)}},modelValue(){this.initDefVal()},mixinDatacomResData:{immediate:!0,handler(e){e.length&&this.initDefVal()}}},methods:{initDefVal(){let e="";if(this.value||0===this.value)e=this.value;else if(this.modelValue||0===this.modelValue)e=this.modelValue;else{let t;if(this.collection&&(t=uni.getStorageSync(this.last)),t||0===t)e=t;else{let t="";this.defItem>0&&this.defItem<this.mixinDatacomResData.length&&(t=this.mixinDatacomResData[this.defItem-1].value),e=t}this.emit(e)}const t=this.mixinDatacomResData.find((t=>t.value===e));this.current=t?this.formatItemName(t):""},clearVal(){this.emit(""),this.collection&&uni.removeStorageSync(this.last)},change(e){this.showSelector=!1,this.current=this.formatItemName(e),this.emit(e.value)},emit(e){this.$emit("change",e),this.$emit("input",e),this.$emit("update:modelValue",e),this.collection&&uni.setStorageSync(this.last,e)},toggleSelector(){this.showSelector=!this.showSelector},formatItemName(e){let{text:t,value:l,channel_code:a}=e;return a=a?`(${a})`:"",this.collection.indexOf("app-list")>0?`${t}(${l})`:t||`未命名${a}`}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-icons"),fe);return e.openBlock(),e.createElementBlock("view",{class:"uni-stat__select"},[a.label?(e.openBlock(),e.createElementBlock("span",{key:0,class:"uni-label-text hide-on-phone"},e.toDisplayString(a.label+"："),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass({"uni-stat__actived":n.current})},[e.createElementVNode("view",{class:"uni-select"},[e.createElementVNode("view",{class:"uni-select__input-box",onClick:l[0]||(l[0]=(...e)=>i.toggleSelector&&i.toggleSelector(...e))},[n.current?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select__input-text"},e.toDisplayString(n.current),1)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-select__input-text uni-select__input-placeholder"},e.toDisplayString(i.typePlaceholder),1)),n.current&&a.clear?(e.openBlock(),e.createBlock(s,{key:2,type:"clear",color:"#e1e1e1",size:"18",onClick:i.clearVal},null,8,["onClick"])):(e.openBlock(),e.createBlock(s,{key:3,type:n.showSelector?"top":"bottom",size:"14",color:"#999"},null,8,["type"]))]),n.showSelector?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select--mask",onClick:l[1]||(l[1]=(...e)=>i.toggleSelector&&i.toggleSelector(...e))})):e.createCommentVNode("",!0),n.showSelector?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-select__selector"},[e.createElementVNode("view",{class:"uni-popper__arrow"}),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"uni-select__selector-scroll"},[0===n.mixinDatacomResData.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select__selector-empty"},[e.createElementVNode("text",null,e.toDisplayString(a.emptyTips),1)])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(n.mixinDatacomResData,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-select__selector-item",key:l,onClick:e=>i.change(t)},[e.createElementVNode("text",null,e.toDisplayString(i.formatItemName(t)),1)],8,["onClick"])))),128))])])):e.createCommentVNode("",!0)])],2)])}],["__scopeId","data-v-7b5932ed"]]);var Sc=new class extends Je{constructor(){super("Allocate")}getStockList(e,t){return this.request("/Stock/List",{WarehouseIDs:e,QST:t})}getAllocateList(e){return this.request("/Allocate/List",e)}SaveDraft(e){return this.request("/Bill/Allocate/SaveDraft",e)}GetByID(e){return this.request("/Bill/Allocate/GetByID",e)}Delete(e){return this.request("/Bill/Allocate/Delete",{ID:e})}PreStartFlow(e){return this.preStartFlow(e)}StartFlow(e){return this.startFlow(e)}PrevApproval(e){return this.prevApproval(e)}SubmitApproval(e){return this.submitApproval(e)}GetFlowTrail(e){return this.getFlowTrail(e)}},Ic=()=>{const{bill:t,rowDetail:l,remarkVal:a,deleteOperationBtn:o,billDetail:n,applyReasonOption:r,fab:s,fabPattern:c,fabContent:d,scanCodeDialog:u,searchCodeVal:m,serachGoodsList:p,goodsDialog:v,isOpened:h,inputDialog:f,editInfoTitle:g,inputRemarkDialog:y,detailIndex:w,deleteDialog:N,approveDialog:C,submitMsgType:E,submitDialog:b,approveStartUpDialog:V,approverOption:x,approvalProcessData:_,processTrackDialog:I,processTrackCurrent:B,processTrackApprovalLog:T,processTrackApprovalTask:P,windowHeights:O,nonEditable:R,isfiles:U,files:M,toIndex:W}=(()=>{const t=e.ref(!0),l=e.ref({id:null,status:null,isSubmit:null,code:"",fromWarehouse:{Name:"",ID:"",OID:""},toWarehouse:{Name:"",ID:"",OID:""},allocateDate:"",corpID:"",handledPerson:{ID:"",Name:""},handlerOrg:{ID:"",NameCN:"",NameEN:""},remark:"",remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),a=e.ref({ConsumableName:"",Brand:"",Spec:"",Model:"",Qty:1,TotalAvailableStock:0}),o=e.ref(""),n=e.ref([]),i=e.ref(""),r=e.ref([]),s=e.ref([]);return s.value=[{text:"取消",style:{backgroundColor:"#007aff"}},{text:"删除",style:{backgroundColor:"#F56C6C"}}],{bill:l,rowDetail:a,remarkVal:o,deleteOperationBtn:s,billDetail:r,applyReasonOption:n,fab:e.ref(null),fabPattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#007AFF",iconColor:"#fff"},fabContent:[{iconPath:"/static/icon/sys.png",selectedIconPath:"/static/icon/sys.png",text:"扫码",active:!1},{iconPath:"/static/icon/edit.png",selectedIconPath:"/static/icon/edit.png",text:"检索",active:!1},{iconPath:"/static/icon/asset_mingxi.png",selectedIconPath:"/static/icon/asset_mingxi.png",text:"明细",active:!1},{iconPath:"/static/icon/asset_fujian.png",selectedIconPath:"/static/icon/asset_fujian.png",text:"附件",active:!1}],scanCodeDialog:e.ref(null),searchCodeVal:e.ref(""),serachGoodsList:e.ref([]),goodsDialog:e.ref(null),isOpened:e.ref("none"),inputDialog:e.ref(null),editInfoTitle:e.ref(""),inputRemarkDialog:e.ref(null),detailIndex:e.ref(null),deleteDialog:e.ref(null),approveDialog:e.ref(null),submitMsgType:e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),submitDialog:e.ref(null),approveStartUpDialog:e.ref(null),approverOption:e.ref([]),approvalProcessData:e.ref({activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}),processTrackDialog:e.ref(null),processTrackCurrent:e.ref(0),processTrackApprovalLog:e.ref([]),processTrackApprovalTask:e.ref([]),windowHeights:e.ref(""),nonEditable:e.ref(!1),isfiles:t,files:e.ref([]),toIndex:i}})();function $(e){q(),Sc.getStockList([t.value.fromWarehouse.ID],e).then((({Items:e})=>{p.value=e.map((e=>(e.checked=!1,e))),p.value.length<1?F("未查询到可用资产资料"):v.value.open()})).finally((()=>z()))}function Q(e){g.value=e?"新增":"编辑",f.value.open()}function j(){l.value.ConsumableName="",l.value.Brand="",l.value.Spec="",l.value.Model="",l.value.Qty=1,l.value.TotalAvailableStock="",l.value.Remark="",l.value.ReferenceCost="",l.value.ReferenceCostAmount="",w.value=null,f.value.close()}function H(){b.value.close()}function K(){let e={};e.ID=t.value.id,e.AddOrEdit=t.value.id?2:1,e.IsSubmit=!!t.value.isSubmit,e.HandlerEmployeeID=t.value.handledPerson.ID,e.HandlerEmployeeName=t.value.handledPerson.Name,e.HandlerOrgID=t.value.handlerOrg.ID,e.HandlerOrgNameCN=t.value.handlerOrg.NameCN,e.HandlerOrgNameEN=t.value.handlerOrg.NameEN,e.AllocateDate=t.value.allocateDate,e.FromWarehouseID=t.value.fromWarehouse.OID,e.ToWarehouseID=t.value.toWarehouse.OID,e.Remark=t.value.remark,e.Details=n.value.map(((e,t)=>{let l={};return l.ID=e.ID,l.Batch=e.Batch,l.Brand=e.Brand,l.ConsumableCategoryName=e.CategoryName,l.ConsumableCode=e.ConsumableCode,l.ConsumableID=e.ConsumableID,l.ConsumableName=e.ConsumableName,l.IsEnableBatch=e.IsEnableBatch,l.Spec=e.Spec,l.Model=e.Model,l.Unit=e.Unit,l.Qty=e.Qty,l.QtyText=e.Qty,l.ReferenceCost=e.ReferenceCost,l.ReferenceCostText=e.ReferenceCostText,l.ReferenceCostAmount=e.ReferenceCostAmount,l.ReferenceCostAmountText=e.ReferenceCostAmount,l.Remark=e.Remark,l.StockID=e.StockID,l.Stock=e.Stock,l.AvailableStock=e.AvailableStock,l.StockText=e.StockText,l.Sequence=t+1,l})),e.Attachments=M.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),Sc.SaveDraft(e).then((e=>{G(e.ID).then((()=>{t.value.IsStart&&ee()})),H()})).finally((()=>z()))}function G(e){return q(),Sc.GetByID({ID:e}).then((({ID:e,Status:l,Code:a,Remark:o,AllocateDate:i,FromWarehouseID:r,FromWarehouseName:s,ToWarehouseID:c,ToWarehouseName:d,HandlerEmployeeID:u,HandlerEmployeeName:m,CorpID:p,HandlerOrgID:v,HandlerOrgName:h,HandlerOrgNameCN:f,HandlerOrgNameEN:g,Stock:y,Details:w,FlowInfo:N,Attachments:C})=>{t.value.id=e,t.value.status=l,t.value.code=a,t.value.remark=o,t.value.toWarehouse.Name=d,t.value.toWarehouse.ID=c,t.value.toWarehouse.OID=c,t.value.fromWarehouse.Name=s,t.value.fromWarehouse.ID=r,t.value.fromWarehouse.OID=r,t.value.allocateDate=i,t.value.corpID=p,t.value.handledPerson.Name=m,t.value.handledPerson.ID=u,t.value.handlerOrg={ID:v,NameCN:f,NameEN:g},M.value=C.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),n.value=w.map((e=>{let t=e;return t.CategoryName=e.ConsumableCategoryName,t.TotalAvailableStock=e.Stock,e})),R.value=1!=t.value.status&&null!=t.value.status,t.value.IsApproval=N.IsApproval,t.value.IsStart=1!=l&&!N.IsStart&&N.IsEnabledFlow,t.value.FlowPath=1!=l&&N.IsStart&&N.IsEnabledFlow||N.IsSendBack})).finally((()=>z()))}let J=e.computed((()=>{let e=0;for(let t=0;t<n.value.length;t++)e+=parseInt(n.value[t].qty);return e}));function Y(){_.value={activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}}function Z(){q();const e={ID:t.value.id,IsPass:_.value.approvalType,Remark:_.value.remark,SupportedStrategies:_.value.refuseType,IsAdditionalApproval:!1,AdditionalApprovalEmployeeId:null,ActivityName:_.value.activityName,ActivityID:_.value.activityID,ActivityType:_.value.activityType,NextActivityName:_.value.nextActivityName,NextActivityID:_.value.nextActivityID,NextActivityType:_.value.nextActivityType,CandidateApprovers:_.value.nextActivityCandidaters};Sc.SubmitApproval(e).then((({ID:e})=>{t.value.startFlow=!1;let l=setTimeout((()=>{Y(),G(e).then((()=>{X()})).finally((()=>z())),clearTimeout(l)}),3e3)})).catch((()=>z()))}function X(){C.value.close()}function ee(){q(),i("log","at subcontract/consumable/allocate/detail/index.js:631",t.value.id),t.value.enablingApproval=!1,Sc.PreStartFlow(t.value.id).then((({ActivityID:e,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r})=>{if(_.value.activityID=e,_.value.activityName=l,_.value.activityType=a,_.value.nextActivityID=o,_.value.nextActivityName=n,_.value.nextActivityType=i,1!=r.length&&null!=r)_.value.employeeID=null,_.value.employeeName="";else{const{EmployeeID:e,EmployeeName:t}=r[0];_.value.employeeID=e||null,_.value.employeeName=t||""}_.value.nextActivityCandidaters=r,x.value=r.map((e=>(e.text=e.EmployeeName,e.value=e.EmployeeID,e))),V.value.open(),1==r.length&&t.value.IsStart||2==i&&t.value.IsStart?te():z()})).catch((()=>z()))}function te(){if(x.value.length>1&&!_.value.employeeID)return void F("请选择审批人");q();const e={ID:t.value.id,ActivityName:_.value.activityName,ActivityID:_.value.activityID,ActivityType:_.value.activityType,NextActivityName:_.value.nextActivityName,NextActivityID:_.value.nextActivityID,NextActivityType:_.value.nextActivityType,CandidateApprovers:_.value.nextActivityCandidaters};Sc.StartFlow(e).then((async({ID:e})=>{t.value.startFlow=!1,await A(3e3),Y(),await G(e),le()})).catch((()=>z()))}function le(){V.value.close()}function ae(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{$(e)}})}return uni.getSystemInfo({success:e=>{O.value=e.windowHeight}}),{IsScroll:e.computed((()=>{let e,t;return(O.value-60)/2>225?(e=225,t=O.value-285):e=t=(O.value-60)/2,{header:e,content:t}})),bill:t,billDetail:n,remarkVal:a,rowDetail:l,applyReasonOption:r,applyReasonHandle:function(e){t.value.applyReason.text=r.value.filter((t=>t.value==e))[0].text,t.value.applyReason.value=e},deleteOperationBtn:o,isOpened:h,uniSwipeChange:function(e,t){n.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(n.value.splice(t,1),L("移除成功"))},inputDialog:f,openEditDetailDalog:Q,dialogRemarkInputConfirm:function(e){t.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:y,openRemarkDialog:function(){a.value=t.value.remark,y.value.open()},editDetailConfirm:function(e){if(l.value.Qty){{const e=/^\+?[1-9][0-9]*$/;if(!e.test(l.value.Qty))return void F("请输入正确的数量");if(e.test(l.value.Qty)&&l.value.Qty>n.value[w.value].TotalAvailableStock)return void F("调出数量大于可用库存")}n.value[w.value].Qty=parseInt(l.value.Qty),n.value[w.value].Remark=l.value.Remark,n.value[w.value].ReferenceCostAmount=Math.floor(n.value[w.value].Qty*n.value[w.value].ReferenceCost*100)/100,f.value.close(),j()}else F("请输入数量")},editDetailClose:function(){j()},editBillDetail:function(e){if(R&&null!==t.value.status&&1!=t.value.status)return;w.value=e;const{ConsumableName:a,Brand:o,Spec:i,Model:r,Qty:s,TotalAvailableStock:c,Remark:d,ReferenceCost:u,ReferenceCostAmount:m}=n.value[e];l.value.ConsumableName=a,l.value.Brand=o,l.value.Spec=i,l.value.Model=r,l.value.TotalAvailableStock=c,l.value.ReferenceCost=u,l.value.ReferenceCostAmount=m,l.value.Qty=s,l.value.Remark=d,Q(0)},deleteDialog:N,billDelete:function(){N.value.open()},deleteDialogConfirm:function(){q(),Sc.Delete(t.value.id).then((()=>{et(lt.requestDrawDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:j,handleSaveDraft:function(e){t.value.isSubmit=e,t.value.fromWarehouse.ID?t.value.toWarehouse.ID?t.value.fromWarehouse.ID!=t.value.toWarehouse.ID?t.value.allocateDate?t.value.handledPerson.ID?n.value.length?t.value.isSubmit?b.value.open():K():F("请选择易耗品"):F("经办人必填"):F("调拨日期必填"):F("调出仓库和调入仓库不能相同"):F("调入仓库必填"):F("调出仓库必填")},submitDialog:b,submitMsgType:E,submitDialogConfirm:K,submitDialogClose:H,editInfoTitle:g,billDetailNumber:J,editGetByID:G,nonEditable:R,approvalShow:function(){q(),t.value.enablingApproval=!0,Sc.PrevApproval(t.value.id).then((e=>{const{ActivityID:t,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r,SupportedStrategies:s}=e[0];_.value.activityID=t,_.value.activityName=l,_.value.activityType=a,_.value.nextActivityID=o,_.value.nextActivityName=n,_.value.nextActivityType=i;const{EmployeeID:c,EmployeeName:d}=null!=r?r[0]:[];_.value.employeeID=null!=r?c:"",_.value.employeeName=null!=r?d:"",_.value.approvalType=1,_.value.refuseType=null!=s&&s.length>0?s[0]:null,_.value.remark="",_.value.nextActivityCandidaters=r,_.value.supportedStrategies=null!=s?s.map((e=>({text:1==e?"打回":2==e?"拒绝":"退回",value:e}))):[],C.value.open()})).finally((()=>z()))},approveDialog:C,approveConfirm:function(){_.value.approvalType||_.value.refuseType||0==_.value.supportedStrategies.length?_.value.approvalType||_.value.remark?Z():F("请输入审批意见"):F("请选择处理方式")},submitApproval:Z,approvalClose:X,approveStartUpDialog:V,approverOption:x,approverChange:function(e){_.value.nextActivityCandidaters=x.value.filter((t=>t.EmployeeID==e))},approvalProcessData:_,enablingApprovalShow:ee,approveStartConfirm:te,approveStartClose:le,resetApprovalProcessData:Y,jumpList:function(){tt(lt.consumableAllocateEditBill,(e=>{G(e)})),k("/subcontract/consumable/allocate/list/list")},windowHeights:O,fab:s,fabPattern:c,fabContent:d,fabTrigger:function({index:e}){switch(e){case 0:if(null==t.value.fromWarehouse.ID||""==t.value.fromWarehouse.ID)return void F("请先选择调出仓库");ae();break;case 1:if(null==t.value.fromWarehouse.ID||""==t.value.fromWarehouse.ID)return void F("请先选择调出仓库");m.value="",u.value.open();break;case 2:W.value="listDetail";break;case 3:W.value="example"}s.value.close()},scanCodeDialog:u,searchCodeVal:m,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?$(t):F("无效的检索条件")},addQuery:$,serachGoodsList:p,goodsDialog:v,goodsDialogConfirm:function(){let e=p.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(n.value.filter((t=>t.GoodsID==e[l].ID)).length<1)e[l].GoodsID=e[l].ID,e[l].ID=null,e[l].isOpened="none",e[l].Qty=0,e[l].Remark="",e[l].ReferenceCostAmount=e[l].Qty*e[l].ReferenceCost,n.value.push(e[l]);else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}v.value.close(),p.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=p.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},scan:ae,allocateDateTimeChange:function({detail:{value:e}}){R.value||(t.value.allocateDate=e)},processTrackDialog:I,processTrack:function(){q(),Sc.GetFlowTrail(t.value.id).then((({ApprovalLog:e,ApprovalTask:t})=>{T.value=e.reverse(),P.value=t,I.value.open()})).finally((()=>z()))},processTrackCurrent:B,processTrackClickItem:function(e){B.value!=e.currentIndex&&(B.value=e.currentIndex)},processTrackApprovalLog:T,processTrackApprovalTask:P,sign:function(){uni.navigateTo({url:`/pages/system/signConfirm/signConfirm?type=1&key=203&billID=${t.value.id}`})},removeInput:function(e){switch(e){case"toWarehouse":t.value.toWarehouse.ID="",t.value.toWarehouse.Name="";break;case"fromWarehouse":t.value.fromWarehouse.ID="",t.value.fromWarehouse.Name="",n.value=[];break;case"allocateDate":t.value.allocateDate=null;case"handledPerson":t.value.handledPerson.ID="",t.value.handledPerson.Name="";break;case"remark":t.value.remark=""}},openFromWarehouseSelector:function(){uni.navigateTo({url:"/pages/selector/consumable/warehouse?disableOrg=1&isPower=1"}),tt(lt.consumableWarehouseBack,(e=>{t.value.corpID=e.corpID,t.value.fromWarehouse.ID=e.id,t.value.fromWarehouse.Name=e.label,t.value.fromWarehouse.OID=e.oid}))},openToWarehouseSelector:function(){uni.navigateTo({url:"/pages/selector/consumable/warehouse?disableOrg=1"}),tt(lt.consumableWarehouseBack,(e=>{i("log","at subcontract/consumable/allocate/detail/index.js:179",e),t.value.toWarehouse.ID=e.id,t.value.toWarehouse.Name=e.label,t.value.toWarehouse.OID=e.oid}))},openPersonSelector:function(){""!=t.value.corpID&&null!=t.value.corpID?(tt(lt.employeeSelectBack,(e=>{t.value.handledPerson.ID=e.ID,t.value.handledPerson.Name=e.Name,t.value.handlerOrg.ID=e.OrgID,t.value.handlerOrg.NameCN=e.OrgNameCN,t.value.handlerOrg.NameEN=e.OrgNameEN})),uni.navigateTo({url:`/pages/selector/system/employee?ids=${[t.value.handledPerson.ID]}&corpID=${t.value.corpID} `})):F("请先选择调出仓库")},totalQuantity:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){var o;return null!=(o=e.Qty)?o:e+t.Qty}),0)},totalAmount:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){var o;return null!=(o=e.ReferenceCostAmount)?o:e+t.ReferenceCostAmount}),0)},deletefile:function({tempFile:t}){const l=M.value.findIndex((e=>e===t));M.value.splice(l,1),U.value=!1,e.nextTick((()=>{U.value=!0}))},isfiles:U,select:function({tempFilePaths:t}){q(),be.uploadAttachment(t).then((t=>{U.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));M.value.push(...l),e.nextTick((()=>{U.value=!0}))})).finally((()=>z()))},files:M,fileExtType:_s,isfiles:U,toIndex:W}};var Bc=l({components:{UniFilePicker:Zr},props:{id:String,type:String},setup({id:e,type:t}){const{IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,allocateDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openToWarehouseSelector:ye,openPersonSelector:we,totalQuantity:Ne,totalAmount:Ce,select:Ee,files:be,fileExtType:De,isfiles:Ve,toIndex:ke}=Ic();return hs.dictionaryGetByCode("D006").then((({Items:e})=>{r.value=e.map((e=>({text:e.ItemText,value:e.ID})))})),e&&T(e),tt(lt.signBack,(()=>T(a.value.id))),{type:t,IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,allocateDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openToWarehouseSelector:ye,openPersonSelector:we,totalQuantity:Ne,totalAmount:Ce,select:Ee,files:be,fileExtType:De,isfiles:Ve,toIndex:ke}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-data-select"),_c),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl),u=r(e.resolveDynamicComponent("uni-data-checkbox"),Ns),m=r(e.resolveDynamicComponent("uni-easyinput"),Ie),p=r(e.resolveDynamicComponent("uni-segmented-control"),Es),v=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),h=r(e.resolveDynamicComponent("uni-list-item"),we),f=r(e.resolveDynamicComponent("uni-list"),Ne),g=r(e.resolveDynamicComponent("uni-fab"),ul),y=r(e.resolveDynamicComponent("uni-icons"),fe),w=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),N=r(e.resolveDynamicComponent("uni-swipe-action"),ps),C=r(e.resolveDynamicComponent("uni-section"),ue),E=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(d,{ref:"approveStartUpDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"启动审批流",onConfirm:o.approveStartConfirm,onClose:o.approveStartClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)]),e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批人员："),o.approverOption.length>1?(e.openBlock(),e.createBlock(s,{key:0,clear:!1,modelValue:o.approvalProcessData.employeeID,"onUpdate:modelValue":l[0]||(l[0]=e=>o.approvalProcessData.employeeID=e),localdata:o.approverOption,onChange:o.approverChange},null,8,["modelValue","localdata","onChange"])):(e.openBlock(),e.createElementBlock("text",{key:1},e.toDisplayString(o.approvalProcessData.employeeName),1))])])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"approveDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"单据审批",onConfirm:o.approveConfirm,onClose:o.approvalClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批结果："),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.approvalType,"onUpdate:modelValue":l[1]||(l[1]=e=>o.approvalProcessData.approvalType=e),localdata:o.approvalProcessData.approvalTypeOption},null,8,["modelValue","localdata"])])]),1!=o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"approve-type"},[o.approvalProcessData.supportedStrategies.length?(e.openBlock(),e.createElementBlock("text",{key:0}," 处理方式： ")):e.createCommentVNode("",!0),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.refuseType,"onUpdate:modelValue":l[2]||(l[2]=e=>o.approvalProcessData.refuseType=e),localdata:o.approvalProcessData.supportedStrategies},null,8,["modelValue","localdata"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"approve-opinion approve-type"},[e.createElementVNode("text",null,"审批意见："),e.createElementVNode("view",null,[e.createVNode(m,{type:"textarea",modelValue:o.approvalProcessData.remark,"onUpdate:modelValue":l[3]||(l[3]=e=>o.approvalProcessData.remark=e),placeholder:"请输入内容"},null,8,["modelValue"])])]),1==o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"approve-footer approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)])):e.createCommentVNode("",!0)])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"processTrackDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(v,{title:"流程轨迹",onClose:l[4]||(l[4]=e=>o.processTrackDialog.close())},{default:e.withCtx((()=>[e.createElementVNode("view",{style:e.normalizeStyle(`height:${o.windowHeights/3}px`)},[e.createElementVNode("view",{class:"process_track_tab"},[e.createVNode(p,{current:o.processTrackCurrent,values:["待办任务","流转日志"],"style-type":"text","active-color":"#007aff",onClickItem:o.processTrackClickItem},null,8,["current","onClickItem"])]),0==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track_content"},[o.processTrackApprovalTask.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track"},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"当前节点："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"创建时间："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].CreatedTime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"接收者："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].ApprovalEmployeeName),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0),1==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"process_track_content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.processTrackApprovalLog,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"process_track process_dividing_line",key:l},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"节点名称："),e.createElementVNode("view",null,e.toDisplayString(t.FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批人："),e.createElementVNode("view",null,e.toDisplayString(t.OperaterEmployeeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批时间："),e.createElementVNode("view",null,e.toDisplayString(t.OperationDatetime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批结果："),e.createElementVNode("view",null,e.toDisplayString(t.OperationType),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批意见："),e.createElementVNode("view",null,e.toDisplayString(t.ApprovalComment),1)])])))),128)),o.processTrackApprovalLog.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0)],4)])),_:1})])),_:1},512),e.createVNode(d,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(d,{ref:"deleteDialog",class:"deleteDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base",type:"error",cancelText:"取消",confirmText:"确认",title:"删除申领单",onConfirm:o.deleteDialogConfirm},null,8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"goodsDialog",class:"goodsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{title:"选择易耗品库存",type:"info","before-close":!0,onClose:l[5]||(l[5]=e=>o.goodsDialog.close()),onConfirm:o.goodsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"goodsDialogList",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachGoodsList,(({ID:l,CategoryName:a,ConsumableCode:n,ConsumableName:i,Brand:r,Spec:s,Model:c,TotalAvailableStock:d,Unit:u,Batch:m})=>(e.openBlock(),e.createBlock(h,{key:l},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"asset-dialog-list"},[e.createElementVNode("view",{class:"list-item"},[e.createElementVNode("text",{class:"list-item-column-title"},e.toDisplayString(i),1),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"分类："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"批次："+e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"可用库存："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"计量单位："+e.toDisplayString(u),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"take-delivery-checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,l)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:t.checked},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createVNode(f,{class:"inputDialog"},{default:e.withCtx((()=>[e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ConsumableName),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Brand),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Spec),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Model),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"可用库存：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.TotalAvailableStock),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"参考成本：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ReferenceCost),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"参考成本金额：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(Math.floor(o.rowDetail.Qty*o.rowDetail.ReferenceCost*100)/100),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"数量：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createVNode(m,{border:!1,maxlength:"10",type:"number",modelValue:o.rowDetail.Qty,"onUpdate:modelValue":l[6]||(l[6]=e=>o.rowDetail.Qty=e),placeholder:"请输入数量"},null,8,["modelValue"]),e.createElementVNode("text",{class:"checka"},"*")])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createVNode(m,{border:!1,maxlength:"99",type:"text",modelValue:o.rowDetail.Remark,"onUpdate:modelValue":l[7]||(l[7]=e=>o.rowDetail.Remark=e),placeholder:"请输入备注"},null,8,["modelValue"])])])),_:1})])),_:1})])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose",mode:"input",title:"选择易耗品库存",value:o.searchCodeVal,placeholder:"编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"request-draw-fab"},[e.createVNode(g,{ref:"fab",pattern:o.fabPattern,content:o.fabContent,horizontal:"right",vertical:"bottom",direction:"horizontal",onTrigger:o.fabTrigger},null,8,["pattern","content","onTrigger"])])),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"uni_list"},[e.createVNode(f,null,{default:e.withCtx((()=>[e.createVNode(h,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"info-item-text",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view")]))])),_:1}),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"调出仓库：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.fromWarehouse.Name?"info-item-color":""]),onClick:l[8]||(l[8]=e=>o.nonEditable?null:o.openFromWarehouseSelector())},e.toDisplayString(o.bill.fromWarehouse.Name?o.bill.fromWarehouse.Name:"请选择调出仓库"),3)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.fromWarehouse.ID?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[9]||(l[9]=e=>o.removeInput("fromWarehouse")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"调入仓库：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.toWarehouse.Name?"info-item-color":""]),onClick:l[10]||(l[10]=e=>o.nonEditable?null:o.openToWarehouseSelector())},e.toDisplayString(o.bill.toWarehouse.Name?o.bill.toWarehouse.Name:"请选择调入仓库"),3)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.toWarehouse.ID?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[11]||(l[11]=e=>o.removeInput("toWarehouse")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"调拨日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("picker",{mode:"date",onChange:l[12]||(l[12]=(...e)=>o.allocateDateTimeChange&&o.allocateDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.allocateDate?"info-item-color":""])},e.toDisplayString(o.bill.allocateDate?o.bill.allocateDate:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.allocateDate?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[13]||(l[13]=e=>o.removeInput("allocateDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.handledPerson.ID?"info-item-color":""]),onClick:l[14]||(l[14]=e=>o.nonEditable?null:o.openPersonSelector())},e.toDisplayString(o.bill.handledPerson.ID?o.bill.handledPerson.Name:"请选择人员"),3)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.handledPerson.ID?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[15]||(l[15]=e=>o.removeInput("handledPerson")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"备注：")])])),body:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-input",style:{"font-size":"14px",width:"100%","text-align":"right"},disabled:null==o.nonEditable,placeholder:"请输入备注信息","onUpdate:modelValue":l[16]||(l[16]=e=>o.bill.remark=e)},null,8,["disabled"]),[[e.vModelText,o.bill.remark]])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[17]||(l[17]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill-list-request-draw",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),"scroll-y":"",onScroll:l[19]||(l[19]=e=>o.toIndex=""),"scroll-into-view":o.toIndex},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(C,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"Statistics"}," 总数量:"+e.toDisplayString(o.totalQuantity())+" 总金额:"+e.toDisplayString(o.totalAmount()),1),e.createElementVNode("view",{class:"bill-detail-request-draw"},[e.createVNode(N,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(w,{disabled:o.nonEditable,"right-options":o.deleteOperationBtn,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.index,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createVNode(h,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item",onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("text",{class:"list-item-title",selectable:""},"资产名称："+e.toDisplayString(t.ConsumableName),1),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"分类："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(t.ConsumableCode),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(t.Brand),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"可用库存："+e.toDisplayString(t.TotalAvailableStock),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"参考成本："+e.toDisplayString(t.ReferenceCost),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"参考成本金额："+e.toDisplayString(t.ReferenceCostAmount),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"计量单位："+e.toDisplayString(t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"调出数量："+e.toDisplayString(t.Qty),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])])),_:2},1024)])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1})])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(C,{title:"附件",type:"line"},{default:e.withCtx((()=>[o.isfiles?(e.openBlock(),e.createBlock(E,{key:0,ref:"filePicker",limit:9,disabled:o.nonEditable,"del-icon":!o.nonEditable,"file-mediatype":"all","file-extname":o.fileExtType.all,mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[18]||(l[18]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:t.deletefile,title:"最多选择9个附件"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"unload-attachment"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,type:"primary"},"上传附件"))])])),_:1},8,["disabled","del-icon","file-extname","modelValue","onSelect","onDelete"])):e.createCommentVNode("",!0)])),_:1})],44,["scroll-into-view"]),o.nonEditable?(e.openBlock(),e.createElementBlock("view",{key:1,class:"toIndex"},[e.createElementVNode("view",{onClick:l[20]||(l[20]=e=>o.toIndex="listDetail")},[e.createVNode(y,{type:"arrow-up",color:"#fff",size:"30"}),e.createElementVNode("br")]),e.createElementVNode("view",{onClick:l[21]||(l[21]=e=>o.toIndex="example")},[e.createVNode(y,{type:"arrow-down",color:"#fff",size:"30"}),e.createElementVNode("br")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"bill-footer-request-draw"},[e.createElementVNode("view",{class:"bill_list"},[o.type?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("image",{key:0,src:"/static/icon/bill_list.png",alt:"",onClick:l[22]||(l[22]=(...e)=>o.jumpList&&o.jumpList(...e))}))]),e.createElementVNode("view",null,[1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:l[23]||(l[23]=e=>o.handleSaveDraft(0))},[e.createElementVNode("text",{class:"text-overflow"},"保存草稿")])):e.createCommentVNode("",!0),1==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:l[24]||(l[24]=(...e)=>o.billDelete&&o.billDelete(...e))},[e.createElementVNode("text",{class:"uni-icon-delete text-overflow"},"删除草稿")])):e.createCommentVNode("",!0),1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:2,onClick:l[25]||(l[25]=e=>o.handleSaveDraft(1)),type:"primary",class:"uni-icon-submit"},[e.createElementVNode("text",{class:"text-overflow",style:{color:"#fff"}},"提交")])):e.createCommentVNode("",!0),o.bill.IsApproval?(e.openBlock(),e.createElementBlock("button",{key:3,onClick:l[26]||(l[26]=(...e)=>o.approvalShow&&o.approvalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"},"审批")])):e.createCommentVNode("",!0),o.bill.IsStart&&o.bill.startFlow?(e.openBlock(),e.createElementBlock("button",{key:4,onClick:l[27]||(l[27]=(...e)=>o.enablingApprovalShow&&o.enablingApprovalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"}," 启动审批流 ")])):e.createCommentVNode("",!0),o.bill.FlowPath?(e.openBlock(),e.createElementBlock("button",{key:5,onClick:l[28]||(l[28]=(...e)=>o.processTrack&&o.processTrack(...e))},[e.createElementVNode("text",{class:"text-overflow"},"流程轨迹")])):e.createCommentVNode("",!0),7==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:6,onClick:l[29]||(l[29]=(...e)=>o.sign&&o.sign(...e))},[e.createElementVNode("text",null,"签字")])):e.createCommentVNode("",!0)])])],64)}],["__scopeId","data-v-663bbd2a"]]);var Tc=()=>{const{Data:t,BillType:l,Condition:a}={Data:e.ref({IsSetNumber:!0,QST:"",WarehouseOrCorpIDs:[],BillCode:"",AllocateEndDate:"",AllocateStartDate:"",ConsumableCategoryIDs:[],HandlerEmployeeIDs:[],HandlerOrgIDs:[],ConsumableCode:"",ListMode:2,Sort:2,PageSize:20,PageNO:1,BillStatus:0}),BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],Condition:e.ref({WarehouseOrCorp:[],Person:[]})};function o(e){switch(e){case"WarehouseOrCorp":t.value.WarehouseOrCorpIDs=[],a.value.WarehouseOrCorp=[];break;case"BillCode":t.value.BillCode="";break;case"AllocateStartDate":t.value.AllocateStartDate="";break;case"AllocateEndDate":t.value.AllocateEndDate="";break;case"Person":a.value.Person=[],t.value.HandlerEmployeeIDs=[]}}return{Data:t,query:function(){Xe(lt.consumableAllocateConditionBack,t.value),S()},BillType:l,bindPickerChange:function(e){let a=l.findIndex(((t,l,a)=>t.value==e.detail.value));t.value.BillStatus=a},getWarehouseOrCorpText:function(){return a.value.WarehouseOrCorp.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getWarehouseOrCorpIDs:function(){uni.navigateTo({url:`/pages/selector/consumable/warehouse?ids=${t.value.HandlerOrgIDs}&multiple=1`}),tt(lt.consumableWarehouseBack,(e=>{let l=e.items.map((e=>({Name:e.label,ID:e.id})));a.value.WarehouseOrCorp=l,t.value.WarehouseOrCorpIDs=l.map((e=>e.ID))}))},bindAllocateStartDatePickerChange:function(e){t.value.AllocateStartDate=e.detail.value},bindAllocateEndDatePickerChange:function(e){t.value.AllocateEndDate=e.detail.value},clearInputText:o,reset:function(){t.value.BillStatus=0,o("WarehouseOrCorp"),o("BillCode"),o("AllocateStartDate"),o("AllocateEndDate"),o("Person")},getPersonText:function(){return a.value.Person.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getPersonIDs:function(){tt(lt.employeeSelectBack,(e=>{let l=e.items.map((e=>({Name:e.Name,ID:e.ID})));i("log","at subcontract/consumable/allocate/condition/index.js:45",e),a.value.Person=l,t.value.HandlerEmployeeIDs=l.map((e=>e.ID))})),uni.navigateTo({url:`/pages/selector/system/employee?multiple=1&ids=${t.value.HandlerEmployeeIDs}`})}}};var Ac=l({props:{id:String,type:String},setup({id:e,type:t}){const{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindAllocateStartDatePickerChange:c,bindAllocateEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v}=Tc();return{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindAllocateStartDatePickerChange:c,bindAllocateEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"screen"},[e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 单据状态： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{onChange:l[0]||(l[0]=(...e)=>o.bindPickerChange&&o.bindPickerChange(...e)),value:o.BillType[o.Data.BillStatus].value,range:o.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(o.BillType[o.Data.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"right"})]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 调出仓库： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择仓库",value:o.getWarehouseOrCorpText(),onClick:l[1]||(l[1]=(...e)=>o.getWarehouseOrCorpIDs&&o.getWarehouseOrCorpIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getWarehouseOrCorpText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[2]||(l[2]=e=>o.clearInputText("WarehouseOrCorp"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 经办人： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择经办人",value:o.getPersonText(),onClick:l[3]||(l[3]=(...e)=>o.getPersonIDs&&o.getPersonIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getPersonText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[4]||(l[4]=e=>o.clearInputText("Person"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 调拨单号： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请输入调拨单号","onUpdate:modelValue":l[5]||(l[5]=e=>o.Data.BillCode=e)},null,512),[[e.vModelText,o.Data.BillCode]])]),e.createElementVNode("view",{class:"right"},[o.Data.BillCode?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[6]||(l[6]=e=>o.clearInputText("BillCode"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 调拨日期起： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[7]||(l[7]=(...e)=>o.bindAllocateStartDatePickerChange&&o.bindAllocateStartDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.AllocateStartDate?o.Data.AllocateStartDate:"调拨日期起"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.AllocateStartDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[8]||(l[8]=e=>o.clearInputText("AllocateStartDate"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 调拨日期止： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[9]||(l[9]=(...e)=>o.bindAllocateEndDatePickerChange&&o.bindAllocateEndDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.AllocateEndDate?o.Data.AllocateEndDate:"调拨日期止"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.AllocateEndDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[10]||(l[10]=e=>o.clearInputText("AllocateEndDate"))})):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"button_list"},[e.createElementVNode("button",{class:"button_item reset",onClick:l[11]||(l[11]=(...e)=>o.reset&&o.reset(...e))},"重置"),e.createElementVNode("button",{class:"button_item query",onClick:l[12]||(l[12]=(...e)=>o.query&&o.query(...e))},"查询")])])}],["__scopeId","data-v-1c7137b0"]]);const Pc={data:()=>({BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{IsSetNumber:!0,QST:"",WarehouseOrCorpIDs:[],BillCode:"",AllocateEndDate:"",AllocateStartDate:"",ConsumableCategoryIDs:[],HandlerEmployeeIDs:[],HandlerOrgIDs:[],ConsumableCode:"",ListMode:2,Sort:2,PageSize:20,PageNO:1,BillStatus:0},data:[],pageCount:0,total:0}),methods:{timeConvertDate:Ql,bindPickerChange(e){let t=this.BillType.findIndex(((t,l,a)=>t.value==e.detail.value));this.condition.BillStatus=t,this.load()},editBill(e){Xe(lt.consumableAllocateEditBill,e),S()},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;"http://"==l.substring(0,7).toLowerCase()||"https://"==l.substring(0,8).toLowerCase()?e.condition.QST=ruleShow(l):e.condition.QST=l,e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),Sc.getAllocateList(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){tt(lt.consumableAllocateConditionBack,(e=>{this.condition=e,this.condition.PageSize=10,this.condition.PageNO=1,this.load()})),uni.navigateTo({url:"/subcontract/consumable/allocate/condition/condition"})}},computed:{},mounted(){this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var Oc=l(Pc,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"seach_condition",onClick:l[0]||(l[0]=(...e)=>i.SettingCondition&&i.SettingCondition(...e))},[e.createElementVNode("view",{class:"icon_condition"},[e.createElementVNode("image",{src:"/static/icon/condition.png",style:{width:"26px",height:"26px"}})])]),e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"单号","onUpdate:modelValue":l[1]||(l[1]=e=>this.condition.BillCode=e),"confirm-type":"search",onConfirm:l[2]||(l[2]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.BillCode]])]),e.createElementVNode("view",{class:"QC"},[e.createElementVNode("view",{class:"icon-saoma"},[e.createElementVNode("image",{src:"/static/saoma.png",style:{width:"30px",height:"30px"},onClick:l[3]||(l[3]=(...e)=>i.ScanCode&&i.ScanCode(...e))})])])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"billStatus"},[e.createElementVNode("picker",{onChange:l[4]||(l[4]=(...e)=>i.bindPickerChange&&i.bindPickerChange(...e)),value:n.BillType[n.condition.BillStatus].value,range:n.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(n.BillType[n.condition.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[5]||(l[5]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[6]||(l[6]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[7]||(l[7]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[8]||(l[8]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[9]||(l[9]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:e=>i.editBill(t.ID)},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillerEmployeeName)+"提交的易耗品调拨单",1),e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillDateTime),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"单号："+e.toDisplayString(t.BillCode),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#007aff"}},"单据状态："+e.toDisplayString(t.StatusText),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"调拨日期："+e.toDisplayString(i.timeConvertDate(t.AllocateDate)),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"调出仓库："+e.toDisplayString(t.FromWarehouseName),1),e.createElementVNode("text",null,"调入仓库："+e.toDisplayString(t.ToWarehouseName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"经办部门："+e.toDisplayString(t.HandlerOrgName),1),e.createElementVNode("text",null,"经办人："+e.toDisplayString(t.HandlerEmployeeName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"参考成本总金额："+e.toDisplayString(t.TotalReferenceCostAmountText),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])))),128))])],40,["refresher-triggered"])])}],["__scopeId","data-v-c2257d00"]]);var Rc=new class extends Je{constructor(){super("Discard")}getStockList(e,t){return this.request("/Stock/List",{WarehouseIDs:e,QST:t})}QueryDiscardBill(e){return this.request("/Bill/Discard/List",e)}SaveDraft(e){return this.request("/Bill/Discard/SaveDraft",e)}GetByID(e){return this.request("/Bill/Discard/GetByID",e)}Delete(e){return this.request("/Bill/Discard/Delete",{ID:e})}PreStartFlow(e){return this.preStartFlow(e)}StartFlow(e){return this.startFlow(e)}PrevApproval(e){return this.prevApproval(e)}SubmitApproval(e){return this.submitApproval(e)}GetFlowTrail(e){return this.getFlowTrail(e)}},Lc=()=>{const{bill:t,rowDetail:l,remarkVal:a,deleteOperationBtn:o,billDetail:n,applyReasonOption:r,fab:s,fabPattern:c,fabContent:d,scanCodeDialog:u,searchCodeVal:m,serachGoodsList:p,goodsDialog:v,isOpened:h,inputDialog:f,editInfoTitle:g,inputRemarkDialog:y,detailIndex:w,deleteDialog:N,approveDialog:C,submitMsgType:E,submitDialog:b,approveStartUpDialog:V,approverOption:x,approvalProcessData:_,processTrackDialog:I,processTrackCurrent:B,processTrackApprovalLog:T,processTrackApprovalTask:P,windowHeights:O,nonEditable:R,isfiles:U,files:M,toIndex:W}=(()=>{const t=e.ref([]),l=e.ref(!0),a=e.ref(""),o=e.ref({id:null,status:null,isSubmit:null,code:"",warehouse:{Name:"",ID:"",OID:""},discardDate:"",corpID:"",handledPerson:{ID:"",Name:""},handlerOrg:{ID:"",NameCN:"",NameEN:""},remark:"",remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),n=e.ref({ConsumableName:"",Brand:"",Spec:"",Model:"",Qty:1,TotalAvailableStock:0}),i=e.ref(""),r=e.ref([]),s=e.ref([]),c=e.ref([]);return c.value=[{text:"取消",style:{backgroundColor:"#007aff"}},{text:"删除",style:{backgroundColor:"#F56C6C"}}],{bill:o,rowDetail:n,remarkVal:i,deleteOperationBtn:c,billDetail:s,applyReasonOption:r,fab:e.ref(null),fabPattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#007AFF",iconColor:"#fff"},fabContent:[{iconPath:"/static/icon/sys.png",selectedIconPath:"/static/icon/sys.png",text:"扫码",active:!1},{iconPath:"/static/icon/edit.png",selectedIconPath:"/static/icon/edit.png",text:"检索",active:!1},{iconPath:"/static/icon/asset_mingxi.png",selectedIconPath:"/static/icon/asset_mingxi.png",text:"明细",active:!1},{iconPath:"/static/icon/asset_fujian.png",selectedIconPath:"/static/icon/asset_fujian.png",text:"附件",active:!1}],scanCodeDialog:e.ref(null),searchCodeVal:e.ref(""),serachGoodsList:e.ref([]),goodsDialog:e.ref(null),isOpened:e.ref("none"),inputDialog:e.ref(null),editInfoTitle:e.ref(""),inputRemarkDialog:e.ref(null),detailIndex:e.ref(null),deleteDialog:e.ref(null),approveDialog:e.ref(null),submitMsgType:e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),submitDialog:e.ref(null),approveStartUpDialog:e.ref(null),approverOption:e.ref([]),approvalProcessData:e.ref({activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}),processTrackDialog:e.ref(null),processTrackCurrent:e.ref(0),processTrackApprovalLog:e.ref([]),processTrackApprovalTask:e.ref([]),windowHeights:e.ref(""),nonEditable:e.ref(!1),isfiles:l,files:t,toIndex:a}})();function $(e){q(),Rc.getStockList([t.value.warehouse.ID],e).then((({Items:e})=>{p.value=e.map((e=>(e.checked=!1,e))),p.value.length<1?F("未查询到可用资产资料"):v.value.open()})).finally((()=>z()))}function Q(e){g.value=e?"新增":"编辑",f.value.open()}function j(){l.value.ConsumableName="",l.value.Brand="",l.value.Spec="",l.value.Model="",l.value.Qty=1,l.value.TotalAvailableStock="",l.value.Remark="",l.value.ReferenceCost="",l.value.ReferenceCostAmount="",w.value=null,f.value.close()}function H(){b.value.close()}function K(){let e={};e.ID=t.value.id,e.AddOrEdit=t.value.id?2:1,e.IsSubmit=!!t.value.isSubmit,e.HandlerEmployeeID=t.value.handledPerson.ID,e.HandlerEmployeeName=t.value.handledPerson.Name,e.HandlerOrgID=t.value.handlerOrg.ID,e.HandlerOrgNameCN=t.value.handlerOrg.NameCN,e.HandlerOrgNameEN=t.value.handlerOrg.NameEN,e.DiscardDate=t.value.discardDate,e.WarehouseID=t.value.warehouse.OID,e.Remark=t.value.remark,e.Details=n.value.map(((e,t)=>{let l={};return l.ID=e.ID,l.Batch=e.Batch,l.Brand=e.Brand,l.CategoryName=e.CategoryName,l.ConsumableCode=e.ConsumableCode,l.ConsumableID=e.ConsumableID,l.ConsumableName=e.ConsumableName,l.IsEnableBatch=e.IsEnableBatch,l.Spec=e.Spec,l.Model=e.Model,l.Unit=e.Unit,l.Qty=e.Qty,l.ReferenceCostPrice=e.ReferenceCost,l.ReferenceCostAmount=e.ReferenceCostAmount,l.ReferenceCostAmountText=e.ReferenceCostAmount,l.Remark=e.Remark,l.StockID=e.StockID,l.Stock=e.Stock,l.AvailableStock=e.AvailableStock,l.StockText=e.StockText,l.Sequence=t+1,l})),e.Attachments=M.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),Rc.SaveDraft(e).then((e=>{G(e.ID).then((()=>{t.value.IsStart&&ee()})),H()})).finally((()=>z()))}function G(e){return q(),Rc.GetByID({ID:e}).then((({ID:e,Status:l,Code:a,Remark:o,DiscardDate:i,WarehouseID:r,WarehouseName:s,WarehouseNameCN:c,WarehouseNameEN:d,HandlerEmployeeID:u,HandlerEmployeeName:m,CorpID:p,HandlerOrgID:v,HandlerOrgName:h,HandlerOrgNameCN:f,HandlerOrgNameEN:g,Stock:y,Details:w,FlowInfo:N,Attachments:C})=>{t.value.id=e,t.value.status=l,t.value.code=a,t.value.remark=o,t.value.warehouse.Name=s,t.value.warehouse.ID=r,t.value.warehouse.OID=r,t.value.discardDate=i.substring(0,10),t.value.corpID=p,t.value.handledPerson.Name=m,t.value.handledPerson.ID=u,t.value.handlerOrg={ID:v,NameCN:f,NameEN:g},M.value=C.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),n.value=w.map((e=>{let t=e;return t.CategoryName=e.ConsumableCategoryName,t.TotalAvailableStock=e.Stock,t.ReferenceCost=e.ReferenceCostPrice,e})),R.value=1!=t.value.status&&null!=t.value.status,t.value.IsApproval=N.IsApproval,t.value.IsStart=1!=l&&!N.IsStart&&N.IsEnabledFlow,t.value.FlowPath=1!=l&&N.IsStart&&N.IsEnabledFlow||N.IsSendBack})).finally((()=>z()))}let J=e.computed((()=>{let e=0;for(let t=0;t<n.value.length;t++)e+=parseInt(n.value[t].qty);return e}));function Y(){_.value={activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}}function Z(){q();const e={ID:t.value.id,IsPass:_.value.approvalType,Remark:_.value.remark,SupportedStrategies:_.value.refuseType,IsAdditionalApproval:!1,AdditionalApprovalEmployeeId:null,ActivityName:_.value.activityName,ActivityID:_.value.activityID,ActivityType:_.value.activityType,NextActivityName:_.value.nextActivityName,NextActivityID:_.value.nextActivityID,NextActivityType:_.value.nextActivityType,CandidateApprovers:_.value.nextActivityCandidaters};Rc.SubmitApproval(e).then((({ID:e})=>{t.value.startFlow=!1;let l=setTimeout((()=>{Y(),G(e).then((()=>{X()})).finally((()=>z())),clearTimeout(l)}),3e3)})).catch((()=>z()))}function X(){C.value.close()}function ee(){q(),i("log","at subcontract/consumable/discard/detail/index.js:629",t.value.id),t.value.enablingApproval=!1,Rc.PreStartFlow(t.value.id).then((({ActivityID:e,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r})=>{if(_.value.activityID=e,_.value.activityName=l,_.value.activityType=a,_.value.nextActivityID=o,_.value.nextActivityName=n,_.value.nextActivityType=i,1!=r.length&&null!=r)_.value.employeeID=null,_.value.employeeName="";else{const{EmployeeID:e,EmployeeName:t}=r[0];_.value.employeeID=e||null,_.value.employeeName=t||""}_.value.nextActivityCandidaters=r,x.value=r.map((e=>(e.text=e.EmployeeName,e.value=e.EmployeeID,e))),V.value.open(),1==r.length&&t.value.IsStart||2==i&&t.value.IsStart?te():z()})).catch((()=>z()))}function te(){if(x.value.length>1&&!_.value.employeeID)return void F("请选择审批人");q();const e={ID:t.value.id,ActivityName:_.value.activityName,ActivityID:_.value.activityID,ActivityType:_.value.activityType,NextActivityName:_.value.nextActivityName,NextActivityID:_.value.nextActivityID,NextActivityType:_.value.nextActivityType,CandidateApprovers:_.value.nextActivityCandidaters};Rc.StartFlow(e).then((async({ID:e})=>{t.value.startFlow=!1,await A(3e3),Y(),await G(e),le()})).catch((()=>z()))}function le(){V.value.close()}function ae(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{$(e)}})}return uni.getSystemInfo({success:e=>{O.value=e.windowHeight}}),{IsScroll:e.computed((()=>{let e,t;return(O.value-60)/2>225?(e=225,t=O.value-285):e=t=(O.value-60)/2,{header:e,content:t}})),bill:t,billDetail:n,remarkVal:a,rowDetail:l,applyReasonOption:r,applyReasonHandle:function(e){t.value.applyReason.text=r.value.filter((t=>t.value==e))[0].text,t.value.applyReason.value=e},deleteOperationBtn:o,isOpened:h,uniSwipeChange:function(e,t){n.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(n.value.splice(t,1),L("移除成功"))},inputDialog:f,openEditDetailDalog:Q,dialogRemarkInputConfirm:function(e){t.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:y,openRemarkDialog:function(){a.value=t.value.remark,y.value.open()},editDetailConfirm:function(e){if(l.value.Qty){{const e=/^\+?[1-9][0-9]*$/;if(!e.test(l.value.Qty))return void F("请输入正确的数量");if(e.test(l.value.Qty)&&l.value.Qty>n.value[w.value].TotalAvailableStock)return void F("调出数量大于可用库存")}n.value[w.value].Qty=parseInt(l.value.Qty),n.value[w.value].Remark=l.value.Remark,n.value[w.value].ReferenceCostAmount=Math.floor(n.value[w.value].Qty*n.value[w.value].ReferenceCost*100)/100,f.value.close(),j()}else F("请输入数量")},editDetailClose:function(){j()},editBillDetail:function(e){if(R&&null!==t.value.status&&1!=t.value.status)return;w.value=e;const{ConsumableName:a,Brand:o,Spec:i,Model:r,Qty:s,TotalAvailableStock:c,Remark:d,ReferenceCost:u,ReferenceCostAmount:m}=n.value[e];l.value.ConsumableName=a,l.value.Brand=o,l.value.Spec=i,l.value.Model=r,l.value.TotalAvailableStock=c,l.value.ReferenceCost=u,l.value.ReferenceCostAmount=m,l.value.Qty=s,l.value.Remark=d,Q(0)},deleteDialog:N,billDelete:function(){N.value.open()},deleteDialogConfirm:function(){q(),Rc.Delete(t.value.id).then((()=>{et(lt.requestDrawDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:j,handleSaveDraft:function(e){t.value.isSubmit=e,t.value.warehouse.ID?t.value.discardDate?t.value.handledPerson.ID?n.value.length?t.value.isSubmit?b.value.open():K():F("请选择易耗品"):F("经办人必填"):F("报废日期必填"):F("仓库必填")},submitDialog:b,submitMsgType:E,submitDialogConfirm:K,submitDialogClose:H,editInfoTitle:g,billDetailNumber:J,editGetByID:G,nonEditable:R,approvalShow:function(){q(),t.value.enablingApproval=!0,Rc.PrevApproval(t.value.id).then((e=>{const{ActivityID:t,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r,SupportedStrategies:s}=e[0];_.value.activityID=t,_.value.activityName=l,_.value.activityType=a,_.value.nextActivityID=o,_.value.nextActivityName=n,_.value.nextActivityType=i;const{EmployeeID:c,EmployeeName:d}=null!=r?r[0]:[];_.value.employeeID=null!=r?c:"",_.value.employeeName=null!=r?d:"",_.value.approvalType=1,_.value.refuseType=null!=s&&s.length>0?s[0]:null,_.value.remark="",_.value.nextActivityCandidaters=r,_.value.supportedStrategies=null!=s?s.map((e=>({text:1==e?"打回":2==e?"拒绝":"退回",value:e}))):[],C.value.open()})).finally((()=>z()))},approveDialog:C,approveConfirm:function(){_.value.approvalType||_.value.refuseType||0==_.value.supportedStrategies.length?_.value.approvalType||_.value.remark?Z():F("请输入审批意见"):F("请选择处理方式")},submitApproval:Z,approvalClose:X,approveStartUpDialog:V,approverOption:x,approverChange:function(e){_.value.nextActivityCandidaters=x.value.filter((t=>t.EmployeeID==e))},approvalProcessData:_,enablingApprovalShow:ee,approveStartConfirm:te,approveStartClose:le,resetApprovalProcessData:Y,jumpList:function(){tt(lt.consumableAllocateEditBill,(e=>{G(e)})),k("/subcontract/consumable/discard/list/list")},windowHeights:O,fab:s,fabPattern:c,fabContent:d,fabTrigger:function({index:e}){switch(e){case 0:if(null==t.value.warehouse.ID||""==t.value.warehouse.ID)return void F("请先选择仓库");ae();break;case 1:if(null==t.value.warehouse.ID||""==t.value.warehouse.ID)return void F("请先选择仓库");m.value="",u.value.open();case 2:W.value="listDetail";break;case 3:W.value="example"}s.value.close()},scanCodeDialog:u,searchCodeVal:m,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?$(t):F("无效的检索条件")},addQuery:$,serachGoodsList:p,goodsDialog:v,goodsDialogConfirm:function(){let e=p.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(n.value.filter((t=>t.GoodsID==e[l].ID)).length<1)e[l].GoodsID=e[l].ID,e[l].ID=null,e[l].isOpened="none",e[l].Qty=0,e[l].Remark="",e[l].ReferenceCostAmount=e[l].Qty*e[l].ReferenceCost,n.value.push(e[l]);else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}v.value.close(),p.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=p.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},scan:ae,discardDateTimeChange:function({detail:{value:e}}){R.value||(t.value.discardDate=e)},processTrackDialog:I,processTrack:function(){q(),Rc.GetFlowTrail(t.value.id).then((({ApprovalLog:e,ApprovalTask:t})=>{T.value=e.reverse(),P.value=t,I.value.open()})).finally((()=>z()))},processTrackCurrent:B,processTrackClickItem:function(e){B.value!=e.currentIndex&&(B.value=e.currentIndex)},processTrackApprovalLog:T,processTrackApprovalTask:P,sign:function(){uni.navigateTo({url:`/pages/system/signConfirm/signConfirm?type=1&key=202&billID=${t.value.id}`})},removeInput:function e(l){switch(l){case"warehouse":t.value.warehouse.ID="",t.value.warehouse.Name="",t.value.warehouse.OID="",t.value.corpID="",n.value=[],e("handledPerson");break;case"discardDate":t.value.discardDate=null;case"handledPerson":t.value.handledPerson.ID="",t.value.handledPerson.Name="";break;case"remark":t.value.remark=""}},openFromWarehouseSelector:function(){uni.navigateTo({url:"/pages/selector/consumable/warehouse?disableOrg=1&isPower=1"}),tt(lt.consumableWarehouseBack,(e=>{t.value.corpID=e.corpID,t.value.warehouse.ID=e.id,t.value.warehouse.Name=e.label,t.value.warehouse.OID=e.oid}))},openPersonSelector:function(){""!=t.value.corpID&&null!=t.value.corpID?(tt(lt.employeeSelectBack,(e=>{t.value.handledPerson.ID=e.ID,t.value.handledPerson.Name=e.Name,t.value.handlerOrg.ID=e.OrgID,t.value.handlerOrg.NameCN=e.OrgNameCN,t.value.handlerOrg.NameEN=e.OrgNameEN})),uni.navigateTo({url:`/pages/selector/system/employee?ids=${[t.value.handledPerson.ID]}&corpID=${t.value.corpID} `})):F("请先选择调出仓库")},totalQuantity:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){var o;return null!=(o=e.Qty)?o:e+t.Qty}),0)},totalAmount:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){var o;return null!=(o=e.ReferenceCostAmount)?o:e+t.ReferenceCostAmount}),0)},isfiles:U,select:function({tempFilePaths:t}){q(),be.uploadAttachment(t).then((t=>{U.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));M.value.push(...l),e.nextTick((()=>{U.value=!0}))})).finally((()=>z()))},files:M,fileExtType:_s,isfiles:U,toIndex:W}};var Fc=l({components:{UniFilePicker:Zr},props:{id:String,type:String},setup({id:e,type:t}){const{IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,discardDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openPersonSelector:ye,totalQuantity:we,totalAmount:Ne,select:Ce,files:Ee,fileExtType:be,isfiles:De,toIndex:Ve}=Lc();return hs.dictionaryGetByCode("D006").then((({Items:e})=>{r.value=e.map((e=>({text:e.ItemText,value:e.ID})))})),e&&T(e),tt(lt.signBack,(()=>T(a.value.id))),{type:t,IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,discardDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openPersonSelector:ye,totalQuantity:we,totalAmount:Ne,select:Ce,files:Ee,fileExtType:be,isfiles:De,toIndex:Ve}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-data-select"),_c),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl),u=r(e.resolveDynamicComponent("uni-data-checkbox"),Ns),m=r(e.resolveDynamicComponent("uni-easyinput"),Ie),p=r(e.resolveDynamicComponent("uni-segmented-control"),Es),v=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),h=r(e.resolveDynamicComponent("uni-list-item"),we),f=r(e.resolveDynamicComponent("uni-list"),Ne),g=r(e.resolveDynamicComponent("uni-fab"),ul),y=r(e.resolveDynamicComponent("uni-icons"),fe),w=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),N=r(e.resolveDynamicComponent("uni-swipe-action"),ps),C=r(e.resolveDynamicComponent("uni-section"),ue),E=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(d,{ref:"approveStartUpDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"启动审批流",onConfirm:o.approveStartConfirm,onClose:o.approveStartClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)]),e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批人员："),o.approverOption.length>1?(e.openBlock(),e.createBlock(s,{key:0,clear:!1,modelValue:o.approvalProcessData.employeeID,"onUpdate:modelValue":l[0]||(l[0]=e=>o.approvalProcessData.employeeID=e),localdata:o.approverOption,onChange:o.approverChange},null,8,["modelValue","localdata","onChange"])):(e.openBlock(),e.createElementBlock("text",{key:1},e.toDisplayString(o.approvalProcessData.employeeName),1))])])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"approveDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"单据审批",onConfirm:o.approveConfirm,onClose:o.approvalClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批结果："),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.approvalType,"onUpdate:modelValue":l[1]||(l[1]=e=>o.approvalProcessData.approvalType=e),localdata:o.approvalProcessData.approvalTypeOption},null,8,["modelValue","localdata"])])]),1!=o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"approve-type"},[o.approvalProcessData.supportedStrategies.length?(e.openBlock(),e.createElementBlock("text",{key:0}," 处理方式： ")):e.createCommentVNode("",!0),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.refuseType,"onUpdate:modelValue":l[2]||(l[2]=e=>o.approvalProcessData.refuseType=e),localdata:o.approvalProcessData.supportedStrategies},null,8,["modelValue","localdata"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"approve-opinion approve-type"},[e.createElementVNode("text",null,"审批意见："),e.createElementVNode("view",null,[e.createVNode(m,{type:"textarea",modelValue:o.approvalProcessData.remark,"onUpdate:modelValue":l[3]||(l[3]=e=>o.approvalProcessData.remark=e),placeholder:"请输入内容"},null,8,["modelValue"])])]),1==o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"approve-footer approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)])):e.createCommentVNode("",!0)])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"processTrackDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(v,{title:"流程轨迹",onClose:l[4]||(l[4]=e=>o.processTrackDialog.close())},{default:e.withCtx((()=>[e.createElementVNode("view",{style:e.normalizeStyle(`height:${o.windowHeights/3}px`)},[e.createElementVNode("view",{class:"process_track_tab"},[e.createVNode(p,{current:o.processTrackCurrent,values:["待办任务","流转日志"],"style-type":"text","active-color":"#007aff",onClickItem:o.processTrackClickItem},null,8,["current","onClickItem"])]),0==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track_content"},[o.processTrackApprovalTask.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track"},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"当前节点："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"创建时间："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].CreatedTime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"接收者："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].ApprovalEmployeeName),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0),1==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"process_track_content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.processTrackApprovalLog,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"process_track process_dividing_line",key:l},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"节点名称："),e.createElementVNode("view",null,e.toDisplayString(t.FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批人："),e.createElementVNode("view",null,e.toDisplayString(t.OperaterEmployeeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批时间："),e.createElementVNode("view",null,e.toDisplayString(t.OperationDatetime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批结果："),e.createElementVNode("view",null,e.toDisplayString(t.OperationType),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批意见："),e.createElementVNode("view",null,e.toDisplayString(t.ApprovalComment),1)])])))),128)),o.processTrackApprovalLog.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0)],4)])),_:1})])),_:1},512),e.createVNode(d,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(d,{ref:"deleteDialog",class:"deleteDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base",type:"error",cancelText:"取消",confirmText:"确认",title:"删除申领单",onConfirm:o.deleteDialogConfirm},null,8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"goodsDialog",class:"goodsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{title:"选择易耗品库存",type:"info","before-close":!0,onClose:l[5]||(l[5]=e=>o.goodsDialog.close()),onConfirm:o.goodsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"goodsDialogList",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachGoodsList,(({ID:l,CategoryName:a,ConsumableCode:n,ConsumableName:i,Brand:r,Spec:s,Model:c,TotalAvailableStock:d,Unit:u,Batch:m})=>(e.openBlock(),e.createBlock(h,{key:l},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"asset-dialog-list"},[e.createElementVNode("view",{class:"list-item"},[e.createElementVNode("text",{class:"list-item-column-title"},e.toDisplayString(i),1),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"分类："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"批次："+e.toDisplayString(m),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"可用库存："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"计量单位："+e.toDisplayString(u),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"take-delivery-checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,l)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:t.checked},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createVNode(f,{class:"inputDialog"},{default:e.withCtx((()=>[e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ConsumableName),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Brand),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Spec),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Model),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"可用库存：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.TotalAvailableStock),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"参考成本：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ReferenceCost),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"参考成本金额：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(Math.floor(o.rowDetail.Qty*o.rowDetail.ReferenceCost*100)/100),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"报废数量：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createVNode(m,{border:!1,maxlength:"10",type:"number",modelValue:o.rowDetail.Qty,"onUpdate:modelValue":l[6]||(l[6]=e=>o.rowDetail.Qty=e),placeholder:"请输入报废数量"},null,8,["modelValue"]),e.createElementVNode("text",{class:"checka"},"*")])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createVNode(m,{border:!1,maxlength:"99",type:"text",modelValue:o.rowDetail.Remark,"onUpdate:modelValue":l[7]||(l[7]=e=>o.rowDetail.Remark=e),placeholder:"请输入备注"},null,8,["modelValue"])])])),_:1})])),_:1})])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose",mode:"input",title:"选择易耗品库存",value:o.searchCodeVal,placeholder:"编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"request-draw-fab"},[e.createVNode(g,{ref:"fab",pattern:o.fabPattern,content:o.fabContent,horizontal:"right",vertical:"bottom",direction:"horizontal",onTrigger:o.fabTrigger},null,8,["pattern","content","onTrigger"])])),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"uni_list"},[e.createVNode(f,null,{default:e.withCtx((()=>[e.createVNode(h,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"info-item-text",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view")]))])),_:1}),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"仓库：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.warehouse.Name?"info-item-color":""]),onClick:l[8]||(l[8]=e=>o.nonEditable?null:o.openFromWarehouseSelector())},e.toDisplayString(o.bill.warehouse.Name?o.bill.warehouse.Name:"请选择调出仓库"),3)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.warehouse.ID?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[9]||(l[9]=e=>o.removeInput("warehouse")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"报废日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("picker",{mode:"date",onChange:l[10]||(l[10]=(...e)=>o.discardDateTimeChange&&o.discardDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.discardDate?"info-item-color":""])},e.toDisplayString(o.bill.discardDate?o.bill.discardDate:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.discardDate?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[11]||(l[11]=e=>o.removeInput("discardDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.handledPerson.ID?"info-item-color":""]),onClick:l[12]||(l[12]=e=>o.nonEditable?null:o.openPersonSelector())},e.toDisplayString(o.bill.handledPerson.ID?o.bill.handledPerson.Name:"请选择人员"),3)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.handledPerson.ID?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[13]||(l[13]=e=>o.removeInput("handledPerson")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"备注：")])])),body:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-input",style:{"font-size":"14px",width:"100%","text-align":"right"},disabled:null==o.nonEditable,placeholder:"请输入备注信息","onUpdate:modelValue":l[14]||(l[14]=e=>o.bill.remark=e)},null,8,["disabled"]),[[e.vModelText,o.bill.remark]])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[15]||(l[15]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill-list-request-draw",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),"scroll-y":"",onScroll:l[17]||(l[17]=e=>o.toIndex=""),"scroll-into-view":o.toIndex},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(C,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"Statistics"}," 总数量:"+e.toDisplayString(o.totalQuantity())+" 总金额:"+e.toDisplayString(o.totalAmount()),1),e.createElementVNode("view",{class:"bill-detail-request-draw"},[e.createVNode(N,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(w,{disabled:o.nonEditable,"right-options":o.deleteOperationBtn,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.index,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createVNode(h,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item",onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("text",{class:"list-item-title",selectable:""},"资产名称："+e.toDisplayString(t.ConsumableName),1),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"分类："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(t.ConsumableCode),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(t.Brand),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"可用库存："+e.toDisplayString(t.TotalAvailableStock),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"参考成本："+e.toDisplayString(t.ReferenceCost),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"参考成本金额："+e.toDisplayString(t.ReferenceCostAmount),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"计量单位："+e.toDisplayString(t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"报废数量："+e.toDisplayString(t.Qty),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])])),_:2},1024)])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1})])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(C,{title:"附件",type:"line"},{default:e.withCtx((()=>[o.isfiles?(e.openBlock(),e.createBlock(E,{key:0,ref:"filePicker",limit:9,disabled:o.nonEditable,"del-icon":!o.nonEditable,"file-mediatype":"all","file-extname":o.fileExtType.all,mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[16]||(l[16]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:t.deletefile,title:"最多选择9个附件"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"unload-attachment"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,type:"primary"},"上传附件"))])])),_:1},8,["disabled","del-icon","file-extname","modelValue","onSelect","onDelete"])):e.createCommentVNode("",!0)])),_:1})],44,["scroll-into-view"]),o.nonEditable?(e.openBlock(),e.createElementBlock("view",{key:1,class:"toIndex"},[e.createElementVNode("view",{onClick:l[18]||(l[18]=e=>o.toIndex="listDetail")},[e.createVNode(y,{type:"arrow-up",color:"#fff",size:"30"}),e.createElementVNode("br")]),e.createElementVNode("view",{onClick:l[19]||(l[19]=e=>o.toIndex="example")},[e.createVNode(y,{type:"arrow-down",color:"#fff",size:"30"}),e.createElementVNode("br")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"bill-footer-request-draw"},[e.createElementVNode("view",{class:"bill_list"},[o.type?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("image",{key:0,src:"/static/icon/bill_list.png",alt:"",onClick:l[20]||(l[20]=(...e)=>o.jumpList&&o.jumpList(...e))}))]),e.createElementVNode("view",null,[1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:l[21]||(l[21]=e=>o.handleSaveDraft(0))},[e.createElementVNode("text",{class:"text-overflow"},"保存草稿")])):e.createCommentVNode("",!0),1==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:l[22]||(l[22]=(...e)=>o.billDelete&&o.billDelete(...e))},[e.createElementVNode("text",{class:"uni-icon-delete text-overflow"},"删除草稿")])):e.createCommentVNode("",!0),1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:2,onClick:l[23]||(l[23]=e=>o.handleSaveDraft(1)),type:"primary",class:"uni-icon-submit"},[e.createElementVNode("text",{class:"text-overflow",style:{color:"#fff"}},"提交")])):e.createCommentVNode("",!0),o.bill.IsApproval?(e.openBlock(),e.createElementBlock("button",{key:3,onClick:l[24]||(l[24]=(...e)=>o.approvalShow&&o.approvalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"},"审批")])):e.createCommentVNode("",!0),o.bill.IsStart&&o.bill.startFlow?(e.openBlock(),e.createElementBlock("button",{key:4,onClick:l[25]||(l[25]=(...e)=>o.enablingApprovalShow&&o.enablingApprovalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"}," 启动审批流 ")])):e.createCommentVNode("",!0),o.bill.FlowPath?(e.openBlock(),e.createElementBlock("button",{key:5,onClick:l[26]||(l[26]=(...e)=>o.processTrack&&o.processTrack(...e))},[e.createElementVNode("text",{class:"text-overflow"},"流程轨迹")])):e.createCommentVNode("",!0),7==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:6,onClick:l[27]||(l[27]=(...e)=>o.sign&&o.sign(...e))},[e.createElementVNode("text",null,"签字")])):e.createCommentVNode("",!0)])])],64)}],["__scopeId","data-v-0a37e26e"]]);var qc=()=>{const{Data:t,BillType:l,Condition:a}={Data:e.ref({IsSetNumber:!0,QST:"",WarehouseOrCorpIDs:[],BillCode:"",DiscardEndDate:"",DiscardStartDate:"",ConsumableCategoryIDs:[],HandlerEmployeeIDs:[],HandlerOrgIDs:[],ConsumableCode:"",ListMode:2,Sort:2,PageSize:20,PageNO:1,BillStatus:0}),BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],Condition:e.ref({WarehouseOrCorp:[],Person:[]})};function o(e){switch(e){case"WarehouseOrCorp":t.value.WarehouseOrCorpIDs=[],a.value.WarehouseOrCorp=[];break;case"BillCode":t.value.BillCode="";break;case"DiscardStartDate":t.value.DiscardStartDate="";break;case"DiscardEndDate":t.value.DiscardEndDate="";break;case"Person":a.value.Person=[],t.value.HandlerEmployeeIDs=[]}}return{Data:t,query:function(){Xe(lt.consumableAllocateConditionBack,t.value),S()},BillType:l,bindPickerChange:function(e){let a=l.findIndex(((t,l,a)=>t.value==e.detail.value));t.value.BillStatus=a},getWarehouseOrCorpText:function(){return a.value.WarehouseOrCorp.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getWarehouseOrCorpIDs:function(){uni.navigateTo({url:`/pages/selector/consumable/warehouse?ids=${t.value.HandlerOrgIDs}&multiple=1`}),tt(lt.consumableWarehouseBack,(e=>{let l=e.items.map((e=>({Name:e.label,ID:e.id})));a.value.WarehouseOrCorp=l,t.value.WarehouseOrCorpIDs=l.map((e=>e.ID))}))},bindDiscardStartDatePickerChange:function(e){t.value.DiscardStartDate=e.detail.value},bindDiscardEndDatePickerChange:function(e){t.value.DiscardEndDate=e.detail.value},clearInputText:o,reset:function(){t.value.BillStatus=0,o("WarehouseOrCorp"),o("BillCode"),o("DiscardStartDate"),o("DiscardEndDate"),o("Person")},getPersonText:function(){return a.value.Person.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getPersonIDs:function(){tt(lt.employeeSelectBack,(e=>{let l=e.items.map((e=>({Name:e.Name,ID:e.ID})));i("log","at subcontract/consumable/discard/condition/index.js:45",e),a.value.Person=l,t.value.HandlerEmployeeIDs=l.map((e=>e.ID))})),uni.navigateTo({url:`/pages/selector/system/employee?multiple=1&ids=${t.value.HandlerEmployeeIDs}`})}}};var zc=l({props:{id:String,type:String},setup({id:e,type:t}){const{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindDiscardStartDatePickerChange:c,bindDiscardEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v}=qc();return{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindDiscardStartDatePickerChange:c,bindDiscardEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"screen"},[e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 单据状态： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{onChange:l[0]||(l[0]=(...e)=>o.bindPickerChange&&o.bindPickerChange(...e)),value:o.BillType[o.Data.BillStatus].value,range:o.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(o.BillType[o.Data.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"right"})]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 仓库： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择仓库",value:o.getWarehouseOrCorpText(),onClick:l[1]||(l[1]=(...e)=>o.getWarehouseOrCorpIDs&&o.getWarehouseOrCorpIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getWarehouseOrCorpText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[2]||(l[2]=e=>o.clearInputText("WarehouseOrCorp"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 经办人： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择经办人",value:o.getPersonText(),onClick:l[3]||(l[3]=(...e)=>o.getPersonIDs&&o.getPersonIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getPersonText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[4]||(l[4]=e=>o.clearInputText("Person"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 报废单号： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请输入调拨单号","onUpdate:modelValue":l[5]||(l[5]=e=>o.Data.BillCode=e)},null,512),[[e.vModelText,o.Data.BillCode]])]),e.createElementVNode("view",{class:"right"},[o.Data.BillCode?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[6]||(l[6]=e=>o.clearInputText("BillCode"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 报废日期起： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[7]||(l[7]=(...e)=>o.bindDiscardStartDatePickerChange&&o.bindDiscardStartDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.DiscardStartDate?o.Data.DiscardStartDate:"调拨日期起"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.DiscardStartDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[8]||(l[8]=e=>o.clearInputText("DiscardStartDate"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 报废日期止： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[9]||(l[9]=(...e)=>o.bindDiscardEndDatePickerChange&&o.bindDiscardEndDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.DiscardEndDate?o.Data.DiscardEndDate:"调拨日期止"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.DiscardEndDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[10]||(l[10]=e=>o.clearInputText("DiscardEndDate"))})):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"button_list"},[e.createElementVNode("button",{class:"button_item reset",onClick:l[11]||(l[11]=(...e)=>o.reset&&o.reset(...e))},"重置"),e.createElementVNode("button",{class:"button_item query",onClick:l[12]||(l[12]=(...e)=>o.query&&o.query(...e))},"查询")])])}],["__scopeId","data-v-5b63032e"]]);var Uc=new class extends Je{getInventoryList(e){return this.request("/Inventory/Bill/List",e)}getByID(e){return this.request("/Inventory/Bill/GetById",e)}getDetailIDByCode(e){return this.request("/Inventory/Bill/GetDetailIDByCode",e)}getDetailByID(e){return this.request("/Inventory/Bill/GetDetailByID",e)}appletSave(e){return this.request("/Inventory/Bill/AppletSave",e)}};const Mc={data:()=>({state:"",items:["全部","正常","盘盈","盘亏"],IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{Summary:0},data:[],pageCount:0,range:"",warehouseName:"",total:0,fabPattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#007AFF",iconColor:"#fff"},fabContent:[{iconPath:"/static/icon/sys.png",selectedIconPath:"/static/icon/sys.png",text:"扫码",active:!1},{iconPath:"/static/icon/edit.png",selectedIconPath:"/static/icon/edit.png",text:"检索",active:!1}],searchCodeVal:""}),methods:{inventoryConfirm(e){tt(lt.refreshBack,(()=>{this.condition.PageNO=1,this.load()})),uni.navigateTo({url:`/subcontract/consumable/inventory/inventoryConfirm?TaskID=${this.condition.Id}&ID=${e}`})},scan(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{this.dialogsearchCodeValConfirm(e)}})},fabTrigger({index:e}){switch(e){case 0:this.scan();break;case 1:this.searchCodeVal="",this.$refs.scanCodeDialog.open()}this.$refs.fab.close()},dialogsearchCodeValConfirm(e){const t=e.trim();""!=t&&null!=t&&null!=t?(i("log","at subcontract/consumable/inventory/taskDetail.vue:164",t),Uc.getDetailIDByCode({Code:t,ID:this.condition.Id}).then((e=>{null!=e?uni.navigateTo({url:`/subcontract/consumable/inventory/inventoryConfirm?TaskID=${this.condition.Id}&ID=${e}`}):F("当前盘点任务不存在此易耗品")}))):F("无效的检索条件")},fabClick(){},onClickItem(e){this.condition.Summary!==e.currentIndex&&(this.condition.Summary=e.currentIndex,this.condition.PageNO=1,this.load())},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;e.condition.QST=getScanCode(l),e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),Uc.getByID(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.range=l.Range,this.warehouseName=l.WarehouseName,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){tt(lt.conditionBack,(e=>{this.condition=e,this.load()})),uni.navigateTo({url:"/subcontract/consumable/inventory/condition"})}},computed:{},mounted(){let e=getCurrentPages(),t=e[e.length-1].options;uni.setNavigationBarTitle({title:t.title}),this.state=t.Status,this.condition.Id=t.taskID,this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var Wc=l(Mc,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-segmented-control"),Es),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl),u=r(e.resolveDynamicComponent("uni-fab"),ul);return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"uni-padding-wrap uni-common-mt",style:{padding:"0px 10px"}},[e.createVNode(s,{current:n.condition.Summary,values:n.items,onClickItem:i.onClickItem},null,8,["current","values","onClickItem"])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"inventory_detail"},[e.createElementVNode("view",null,[e.createElementVNode("text",{style:{"font-weight":"600"}},"仓库:"),e.createTextVNode(e.toDisplayString(n.warehouseName),1)]),e.createElementVNode("view",null,[e.createElementVNode("text",{style:{"font-weight":"600"}},"范围:"),e.createTextVNode(" "+e.toDisplayString(n.range),1)])]),e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1",overflow:"hidden"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[0]||(l[0]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[1]||(l[1]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[2]||(l[2]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[3]||(l[3]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[4]||(l[4]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:()=>{2==this.state&&i.inventoryConfirm(t.ID)}},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}}," 易耗品编码："+e.toDisplayString(t.ConsumableCode),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"易耗品分类："+e.toDisplayString(t.ConsumableCategoryName),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"易耗品名称："+e.toDisplayString(t.ConsumableName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null," 商品码："+e.toDisplayString(t.WarehouseName),1),e.createElementVNode("text",null," 品牌："+e.toDisplayString(t.Brand),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"规格 ："+e.toDisplayString(t.Spec),1),e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"库存数量："+e.toDisplayString(t.Stock),1),e.createElementVNode("text",null,"实盘数："+e.toDisplayString(t.RealStock),1)]),e.createElementVNode("view",{class:"list-item-column",style:e.normalizeStyle(0!=t.Difference?"color:red":"")},[e.createElementVNode("text",null,"亏盈数量："+e.toDisplayString(t.Difference),1)],4),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"计量单位："+e.toDisplayString(t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)]),1!=t.Status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tips"},[e.createElementVNode("view",{class:"right"},[e.createElementVNode("image",{src:"/static/icon/right_arrow_3.png"})])])):e.createCommentVNode("",!0)],8,["onClick"])))),128))])],40,["refresher-triggered"]),e.createVNode(d,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose",mode:"input",title:"选择易耗品库存",value:n.searchCodeVal,placeholder:"编码/名称",onConfirm:i.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(u,{ref:"fab",pattern:n.fabPattern,content:n.fabContent,horizontal:"right",vertical:"bottom",direction:"horizontal",onTrigger:i.fabTrigger,onFabClick:i.fabClick},null,8,["pattern","content","onTrigger","onFabClick"])])}],["__scopeId","data-v-46d5844d"]]);const $c={data:()=>({TaskID:"",Batch:"",Brand:"",ConsumableCategoryName:"",ConsumableCode:"",ConsumableBarcode:"",ConsumableName:"",Difference:"",ID:"",Model:"",RealStock:"",Remark:"",Spec:"",Stock:"",Unit:"",ConsumableID:"",StockID:""}),methods:{save(){Uc.appletSave({ID:this.TaskID,Items:[{ID:this.ID,Remark:this.Remark,RealStock:this.RealStock,DifferenceQty:this.DifferenceQty}]}).then((e=>{Xe(lt.refreshBack),S()}))}},computed:{GetDifference(){return this.RealStock-this.Stock}},mounted(){let e=getCurrentPages(),t=e[e.length-1].options;var l=t.ID;this.TaskID=t.TaskID,Uc.getDetailByID({ID:l}).then((e=>{this.Batch=e.Batch,this.Brand=e.Brand,this.ConsumableCategoryName=e.ConsumableCategoryName,this.ConsumableCode=e.ConsumableCode,this.ConsumableBarcode=e.ConsumableBarcode,this.ConsumableName=e.ConsumableName,this.Difference=e.Difference,this.ID=e.ID,this.Model=e.Model,this.RealStock=e.RealStock,this.Remark=e.Remark,this.Spec=e.Spec,this.Stock=e.Stock,this.Unit=e.Unit,this.ConsumableID=e.ConsumableID,this.StockID=e.StockID}))},watch:{RealStock(){this.Difference=this.Stock-this.RealStock}}};var Qc=l($c,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"screen"},[e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 易耗品编码： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[0]||(l[0]=e=>n.ConsumableCode=e)},null,512),[[e.vModelText,n.ConsumableCode]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 易耗品分类： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[1]||(l[1]=e=>n.ConsumableCategoryName=e)},null,512),[[e.vModelText,n.ConsumableCategoryName]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 易耗品名称： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[2]||(l[2]=e=>n.ConsumableName=e)},null,512),[[e.vModelText,n.ConsumableName]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 商品码： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[3]||(l[3]=e=>t.WarehouseName=e)},null,512),[[e.vModelText,t.WarehouseName]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 品牌： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[4]||(l[4]=e=>n.Brand=e)},null,512),[[e.vModelText,n.Brand]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 规格： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[5]||(l[5]=e=>n.Spec=e)},null,512),[[e.vModelText,n.Spec]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 型号： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[6]||(l[6]=e=>n.Model=e)},null,512),[[e.vModelText,n.Model]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 库存数量： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[7]||(l[7]=e=>n.Stock=e)},null,512),[[e.vModelText,n.Stock]])])]),e.createElementVNode("view",{class:"condition_item_selector",style:{"padding-top":"10px"}},[e.createElementVNode("view",{class:"left"}," 实盘数： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"","onUpdate:modelValue":l[8]||(l[8]=e=>n.RealStock=e),style:{border:"1px solid #dcdee2",padding:"3px 10px","border-radius":"4px",color:"#515a6e"}},null,512),[[e.vModelText,n.RealStock]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 亏盈数量： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[9]||(l[9]=e=>i.GetDifference=e),style:e.normalizeStyle(0!=i.GetDifference?"color:red":"")},null,4),[[e.vModelText,i.GetDifference]])])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 计量单位： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",disabled:"","onUpdate:modelValue":l[10]||(l[10]=e=>n.Unit=e)},null,512),[[e.vModelText,n.Unit]])])]),e.createElementVNode("view",{class:"condition_item_selector",style:{"padding-top":"10px"}},[e.createElementVNode("view",{class:"left"}," 备注： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input","onUpdate:modelValue":l[11]||(l[11]=e=>n.Remark=e),style:{border:"1px solid #dcdee2",padding:"3px 10px","border-radius":"4px",color:"#515a6e"}},null,512),[[e.vModelText,n.Remark]])])])]),e.createElementVNode("view",{class:"button_list"},[e.createElementVNode("button",{class:"button_item query",onClick:l[12]||(l[12]=(...e)=>i.save&&i.save(...e))},"保存")])])}],["__scopeId","data-v-04057d78"]]);const jc={data:()=>({BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{IsSetNumber:!0,QST:"",WarehouseOrCorpIDs:[],BillCode:"",DiscardEndDate:"",DiscardStartDate:"",ConsumableCategoryIDs:[],HandlerEmployeeIDs:[],HandlerOrgIDs:[],ConsumableCode:"",ListMode:2,Sort:2,PageSize:20,PageNO:1,BillStatus:0},data:[],pageCount:0,total:0}),methods:{timeConvertDate:Ql,bindPickerChange(e){let t=this.BillType.findIndex(((t,l,a)=>t.value==e.detail.value));this.condition.BillStatus=t,this.load()},editBill(e){Xe(lt.consumableAllocateEditBill,e),S()},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;"http://"==l.substring(0,7).toLowerCase()||"https://"==l.substring(0,8).toLowerCase()?e.condition.QST=ruleShow(l):e.condition.QST=l,e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),Rc.QueryDiscardBill(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){tt(lt.consumableAllocateConditionBack,(e=>{this.condition=e,this.condition.PageSize=10,this.condition.PageNO=1,this.load()})),uni.navigateTo({url:"/subcontract/consumable/discard/condition/condition"})}},computed:{},mounted(){this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var Hc=l(jc,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"seach_condition",onClick:l[0]||(l[0]=(...e)=>i.SettingCondition&&i.SettingCondition(...e))},[e.createElementVNode("view",{class:"icon_condition"},[e.createElementVNode("image",{src:"/static/icon/condition.png",style:{width:"26px",height:"26px"}})])]),e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"单号","onUpdate:modelValue":l[1]||(l[1]=e=>this.condition.BillCode=e),"confirm-type":"search",onConfirm:l[2]||(l[2]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.BillCode]])]),e.createElementVNode("view",{class:"QC"},[e.createElementVNode("view",{class:"icon-saoma"},[e.createElementVNode("image",{src:"/static/saoma.png",style:{width:"30px",height:"30px"},onClick:l[3]||(l[3]=(...e)=>i.ScanCode&&i.ScanCode(...e))})])])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"billStatus"},[e.createElementVNode("picker",{onChange:l[4]||(l[4]=(...e)=>i.bindPickerChange&&i.bindPickerChange(...e)),value:n.BillType[n.condition.BillStatus].value,range:n.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(n.BillType[n.condition.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1",overflow:"hidden"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[5]||(l[5]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[6]||(l[6]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[7]||(l[7]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[8]||(l[8]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[9]||(l[9]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:e=>i.editBill(t.ID)},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillerEmployeeName)+"提交的易耗品报废单",1),e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillDateTime),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"单号："+e.toDisplayString(t.BillCode),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#007aff"}},"单据状态："+e.toDisplayString(t.StatusText),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"调出仓库："+e.toDisplayString(t.WarehouseName),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"报废日期："+e.toDisplayString(i.timeConvertDate(t.DiscardDate)),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"经办人："+e.toDisplayString(t.HandlerEmployeeName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"金额："+e.toDisplayString(t.TotalReferenceCostAmountText),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])))),128))])],40,["refresher-triggered"])])}],["__scopeId","data-v-0637b2da"]]);var Kc=l({data:()=>({IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{Sort:2,HandlerEmployeeIDs:[],BillCode:"",HandlerOrgIDs:null,InventoryEndDate:"",InventoryStartDate:"",PageNO:1,PageSize:20,QST:"",Title:"",IsSetNumber:!0},data:[],pageCount:0,total:0}),methods:{Jump(e,t,l){uni.navigateTo({url:`/subcontract/consumable/inventory/taskDetail?taskID=${e}&title=${t}&Status=${l}`})},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;e.condition.QST=getScanCode(l),e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),Uc.getInventoryList(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){tt(lt.conditionBack,(e=>{this.condition=e,this.load()})),uni.navigateTo({url:"/subcontract/consumable/inventory/condition"})}},computed:{},mounted(){this.condition.PageSize=10,this.condition.PageNO=1,this.load()}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"seach_condition",onClick:l[0]||(l[0]=(...e)=>i.SettingCondition&&i.SettingCondition(...e))},[e.createElementVNode("view",{class:"icon_condition"},[e.createElementVNode("image",{src:"/static/icon/condition.png",style:{width:"26px",height:"26px"}})])]),e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"盘点单号/主题","onUpdate:modelValue":l[1]||(l[1]=e=>this.condition.QST=e),"confirm-type":"search",onConfirm:l[2]||(l[2]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.QST]])])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[3]||(l[3]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[4]||(l[4]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[5]||(l[5]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[6]||(l[6]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[7]||(l[7]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:()=>{1!=t.Status&&i.Jump(t.ID,t.Title,t.Status)}},[e.createElementVNode("view",{class:e.normalizeClass(["Status",1==t.Status?"Draft":2==t.Status?"Waiting":"Completed"])},e.toDisplayString(t.StatusText),3),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000","font-size":"14px"}},"主题："+e.toDisplayString(t.Title),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"盘点单号："+e.toDisplayString(t.BillCode),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"盘点日期："+e.toDisplayString(t.InventoryDate.substring(0,10)),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"仓库："+e.toDisplayString(t.WarehouseName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"库存数量："+e.toDisplayString(t.TotalStock),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"实盘数量 ："+e.toDisplayString(t.TotalRealStock),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"亏盈数量："+e.toDisplayString(t.Difference),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"经办部门："+e.toDisplayString(t.HandlerOrgName),1)]),1!=t.Status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tips"},[e.createElementVNode("view",{class:"right"},[e.createElementVNode("image",{src:"/static/icon/right_arrow_3.png"})])])):e.createCommentVNode("",!0)],8,["onClick"])))),128))])],40,["refresher-triggered"])])}],["__scopeId","data-v-0cb95221"]]);const Gc={data:()=>({Data:{Sort:2,HandlerEmployeeIDs:[],BillCode:"",HandlerOrgIDs:null,InventoryEndDate:"",InventoryStartDate:"",PageNO:1,PageSize:10,QST:"",Title:"",IsSetNumber:!0},Person:[]}),methods:{bindInventoryStartDatePickerChange(e){this.Data.InventoryStartDate=e.detail.value},bindInventoryEndDatePickerChange(e){this.Data.InventoryEndDate=e.detail.value},clearInputText(e){switch(e){case"BillCode":this.Data.BillCode="";break;case"Person":this.Person=[],this.Data.HandlerEmployeeIDs=[];break;case"InventoryStartDate":this.Data.InventoryStartDate="";break;case"InventoryEndDate":this.Data.InventoryEndDate="";break;case"Title":this.Data.Title="";break;default:this.Data.BillCode="",this.Person=[],this.Data.HandlerEmployeeIDs=[],this.Data.InventoryStartDate="",this.Data.InventoryEndDate="",this.Data.Title=""}},getPersonIDs(){tt(lt.employeeSelectBack,(e=>{let t=e.items.map((e=>({Name:e.Name,ID:e.ID})));this.Person=t,this.Data.HandlerEmployeeIDs=t.map((e=>e.ID))})),uni.navigateTo({url:`/pages/selector/system/employee?multiple=1&ids=${this.Data.HandlerEmployeeIDs}`})},reset(){this.clearInputText()},query(){Xe(lt.conditionBack,this.Data),S()},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;e.QST=R(l)},fail(){F("扫描失败，请稍后重试")}})}},computed:{getPersonText(){return this.Person.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")}}};var Jc=l(Gc,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"screen"},[e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 盘点单号： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请输入入库单号","onUpdate:modelValue":l[0]||(l[0]=e=>n.Data.BillCode=e)},null,512),[[e.vModelText,n.Data.BillCode]])]),e.createElementVNode("view",{class:"right"},[n.Data.BillCode?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[1]||(l[1]=e=>i.clearInputText("BillCode"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 主题： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请输入主题","onUpdate:modelValue":l[2]||(l[2]=e=>n.Data.Title=e)},null,512),[[e.vModelText,n.Data.Title]])]),e.createElementVNode("view",{class:"right"},[n.Data.Title?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[3]||(l[3]=e=>i.clearInputText("Title"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 经办人员： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择领用人员",value:i.getPersonText,onClick:l[4]||(l[4]=(...e)=>i.getPersonIDs&&i.getPersonIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[i.getPersonText?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[5]||(l[5]=e=>i.clearInputText("Person"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 出库日期起： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[6]||(l[6]=(...e)=>i.bindInventoryStartDatePickerChange&&i.bindInventoryStartDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(n.Data.InventoryStartDate?n.Data.InventoryStartDate:"入库日期起"),1)],32)]),e.createElementVNode("view",{class:"right"},[n.Data.InventoryStartDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[7]||(l[7]=e=>i.clearInputText("InventoryStartDate"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 出库日期止： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[8]||(l[8]=(...e)=>i.bindInventoryEndDatePickerChange&&i.bindInventoryEndDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(n.Data.InventoryEndDate?n.Data.InventoryEndDate:"入库日期止"),1)],32)]),e.createElementVNode("view",{class:"right"},[n.Data.InventoryEndDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[9]||(l[9]=e=>i.clearInputText("InventoryEndDate"))})):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"button_list"},[e.createElementVNode("button",{class:"button_item reset",onClick:l[10]||(l[10]=(...e)=>i.reset&&i.reset(...e))},"重置"),e.createElementVNode("button",{class:"button_item query",onClick:l[11]||(l[11]=(...e)=>i.query&&i.query(...e))},"查询")])])}],["__scopeId","data-v-581a8764"]]);var Yc=new class extends Je{constructor(){super("InWarehouse")}QueryInWarehouseBill(e){return this.request("/Bill/InWarehouse/List",e)}GetOrderList(e){return this.request("/Bill/PurchasingOrder/Selector/Query",e)}SaveDraft(e){return this.request("/Bill/InWarehouse/SaveDraft",e)}GetByID(e){return this.request("/Bill/InWarehouse/GetByID",e)}Delete(e){return this.request("/Bill/InWarehouse/Delete",{ID:e})}PreStartFlow(e){return this.preStartFlow(e)}StartFlow(e){return this.startFlow(e)}PrevApproval(e){return this.prevApproval(e)}SubmitApproval(e){return this.submitApproval(e)}GetFlowTrail(e){return this.getFlowTrail(e)}},Zc=()=>{const{bill:t,rowDetail:l,remarkVal:a,deleteOperationBtn:o,billDetail:n,applyReasonOption:r,fab:s,fabPattern:c,fabContent:d,scanCodeDialog:u,searchCodeVal:m,serachGoodsList:p,goodsDialog:v,isOpened:f,inputDialog:g,editInfoTitle:y,inputRemarkDialog:w,detailIndex:N,deleteDialog:C,approveDialog:E,submitMsgType:b,submitDialog:V,approveStartUpDialog:x,approverOption:_,approvalProcessData:I,processTrackDialog:B,processTrackCurrent:T,processTrackApprovalLog:P,processTrackApprovalTask:O,windowHeights:R,nonEditable:U,IsEnableBatch:M,IsAutoBatchNumber:W,isfiles:$,files:Q,toIndex:j}=(()=>{const t=e.ref([]),l=e.ref(!0),a=e.ref("");let o=h("ConsumableDicSettings"),n=o.filter((e=>{if("IsEnableBatch"==e.Key)return e}))[0],r=o.filter((e=>{if("IsAutoBatchNumber"==e.Key)return e}))[0];i("log","at subcontract/consumable/inwarehouse/detail/metadata.js:27",n);const s="true"===n.Value.toLowerCase(),c="true"===r.Value.toLowerCase(),d=e.ref({id:null,status:null,isSubmit:null,currentInWarehouseType:null,code:"",warehouse:{ID:"",Name:"",OID:""},corpID:"",inWarehouseDate:"",supplierID:"",supplierName:"",handlerOrgID:"",handlerOrgNameCN:"",handlerOrgNameEN:"",handlerEmployeeID:"",handlerEmployeeName:"",remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),u=e.ref({ConsumableName:"",Brand:"",Spec:"",Model:"",Qty:1,TotalAvailableStock:0}),m=e.ref(""),p=e.ref([]),v=e.ref([]),f=e.ref([]);return f.value=[{text:"取消",style:{backgroundColor:"#007aff"}},{text:"删除",style:{backgroundColor:"#F56C6C"}}],{bill:d,rowDetail:u,remarkVal:m,deleteOperationBtn:f,billDetail:v,applyReasonOption:p,fab:e.ref(null),fabPattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#007AFF",iconColor:"#fff"},fabContent:[{iconPath:"/static/icon/sys.png",selectedIconPath:"/static/icon/sys.png",text:"扫码",active:!1},{iconPath:"/static/icon/edit.png",selectedIconPath:"/static/icon/edit.png",text:"检索",active:!1},{iconPath:"/static/icon/asset_mingxi.png",selectedIconPath:"/static/icon/asset_mingxi.png",text:"明细",active:!1},{iconPath:"/static/icon/asset_fujian.png",selectedIconPath:"/static/icon/asset_fujian.png",text:"附件",active:!1}],scanCodeDialog:e.ref(null),searchCodeVal:e.ref(""),serachGoodsList:e.ref([]),goodsDialog:e.ref(null),isOpened:e.ref("none"),inputDialog:e.ref(null),editInfoTitle:e.ref(""),inputRemarkDialog:e.ref(null),detailIndex:e.ref(null),deleteDialog:e.ref(null),approveDialog:e.ref(null),submitMsgType:e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),submitDialog:e.ref(null),approveStartUpDialog:e.ref(null),approverOption:e.ref([]),approvalProcessData:e.ref({activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}),processTrackDialog:e.ref(null),processTrackCurrent:e.ref(0),processTrackApprovalLog:e.ref([]),processTrackApprovalTask:e.ref([]),windowHeights:e.ref(""),nonEditable:e.ref(!1),IsEnableBatch:s,IsAutoBatchNumber:c,isfiles:l,files:t,toIndex:a}})();function H(e){q(),Ye.getConsumable({QST:e}).then((({Items:e})=>{p.value=e.map((e=>(e.checked=!1,e))),p.value.length<1?F("未查询到可用资产资料"):v.value.open()})).finally((()=>z()))}function K(e){y.value=e?"新增":"编辑",g.value.open()}function G(){l.value.ConsumableName="",l.value.ConsumableCode="",l.value.WaitingInWarehouseQty="",l.value.BillCode="",l.value.Spec="",l.value.Qty="",l.value.Amount="",l.value.Price="",l.value.Batch="",l.value.CategoryName="",N.value=null,g.value.close()}function J(){V.value.close()}function Y(){let e={};e.ID=t.value.id,e.AddOrEdit=t.value.id?2:1,e.IsSubmit=!!t.value.isSubmit,e.ID=t.value.id,e.AddOrEdit=t.value.id?2:1,e.IsSubmit=!!t.value.isSubmit,e.HandlerEmployeeID=t.value.handlerEmployeeID,e.HandlerEmployeeName=t.value.handlerEmployeeName,e.HandlerOrgID=t.value.handlerOrgID,e.HandlerOrgNameCN=t.value.handlerOrgNameCN,e.HandlerOrgNameEN=t.value.handlerOrgNameEN,e.InWarehouseDate=t.value.inWarehouseDate,e.InWarehouseType=t.value.currentInWarehouseType,e.SupplierID=t.value.supplierID,e.SupplierName=t.value.supplierName,e.WarehouseID=t.value.warehouse.OID,e.Remark=t.value.remark,e.Attachments=Q.value.map(((e,t)=>(e.Sequence=t+1,e))),1==t.value.currentInWarehouseType?e.Details=n.value.map(((e,t)=>{let l={};return l.ID=e.ID,l.Batch=e.Batch,l.Brand=e.Brand,l.CategoryName=e.CategoryName,l.Code=e.Code,l.ConsumableID=e.ConsumableID,l.ConsumableName=e.ConsumableName,l.IsEnableBatch=M,l.Spec=e.Spec,l.Price=e.Price,l.Model=e.Model,l.Unit=e.Unit,l.Qty=e.Qty,l.Remark=e.Remark,l.Amount=e.Amount,l.Sequence=t+1,l})):2==t.value.currentInWarehouseType&&(e.Details=n.value),q(),Yc.SaveDraft(e).then((e=>{Z(e.ID).then((()=>{t.value.IsStart&&ae()})),J()})).finally((()=>z()))}function Z(e){return q(),Yc.GetByID({ID:e}).then((({ID:e,Status:l,Code:a,Remark:o,InWarehouseType:i,CorpID:r,InStockDate:s,SupplierID:c,SupplierName:d,HandlerOrgID:u,HandlerOrgNameCN:m,HandlerOrgNameEN:p,HandlerEmployeeID:v,HandlerEmployeeName:h,WarehouseID:f,WarehouseName:g,Details:y,FlowInfo:w,Attachments:N})=>{t.value.id=e,t.value.status=l,t.value.code=a,t.value.remark=o,t.value.currentInWarehouseType=i,t.value.corpID=r,t.value.inWarehouseDate=Ql(s),t.value.supplierID=c,t.value.supplierName=d,t.value.handlerOrgID=u,t.value.handlerOrgNameCN=m,t.value.handlerOrgNameEN=p,t.value.handlerEmployeeID=v,t.value.handlerEmployeeName=h,t.value.warehouse.OID=f,t.value.warehouse.ID=f,t.value.warehouse.Name=g,Q.value=N.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),n.value=y.map((e=>(e.Code=e.ConsumableCode,e))),U.value=1!=t.value.status&&null!=t.value.status,t.value.IsApproval=w.IsApproval,t.value.IsStart=1!=l&&!w.IsStart&&w.IsEnabledFlow,t.value.FlowPath=1!=l&&w.IsStart&&w.IsEnabledFlow||w.IsSendBack})).finally((()=>z()))}let X=e.computed((()=>{let e=0;for(let t=0;t<n.value.length;t++)e+=parseInt(n.value[t].qty);return e}));function ee(){I.value={activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}}function te(){q();const e={ID:t.value.id,IsPass:I.value.approvalType,Remark:I.value.remark,SupportedStrategies:I.value.refuseType,IsAdditionalApproval:!1,AdditionalApprovalEmployeeId:null,ActivityName:I.value.activityName,ActivityID:I.value.activityID,ActivityType:I.value.activityType,NextActivityName:I.value.nextActivityName,NextActivityID:I.value.nextActivityID,NextActivityType:I.value.nextActivityType,CandidateApprovers:I.value.nextActivityCandidaters};Yc.SubmitApproval(e).then((({ID:e})=>{t.value.startFlow=!1;let l=setTimeout((()=>{ee(),Z(e).then((()=>{le()})).finally((()=>z())),clearTimeout(l)}),3e3)})).catch((()=>z()))}function le(){E.value.close()}function ae(){q(),i("log","at subcontract/consumable/inwarehouse/detail/index.js:660",t.value.id),t.value.enablingApproval=!1,Yc.PreStartFlow(t.value.id).then((({ActivityID:e,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r})=>{if(I.value.activityID=e,I.value.activityName=l,I.value.activityType=a,I.value.nextActivityID=o,I.value.nextActivityName=n,I.value.nextActivityType=i,1!=r.length&&null!=r)I.value.employeeID=null,I.value.employeeName="";else{const{EmployeeID:e,EmployeeName:t}=r[0];I.value.employeeID=e||null,I.value.employeeName=t||""}I.value.nextActivityCandidaters=r,_.value=r.map((e=>(e.text=e.EmployeeName,e.value=e.EmployeeID,e))),x.value.open(),1==r.length&&t.value.IsStart||2==i&&t.value.IsStart?oe():z()})).catch((()=>z()))}function oe(){if(_.value.length>1&&!I.value.employeeID)return void F("请选择审批人");q();const e={ID:t.value.id,ActivityName:I.value.activityName,ActivityID:I.value.activityID,ActivityType:I.value.activityType,NextActivityName:I.value.nextActivityName,NextActivityID:I.value.nextActivityID,NextActivityType:I.value.nextActivityType,CandidateApprovers:I.value.nextActivityCandidaters};Yc.StartFlow(e).then((async({ID:e})=>{t.value.startFlow=!1,await A(3e3),ee(),await Z(e),ne()})).catch((()=>z()))}function ne(){x.value.close()}function ie(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{H(e)}})}return uni.getSystemInfo({success:e=>{R.value=e.windowHeight}}),{IsScroll:e.computed((()=>{let e,t;return(R.value-60)/2>225?(e=225,t=R.value-285):e=t=(R.value-60)/2,{header:e,content:t}})),bill:t,billDetail:n,remarkVal:a,rowDetail:l,applyReasonOption:r,applyReasonHandle:function(e){t.value.applyReason.text=r.value.filter((t=>t.value==e))[0].text,t.value.applyReason.value=e},deleteOperationBtn:o,isOpened:f,uniSwipeChange:function(e,t){n.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(n.value.splice(t,1),L("移除成功"))},inputDialog:g,openEditDetailDalog:K,dialogRemarkInputConfirm:function(e){t.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:w,openRemarkDialog:function(){a.value=t.value.remark,w.value.open()},editDetailConfirm:function(e){if(l.value.Qty){{const e=/^\+?[1-9][0-9]*$/;if(!e.test(l.value.Qty))return void F("请输入正确的数量");if(e.test(l.value.Qty)&&l.value.Qty>l.value.WaitingInWarehouseQty&&2==t.value.currentInWarehouseType)return void F("入库数量大于待入库数量")}n.value[N.value].Qty=parseInt(l.value.Qty),n.value[N.value].Amount=l.value.Amount,n.value[N.value].Batch=l.value.Batch,n.value[N.value].Remark=l.value.Remark,2!=t.value.currentInWarehouseType&&(n.value[N.value].Price=l.value.Price),g.value.close(),G()}else F("请输入数量")},editDetailClose:function(){G()},editBillDetail:function(e){if(U&&null!==t.value.status&&1!=t.value.status)return;N.value=e;const{ConsumableName:a,ConsumableCode:o,BillCode:i,Spec:r,WaitingInWarehouseQty:s,Qty:c,Price:d,Batch:u,Amount:m,CategoryName:p}=n.value[e];l.value.ConsumableName=a,l.value.ConsumableCode=o,l.value.WaitingInWarehouseQty=s,l.value.BillCode=i,l.value.Spec=r,l.value.Qty=c,l.value.Amount=m,l.value.Price=d,l.value.Batch=u,l.value.CategoryName=p,K(0)},deleteDialog:C,billDelete:function(){C.value.open()},deleteDialogConfirm:function(){q(),Yc.Delete(t.value.id).then((()=>{et(lt.requestDrawDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:G,handleSaveDraft:function(e){t.value.isSubmit=e,t.value.warehouse.ID?t.value.inWarehouseDate?t.value.supplierID?t.value.handlerEmployeeID?n.value.length?t.value.isSubmit?V.value.open():Y():F("请添加入库单明细"):F("经办人必填"):F("供应商必填"):F("入库日期必填"):F("仓库必填")},submitDialog:V,submitMsgType:b,submitDialogConfirm:Y,submitDialogClose:J,editInfoTitle:y,billDetailNumber:X,editGetByID:Z,nonEditable:U,approvalShow:function(){q(),t.value.enablingApproval=!0,Yc.PrevApproval(t.value.id).then((e=>{const{ActivityID:t,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r,SupportedStrategies:s}=e[0];I.value.activityID=t,I.value.activityName=l,I.value.activityType=a,I.value.nextActivityID=o,I.value.nextActivityName=n,I.value.nextActivityType=i;const{EmployeeID:c,EmployeeName:d}=null!=r?r[0]:[];I.value.employeeID=null!=r?c:"",I.value.employeeName=null!=r?d:"",I.value.approvalType=1,I.value.refuseType=null!=s&&s.length>0?s[0]:null,I.value.remark="",I.value.nextActivityCandidaters=r,I.value.supportedStrategies=null!=s?s.map((e=>({text:1==e?"打回":2==e?"拒绝":"退回",value:e}))):[],E.value.open()})).finally((()=>z()))},approveDialog:E,approveConfirm:function(){I.value.approvalType||I.value.refuseType||0==I.value.supportedStrategies.length?I.value.approvalType||I.value.remark?te():F("请输入审批意见"):F("请选择处理方式")},submitApproval:te,approvalClose:le,approveStartUpDialog:x,approverOption:_,approverChange:function(e){I.value.nextActivityCandidaters=_.value.filter((t=>t.EmployeeID==e))},approvalProcessData:I,enablingApprovalShow:ae,approveStartConfirm:oe,approveStartClose:ne,resetApprovalProcessData:ee,jumpList:function(){tt(lt.consumableInwarehouseEditBill,(e=>{Z(e)})),k("/subcontract/consumable/inwarehouse/list/list")},windowHeights:R,fab:s,fabPattern:c,fabContent:d,fabTrigger:function({index:e}){switch(e){case 0:if(null==t.value.supplierID||""==t.value.supplierID)return void F("请先选择供应商");ie();break;case 1:if(null==t.value.supplierID||""==t.value.supplierID)return void F("请先选择供应商");m.value="",u.value.open();break;case 2:j.value="listDetail";break;case 3:j.value="example"}s.value.close()},scanCodeDialog:u,searchCodeVal:m,dialogsearchCodeValConfirm:function(e){const t=null==e?void 0:e.trim();""!=t&&null!=t&&null!=t?H(t):F("无效的检索条件")},addQuery:H,serachGoodsList:p,goodsDialog:v,goodsDialogConfirm:function(){let e=p.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(n.value.filter((t=>t.GoodsID==e[l].ID)).length<1)e[l].GoodsID=e[l].ID,e[l].ID=null,e[l].isOpened="none",e[l].Qty=0,e[l].Remark="",e[l].Price=0,e[l].Amount=0,e[l].ReferenceCostAmount=e[l].Qty*e[l].ReferenceCost,n.value.push(e[l]);else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}v.value.close(),p.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=p.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},scan:ie,inWarehouseDateTimeChange:function({detail:{value:e}}){U.value||(t.value.inWarehouseDate=e)},processTrackDialog:B,processTrack:function(){q(),Yc.GetFlowTrail(t.value.id).then((({ApprovalLog:e,ApprovalTask:t})=>{P.value=e.reverse(),O.value=t,B.value.open()})).finally((()=>z()))},processTrackCurrent:T,processTrackClickItem:function(e){T.value!=e.currentIndex&&(T.value=e.currentIndex)},processTrackApprovalLog:P,processTrackApprovalTask:O,sign:function(){uni.navigateTo({url:`/pages/system/signConfirm/signConfirm?type=1&key=200&billID=${t.value.id}`})},removeInput:function(e){switch(e){case"warehouse":t.value.warehouse.ID="",t.value.warehouse.Name="",t.value.warehouse.OID="";break;case"inWarehouseDate":t.value.inWarehouseDate="";break;case"supplierName":t.value.supplierID="",t.value.supplierName="";case"handlerEmployeeName":t.value.handlerOrgID="",t.value.handlerOrgNameCN="",t.value.handlerOrgNameEN="",t.value.handlerEmployeeID="",t.value.handlerEmployeeName="";break;case"remark":t.value.remark=""}},openFromWarehouseSelector:function(){uni.navigateTo({url:"/pages/selector/consumable/warehouse?disableOrg=1&isPower=1"}),tt(lt.consumableWarehouseBack,(e=>{t.value.corpID=e.corpID,t.value.warehouse.ID=e.id,t.value.warehouse.Name=e.label,t.value.warehouse.OID=e.oid}))},openToWarehouseSelector:function(){uni.navigateTo({url:"/pages/selector/consumable/warehouse?disableOrg=1"}),tt(lt.consumableWarehouseBack,(e=>{i("log","at subcontract/consumable/inwarehouse/detail/index.js:205",e),t.value.toWarehouse.ID=e.id,t.value.toWarehouse.Name=e.label,t.value.toWarehouse.OID=e.oid}))},openPersonSelector:function(){""!=t.value.corpID&&null!=t.value.corpID?(tt(lt.employeeSelectBack,(e=>{t.value.handlerEmployeeID=e.ID,t.value.handlerEmployeeName=e.Name,t.value.handlerOrgID=e.OrgID,t.value.handlerOrgNameCN=e.OrgNameCN,t.value.handlerOrgNameEN=e.OrgNameEN})),uni.navigateTo({url:`/pages/selector/system/employee?ids=${[t.value.handlerEmployeeID]}&corpID=${t.value.corpID} `})):F("请先选择仓库")},totalQuantity:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){var o;return null!=(o=e.Qty)?o:e+t.Qty}),0)},totalAmount:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){return e+t.Qty*t.Price}),0)},changeCurrentInWarehouseType:function(e){t.value.currentInWarehouseType=e},orderImport:function(){null!=t.value.supplierID&&""!=t.value.supplierID?(tt(lt.consumableOrderBack,(e=>{n.value=e.map((e=>{let t={};return t.Amount=e.Amount,t.Batch="",t.BillCode=e.BillCode,t.Brand=e.Brand,t.CategoryName=e.CategoryName,t.ConsumableCode=e.ConsumableCode,t.Code=e.ConsumableCode,t.ConsumableID=e.ConsumableID,t.ConsumableName=e.ConsumableName,t.IsEnableBatch=M,t.Model=e.Model,t.BillCode=e.BillCode,t.OrderDetailID=e.ID,t.OrderID=e.BillID,t.Price=e.Price,t.Qty=e.Qty,t.Remark=e.Remark,t.Spec=e.Spec,t.Unit=e.Unit,t.WaitingInWarehouseQty=e.WaitingInWarehouseQty,t}))})),uni.navigateTo({url:`/subcontract/consumable/inwarehouse/order/order?SupplierID=${t.value.supplierID}`})):F("请选择供应商")},supplierSelector:function(){tt(lt.supplierSelectBack,(e=>{t.value.supplierID=e.ID,t.value.supplierName=e.Name})),uni.navigateTo({url:"/pages/selector/asset/supplier"})},IsEnableBatch:M,IsAutoBatchNumber:W,changeQty:function(e){2==t.value.currentInWarehouseType&&(l.value.Amount=""!=e.detail.value?parseInt(e.detail.value)*l.value.Price:0)},getPrice:function(){let e=1;null!=l.value.Qty&&""!=l.value.Qty&&0!=parseInt(l.value.Qty)&&(e=parseInt(l.value.Qty));let t=0;return null!=l.value.Amount&&""!=l.value.Amount&&(t=l.value.Amount),l.value.Price=Math.floor(t/e*100)/100,l.value.Price},isfiles:$,select:function({tempFilePaths:t}){q(),be.uploadAttachment(t).then((t=>{$.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));Q.value.push(...l),e.nextTick((()=>{$.value=!0}))})).finally((()=>z()))},files:Q,fileExtType:_s,isfiles:$,toIndex:j}};var Xc=l({components:{UniFilePicker:Zr},props:{id:String,type:String},setup({id:e,type:t}){const{IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,inWarehouseDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openToWarehouseSelector:ye,openPersonSelector:we,totalQuantity:Ne,totalAmount:Ce,changeCurrentInWarehouseType:Ee,orderImport:be,supplierSelector:De,IsEnableBatch:Ve,IsAutoBatchNumber:ke,changeQty:xe,getPrice:_e,select:Se,files:Ie,fileExtType:Be,isfiles:Te,toIndex:Ae}=Zc();return hs.dictionaryGetByCode("D006").then((({Items:e})=>{r.value=e.map((e=>({text:e.ItemText,value:e.ID})))})),e&&T(e),tt(lt.signBack,(()=>T(a.value.id))),{type:t,IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,inWarehouseDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openToWarehouseSelector:ye,openPersonSelector:we,totalQuantity:Ne,totalAmount:Ce,changeCurrentInWarehouseType:Ee,orderImport:be,supplierSelector:De,IsEnableBatch:Ve,IsAutoBatchNumber:ke,changeQty:xe,getPrice:_e,select:Se,files:Ie,fileExtType:Be,isfiles:Te,toIndex:Ae}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-data-select"),_c),c=r(e.resolveDynamicComponent("uni-popup-dialog"),al),d=r(e.resolveDynamicComponent("uni-popup"),dl),u=r(e.resolveDynamicComponent("uni-data-checkbox"),Ns),m=r(e.resolveDynamicComponent("uni-easyinput"),Ie),p=r(e.resolveDynamicComponent("uni-segmented-control"),Es),v=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),h=r(e.resolveDynamicComponent("uni-list-item"),we),f=r(e.resolveDynamicComponent("uni-list"),Ne),g=r(e.resolveDynamicComponent("uni-fab"),ul),y=r(e.resolveDynamicComponent("uni-icons"),fe),w=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),N=r(e.resolveDynamicComponent("uni-swipe-action"),ps),C=r(e.resolveDynamicComponent("uni-section"),ue),E=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(d,{ref:"approveStartUpDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"启动审批流",onConfirm:o.approveStartConfirm,onClose:o.approveStartClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)]),e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批人员："),o.approverOption.length>1?(e.openBlock(),e.createBlock(s,{key:0,clear:!1,modelValue:o.approvalProcessData.employeeID,"onUpdate:modelValue":l[0]||(l[0]=e=>o.approvalProcessData.employeeID=e),localdata:o.approverOption,onChange:o.approverChange},null,8,["modelValue","localdata","onChange"])):(e.openBlock(),e.createElementBlock("text",{key:1},e.toDisplayString(o.approvalProcessData.employeeName),1))])])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"approveDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"单据审批",onConfirm:o.approveConfirm,onClose:o.approvalClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批结果："),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.approvalType,"onUpdate:modelValue":l[1]||(l[1]=e=>o.approvalProcessData.approvalType=e),localdata:o.approvalProcessData.approvalTypeOption},null,8,["modelValue","localdata"])])]),1!=o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"approve-type"},[o.approvalProcessData.supportedStrategies.length?(e.openBlock(),e.createElementBlock("text",{key:0}," 处理方式： ")):e.createCommentVNode("",!0),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.refuseType,"onUpdate:modelValue":l[2]||(l[2]=e=>o.approvalProcessData.refuseType=e),localdata:o.approvalProcessData.supportedStrategies},null,8,["modelValue","localdata"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"approve-opinion approve-type"},[e.createElementVNode("text",null,"审批意见："),e.createElementVNode("view",null,[e.createVNode(m,{type:"textarea",modelValue:o.approvalProcessData.remark,"onUpdate:modelValue":l[3]||(l[3]=e=>o.approvalProcessData.remark=e),placeholder:"请输入内容"},null,8,["modelValue"])])]),1==o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"approve-footer approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)])):e.createCommentVNode("",!0)])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"processTrackDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(v,{title:"流程轨迹",onClose:l[4]||(l[4]=e=>o.processTrackDialog.close())},{default:e.withCtx((()=>[e.createElementVNode("view",{style:e.normalizeStyle(`height:${o.windowHeights/3}px`)},[e.createElementVNode("view",{class:"process_track_tab"},[e.createVNode(p,{current:o.processTrackCurrent,values:["待办任务","流转日志"],"style-type":"text","active-color":"#007aff",onClickItem:o.processTrackClickItem},null,8,["current","onClickItem"])]),0==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track_content"},[o.processTrackApprovalTask.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track"},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"当前节点："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"创建时间："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].CreatedTime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"接收者："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].ApprovalEmployeeName),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0),1==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"process_track_content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.processTrackApprovalLog,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"process_track process_dividing_line",key:l},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"节点名称："),e.createElementVNode("view",null,e.toDisplayString(t.FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批人："),e.createElementVNode("view",null,e.toDisplayString(t.OperaterEmployeeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批时间："),e.createElementVNode("view",null,e.toDisplayString(t.OperationDatetime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批结果："),e.createElementVNode("view",null,e.toDisplayString(t.OperationType),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批意见："),e.createElementVNode("view",null,e.toDisplayString(t.ApprovalComment),1)])])))),128)),o.processTrackApprovalLog.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0)],4)])),_:1})])),_:1},512),e.createVNode(d,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(d,{ref:"deleteDialog",class:"deleteDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base",type:"error",cancelText:"取消",confirmText:"确认",title:"删除申领单",onConfirm:o.deleteDialogConfirm},null,8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(d,{ref:"goodsDialog",class:"goodsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{title:"选择易耗品",type:"info","before-close":!0,onClose:l[6]||(l[6]=e=>o.goodsDialog.close()),onConfirm:o.goodsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"goodsDialogList",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachGoodsList,(({ConsumableID:a,ConsumableName:n,CategoryName:i,Code:r,Brand:s,Spec:c,Model:d,Unit:u,Remark:m})=>(e.openBlock(),e.createBlock(h,{key:a},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"asset-dialog-list"},[e.createElementVNode("view",{class:"list-item"},[e.createElementVNode("text",{class:"list-item-column-title"},e.toDisplayString(n),1),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"分类："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"计量单位："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(m),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"take-delivery-checkbox"},[e.createElementVNode("checkbox-group",{onChange:l[5]||(l[5]=e=>o.checkBoxChange(e,t.ID))},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:t.checked},null,8,["checked"])])],32)])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(d,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createVNode(f,{class:"inputDialog"},{default:e.withCtx((()=>[e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ConsumableName),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"编码：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ConsumableCode),1)])])),_:1}),2==o.bill.currentInWarehouseType?(e.openBlock(),e.createBlock(h,{key:0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"订单号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.BillCode),1)])])),_:1})):e.createCommentVNode("",!0),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"分类：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.CategoryName),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"规格型号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Spec),1)])])),_:1}),2==o.bill.currentInWarehouseType?(e.openBlock(),e.createBlock(h,{key:1},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"待入库数量：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.WaitingInWarehouseQty),1)])])),_:1})):e.createCommentVNode("",!0),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"入库数量：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.withDirectives(e.createElementVNode("input",{style:{border:"1px solid #ccc","font-size":"14px"},class:"uni-input",type:"number",placeholder:"入库数量","onUpdate:modelValue":l[7]||(l[7]=e=>o.rowDetail.Qty=e),onInput:l[8]||(l[8]=(...e)=>o.changeQty&&o.changeQty(...e))},null,544),[[e.vModelText,o.rowDetail.Qty]])])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"单价：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(2==o.bill.currentInWarehouseType?o.rowDetail.Price:o.getPrice()),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"金额：")])])),body:e.withCtx((()=>[2==o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Amount),1)])):e.createCommentVNode("",!0),2!=o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"input-dialog-body"},[e.withDirectives(e.createElementVNode("input",{style:{border:"1px solid #ccc","font-size":"14px"},class:"uni-input",type:"number",placeholder:"金额","onUpdate:modelValue":l[9]||(l[9]=e=>o.rowDetail.Amount=e)},null,512),[[e.vModelText,o.rowDetail.Amount]])])):e.createCommentVNode("",!0)])),_:1}),o.IsEnableBatch?(e.openBlock(),e.createBlock(h,{key:2},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"批次：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.withDirectives(e.createElementVNode("input",{style:{border:"1px solid #ccc","font-size":"14px"},class:"uni-input",type:"number",disabled:o.IsAutoBatchNumber,placeholder:o.IsAutoBatchNumber?"自动生成":"请输入批次","onUpdate:modelValue":l[10]||(l[10]=e=>o.rowDetail.Batch=e)},null,8,["disabled","placeholder"]),[[e.vModelText,o.rowDetail.Batch]])])])),_:1})):e.createCommentVNode("",!0),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.withDirectives(e.createElementVNode("input",{style:{border:"1px solid #ccc","font-size":"14px"},class:"uni-input",placeholder:"请输入批次备注","onUpdate:modelValue":l[11]||(l[11]=e=>o.rowDetail.Remark=e)},null,512),[[e.vModelText,o.rowDetail.Remark]])])])),_:1})])),_:1})])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),null==o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"inWarehouseType-select"},[e.createElementVNode("view",{class:"btns"},[e.createElementVNode("button",{onClick:l[12]||(l[12]=e=>o.changeCurrentInWarehouseType(1))},"直接入库"),e.createElementVNode("button",{onClick:l[13]||(l[13]=e=>o.changeCurrentInWarehouseType(2))},"采购入库")])])):e.createCommentVNode("",!0),e.createVNode(d,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{ref:"inputClose",mode:"input",title:"选择易耗品",value:o.searchCodeVal,placeholder:"编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),o.nonEditable||null==o.bill.currentInWarehouseType||1!=o.bill.currentInWarehouseType?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"request-draw-fab"},[e.createVNode(g,{ref:"fab",pattern:o.fabPattern,content:o.fabContent,horizontal:"right",vertical:"bottom",direction:"horizontal",onTrigger:o.fabTrigger},null,8,["pattern","content","onTrigger"])])),null!=o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("scroll-view",{key:2,style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"uni_list"},[e.createVNode(f,null,{default:e.withCtx((()=>[e.createVNode(h,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"info-item-text",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view")]))])),_:1}),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"仓库：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.warehouse.Name?"info-item-color":""]),onClick:l[14]||(l[14]=e=>o.nonEditable?null:o.openFromWarehouseSelector())},e.toDisplayString(o.bill.warehouse.Name?o.bill.warehouse.Name:"请选择仓库"),3)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.warehouse.ID?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[15]||(l[15]=e=>o.removeInput("warehouse")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"入库日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("picker",{mode:"date",onChange:l[16]||(l[16]=(...e)=>o.inWarehouseDateTimeChange&&o.inWarehouseDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.inWarehouseDate?"info-item-color":""])},e.toDisplayString(o.bill.inWarehouseDate?o.bill.inWarehouseDate:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.inWarehouseDate?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[17]||(l[17]=e=>o.removeInput("inWarehouseDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"供应商：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.supplierName?"info-item-color":""]),onClick:l[18]||(l[18]=e=>o.nonEditable?null:o.supplierSelector())},e.toDisplayString(o.bill.supplierName?o.bill.supplierName:"请选择供应商"),3)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.supplierName?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[19]||(l[19]=e=>o.removeInput("supplierName")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"经办人：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.handlerEmployeeName?"info-item-color":""]),onClick:l[20]||(l[20]=e=>o.nonEditable?null:o.openPersonSelector())},e.toDisplayString(o.bill.handlerEmployeeName?o.bill.handlerEmployeeName:"请选择人员"),3)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.handlerEmployeeName?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[21]||(l[21]=e=>o.removeInput("handlerEmployeeName")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"备注：")])])),body:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-input",style:{"font-size":"14px",width:"100%","text-align":"right"},disabled:null==o.nonEditable,placeholder:"请输入备注信息","onUpdate:modelValue":l[22]||(l[22]=e=>o.bill.remark=e)},null,8,["disabled"]),[[e.vModelText,o.bill.remark]])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[23]||(l[23]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"])])),_:1})])],4)):e.createCommentVNode("",!0),null!=o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("scroll-view",{key:3,class:"bill-list-request-draw",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),"scroll-y":"",onScroll:l[25]||(l[25]=e=>o.toIndex=""),"scroll-into-view":o.toIndex},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(C,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"Statistics"}," 总数量:"+e.toDisplayString(o.totalQuantity())+" 总金额:"+e.toDisplayString(o.totalAmount()),1),e.createElementVNode("view",{class:"bill-detail-request-draw"},[e.createVNode(N,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(w,{disabled:o.nonEditable,"right-options":o.deleteOperationBtn,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.index,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createVNode(h,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item",onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.ConsumableName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(t.Code),1)]),2==o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"list-item-column"},[e.createElementVNode("text",null,"订单号："+e.toDisplayString(t.BillCode),1)])):e.createCommentVNode("",!0),2!=o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"list-item-column"},[e.createElementVNode("text",null,"易耗品分类："+e.toDisplayString(t.CategoryName),1)])):e.createCommentVNode("",!0),2!=o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:2,class:"list-item-column"},[e.createElementVNode("text",null,"规格型号："+e.toDisplayString(t.Spec),1)])):e.createCommentVNode("",!0),2==o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:3,class:"list-item-column"},[e.createElementVNode("text",null,"待入库数量："+e.toDisplayString(t.WaitingInWarehouseQty),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"入库数量："+e.toDisplayString(t.Qty)+e.toDisplayString(t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"单价："+e.toDisplayString(t.Price),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"金额："+e.toDisplayString(t.Amount),1)]),o.IsEnableBatch?(e.openBlock(),e.createElementBlock("view",{key:4,class:"list-item-column"},[e.createElementVNode("text",null,"批次："+e.toDisplayString(o.IsAutoBatchNumber?"自动生成":t.Batch),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])])),_:2},1024)])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1})])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(C,{title:"附件",type:"line"},{default:e.withCtx((()=>[o.isfiles?(e.openBlock(),e.createBlock(E,{key:0,ref:"filePicker",limit:9,disabled:o.nonEditable,"del-icon":!o.nonEditable,"file-mediatype":"all","file-extname":o.fileExtType.all,mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[24]||(l[24]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:t.deletefile,title:"最多选择9个附件"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"unload-attachment"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,type:"primary"},"上传附件"))])])),_:1},8,["disabled","del-icon","file-extname","modelValue","onSelect","onDelete"])):e.createCommentVNode("",!0)])),_:1})],44,["scroll-into-view"])):e.createCommentVNode("",!0),o.nonEditable?(e.openBlock(),e.createElementBlock("view",{key:4,class:"toIndex"},[e.createElementVNode("view",{onClick:l[26]||(l[26]=e=>o.toIndex="listDetail")},[e.createVNode(y,{type:"arrow-up",color:"#fff",size:"30"}),e.createElementVNode("br")]),e.createElementVNode("view",{onClick:l[27]||(l[27]=e=>o.toIndex="example")},[e.createVNode(y,{type:"arrow-down",color:"#fff",size:"30"}),e.createElementVNode("br")])])):e.createCommentVNode("",!0),null!=o.bill.currentInWarehouseType?(e.openBlock(),e.createElementBlock("view",{key:5,class:"bill-footer-request-draw"},[e.createElementVNode("view",{class:"bill_list"},[o.type?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("image",{key:0,src:"/static/icon/bill_list.png",alt:"",onClick:l[28]||(l[28]=(...e)=>o.jumpList&&o.jumpList(...e))}))]),e.createElementVNode("view",null,[2!=o.bill.currentInWarehouseType||1!=o.bill.status&&null!=o.bill.status?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,onClick:l[29]||(l[29]=(...e)=>o.orderImport&&o.orderImport(...e))},[e.createElementVNode("text",{class:"text-overflow"},"订单导入")])),1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:l[30]||(l[30]=e=>o.handleSaveDraft(0))},[e.createElementVNode("text",{class:"text-overflow"},"保存草稿")])):e.createCommentVNode("",!0),1==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:2,onClick:l[31]||(l[31]=(...e)=>o.billDelete&&o.billDelete(...e))},[e.createElementVNode("text",{class:"uni-icon-delete text-overflow"},"删除草稿")])):e.createCommentVNode("",!0),1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:3,onClick:l[32]||(l[32]=e=>o.handleSaveDraft(1)),type:"primary",class:"uni-icon-submit"},[e.createElementVNode("text",{class:"text-overflow",style:{color:"#fff"}},"提交")])):e.createCommentVNode("",!0),o.bill.IsApproval?(e.openBlock(),e.createElementBlock("button",{key:4,onClick:l[33]||(l[33]=(...e)=>o.approvalShow&&o.approvalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"},"审批")])):e.createCommentVNode("",!0),o.bill.IsStart&&o.bill.startFlow?(e.openBlock(),e.createElementBlock("button",{key:5,onClick:l[34]||(l[34]=(...e)=>o.enablingApprovalShow&&o.enablingApprovalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"}," 启动审批流 ")])):e.createCommentVNode("",!0),o.bill.FlowPath?(e.openBlock(),e.createElementBlock("button",{key:6,onClick:l[35]||(l[35]=(...e)=>o.processTrack&&o.processTrack(...e))},[e.createElementVNode("text",{class:"text-overflow"},"流程轨迹")])):e.createCommentVNode("",!0),7==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:7,onClick:l[36]||(l[36]=(...e)=>o.sign&&o.sign(...e))},[e.createElementVNode("text",null,"签字")])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)],64)}],["__scopeId","data-v-11e4fa8a"]]);const ed={data:()=>({IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{SupplierID:"",OrderDateEndDate:"",OrderDateStartDate:"",QST:""},selectArray:[],data:[],pageCount:0,total:0}),methods:{timeConvertDate:Ql,orderConfirm(){this.selectArray.length<1?F("请选择采购订单"):(Xe(lt.consumableOrderBack,this.selectArray),S())},cancel(){S()},orderDateStartDateChange(e){this.condition.OrderDateStartDate=e.detail.value},orderDateEndDateChange(e){this.condition.OrderDateEndDate=e.detail.value},editBill(e){Xe(lt.consumableAllocateEditBill,e),S()},check(e){this.data[e].checked=!this.data[e].checked,this.data[e].checked?this.selectArray.push(this.data[e]):this.selectArray=this.selectArray.filter((t=>{if(t.ID!=this.data[e].ID)return t}))},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;"http://"==l.substring(0,7).toLowerCase()||"https://"==l.substring(0,8).toLowerCase()?e.condition.QST=ruleShow(l):e.condition.QST=l,e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},query(){this.condition.PageNO=1,this.load()},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),Yc.GetOrderList(this.condition).then((l=>{l.Items=l.Items.map((e=>(e.checked=!1,e))),t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))}},computed:{},mounted(){let e=getCurrentPages(),t=e[e.length-1].options;this.condition.SupplierID=t.SupplierID,this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var td=l(ed,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"订单号/易耗品编码/名称","onUpdate:modelValue":l[0]||(l[0]=e=>this.condition.QST=e),"confirm-type":"search",onConfirm:l[1]||(l[1]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.QST]])]),e.createElementVNode("view",{class:"QC"},[e.createElementVNode("button",{onClick:l[2]||(l[2]=(...e)=>i.query&&i.query(...e))},"查询")])]),e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 订单日期起： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[3]||(l[3]=(...e)=>i.orderDateStartDateChange&&i.orderDateStartDateChange(...e))},[e.createElementVNode("text",{class:"info-item-text",style:{color:"#ccc"}},e.toDisplayString(this.condition.OrderDateStartDate?this.condition.OrderDateStartDate:"请选择订单日期起"),1)],32)]),e.createElementVNode("view",{class:"right"})]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 订单日期止： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[4]||(l[4]=(...e)=>i.orderDateEndDateChange&&i.orderDateEndDateChange(...e))},[e.createElementVNode("text",{class:"info-item-text",style:{color:"#ccc"}},e.toDisplayString(this.condition.OrderDateEndDate?this.condition.OrderDateEndDate:"请选择订单日期止"),1)],32)]),e.createElementVNode("view",{class:"right"})])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"billStatus"}," 采购订单明细 "),e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1",overflow:"hidden"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[5]||(l[5]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[6]||(l[6]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[7]||(l[7]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[8]||(l[8]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[9]||(l[9]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:e=>i.check(l)},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.ConsumableName),1),e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.ConsumableCode),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"易耗品分类："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"规格型号："+e.toDisplayString(t.Spec),1),e.createElementVNode("checkbox",{checked:t.checked},null,8,["checked"])]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"采购数量："+e.toDisplayString(t.Qty)+e.toDisplayString(t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"待入库数量："+e.toDisplayString(t.WaitingInWarehouseQty),1)])],8,["onClick"])))),128))])],40,["refresher-triggered"]),e.createElementVNode("view",{class:"btn_bottom"},[e.createElementVNode("button",{class:e.normalizeClass(n.selectArray.length>0?"button_show":""),onClick:l[10]||(l[10]=(...e)=>i.orderConfirm&&i.orderConfirm(...e))},"确定",2),e.createElementVNode("button",{onClick:l[11]||(l[11]=(...e)=>i.cancel&&i.cancel(...e))},"取消")])])}],["__scopeId","data-v-39983e20"]]);const ld={data:()=>({BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{BillStatus:0,BillCode:"",ConsumableCategoryIDs:[],ConsumableCode:"",HandlerEmployeeIDs:[],InWarehouseEndDate:"",InWarehouseStartDate:"",IsSetNumber:!0,ListMode:2,PageNO:1,PageSize:20,QST:"",Sort:2,SupplierIDs:[],WarehouseOrCorpIDs:[]},data:[],pageCount:0,total:0}),methods:{timeConvertDate:Ql,bindPickerChange(e){let t=this.BillType.findIndex(((t,l,a)=>t.value==e.detail.value));this.condition.BillStatus=t,this.load()},editBill(e){Xe(lt.consumableInwarehouseEditBill,e),S()},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;"http://"==l.substring(0,7).toLowerCase()||"https://"==l.substring(0,8).toLowerCase()?e.condition.QST=ruleShow(l):e.condition.QST=l,e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),Yc.QueryInWarehouseBill(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){tt(lt.consumableInwarehouseConditionBack,(e=>{this.condition=e,this.condition.PageSize=10,this.condition.PageNO=1,this.load()})),uni.navigateTo({url:"/subcontract/consumable/inwarehouse/condition/condition"})}},computed:{},mounted(){this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var ad=l(ld,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"seach_condition",onClick:l[0]||(l[0]=(...e)=>i.SettingCondition&&i.SettingCondition(...e))},[e.createElementVNode("view",{class:"icon_condition"},[e.createElementVNode("image",{src:"/static/icon/condition.png",style:{width:"26px",height:"26px"}})])]),e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"单号","onUpdate:modelValue":l[1]||(l[1]=e=>this.condition.BillCode=e),"confirm-type":"search",onConfirm:l[2]||(l[2]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.BillCode]])]),e.createElementVNode("view",{class:"QC"},[e.createElementVNode("view",{class:"icon-saoma"},[e.createElementVNode("image",{src:"/static/saoma.png",style:{width:"30px",height:"30px"},onClick:l[3]||(l[3]=(...e)=>i.ScanCode&&i.ScanCode(...e))})])])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"billStatus"},[e.createElementVNode("picker",{onChange:l[4]||(l[4]=(...e)=>i.bindPickerChange&&i.bindPickerChange(...e)),value:n.BillType[n.condition.BillStatus].value,range:n.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(n.BillType[n.condition.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[5]||(l[5]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[6]||(l[6]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[7]||(l[7]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[8]||(l[8]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[9]||(l[9]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:e=>i.editBill(t.ID)},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillerEmployeeName)+"提交的易耗品入库单",1),e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillDateTime),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"单号："+e.toDisplayString(t.BillCode),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#007aff"}},"单据状态："+e.toDisplayString(t.StatusText),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"仓库："+e.toDisplayString(t.WarehouseName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"供应商："+e.toDisplayString(t.SupplierName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"入库日期："+e.toDisplayString(t.InStockDate),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"经办人："+e.toDisplayString(t.HandlerEmployeeName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"金额："+e.toDisplayString(t.TotalAmount),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])))),128))])],40,["refresher-triggered"])])}],["__scopeId","data-v-5ff66c32"]]);var od=()=>{const{Data:t,BillType:l,Condition:a}={Data:e.ref({BillStatus:0,BillCode:"",ConsumableCategoryIDs:[],ConsumableCode:"",HandlerEmployeeIDs:[],InWarehouseEndDate:"",InWarehouseStartDate:"",IsSetNumber:!0,ListMode:2,PageNO:1,PageSize:20,QST:"",Sort:2,SupplierIDs:[],WarehouseOrCorpIDs:[]}),BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],Condition:e.ref({WarehouseOrCorp:[],Person:[],Supplier:[]})};function o(e){switch(e){case"WarehouseOrCorp":t.value.WarehouseOrCorpIDs=[],a.value.WarehouseOrCorp=[];break;case"BillCode":t.value.BillCode="";break;case"InWarehouseStartDate":t.value.InWarehouseStartDate="";break;case"InWarehouseEndDate":t.value.InWarehouseEndDate="";break;case"Person":a.value.Person=[],t.value.HandlerEmployeeIDs=[];break;case"Supplier":a.value.Supplier=[],t.value.SupplierIDs=[]}}return{Data:t,query:function(){Xe(lt.consumableInwarehouseConditionBack,t.value),S()},BillType:l,bindPickerChange:function(e){let a=l.findIndex(((t,l,a)=>t.value==e.detail.value));t.value.BillStatus=a},getWarehouseOrCorpText:function(){return a.value.WarehouseOrCorp.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getWarehouseOrCorpIDs:function(){uni.navigateTo({url:`/pages/selector/consumable/warehouse?ids=${t.value.HandlerOrgIDs}&multiple=1`}),tt(lt.consumableWarehouseBack,(e=>{let l=e.items.map((e=>({Name:e.label,ID:e.id})));a.value.WarehouseOrCorp=l,t.value.WarehouseOrCorpIDs=l.map((e=>e.ID))}))},bindInWarehouseStartDatePickerChange:function(e){t.value.InWarehouseStartDate=e.detail.value},bindInWarehouseEndDatePickerChange:function(e){t.value.InWarehouseEndDate=e.detail.value},clearInputText:o,reset:function(){t.value.BillStatus=0,o("WarehouseOrCorp"),o("BillCode"),o("InWarehouseStartDate"),o("InWarehouseEndDate"),o("Person"),o("Supplier")},getPersonText:function(){return a.value.Person.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getPersonIDs:function(){tt(lt.employeeSelectBack,(e=>{let l=e.items.map((e=>({Name:e.Name,ID:e.ID})));i("log","at subcontract/consumable/inwarehouse/condition/index.js:44",e),a.value.Person=l,t.value.HandlerEmployeeIDs=l.map((e=>e.ID))})),uni.navigateTo({url:`/pages/selector/system/employee?multiple=1&ids=${t.value.HandlerEmployeeIDs}`})},getSupplierText:function(){return a.value.Supplier.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getSupplierIDs:function(){tt(lt.supplierSelectBack,(e=>{let l=e.items.map((e=>({Name:e.Name,ID:e.ID})));a.value.Supplier=l,t.value.SupplierIDs=l.map((e=>e.ID))})),uni.navigateTo({url:`/pages/selector/asset/supplier?multiple=1&ids=${t.value.SupplierIDs}`})}}};var nd=l({props:{id:String,type:String},setup({id:e,type:t}){const{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindInWarehouseStartDatePickerChange:c,bindInWarehouseEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v,getSupplierText:h,getSupplierIDs:f}=od();return{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindInWarehouseStartDatePickerChange:c,bindInWarehouseEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v,getSupplierText:h,getSupplierIDs:f}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"screen"},[e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 单据状态： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{onChange:l[0]||(l[0]=(...e)=>o.bindPickerChange&&o.bindPickerChange(...e)),value:o.BillType[o.Data.BillStatus].value,range:o.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(o.BillType[o.Data.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"right"})]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 仓库： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择仓库",value:o.getWarehouseOrCorpText(),onClick:l[1]||(l[1]=(...e)=>o.getWarehouseOrCorpIDs&&o.getWarehouseOrCorpIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getWarehouseOrCorpText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[2]||(l[2]=e=>o.clearInputText("WarehouseOrCorp"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 经办人： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择经办人",value:o.getPersonText(),onClick:l[3]||(l[3]=(...e)=>o.getPersonIDs&&o.getPersonIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getPersonText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[4]||(l[4]=e=>o.clearInputText("Person"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 入库单号： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请输入入库单号","onUpdate:modelValue":l[5]||(l[5]=e=>o.Data.BillCode=e)},null,512),[[e.vModelText,o.Data.BillCode]])]),e.createElementVNode("view",{class:"right"},[o.Data.BillCode?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[6]||(l[6]=e=>o.clearInputText("BillCode"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 供应商： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择供应商",value:o.getSupplierText(),onClick:l[7]||(l[7]=(...e)=>o.getSupplierIDs&&o.getSupplierIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getSupplierText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[8]||(l[8]=e=>o.clearInputText("Supplier"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 入库日期起： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[9]||(l[9]=(...e)=>o.bindInWarehouseStartDatePickerChange&&o.bindInWarehouseStartDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.InWarehouseStartDate?o.Data.InWarehouseStartDate:"入库日期起"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.InWarehouseStartDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[10]||(l[10]=e=>o.clearInputText("InWarehouseStartDate"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 入库日期止： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[11]||(l[11]=(...e)=>o.bindInWarehouseEndDatePickerChange&&o.bindInWarehouseEndDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.InWarehouseEndDate?o.Data.InWarehouseEndDate:"入库日期止"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.InWarehouseEndDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[12]||(l[12]=e=>o.clearInputText("InWarehouseEndDate"))})):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"button_list"},[e.createElementVNode("button",{class:"button_item reset",onClick:l[13]||(l[13]=(...e)=>o.reset&&o.reset(...e))},"重置"),e.createElementVNode("button",{class:"button_item query",onClick:l[14]||(l[14]=(...e)=>o.query&&o.query(...e))},"查询")])])}],["__scopeId","data-v-451d46bf"]]);var id=new class extends Je{constructor(){super("OutWarehouse")}QueryRequestDrawBill(e){return this.request("/Bill/RequestDraw/List",e)}QueryRequestDrawBillByID(e){return this.request("/Bill/RequestDraw/GetByID",e)}QueryOutWarehouseBill(e){return this.request("/Bill/OutWarehouse/List",e)}GetOrderList(e){return this.request("/Bill/PurchasingOrder/Selector/Query",e)}SaveDraft(e){return this.request("/Bill/OutWarehouse/SaveDraft",e)}GetByID(e){return this.request("/Bill/OutWarehouse/GetByID",e)}Delete(e){return this.request("/Bill/OutWarehouse/Delete",{ID:e})}PreStartFlow(e){return this.preStartFlow(e)}StartFlow(e){return this.startFlow(e)}PrevApproval(e){return this.prevApproval(e)}SubmitApproval(e){return this.submitApproval(e)}GetFlowTrail(e){return this.getFlowTrail(e)}};var rd=new class extends Je{getStockList(e){return this.request("/Stock/List",e)}},sd=()=>{const{bill:t,rowDetail:l,remarkVal:a,deleteOperationBtn:o,billDetail:n,applyReasonOption:r,fab:s,fabPattern:c,fabContent:d,scanCodeDialog:u,searchCodeVal:m,serachGoodsList:p,goodsDialog:v,isOpened:f,inputDialog:g,editInfoTitle:y,inputRemarkDialog:w,detailIndex:N,deleteDialog:C,approveDialog:E,submitMsgType:b,submitDialog:V,approveStartUpDialog:x,approverOption:_,approvalProcessData:I,processTrackDialog:B,processTrackCurrent:T,processTrackApprovalLog:P,processTrackApprovalTask:O,windowHeights:R,nonEditable:U,IsEnableBatch:M,IsAutoBatchNumber:W,popup:$,isfiles:Q,files:j,toIndex:H}=(()=>{const t=e.ref([]),l=e.ref(!0),a=e.ref("");let o=h("ConsumableDicSettings"),n=o.filter((e=>{if("IsEnableBatch"==e.Key)return e}))[0],i=o.filter((e=>{if("IsAutoBatchNumber"==e.Key)return e}))[0];const r="true"===n.Value.toLowerCase(),s="true"===i.Value.toLowerCase(),c=e.ref({id:null,status:null,isSubmit:null,code:"",warehouse:{ID:"",Name:"",OID:""},corpID:"",outWarehouseDate:"",supplierID:"",supplierName:"",drawOrgID:"",drawOrgNameCN:"",drawOrgNameEN:"",drawEmployeeID:"",drawEmployeeName:"",requestDrawCode:"",requestDrawID:"",isClosedRequestDraw:"",remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1,abstract:""}),d=e.ref({ConsumableName:"",Brand:"",Spec:"",Model:"",Qty:1,TotalAvailableStock:0}),u=e.ref(""),m=e.ref([]),p=e.ref([]),v=e.ref([]);v.value=[{text:"取消",style:{backgroundColor:"#007aff"}},{text:"删除",style:{backgroundColor:"#F56C6C"}}];const f=e.ref(null),g=e.ref(null),y=e.ref("");let w=e.ref([]);const N=e.ref(null),C=e.ref(null);return{bill:c,rowDetail:d,remarkVal:u,deleteOperationBtn:v,billDetail:p,applyReasonOption:m,fab:f,fabPattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#007AFF",iconColor:"#fff"},fabContent:[{iconPath:"/static/icon/sys.png",selectedIconPath:"/static/icon/sys.png",text:"扫码",active:!1},{iconPath:"/static/icon/edit.png",selectedIconPath:"/static/icon/edit.png",text:"检索",active:!1},{iconPath:"/static/icon/asset_mingxi.png",selectedIconPath:"/static/icon/asset_mingxi.png",text:"明细",active:!1},{iconPath:"/static/icon/asset_fujian.png",selectedIconPath:"/static/icon/asset_fujian.png",text:"附件",active:!1}],scanCodeDialog:g,searchCodeVal:y,serachGoodsList:w,goodsDialog:N,isOpened:e.ref("none"),inputDialog:e.ref(null),editInfoTitle:e.ref(""),inputRemarkDialog:e.ref(null),detailIndex:e.ref(null),deleteDialog:e.ref(null),approveDialog:e.ref(null),submitMsgType:e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),submitDialog:e.ref(null),approveStartUpDialog:e.ref(null),approverOption:e.ref([]),approvalProcessData:e.ref({activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}),processTrackDialog:e.ref(null),processTrackCurrent:e.ref(0),processTrackApprovalLog:e.ref([]),processTrackApprovalTask:e.ref([]),windowHeights:e.ref(""),nonEditable:e.ref(!1),IsEnableBatch:r,IsAutoBatchNumber:s,popup:C,isfiles:l,files:t,toIndex:a}})();function K(e){q(),rd.getStockList({WarehouseIDs:[t.value.warehouse.ID],PageNO:1,PageSize:20,QST:e}).then((({Items:e})=>{p.value=e.map((e=>(e.checked=!1,e))),p.value.length<1?F("未查询到可用资产资料"):v.value.open()})).finally((()=>z()))}function G(e){y.value=e?"新增":"编辑",g.value.open()}function J(){l.value.ConsumableName="",l.value.ConsumableCode="",l.value.WaitingInWarehouseQty="",l.value.BillCode="",l.value.Spec="",l.value.Qty="",l.value.Amount="",l.value.Price="",l.value.Batch="",l.value.CategoryName="",N.value=null,g.value.close()}function Y(){V.value.close()}function Z(){let e={};e.ID=t.value.id,e.AddOrEdit=t.value.id?2:1,e.IsSubmit=!!t.value.isSubmit,e.AddOrEdit=t.value.id?2:1,e.IsSubmit=!!t.value.isSubmit,e.drawEmployeeID=t.value.drawEmployeeID,e.drawEmployeeName=t.value.drawEmployeeName,e.drawOrgID=t.value.drawOrgID,e.drawOrgNameCN=t.value.drawOrgNameCN,e.drawOrgNameEN=t.value.drawOrgNameEN,e.outWarehouseDate=t.value.outWarehouseDate,e.WarehouseID=t.value.warehouse.OID,e.IsClosedRequestDraw=t.value.isClosedRequestDraw,e.RequestDrawCode=t.value.requestDrawCode,e.requestDrawID=t.value.requestDrawID,e.Remark=t.value.remark,e.Attachments=j.value.map(((e,t)=>(e.Sequence=t+1,e))),e.Details=n.value.map(((e,t)=>{let l={};return l.ID=e.ID,l.Batch=e.Batch,l.Brand=e.Brand,l.CategoryName=e.CategoryName,l.Code=e.Code,l.ConsumableID=e.ConsumableID,l.ConsumableCode=e.ConsumableCode,l.ConsumableName=e.ConsumableName,l.IsEnableBatch=M,l.ReferenceCost=e.ReferenceCost,l.ReferenceCostAmount=e.ReferenceCostAmount,l.StockID=e.StockID,l.Spec=e.Spec,l.Price=e.Price,l.Model=e.Model,l.Unit=e.Unit,l.Qty=e.Qty,l.Remark=e.Remark,l.Amount=e.Amount,l.Sequence=t+1,l})),q(),id.SaveDraft(e).then((e=>{X(e.ID).then((()=>{t.value.IsStart&&oe()})),Y()})).finally((()=>z()))}function X(e){return q(),id.GetByID({ID:e}).then((({ID:e,Status:l,Code:a,Remark:o,CorpID:i,OutStockDate:r,SupplierID:s,SupplierName:c,DrawOrgID:d,DrawOrgNameCN:u,DrawOrgNameEN:m,DrawEmployeeID:p,DrawEmployeeName:v,WarehouseID:h,WarehouseName:f,RequestDrawCode:g,RequestDrawID:y,IsClosedRequestDraw:w,Details:N,FlowInfo:C,Attachments:E})=>{t.value.id=e,t.value.status=l,t.value.code=a,t.value.remark=o,t.value.corpID=i,t.value.outWarehouseDate=Ql(r),t.value.drawOrgID=d,t.value.drawOrgNameCN=u,t.value.drawOrgNameEN=m,t.value.drawEmployeeID=p,t.value.drawEmployeeName=v,t.value.requestDrawCode=g,t.value.requestDrawID=y,t.value.warehouse.OID=h,t.value.warehouse.ID=h,t.value.isClosedRequestDraw=w,t.value.warehouse.Name=f,j.value=E.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),n.value=N.map((e=>(e.Code=e.ConsumableCode,e))),U.value=1!=t.value.status&&null!=t.value.status,t.value.IsApproval=C.IsApproval,t.value.IsStart=1!=l&&!C.IsStart&&C.IsEnabledFlow,t.value.FlowPath=1!=l&&C.IsStart&&C.IsEnabledFlow||C.IsSendBack})).finally((()=>z()))}let ee=e.computed((()=>{let e=0;for(let t=0;t<n.value.length;t++)e+=parseInt(n.value[t].qty);return e}));function te(){I.value={activityID:null,activityName:"",activityType:"",nextActivityID:null,nextActivityName:"",nextActivityType:"",employeeID:null,employeeName:"",nextActivityCandidaters:[],refuseType:null,supportedStrategies:[],approvalType:1,approvalTypeOption:[{text:"通过",value:1},{text:"不通过",value:0}],remark:""}}function le(){q();const e={ID:t.value.id,IsPass:I.value.approvalType,Remark:I.value.remark,SupportedStrategies:I.value.refuseType,IsAdditionalApproval:!1,AdditionalApprovalEmployeeId:null,ActivityName:I.value.activityName,ActivityID:I.value.activityID,ActivityType:I.value.activityType,NextActivityName:I.value.nextActivityName,NextActivityID:I.value.nextActivityID,NextActivityType:I.value.nextActivityType,CandidateApprovers:I.value.nextActivityCandidaters};id.SubmitApproval(e).then((({ID:e})=>{t.value.startFlow=!1;let l=setTimeout((()=>{te(),X(e).then((()=>{ae()})).finally((()=>z())),clearTimeout(l)}),3e3)})).catch((()=>z()))}function ae(){E.value.close()}function oe(){q(),i("log","at subcontract/consumable/outwarehouse/detail/index.js:668",t.value.id),t.value.enablingApproval=!1,id.PreStartFlow(t.value.id).then((({ActivityID:e,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r})=>{if(I.value.activityID=e,I.value.activityName=l,I.value.activityType=a,I.value.nextActivityID=o,I.value.nextActivityName=n,I.value.nextActivityType=i,1!=r.length&&null!=r)I.value.employeeID=null,I.value.employeeName="";else{const{EmployeeID:e,EmployeeName:t}=r[0];I.value.employeeID=e||null,I.value.employeeName=t||""}I.value.nextActivityCandidaters=r,_.value=r.map((e=>(e.text=e.EmployeeName,e.value=e.EmployeeID,e))),x.value.open(),1==r.length&&t.value.IsStart||2==i&&t.value.IsStart?ne():z()})).catch((()=>z()))}function ne(){if(_.value.length>1&&!I.value.employeeID)return void F("请选择审批人");q();const e={ID:t.value.id,ActivityName:I.value.activityName,ActivityID:I.value.activityID,ActivityType:I.value.activityType,NextActivityName:I.value.nextActivityName,NextActivityID:I.value.nextActivityID,NextActivityType:I.value.nextActivityType,CandidateApprovers:I.value.nextActivityCandidaters};id.StartFlow(e).then((async({ID:e})=>{t.value.startFlow=!1,await A(3e3),te(),await X(e),ie()})).catch((()=>z()))}function ie(){x.value.close()}function re(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{K(e)}})}return uni.getSystemInfo({success:e=>{R.value=e.windowHeight}}),{IsScroll:e.computed((()=>{let e,t;return(R.value-60)/2>225?(e=225,t=R.value-285):e=t=(R.value-60)/2,{header:e,content:t}})),bill:t,billDetail:n,remarkVal:a,rowDetail:l,applyReasonOption:r,applyReasonHandle:function(e){t.value.applyReason.text=r.value.filter((t=>t.value==e))[0].text,t.value.applyReason.value=e},deleteOperationBtn:o,isOpened:f,uniSwipeChange:function(e,t){n.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(n.value.splice(t,1),L("移除成功"))},inputDialog:g,openEditDetailDalog:G,dialogRemarkInputConfirm:function(e){t.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:w,openRemarkDialog:function(){a.value=t.value.remark,w.value.open()},editDetailConfirm:function(e){if(l.value.Qty){if(!/^\+?[1-9][0-9]*$/.test(l.value.Qty))return void F("请输入正确的数量");n.value[N.value].Qty=parseInt(l.value.Qty),n.value[N.value].Remark=l.value.Remark,g.value.close(),J()}else F("请输入数量")},editDetailClose:function(){J()},editBillDetail:function(e){if(U&&null!==t.value.status&&1!=t.value.status)return;N.value=e;const{AvailableStockText:a,StockText:o,Stock:i,ReferenceCostText:r,ConsumableName:s,CategoryName:c,Spec:d,Model:u,Batch:m,Qty:p}=n.value[e];l.value.AvailableStockText=a,l.value.StockText=o,l.value.ReferenceCostText=r,l.value.ConsumableName=s,l.value.CategoryName=c,l.value.Spec=d,l.value.Model=u,l.value.Batch=m,l.value.Stock=i,l.value.Qty=p,G(0)},deleteDialog:C,billDelete:function(){C.value.open()},deleteDialogConfirm:function(){q(),id.Delete(t.value.id).then((()=>{et(lt.requestDrawDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:J,handleSaveDraft:function(e){t.value.isSubmit=e,t.value.warehouse.ID?t.value.outWarehouseDate?t.value.drawEmployeeID?n.value.length?t.value.isSubmit?V.value.open():Z():F("请添加入库单明细"):F("领用人员必填"):F("出库日期必填"):F("仓库必填")},submitDialog:V,submitMsgType:b,submitDialogConfirm:Z,submitDialogClose:Y,editInfoTitle:y,billDetailNumber:ee,editGetByID:X,nonEditable:U,approvalShow:function(){q(),t.value.enablingApproval=!0,id.PrevApproval(t.value.id).then((e=>{const{ActivityID:t,ActivityName:l,ActivityType:a,NextActivityID:o,NextActivityName:n,NextActivityType:i,NextActivityCandidaters:r,SupportedStrategies:s}=e[0];I.value.activityID=t,I.value.activityName=l,I.value.activityType=a,I.value.nextActivityID=o,I.value.nextActivityName=n,I.value.nextActivityType=i;const{EmployeeID:c,EmployeeName:d}=null!=r?r[0]:[];I.value.employeeID=null!=r?c:"",I.value.employeeName=null!=r?d:"",I.value.approvalType=1,I.value.refuseType=null!=s&&s.length>0?s[0]:null,I.value.remark="",I.value.nextActivityCandidaters=r,I.value.supportedStrategies=null!=s?s.map((e=>({text:1==e?"打回":2==e?"拒绝":"退回",value:e}))):[],E.value.open()})).finally((()=>z()))},approveDialog:E,approveConfirm:function(){I.value.approvalType||I.value.refuseType||0==I.value.supportedStrategies.length?I.value.approvalType||I.value.remark?le():F("请输入审批意见"):F("请选择处理方式")},submitApproval:le,approvalClose:ae,approveStartUpDialog:x,approverOption:_,approverChange:function(e){I.value.nextActivityCandidaters=_.value.filter((t=>t.EmployeeID==e))},approvalProcessData:I,enablingApprovalShow:oe,approveStartConfirm:ne,approveStartClose:ie,resetApprovalProcessData:te,jumpList:function(){tt(lt.consumableInwarehouseEditBill,(e=>{X(e)})),k("/subcontract/consumable/outwarehouse/list/list")},windowHeights:R,fab:s,fabPattern:c,fabContent:d,fabTrigger:function({index:e}){switch(e){case 0:if(null==t.value.warehouse.ID||""==t.value.warehouse.ID)return void F("请先选择仓库");re();break;case 1:if(null==t.value.warehouse.ID||""==t.value.warehouse.ID)return void F("请先选择仓库");m.value="",u.value.open();break;case 2:H.value="listDetail";break;case 3:H.value="example"}s.value.close()},scanCodeDialog:u,searchCodeVal:m,dialogsearchCodeValConfirm:function(e){const t=null==e?void 0:e.trim();""!=t&&null!=t&&null!=t?K(t):F("无效的检索条件")},addQuery:K,serachGoodsList:p,goodsDialog:v,goodsDialogConfirm:function(){let e=p.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(n.value.filter((t=>t.GoodsID==e[l].ID)).length<1)e[l].GoodsID=e[l].ID,e[l].ID=null,e[l].isOpened="none",e[l].Qty=0,e[l].Remark="",e[l].Price=0,e[l].Amount=0,e[l].Code=e[l].ConsumableCode,n.value.push(e[l]);else if(t){F("请勿添加重复资产"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}v.value.close(),p.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=p.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ID==t){a[o].checked=!1;break}},scan:re,outWarehouseDateTimeChange:function({detail:{value:e}}){U.value||(t.value.outWarehouseDate=e)},processTrackDialog:B,processTrack:function(){q(),id.GetFlowTrail(t.value.id).then((({ApprovalLog:e,ApprovalTask:t})=>{P.value=e.reverse(),O.value=t,B.value.open()})).finally((()=>z()))},processTrackCurrent:T,processTrackClickItem:function(e){T.value!=e.currentIndex&&(T.value=e.currentIndex)},processTrackApprovalLog:P,processTrackApprovalTask:O,sign:function(){uni.navigateTo({url:`/pages/system/signConfirm/signConfirm?type=1&key=201&billID=${t.value.id}`})},removeInput:function(e){switch(e){case"warehouse":t.value.warehouse.ID="",t.value.warehouse.Name="",t.value.warehouse.OID="";break;case"outWarehouseDate":t.value.outWarehouseDate="";break;case"supplierName":t.value.supplierID="",t.value.supplierName="";case"drawEmployeeName":t.value.drawOrgID="",t.value.drawOrgNameCN="",t.value.drawOrgNameEN="",t.value.drawEmployeeID="",t.value.drawEmployeeName="";break;case"remark":t.value.remark=""}},openFromWarehouseSelector:function(){uni.navigateTo({url:"/pages/selector/consumable/warehouse?disableOrg=1&isPower=1"}),tt(lt.consumableWarehouseBack,(e=>{t.value.corpID=e.corpID,t.value.warehouse.ID=e.id,t.value.warehouse.Name=e.label,t.value.warehouse.OID=e.oid}))},openToWarehouseSelector:function(){uni.navigateTo({url:"/pages/selector/consumable/warehouse?disableOrg=1"}),tt(lt.consumableWarehouseBack,(e=>{i("log","at subcontract/consumable/outwarehouse/detail/index.js:209",e),t.value.toWarehouse.ID=e.id,t.value.toWarehouse.Name=e.label,t.value.toWarehouse.OID=e.oid}))},openPersonSelector:function(){""!=t.value.corpID&&null!=t.value.corpID?(tt(lt.employeeSelectBack,(e=>{t.value.drawEmployeeID=e.ID,t.value.drawEmployeeName=e.Name,t.value.drawOrgID=e.OrgID,t.value.drawOrgNameCN=e.OrgNameCN,t.value.drawOrgNameEN=e.OrgNameEN})),uni.navigateTo({url:`/pages/selector/system/employee?ids=${[t.value.drawEmployeeID]}&corpID=${t.value.corpID} `})):F("请先选择仓库")},totalQuantity:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){var o;return null!=(o=e.Qty)?o:e+t.Qty}),0)},totalAmount:function(){return n.value.length<1?0:n.value.reduce((function(e,t,l,a){return e+t.ReferenceCost}),0)},changeCurrentInWarehouseType:function(e){t.value.currentInWarehouseType=e},orderImport:function(){null!=t.value.supplierID&&""!=t.value.supplierID?(tt(lt.consumableOrderBack,(e=>{n.value=e.map((e=>{let t={};return t.Amount=e.Amount,t.Batch="",t.BillCode=e.BillCode,t.Brand=e.Brand,t.CategoryName=e.CategoryName,t.ConsumableCode=e.ConsumableCode,t.Code=e.ConsumableCode,t.ConsumableID=e.ConsumableID,t.ConsumableName=e.ConsumableName,t.IsEnableBatch=M,t.Model=e.Model,t.BillCode=e.BillCode,t.OrderDetailID=e.ID,t.OrderID=e.BillID,t.Price=e.Price,t.Qty=e.Qty,t.Remark=e.Remark,t.Spec=e.Spec,t.Unit=e.Unit,t.WaitingInWarehouseQty=e.WaitingInWarehouseQty,t}))})),uni.navigateTo({url:`/subcontract/consumable/inwarehouse/order/order?SupplierID=${t.value.supplierID}`})):F("请选择供应商")},supplierSelector:function(){tt(lt.supplierSelectBack,(e=>{t.value.supplierID=e.ID,t.value.supplierName=e.Name})),uni.navigateTo({url:"/pages/selector/asset/supplier"})},IsEnableBatch:M,IsAutoBatchNumber:W,changeQty:function(e){},getPrice:function(){let e=1;null!=l.value.Qty&&""!=l.value.Qty&&0!=parseInt(l.value.Qty)&&(e=parseInt(l.value.Qty));let t=0;return null!=l.value.Amount&&""!=l.value.Amount&&(t=l.value.Amount),l.value.Price=Math.floor(t/e*100)/100,l.value.Price},requestDrawSelector:function(){tt(lt.consumableOutwarehouseBillRequestDrawSelectorBack,(e=>{t.value.requestDrawCode=e.BillCode,t.value.requestDrawID=e.ID})),uni.navigateTo({url:"/subcontract/consumable/outwarehouse/requestDraw/requestDraw"})},openText:function(){var e;uni.showModal({title:"查看摘要",content:null==(e=t.value.abstract)?void 0:e.replace("<br/>","\r\n"),showCancel:!1,success:function(e){}})},popup:$,isfiles:Q,select:function({tempFilePaths:t}){q(),be.uploadAttachment(t).then((t=>{Q.value=!1;const l=t.map((e=>{const t=e.FileName,l=t.lastIndexOf(".");return __spreadProps(__spreadValues({},e),{name:t,url:D(e.FileUrl),extname:t.substr(l+1)})}));j.value.push(...l),e.nextTick((()=>{Q.value=!0}))})).finally((()=>z()))},files:j,fileExtType:_s,isfiles:Q,toIndex:H}};var cd=l({components:{UniFilePicker:Zr},props:{id:String,type:String},watch:{"bill.requestDrawID"(e){i("log","at subcontract/consumable/outwarehouse/detail/detail.vue:623",e),null!=e&&""!=e&&id.QueryRequestDrawBillByID({ID:e,RequestType:1}).then((e=>{this.bill.abstract=e.Summay}))}},setup({id:e,type:t}){const{IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,outWarehouseDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openToWarehouseSelector:ye,openPersonSelector:we,totalQuantity:Ne,totalAmount:Ce,orderImport:Ee,requestDrawSelector:be,IsEnableBatch:De,IsAutoBatchNumber:Ve,changeQty:ke,getPrice:xe,openText:_e,popup:Se,select:Ie,files:Be,fileExtType:Te,isfiles:Ae,toIndex:Pe}=sd();return hs.dictionaryGetByCode("D006").then((({Items:e})=>{r.value=e.map((e=>({text:e.ItemText,value:e.ID})))})),e&&T(e),tt(lt.signBack,(()=>T(a.value.id))),{type:t,IsScroll:l,bill:a,billDetail:o,remarkVal:n,rowDetail:i,applyReasonOption:r,applyReasonHandle:s,deleteOperationBtn:c,isOpened:d,uniSwipeChange:u,uniSwipeClick:m,inputDialog:p,openEditDetailDalog:v,dialogRemarkInputConfirm:h,inputRemarkDialog:f,openRemarkDialog:g,editDetailConfirm:y,editDetailClose:w,editBillDetail:N,deleteDialog:C,billDelete:E,deleteDialogConfirm:b,resetInputDialog:D,handleSaveDraft:V,submitDialog:k,submitMsgType:x,submitDialogConfirm:_,submitDialogClose:S,editInfoTitle:I,billDetailNumber:B,editGetByID:T,nonEditable:A,approvalShow:P,approveDialog:O,approveConfirm:R,submitApproval:L,approvalClose:F,approveStartUpDialog:q,approverOption:z,approverChange:U,approvalProcessData:M,enablingApprovalShow:W,approveStartConfirm:$,approveStartClose:Q,resetApprovalProcessData:j,jumpList:H,windowHeights:K,fab:G,fabPattern:J,fabContent:Y,fabTrigger:Z,scanCodeDialog:X,searchCodeVal:ee,dialogsearchCodeValConfirm:te,addQuery:le,serachGoodsList:ae,goodsDialog:oe,goodsDialogConfirm:ne,checkBoxChange:ie,scan:re,outWarehouseDateTimeChange:se,processTrackDialog:ce,processTrack:de,processTrackCurrent:ue,processTrackClickItem:me,processTrackApprovalLog:pe,processTrackApprovalTask:ve,sign:he,removeInput:fe,openFromWarehouseSelector:ge,openToWarehouseSelector:ye,openPersonSelector:we,totalQuantity:Ne,totalAmount:Ce,orderImport:Ee,requestDrawSelector:be,IsEnableBatch:De,IsAutoBatchNumber:Ve,changeQty:ke,getPrice:xe,openText:_e,popup:Se,test:function(e){},inputBlur:function(){i.value.Qty>i.value.Stock&&(i.value.Qty=i.value.Stock)},OnlyIsClosedRequestDraw:function(e){a.value.isClosedRequestDraw=!a.value.isClosedRequestDraw},select:Ie,files:Be,fileExtType:Te,isfiles:Ae,toIndex:Pe}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-data-select"),_c),u=r(e.resolveDynamicComponent("uni-data-checkbox"),Ns),m=r(e.resolveDynamicComponent("uni-easyinput"),Ie),p=r(e.resolveDynamicComponent("uni-segmented-control"),Es),v=r(e.resolveDynamicComponent("uni-popup-cancel-dialog"),Vs),h=r(e.resolveDynamicComponent("uni-list-item"),we),f=r(e.resolveDynamicComponent("uni-list"),Ne),g=r(e.resolveDynamicComponent("uni-fab"),ul),y=r(e.resolveDynamicComponent("uni-icons"),fe),w=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),N=r(e.resolveDynamicComponent("uni-swipe-action"),ps),C=r(e.resolveDynamicComponent("uni-section"),ue),E=e.resolveComponent("uni-file-picker");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"popup",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{type:t.msgType,confirmText:"关闭",title:"查看摘要",content:o.bill.abstract,onConfirm:l[0]||(l[0]=()=>{o.popup.close()})},null,8,["type","content"])])),_:1},512),e.createVNode(c,{ref:"approveStartUpDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"启动审批流",onConfirm:o.approveStartConfirm,onClose:o.approveStartClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)]),e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批人员："),o.approverOption.length>1?(e.openBlock(),e.createBlock(d,{key:0,clear:!1,modelValue:o.approvalProcessData.employeeID,"onUpdate:modelValue":l[1]||(l[1]=e=>o.approvalProcessData.employeeID=e),localdata:o.approverOption,onChange:o.approverChange},null,8,["modelValue","localdata","onChange"])):(e.openBlock(),e.createElementBlock("text",{key:1},e.toDisplayString(o.approvalProcessData.employeeName),1))])])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"approveDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{type:"info","before-close":!0,cancelText:"取消",confirmText:"确认",title:"单据审批",onConfirm:o.approveConfirm,onClose:o.approvalClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"approve"},[e.createElementVNode("view",{class:"approve-type"},[e.createElementVNode("text",null,"审批结果："),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.approvalType,"onUpdate:modelValue":l[2]||(l[2]=e=>o.approvalProcessData.approvalType=e),localdata:o.approvalProcessData.approvalTypeOption},null,8,["modelValue","localdata"])])]),1!=o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"approve-type"},[o.approvalProcessData.supportedStrategies.length?(e.openBlock(),e.createElementBlock("text",{key:0}," 处理方式： ")):e.createCommentVNode("",!0),e.createElementVNode("view",null,[e.createVNode(u,{modelValue:o.approvalProcessData.refuseType,"onUpdate:modelValue":l[3]||(l[3]=e=>o.approvalProcessData.refuseType=e),localdata:o.approvalProcessData.supportedStrategies},null,8,["modelValue","localdata"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"approve-opinion approve-type"},[e.createElementVNode("text",null,"审批意见："),e.createElementVNode("view",null,[e.createVNode(m,{type:"textarea",modelValue:o.approvalProcessData.remark,"onUpdate:modelValue":l[4]||(l[4]=e=>o.approvalProcessData.remark=e),placeholder:"请输入内容"},null,8,["modelValue"])])]),1==o.approvalProcessData.approvalType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"approve-footer approve-type"},[e.createElementVNode("text",null,"下个节点："),e.createElementVNode("text",null,e.toDisplayString(o.approvalProcessData.nextActivityName),1)])):e.createCommentVNode("",!0)])])),_:1},8,["onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"processTrackDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(v,{title:"流程轨迹",onClose:l[5]||(l[5]=e=>o.processTrackDialog.close())},{default:e.withCtx((()=>[e.createElementVNode("view",{style:e.normalizeStyle(`height:${o.windowHeights/3}px`)},[e.createElementVNode("view",{class:"process_track_tab"},[e.createVNode(p,{current:o.processTrackCurrent,values:["待办任务","流转日志"],"style-type":"text","active-color":"#007aff",onClickItem:o.processTrackClickItem},null,8,["current","onClickItem"])]),0==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track_content"},[o.processTrackApprovalTask.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"process_track"},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"当前节点："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"创建时间："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].CreatedTime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"接收者："),e.createElementVNode("view",null,e.toDisplayString(o.processTrackApprovalTask[0].ApprovalEmployeeName),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0),1==o.processTrackCurrent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"process_track_content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.processTrackApprovalLog,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"process_track process_dividing_line",key:l},[e.createElementVNode("view",null,[e.createElementVNode("view",null,"节点名称："),e.createElementVNode("view",null,e.toDisplayString(t.FlowNodeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批人："),e.createElementVNode("view",null,e.toDisplayString(t.OperaterEmployeeName),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批时间："),e.createElementVNode("view",null,e.toDisplayString(t.OperationDatetime),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批结果："),e.createElementVNode("view",null,e.toDisplayString(t.OperationType),1)]),e.createElementVNode("view",null,[e.createElementVNode("view",null,"审批意见："),e.createElementVNode("view",null,e.toDisplayString(t.ApprovalComment),1)])])))),128)),o.processTrackApprovalLog.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"no_content"}," 暂无内容 "))])):e.createCommentVNode("",!0)],4)])),_:1})])),_:1},512),e.createVNode(c,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"deleteDialog",class:"deleteDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base",type:"error",cancelText:"取消",confirmText:"确认",title:"删除申领单",onConfirm:o.deleteDialogConfirm},null,8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"goodsDialog",class:"goodsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{title:"选择易耗品",type:"info","before-close":!0,onClose:l[6]||(l[6]=e=>o.goodsDialog.close()),onConfirm:o.goodsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"goodsDialogList",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachGoodsList,(({ID:l,ConsumableID:a,ConsumableName:n,CategoryName:i,Code:r,Brand:s,Spec:c,Model:d,Unit:u,Remark:m})=>(e.openBlock(),e.createBlock(h,{key:l},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"asset-dialog-list"},[e.createElementVNode("view",{class:"list-item"},[e.createElementVNode("text",{class:"list-item-column-title"},e.toDisplayString(n),1),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"分类："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(d),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"计量单位："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-column-list"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(m),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"take-delivery-checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,l)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:t.checked},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createVNode(f,{class:"inputDialog"},{default:e.withCtx((()=>[e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ConsumableName),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"分类：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.CategoryName),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"规格型号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.Spec)+e.toDisplayString(o.rowDetail.Model),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"可用库存：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.AvailableStockText),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"库存：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.StockText),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"数量：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createVNode(m,{border:!1,maxlength:"10",type:"number",modelValue:o.rowDetail.Qty,"onUpdate:modelValue":l[7]||(l[7]=e=>o.rowDetail.Qty=e),onBlur:l[8]||(l[8]=e=>o.inputBlur()),placeholder:"请输入数量"},null,8,["modelValue"]),e.createElementVNode("text",{class:"checka"},"*")])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"参考成本：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.createElementVNode("text",{class:"slot-box"},e.toDisplayString(o.rowDetail.ReferenceCostText),1)])])),_:1}),e.createVNode(h,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"input-dialog-body"},[e.withDirectives(e.createElementVNode("input",{style:{border:"1px solid #ccc","font-size":"14px"},class:"uni-input",placeholder:"请输入批次备注","onUpdate:modelValue":l[9]||(l[9]=e=>o.rowDetail.Remark=e)},null,512),[[e.vModelText,o.rowDetail.Remark]])])])),_:1})])),_:1})])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"选择易耗品",value:o.searchCodeVal,placeholder:"编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"request-draw-fab"},[e.createVNode(g,{ref:"fab",pattern:o.fabPattern,content:o.fabContent,horizontal:"right",vertical:"bottom",direction:"horizontal",onTrigger:o.fabTrigger},null,8,["pattern","content","onTrigger"])])),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"uni_list"},[e.createVNode(f,null,{default:e.withCtx((()=>[e.createVNode(h,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"info-item-text",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view")]))])),_:1}),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"仓库：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.warehouse.Name?"info-item-color":""]),onClick:l[10]||(l[10]=e=>o.nonEditable?null:o.openFromWarehouseSelector())},e.toDisplayString(o.bill.warehouse.Name?o.bill.warehouse.Name:"请选择仓库"),3)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.warehouse.ID?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[11]||(l[11]=e=>o.removeInput("warehouse")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"出库日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("picker",{mode:"date",onChange:l[12]||(l[12]=(...e)=>o.outWarehouseDateTimeChange&&o.outWarehouseDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.outWarehouseDate?"info-item-color":""])},e.toDisplayString(o.bill.outWarehouseDate?o.bill.outWarehouseDate:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.outWarehouseDate?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[13]||(l[13]=e=>o.removeInput("outWarehouseDate")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"checka"},"*"),e.createElementVNode("text",{class:"slot-box"},"申领人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.drawEmployeeName?"info-item-color":""]),onClick:l[14]||(l[14]=e=>o.nonEditable?null:o.openPersonSelector())},e.toDisplayString(o.bill.drawEmployeeName?o.bill.drawEmployeeName:"请选择人员"),3)])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.drawEmployeeName?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[15]||(l[15]=e=>o.removeInput("drawEmployeeName")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"关联申请单：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text"},[e.createElementVNode("text",{class:e.normalizeClass(["info-item-text",o.bill.requestDrawCode?"info-item-color":""]),onClick:l[16]||(l[16]=e=>o.nonEditable?null:o.requestDrawSelector())},e.toDisplayString(o.bill.requestDrawCode?o.bill.requestDrawCode:"请选择申请单"),3)])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.requestDrawCode?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[17]||(l[17]=e=>o.removeInput("requestDrawCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"]),o.bill.requestDrawCode?(e.openBlock(),e.createBlock(h,{key:0,disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box"},"申领摘要：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"info-item-text",onClick:l[18]||(l[18]=(...e)=>o.openText&&o.openText(...e))},e.toDisplayString(o.bill.abstract),1)])),_:1},8,["disabled"])):e.createCommentVNode("",!0),o.bill.requestDrawCode?(e.openBlock(),e.createBlock(h,{key:1,disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("checkbox",{onClick:l[19]||(l[19]=(...e)=>o.OnlyIsClosedRequestDraw&&o.OnlyIsClosedRequestDraw(...e)),checked:o.bill.isClosedRequestDraw,color:"#007aff",style:{transform:"scale(0.6)"}},null,8,["checked"]),e.createElementVNode("text",{style:{"font-size":"14px"}},"结束申领")])])),body:e.withCtx((()=>[])),_:1},8,["disabled"])):e.createCommentVNode("",!0),e.createVNode(h,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center"},[e.createElementVNode("text",{class:"slot-box ensp"},"备注：")])])),body:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-input",style:{"font-size":"14px",width:"100%","text-align":"right"},disabled:null==o.nonEditable,placeholder:"请输入备注信息","onUpdate:modelValue":l[20]||(l[20]=e=>o.bill.remark=e)},null,8,["disabled"]),[[e.vModelText,o.bill.remark]])])),footer:e.withCtx((()=>[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-icon-del"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(y,{key:0,onClick:l[21]||(l[21]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill-list-request-draw",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),"scroll-y":"",onScroll:l[23]||(l[23]=e=>o.toIndex=""),"scroll-into-view":o.toIndex},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(C,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"Statistics"}," 总数量:"+e.toDisplayString(o.totalQuantity())+" 参考成本:"+e.toDisplayString(o.totalAmount()),1),e.createElementVNode("view",{class:"bill-detail-request-draw"},[e.createVNode(N,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(w,{disabled:o.nonEditable,"right-options":o.deleteOperationBtn,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.index,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createVNode(h,null,{body:e.withCtx((()=>[e.createElementVNode("view",{class:"list-item",onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.ConsumableName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"分类："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"编码："+e.toDisplayString(t.Code),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"规格型号："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"出库数量："+e.toDisplayString(t.Qty)+e.toDisplayString(t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"参考成本："+e.toDisplayString(t.ReferenceCostText),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])])),_:2},1024)])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1})])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(C,{title:"附件",type:"line"},{default:e.withCtx((()=>[o.isfiles?(e.openBlock(),e.createBlock(E,{key:0,ref:"filePicker",limit:9,disabled:o.nonEditable,"del-icon":!o.nonEditable,"file-mediatype":"all","file-extname":o.fileExtType.all,mode:"grid",modelValue:o.files,"onUpdate:modelValue":l[22]||(l[22]=e=>o.files=e),"auto-upload":!1,onSelect:o.select,onDelete:t.deletefile,title:"最多选择9个附件"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"unload-attachment"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,type:"primary"},"上传附件"))])])),_:1},8,["disabled","del-icon","file-extname","modelValue","onSelect","onDelete"])):e.createCommentVNode("",!0)])),_:1})],44,["scroll-into-view"]),o.nonEditable?(e.openBlock(),e.createElementBlock("view",{key:1,class:"toIndex"},[e.createElementVNode("view",{onClick:l[24]||(l[24]=e=>o.toIndex="listDetail")},[e.createVNode(y,{type:"arrow-up",color:"#fff",size:"30"}),e.createElementVNode("br")]),e.createElementVNode("view",{onClick:l[25]||(l[25]=e=>o.toIndex="example")},[e.createVNode(y,{type:"arrow-down",color:"#fff",size:"30"}),e.createElementVNode("br")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"bill-footer-request-draw"},[e.createElementVNode("view",{class:"bill_list"},[o.type?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("image",{key:0,src:"/static/icon/bill_list.png",alt:"",onClick:l[26]||(l[26]=(...e)=>o.jumpList&&o.jumpList(...e))}))]),e.createElementVNode("view",null,[1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:l[27]||(l[27]=e=>o.handleSaveDraft(0))},[e.createElementVNode("text",{class:"text-overflow"},"保存草稿")])):e.createCommentVNode("",!0),1==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:l[28]||(l[28]=(...e)=>o.billDelete&&o.billDelete(...e))},[e.createElementVNode("text",{class:"uni-icon-delete text-overflow"},"删除草稿")])):e.createCommentVNode("",!0),1==o.bill.status||null==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:2,onClick:l[29]||(l[29]=e=>o.handleSaveDraft(1)),type:"primary",class:"uni-icon-submit"},[e.createElementVNode("text",{class:"text-overflow",style:{color:"#fff"}},"提交")])):e.createCommentVNode("",!0),o.bill.IsApproval?(e.openBlock(),e.createElementBlock("button",{key:3,onClick:l[30]||(l[30]=(...e)=>o.approvalShow&&o.approvalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"},"审批")])):e.createCommentVNode("",!0),o.bill.IsStart&&o.bill.startFlow?(e.openBlock(),e.createElementBlock("button",{key:4,onClick:l[31]||(l[31]=(...e)=>o.enablingApprovalShow&&o.enablingApprovalShow(...e))},[e.createElementVNode("text",{class:"text-overflow"}," 启动审批流 ")])):e.createCommentVNode("",!0),o.bill.FlowPath?(e.openBlock(),e.createElementBlock("button",{key:5,onClick:l[32]||(l[32]=(...e)=>o.processTrack&&o.processTrack(...e))},[e.createElementVNode("text",{class:"text-overflow"},"流程轨迹")])):e.createCommentVNode("",!0),7==o.bill.status?(e.openBlock(),e.createElementBlock("button",{key:6,onClick:l[33]||(l[33]=(...e)=>o.sign&&o.sign(...e))},[e.createElementVNode("text",null,"签字")])):e.createCommentVNode("",!0)])])],64)}],["__scopeId","data-v-123f42fe"]]);const ud={data:()=>({triggered:!1,isfreshing:!1,condition:{PageNO:1,PageSize:20,QST:"",QSE:"",ShowMode:0,IsClosed:!1,BillStatus:8},data:[],pageCount:0,total:0}),methods:{timeConvertDate:Ql,bindPickerChange(e){let t=this.BillType.findIndex(((t,l,a)=>t.value==e.detail.value));this.condition.BillStatus=t,this.load()},editBill(e){Xe(lt.consumableOutwarehouseBillRequestDrawSelectorBack,e),S()},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;"http://"==l.substring(0,7).toLowerCase()||"https://"==l.substring(0,8).toLowerCase()?e.condition.QST=ruleShow(l):e.condition.QST=l,e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),id.QueryRequestDrawBill(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){tt(lt.consumableAllocateConditionBack,(e=>{this.condition=e,this.condition.PageSize=10,this.condition.PageNO=1,this.load()})),uni.navigateTo({url:"/subcontract/consumable/allocate/condition/condition"})}},computed:{},mounted(){this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var md=l(ud,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"单号","onUpdate:modelValue":l[0]||(l[0]=e=>this.condition.QST=e),"confirm-type":"search",onConfirm:l[1]||(l[1]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.QST]])]),e.createElementVNode("view",{class:"QC"},[e.createElementVNode("view",{class:"icon-saoma"},[e.createElementVNode("image",{src:"/static/saoma.png",style:{width:"30px",height:"30px"},onClick:l[2]||(l[2]=(...e)=>i.ScanCode&&i.ScanCode(...e))})])])]),e.createElementVNode("scroll-view",{style:{flex:"1"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[3]||(l[3]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[4]||(l[4]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[5]||(l[5]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[6]||(l[6]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[7]||(l[7]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:e=>i.editBill(t)},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillerEmployeeName),1),e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillDateTime),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#007aff"}},"单据状态："+e.toDisplayString(t.StatusText),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"申领单号："+e.toDisplayString(t.BillCode),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"申领人员："+e.toDisplayString(t.BillerEmployeeName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"申领日期："+e.toDisplayString(t.RequestDate?t.RequestDate.substring(0,10):""),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])))),128))])],40,["refresher-triggered"])])}],["__scopeId","data-v-6a4c7c65"]]);const pd={data:()=>({BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{BillStatus:0,BillCode:"",ConsumableCategoryIDs:[],ConsumableCode:"",DrawEmployeeIDs:[],OutWarehouseEndDate:"",OutWarehouseStartDate:"",IsSetNumber:!0,ListMode:2,PageNO:1,PageSize:20,QST:"",Sort:2,SupplierIDs:[],WarehouseOrCorpIDs:[]},data:[],pageCount:0,total:0}),methods:{timeConvertDate:Ql,bindPickerChange(e){let t=this.BillType.findIndex(((t,l,a)=>t.value==e.detail.value));this.condition.BillStatus=t,this.load()},editBill(e){Xe(lt.consumableInwarehouseEditBill,e),S()},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;"http://"==l.substring(0,7).toLowerCase()||"https://"==l.substring(0,8).toLowerCase()?e.condition.QST=ruleShow(l):e.condition.QST=l,e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),id.QueryOutWarehouseBill(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,i("log","at subcontract/consumable/outwarehouse/list/list.vue:229",this.data),e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){tt(lt.consumableInwarehouseConditionBack,(e=>{this.condition=e,this.condition.PageSize=10,this.condition.PageNO=1,this.load()})),uni.navigateTo({url:"/subcontract/consumable/outwarehouse/condition/condition"})}},computed:{},mounted(){this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var vd=l(pd,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"seach_condition",onClick:l[0]||(l[0]=(...e)=>i.SettingCondition&&i.SettingCondition(...e))},[e.createElementVNode("view",{class:"icon_condition"},[e.createElementVNode("image",{src:"/static/icon/condition.png",style:{width:"26px",height:"26px"}})])]),e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"单号","onUpdate:modelValue":l[1]||(l[1]=e=>this.condition.BillCode=e),"confirm-type":"search",onConfirm:l[2]||(l[2]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.BillCode]])]),e.createElementVNode("view",{class:"QC"},[e.createElementVNode("view",{class:"icon-saoma"},[e.createElementVNode("image",{src:"/static/saoma.png",style:{width:"30px",height:"30px"},onClick:l[3]||(l[3]=(...e)=>i.ScanCode&&i.ScanCode(...e))})])])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"billStatus"},[e.createElementVNode("picker",{onChange:l[4]||(l[4]=(...e)=>i.bindPickerChange&&i.bindPickerChange(...e)),value:n.BillType[n.condition.BillStatus].value,range:n.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(n.BillType[n.condition.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[5]||(l[5]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[6]||(l[6]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[7]||(l[7]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[8]||(l[8]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[9]||(l[9]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID,onClick:e=>i.editBill(t.ID)},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillerEmployeeName)+"提交的易耗品出库单",1),e.createElementVNode("text",{style:{color:"#000"}},e.toDisplayString(t.BillDateTime),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"单号："+e.toDisplayString(t.BillCode),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#007aff"}},"单据状态："+e.toDisplayString(t.StatusText),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"仓库："+e.toDisplayString(t.WarehouseName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"出库日期："+e.toDisplayString(t.OutStockDate.substring(0,10)),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{class:"RequestDrawCode"},"关联申领单号："+e.toDisplayString(t.RequestDrawCode),1),e.createElementVNode("checkbox",{checked:t.IsClosedRequestDraw,disabled:""},"结束申领",8,["checked"])]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"金额："+e.toDisplayString(t.TotalReferenceCostAmountText),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"备注："+e.toDisplayString(t.Remark),1)])],8,["onClick"])))),128))])],40,["refresher-triggered"])])}],["__scopeId","data-v-020d1c0a"]]);var hd=()=>{const{Data:t,BillType:l,Condition:a}={Data:e.ref({BillStatus:0,BillCode:"",ConsumableCategoryIDs:[],ConsumableCode:"",DrawEmployeeIDs:[],OutWarehouseEndDate:"",OutWarehouseStartDate:"",IsSetNumber:!0,ListMode:2,PageNO:1,PageSize:20,QST:"",Sort:2,SupplierIDs:[],WarehouseOrCorpIDs:[]}),BillType:[{label:"全部",value:0},{label:"草稿",value:1},{label:"已提交",value:2},{label:"待审批",value:3},{label:"审批中",value:4},{label:"审批不通过",value:5},{label:"审批通过",value:6},{label:"待确认",value:7},{label:"已生效",value:8},{label:"已取消",value:9}],Condition:e.ref({WarehouseOrCorp:[],Person:[],Supplier:[]})};function o(e){switch(e){case"WarehouseOrCorp":t.value.WarehouseOrCorpIDs=[],a.value.WarehouseOrCorp=[];break;case"BillCode":t.value.BillCode="";break;case"OutWarehouseStartDate":t.value.OutWarehouseStartDate="";break;case"OutWarehouseEndDate":t.value.OutWarehouseEndDate="";break;case"Person":a.value.Person=[],t.value.DrawEmployeeIDs=[];break;case"Supplier":a.value.Supplier=[],t.value.SupplierIDs=[]}}return{Data:t,query:function(){Xe(lt.consumableInwarehouseConditionBack,t.value),S()},BillType:l,bindPickerChange:function(e){let a=l.findIndex(((t,l,a)=>t.value==e.detail.value));t.value.BillStatus=a},getWarehouseOrCorpText:function(){return a.value.WarehouseOrCorp.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getWarehouseOrCorpIDs:function(){uni.navigateTo({url:`/pages/selector/consumable/warehouse?ids=${t.value.HandlerOrgIDs}&multiple=1`}),tt(lt.consumableWarehouseBack,(e=>{let l=e.items.map((e=>({Name:e.label,ID:e.id})));a.value.WarehouseOrCorp=l,t.value.WarehouseOrCorpIDs=l.map((e=>e.ID))}))},bindOutWarehouseStartDatePickerChange:function(e){t.value.OutWarehouseStartDate=e.detail.value},bindOutWarehouseEndDatePickerChange:function(e){t.value.OutWarehouseEndDate=e.detail.value},clearInputText:o,reset:function(){t.value.BillStatus=0,o("WarehouseOrCorp"),o("BillCode"),o("OutWarehouseStartDate"),o("OutWarehouseEndDate"),o("Person"),o("Supplier")},getPersonText:function(){return a.value.Person.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getPersonIDs:function(){tt(lt.employeeSelectBack,(e=>{let l=e.items.map((e=>({Name:e.Name,ID:e.ID})));i("log","at subcontract/consumable/outwarehouse/condition/index.js:50",e),a.value.Person=l,t.value.DrawEmployeeIDs=l.map((e=>e.ID))})),uni.navigateTo({url:`/pages/selector/system/employee?multiple=1&ids=${t.value.DrawEmployeeIDs}`})},getSupplierText:function(){return a.value.Supplier.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},getSupplierIDs:function(){tt(lt.supplierSelectBack,(e=>{let l=e.items.map((e=>({Name:e.Name,ID:e.ID})));a.value.Supplier=l,t.value.SupplierIDs=l.map((e=>e.ID))})),uni.navigateTo({url:`/pages/selector/asset/supplier?multiple=1&ids=${t.value.SupplierIDs}`})}}};var fd=l({props:{id:String,type:String},setup({id:e,type:t}){const{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindOutWarehouseStartDatePickerChange:c,bindOutWarehouseEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v,getSupplierText:h,getSupplierIDs:f}=hd();return{Data:l,query:a,BillType:o,BillTypeIndex:n,bindPickerChange:i,getWarehouseOrCorpText:r,getWarehouseOrCorpIDs:s,bindOutWarehouseStartDatePickerChange:c,bindOutWarehouseEndDatePickerChange:d,clearInputText:u,reset:m,getPersonText:p,getPersonIDs:v,getSupplierText:h,getSupplierIDs:f}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"screen"},[e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 单据状态： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{onChange:l[0]||(l[0]=(...e)=>o.bindPickerChange&&o.bindPickerChange(...e)),value:o.BillType[o.Data.BillStatus].value,range:o.BillType.map((e=>e.label))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(o.BillType[o.Data.BillStatus].label),1)],40,["value","range"])]),e.createElementVNode("view",{class:"right"})]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 仓库： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择仓库",value:o.getWarehouseOrCorpText(),onClick:l[1]||(l[1]=(...e)=>o.getWarehouseOrCorpIDs&&o.getWarehouseOrCorpIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getWarehouseOrCorpText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[2]||(l[2]=e=>o.clearInputText("WarehouseOrCorp"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 领用人员： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择领用人员",value:o.getPersonText(),onClick:l[3]||(l[3]=(...e)=>o.getPersonIDs&&o.getPersonIDs(...e)),disabled:"true"},null,8,["value"])]),e.createElementVNode("view",{class:"right"},[o.getPersonText()?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[4]||(l[4]=e=>o.clearInputText("Person"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 入库单号： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请输入入库单号","onUpdate:modelValue":l[5]||(l[5]=e=>o.Data.BillCode=e)},null,512),[[e.vModelText,o.Data.BillCode]])]),e.createElementVNode("view",{class:"right"},[o.Data.BillCode?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[6]||(l[6]=e=>o.clearInputText("BillCode"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 出库日期起： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[7]||(l[7]=(...e)=>o.bindOutWarehouseStartDatePickerChange&&o.bindOutWarehouseStartDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.OutWarehouseStartDate?o.Data.OutWarehouseStartDate:"入库日期起"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.OutWarehouseStartDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[8]||(l[8]=e=>o.clearInputText("OutWarehouseStartDate"))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 出库日期止： "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("picker",{mode:"date",onChange:l[9]||(l[9]=(...e)=>o.bindOutWarehouseEndDatePickerChange&&o.bindOutWarehouseEndDatePickerChange(...e))},[e.createElementVNode("text",{class:"info-item-text"},e.toDisplayString(o.Data.OutWarehouseEndDate?o.Data.OutWarehouseEndDate:"入库日期止"),1)],32)]),e.createElementVNode("view",{class:"right"},[o.Data.OutWarehouseEndDate?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[10]||(l[10]=e=>o.clearInputText("OutWarehouseEndDate"))})):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"button_list"},[e.createElementVNode("button",{class:"button_item reset",onClick:l[11]||(l[11]=(...e)=>o.reset&&o.reset(...e))},"重置"),e.createElementVNode("button",{class:"button_item query",onClick:l[12]||(l[12]=(...e)=>o.query&&o.query(...e))},"查询")])])}],["__scopeId","data-v-46f56b8a"]]);const gd={data:()=>({IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,Categorys:[],Warehouse:[],QST:""}),methods:{reset(){this.IsIncludeZeroStockItems=!1,this.IsOnlyLessThanMinimunStockItems=!1,this.QST="",this.Warehouse=[],this.Categorys=[]},IncludeZeroStockItemsChange(e){this.IsIncludeZeroStockItems=e.detail.value.length>0},OnlyLessThanMinimunStockItems(e){this.IsOnlyLessThanMinimunStockItems=e.detail.value.length>0},openCategorySelector(){uni.navigateTo({url:`/pages/selector/consumable/category?ids=${this.Categorys.map((e=>e.ID))}&multiple=1`}),tt(lt.consumableCategoryBack,(e=>{let t=e.items.map((e=>({Name:e.label,ID:e.id})));this.Categorys.push(...t)}))},openWarehouseSelector(){uni.navigateTo({url:`/pages/selector/consumable/warehouse?ids=${this.Warehouse.map((e=>e.ID))}&multiple=1`}),tt(lt.consumableWarehouseBack,(e=>{let t=e.items.map((e=>({Name:e.label,ID:e.id})));this.Warehouse.push(...t)}))},query(){if(0==this.Warehouse.length)return void F("请选择仓库");let e={CategoryIDs:this.Categorys.map((e=>e.ID)),WarehouseIDs:this.Warehouse.map((e=>e.ID)),QST:this.QST,IsOnlyLessThanMinimunStockItems:this.IsOnlyLessThanMinimunStockItems,IsIncludeZeroStockItems:this.IsIncludeZeroStockItems},t=JSON.stringify(e);i("log","at subcontract/consumable/stock/condition.vue:178",e),uni.navigateTo({url:`/subcontract/consumable/stock/list?condition=${t}`})},clearCategory(){this.Categorys=[]},clearWarehouse(){this.Warehouse=[]},ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;e.QST=R(l)},fail(){F("扫描失败，请稍后重试")}})}},computed:{CategoryIDsText(){return this.Categorys.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")},WarehouseText(){return this.Warehouse.reduce(((e,t)=>""==e?t.Name:t.Name+"/"+e),"")}}};var yd=l(gd,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{class:"screen"},[e.createElementVNode("view",{class:"condition_list"},[e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left tips"}," 仓库： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择仓库","onUpdate:modelValue":l[0]||(l[0]=e=>i.WarehouseText=e),disabled:"true",onClick:l[1]||(l[1]=(...e)=>i.openWarehouseSelector&&i.openWarehouseSelector(...e))},null,512),[[e.vModelText,i.WarehouseText]])]),e.createElementVNode("view",{class:"right"},[i.WarehouseText?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[2]||(l[2]=(...e)=>i.clearWarehouse&&i.clearWarehouse(...e))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 易耗品分类： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请选择易耗品分类","onUpdate:modelValue":l[3]||(l[3]=e=>i.CategoryIDsText=e),disabled:"true",onClick:l[4]||(l[4]=(...e)=>i.openCategorySelector&&i.openCategorySelector(...e))},null,512),[[e.vModelText,i.CategoryIDsText]])]),e.createElementVNode("view",{class:"right"},[i.CategoryIDsText?(e.openBlock(),e.createElementBlock("icon",{key:0,type:"clear",size:"14",style:{"vertical-align":"bottom"},onClick:l[5]||(l[5]=(...e)=>i.clearCategory&&i.clearCategory(...e))})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"condition_item_selector"},[e.createElementVNode("view",{class:"left"}," 易耗品： "),e.createElementVNode("view",{class:"content"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input",focus:"",placeholder:"请扫描/输入易耗品编码","onUpdate:modelValue":l[6]||(l[6]=e=>n.QST=e)},null,512),[[e.vModelText,n.QST]])]),e.createElementVNode("view",{class:"right saomao"},[e.createElementVNode("view",{class:"icon-saoma"},[e.createElementVNode("image",{src:"/static/saoma.png",style:{width:"100%",height:"100%"},onClick:l[7]||(l[7]=(...e)=>i.ScanCode&&i.ScanCode(...e))})])])]),e.createElementVNode("view",{class:"selection_item"},[e.createElementVNode("view",{class:"left_control"},[e.createElementVNode("checkbox-group",{onChange:l[8]||(l[8]=(...e)=>i.IncludeZeroStockItemsChange&&i.IncludeZeroStockItemsChange(...e))},[e.createElementVNode("checkbox",{value:"cb",checked:n.IsIncludeZeroStockItems,color:"#007aff",style:{transform:"scale(0.6)"}},null,8,["checked"])],32)]),e.createElementVNode("view",{class:"right_text"},"含库存为0")]),e.createElementVNode("view",{class:"selection_item"},[e.createElementVNode("view",{class:"left_control"},[e.createElementVNode("checkbox-group",{onChange:l[9]||(l[9]=(...e)=>i.OnlyLessThanMinimunStockItems&&i.OnlyLessThanMinimunStockItems(...e))},[e.createElementVNode("checkbox",{value:"cb",checked:n.IsOnlyLessThanMinimunStockItems,color:"#007aff",style:{transform:"scale(0.6)"}},null,8,["checked"])],32)]),e.createElementVNode("view",{class:"right_text"},"仅小于最低库存")])]),e.createElementVNode("view",{class:"button_list"},[e.createElementVNode("button",{class:"button_item reset",onClick:l[10]||(l[10]=(...e)=>i.reset&&i.reset(...e))},"重置"),e.createElementVNode("button",{class:"button_item query",onClick:l[11]||(l[11]=(...e)=>i.query&&i.query(...e))},"查询")])])}],["__scopeId","data-v-6857824e"]]);const wd={data:()=>({IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1,triggered:!1,isfreshing:!1,condition:{CategoryIDs:[],WarehouseIDs:["w_8"],QST:"",PageSize:10,PageNO:1,IsIncludeZeroStockItems:!1,IsOnlyLessThanMinimunStockItems:!1},data:[],pageCount:0,total:0}),methods:{ScanCode(){let e=this;uni.scanCode({success(t){let l=t.result;e.condition.QST=getScanCode(l),e.condition.PageSize=10,e.condition.PageNO=1,e.load()},fail(){F("扫描失败，请稍后重试")}})},confirm(){this.condition.PageNO=1,this.load()},onRefresh(){this.isfreshing||(this.isfreshing=!0,this.triggered||(this.triggered=!0),this.condition.PageNO=1,this.load((()=>{this.isfreshing=!1,this.triggered=!1})))},reachBottom(){this.condition.PageNO>=this.pageCount?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++this.condition.PageNO,this.load(null,!0))},load(e,t){q(),rd.getStockList(this.condition).then((l=>{t?this.data.push(...l.Items):this.data=l.Items,this.total=l.TotalRecordQty,this.pageCount=l.PageCount,e&&e(),z()})).catch((()=>{z()}))},SettingCondition(){uni.navigateBack({delta:1})}},computed:{},mounted(){let e=getCurrentPages(),t=e[e.length-1].options;i("log","at subcontract/consumable/stock/list.vue:183",t.condition),this.condition=JSON.parse(t.condition),this.condition.PageSize=10,this.condition.PageNO=1,this.load()}};var Nd=l(wd,[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",{style:{display:"flex","flex-direction":"column",height:"100%"}},[e.createElementVNode("view",{class:"head"},[e.createElementVNode("view",{class:"seach_condition",onClick:l[0]||(l[0]=(...e)=>i.SettingCondition&&i.SettingCondition(...e))},[e.createElementVNode("view",{class:"icon_condition"},[e.createElementVNode("image",{src:"/static/icon/condition.png",style:{width:"26px",height:"26px"}})])]),e.createElementVNode("view",{class:"input_search"},[e.withDirectives(e.createElementVNode("input",{class:"uni-input seach",focus:"",placeholder:"易耗品编码/名称/商品码","onUpdate:modelValue":l[1]||(l[1]=e=>this.condition.QST=e),"confirm-type":"search",onConfirm:l[2]||(l[2]=(...e)=>i.confirm&&i.confirm(...e))},null,544),[[e.vModelText,this.condition.QST]])]),e.createElementVNode("view",{class:"QC"},[e.createElementVNode("view",{class:"icon-saoma"},[e.createElementVNode("image",{src:"/static/saoma.png",style:{width:"30px",height:"30px"},onClick:l[3]||(l[3]=(...e)=>i.ScanCode&&i.ScanCode(...e))})])])]),e.createElementVNode("view",{class:"statistics"},[e.createElementVNode("view",{class:"qty"}," 共计："+e.toDisplayString(n.total),1)]),e.createElementVNode("scroll-view",{style:{flex:"1"},"scroll-y":"true","refresher-enabled":"true","refresher-triggered":n.triggered,"refresher-threshold":100,onRefresherpulling:l[4]||(l[4]=(...e)=>t.onPulling&&t.onPulling(...e)),"lower-threshold":"10px",onScrolltolower:l[5]||(l[5]=(...e)=>i.reachBottom&&i.reachBottom(...e)),onRefresherrefresh:l[6]||(l[6]=(...e)=>i.onRefresh&&i.onRefresh(...e)),onRefresherrestore:l[7]||(l[7]=(...e)=>t.onRestore&&t.onRestore(...e)),onRefresherabort:l[8]||(l[8]=(...e)=>t.onAbort&&t.onAbort(...e))},[e.createElementVNode("view",{class:"data_list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.data,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:t.ID},[e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",{style:{color:"#000"}},"易耗品编码："+e.toDisplayString(t.ConsumableCode),1),e.createElementVNode("text",null,"易耗品名称："+e.toDisplayString(t.ConsumableName),1)]),e.createElementVNode("view",{class:"list-item-textarea"},[e.createElementVNode("text",null,"易耗品分类："+e.toDisplayString(t.CategoryName),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1),e.createElementVNode("text",null,"批次："+e.toDisplayString(t.Batch),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"最低库存："+e.toDisplayString(t.MinimumStockText+t.Unit),1),e.createElementVNode("text",null,"可用库存："+e.toDisplayString(t.AvailableStockText+t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"占用库存："+e.toDisplayString(t.UsedStockText+t.Unit),1),e.createElementVNode("text",null,"库存："+e.toDisplayString(t.StockText+t.Unit),1)]),e.createElementVNode("view",{class:"list-item-column"},[e.createElementVNode("text",null,"参考成本："+e.toDisplayString(t.ReferenceCostText),1),e.createElementVNode("text",null,"在库金额："+e.toDisplayString(t.StockAmountText),1)])])))),128))])],40,["refresher-triggered"])])}],["__scopeId","data-v-91f78e48"]]);var Cd=new class extends Je{requestDrawList({qst:e,pageNo:t,billCode:l,startRequestDrawDate:a,endRequestDrawDate:o,consumableCode:n,consumableName:i,assetCategoryIDs:r,brand:s,spec:c,model:d,IsClosed:u}){const m={IsSetNumber:!0,ShowMode:0,Sort:1,QST:e,PageNO:t,BillCode:l,StartRequestDrawDate:a,EndRequestDrawDate:o,ConsumableCode:n,ConsumableName:i,CategoryIDs:r,Brand:s,Spec:c,Model:d,IsClosed:u,PageSize:20};return this.request("/Bill/RequestDraw/List",m)}consumableFuzzyQuery(e){return this.request("/BasicData/Consumable/FuzzyQuery",{QST:e})}requestDrawSaveDraft(e){return this.request("/Bill/RequestDraw/SaveDraft",e)}requestDrawGetByID(e){return this.request("/Bill/RequestDraw/GetByID",{ID:e})}requestDrawDelete(e){return this.request("/Bill/RequestDraw/Delete",{ID:e})}requestDrawPreStartFlow(e){return this.request("/Bill/RequestDraw/PreStartFlow",{ID:e})}requestDrawStartFlow(e){return this.request("/Bill/RequestDraw/StartFlow",e)}requestDrawPrevApproval(e){return this.request("/Bill/RequestDraw/PrevApproval",{ID:e})}requestDrawSubmitApproval(e){return this.request("/Bill/RequestDraw/SubmitApproval",e)}requestDrawGetFlowTrail(e){return this.request("/Bill/RequestDraw/GetFlowTrail",{ID:e})}getStockList(e){return this.request("/Stock/List",e)}};const Ed={components:{BillEnclosure:Is,BillFooterBtn:xs},props:{id:String,type:String},setup({id:t,type:l}){const a=e.ref(""),o=e.ref({id:null,status:null,isSubmit:null,code:"",applyPersonnel:{text:h("UserName"),value:h("EmployeeID")},applyCorp:{text:h("OrgName"),value:h("OrgID")},applyDateTime:{hint:"请选择申领日期",value:$l()},applyReason:{hint:"请选择申领原因",text:"",value:null},remark:"",IsStart:!1,startFlow:!0,FlowPath:!1,IsApproval:!1,enablingApproval:!1}),n=e.ref({consumableName:"",brand:"",spec:"",model:"",qty:1}),i=e.ref([]),r=e.ref([]),s=e.ref(null),c=e.ref("");let d=e.ref([]);const u=e.ref(null),m=e.ref("none"),p=e.ref(null),v=e.ref(""),f=e.ref(null),g=e.ref(null),y=e.reactive({type:"info",cancel:"取消",confirm:"确认",title:"确认提交?"}),w=e.ref(null),N=e.ref(""),C=e.ref(!1),E=e.ref([]),b=e.ref(!1),V=e.ref("");function x(e){q(),Cd.consumableFuzzyQuery(e).then((e=>{d.value=e.map((e=>(e.checked=!1,e))),d.value.length<1?F("未查询到可用易耗品"):u.value.open()})).finally((()=>z()))}function _(e){v.value=e?"新增":"编辑",p.value.open()}function I(){n.value.consumableName="",n.value.brand="",n.value.spec="",n.value.model="",n.value.qty=1,g.value=null,p.value.close()}function B(){w.value.close()}function T(){let e={};e.ID=o.value.id,e.AddOrEdit=o.value.id?2:1,e.IsSubmit=!!o.value.isSubmit,e.RequestDate=o.value.applyDateTime.value,e.RequestDrawReason=o.value.applyReason.value,e.RequesterEmployeeID=o.value.applyPersonnel.value,e.RequesterEmployeeName=o.value.applyPersonnel.text,e.RequesterOrgID=o.value.applyCorp.value,e.RequesterOrgName=o.value.applyCorp.text,e.RequesterOrgNameCN=o.value.applyCorp.text,e.RequesterOrgNameEN=o.value.applyCorp.text,e.Remark=o.value.remark,e.Details=r.value.map(((e,t)=>{let l=e;return l.Sequence=t+1,l})),e.Attachments=E.value.map(((e,t)=>(e.Sequence=t+1,e))),q(),Cd.requestDrawSaveDraft(e).then((({Code:e,ID:t})=>{A(t).then((()=>{o.value.IsStart&&(C.value=!0)})),B()})).finally((()=>z()))}function A(e){return q(),Cd.requestDrawGetByID(e).then((({BillID:e,Status:t,Code:a,RequestDate:n,RequesterEmployeeID:i,RequesterEmployeeName:s,RequesterOrgID:c,RequesterOrgNameCN:d,RequestDrawReason:u,RequestDrawReasonText:m,Remark:p,Details:v,Attachments:h,FlowInfo:f})=>{o.value.id=e,o.value.status=t,o.value.code=a,o.value.applyDateTime.value=n?n.substring(0,10):"",o.value.applyPersonnel.value=i,o.value.applyPersonnel.text=s,o.value.applyCorp.value=c,o.value.applyCorp.text=d,o.value.applyReason.value=u,o.value.applyReason.text=m,o.value.remark=p,r.value=v,E.value=h.map((e=>(e.name=e.FileName,e.url=D(e.FileUrl),e))),b.value=1!=o.value.status&&null!=o.value.status,o.value.IsApproval=f.IsApproval,o.value.IsStart=1!=t&&!f.IsStart&&f.IsEnabledFlow,o.value.FlowPath=1!=t&&f.IsStart&&f.IsEnabledFlow||f.IsSendBack,C.value=!1,l&&"mywork"==l&&!o.value.IsApproval&&et(lt.billDetailBack).then((()=>S()))})).finally((()=>z()))}let P=e.computed((()=>{let e=0;for(let t=0;t<r.value.length;t++)e+=parseInt(r.value[t].qty);return e}));hs.dictionaryGetByCode("D006").then((({Items:e})=>{i.value=e.map((e=>({text:e.ItemText,value:e.ID})))})),t&&A(t),tt(lt.signBack,(()=>A(o.value.id))),uni.getSystemInfo({success:e=>{V.value=e.windowHeight}});let O=e.computed((()=>{let e,t;return(V.value-60)/2>225?(e=225,t=V.value-285):e=t=(V.value-60)/2,{header:e,content:t}}));return{type:l,IsScroll:O,bill:o,billDetail:r,remarkVal:a,rowDetail:n,applyReasonOption:i,applyReasonHandle:function(e){o.value.applyReason.text=i.value.filter((t=>t.value==e))[0].text,o.value.applyReason.value=e},uniSwipeActionItemRightOptions:Ot,isOpened:m,uniSwipeChange:function(e,t){r.value.isOpened=e},uniSwipeClick:function(e,t){1==e.index&&(r.value.splice(t,1),L("移除成功"))},inputDialog:p,openEditDetailDalog:_,dialogRemarkInputConfirm:function(e){o.value.remark=e.trim(),a.value=e.trim()},inputRemarkDialog:f,openRemarkDialog:function(){a.value=o.value.remark,f.value.open()},editDetailConfirm:function(e){if(n.value.consumableName)if(n.value.qty){if(!/^\+?[1-9][0-9]*$/.test(n.value.qty))return void F("请输入正确的数量");if(null==g.value){const e={ConsumableName:n.value.consumableName,Brand:n.value.brand,Spec:n.value.spec,Model:n.value.model,Qty:parseInt(n.value.qty),isOpened:"none"};r.value.push(e)}else r.value[g.value].ConsumableName=n.value.consumableName,r.value[g.value].Brand=n.value.brand,r.value[g.value].Spec=n.value.spec,r.value[g.value].Model=n.value.model,r.value[g.value].Qty=parseInt(n.value.qty);I()}else F("请输入数量");else F("请输入易耗品名称")},editDetailClose:function(){I()},editBillDetail:function(e){if(b&&null!==o.value.status&&1!=o.value.status)return;g.value=e;const{ConsumableName:t,Brand:l,Spec:a,Model:i,Qty:s}=r.value[e];n.value.consumableName=t,n.value.brand=l,n.value.spec=a,n.value.model=i,n.value.qty=s,_(0)},deleteDialogConfirm:function(){q(),Cd.requestDrawDelete(o.value.id).then((()=>{et(lt.requestDrawDetailBack).then((()=>S()))})).finally((()=>z()))},resetInputDialog:I,handleSaveDraft:function(e){if(o.value.isSubmit=e,o.value.applyDateTime.value){if(o.value.applyReason.value)return r.value.length<1?(N.value="listDetail",void F("请添加易耗品信息")):void(o.value.isSubmit?w.value.open():T());F("请选择申领原因")}else F("请选择申领日期")},submitDialog:w,submitMsgType:y,submitDialogConfirm:T,submitDialogClose:B,editInfoTitle:v,billDetailNumber:P,editGetByID:A,nonEditable:b,jumpList:function(){k("/subcontract/consumable/requestDraw/requestDrawList")},windowHeights:V,scanCodeDialog:s,searchCodeVal:c,dialogsearchCodeValConfirm:function(e){const t=e.trim();""!=t&&null!=t&&null!=t?x(t):F("无效的检索条件")},addQuery:x,serachConsumableList:d,goodsDialog:u,goodsDialogConfirm:function(){let e=d.value.filter((e=>e.checked));if(e.length<1)return void F("请勾选一条数据");let t=!0;for(let l=0,a=e.length;l<a;l++){if(r.value.filter((t=>t.ConsumableID==e[l].ConsumableID)).length<1){let t={ID:null};t.BillID=e[l].BillID,t.DetailID=e[l].DetailID,t.Code=e[l].Code,t.ConsumableID=e[l].ConsumableID,t.ConsumableName=e[l].ConsumableName,t.CategoryName=e[l].CategoryName,t.Brand=e[l].Brand,t.Spec=e[l].Spec,t.Model=e[l].Model,t.ConsumableInfo=[{label:e[l].ConsumableName,value:e[l].ConsumableID,Code:e[l].Code}],t.isOpened="none",t.Qty=1,r.value.push(t)}else if(t){F("请勿添加重复易耗品"),t=!1;const e=setTimeout((()=>{t=!0,clearTimeout(e)}),3e3)}}u.value.close(),d.value=[]},checkBoxChange:function(e,t){let l=e.detail.value,a=d.value;if(l.length>0){for(let o=0,n=a.length;o<n;o++)if(a[o].ConsumableID==t){a[o].checked=!0;break}}else for(let o=0,n=a.length;o<n;o++)if(a[o].ConsumableID==t){a[o].checked=!1;break}},scan:function(){uni.scanCode({scanType:["barCode","qrCode"],success:({result:e})=>{x(R(e))}})},applyDateTimeChange:({detail:{value:e}})=>{b.value||(o.value.applyDateTime.value=e)},removeInput:function(e){if("applyDateTime"!=e)return"applyPersonnel"==e?(o.value.applyPersonnel.text="",o.value.applyPersonnel.value=null,o.value.applyCorp.text="",void(o.value.applyCorp.value=null)):"applyReason"==e?(o.value.applyReason.text="",void(o.value.applyReason.value=null)):void("remark"!=e||(o.value.remark=""));o.value.applyDateTime.value=""},personnelSelect:function(e){tt(lt.employeeSelectBack,(({ID:t,Name:l,OrgID:a,OrgName:n})=>{o.value[e].value=t,o.value[e].text=l,o.value.applyCorp.value=a,o.value.applyCorp.text=n})),k(`pages/selector/system/employee?&multiple=0&ids=${o.value[e].value}`)},files:E,filesChange:function(e){E.value=e},toIndex:N,autoStart:C}}};var bd=l(Ed,[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-list-item"),we),u=r(e.resolveDynamicComponent("uni-list"),Ne),m=r(e.resolveDynamicComponent("uni-easyinput"),Ie),p=r(e.resolveDynamicComponent("uni-icons"),fe),v=r(e.resolveDynamicComponent("uni-data-picker"),rs),h=r(e.resolveDynamicComponent("uni-swipe-action-item"),ms),f=r(e.resolveDynamicComponent("uni-swipe-action"),ps),g=r(e.resolveDynamicComponent("uni-section"),ue),y=e.resolveComponent("BillEnclosure"),w=e.resolveComponent("BillFooterBtn");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,{ref:"inputRemarkDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"单据备注",value:o.remarkVal,placeholder:"请输入备注信息",onConfirm:o.dialogRemarkInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createVNode(c,{ref:"submitDialog",class:"submitDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{model:"base","before-close":!0,type:o.submitMsgType.type,cancelText:o.submitMsgType.cancel,confirmText:o.submitMsgType.confirm,title:o.submitMsgType.title,onConfirm:o.submitDialogConfirm,onClose:o.submitDialogClose},null,8,["type","cancelText","confirmText","title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"goodsDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{title:"选择易耗品",type:"info","before-close":!0,onClose:l[0]||(l[0]=e=>o.goodsDialog.close()),onConfirm:o.goodsDialogConfirm},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval",style:e.normalizeStyle(`height:${o.windowHeights/2}px`)},[e.createVNode(u,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.serachConsumableList,(({ConsumableID:t,ConsumableName:l,Code:a,CategoryName:n,Brand:i,Spec:r,Model:s,checked:c})=>(e.openBlock(),e.createBlock(d,{key:t},{body:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_content"},[e.createElementVNode("view",{class:"retrieval_item"},[e.createElementVNode("text",{class:"retrieval_item_title"},e.toDisplayString(l),1),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"易耗品编码："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"易耗品分类："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"规格："+e.toDisplayString(r),1)]),e.createElementVNode("view",{class:"retrieval_item_row"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(s),1)])])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"retrieval_checkbox"},[e.createElementVNode("checkbox-group",{onChange:e=>o.checkBoxChange(e,t)},[e.createElementVNode("label",null,[e.createElementVNode("checkbox",{color:"#ff5e00",checked:c},null,8,["checked"])])],40,["onChange"])])])),_:2},1024)))),128))])),_:1})],4)])),_:1},8,["onConfirm"])])),_:1},512),e.createVNode(c,{ref:"inputDialog",type:"center"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose","before-close":!0,mode:"input",title:o.editInfoTitle,onConfirm:o.editDetailConfirm,onClose:o.editDetailClose},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"edit_detail_content"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"名称：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.consumableName),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.brand),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.spec),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createElementVNode("text",{class:"item_text_content"},e.toDisplayString(o.rowDetail.model),1)])])),_:1}),e.createVNode(d,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_label"},[e.createElementVNode("text",{class:"detail_label_color"},"数量：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"detail_item_body"},[e.createVNode(m,{border:!1,maxlength:"10",type:"number",modelValue:o.rowDetail.qty,"onUpdate:modelValue":l[1]||(l[1]=e=>o.rowDetail.qty=e),placeholder:"请输入数量"},null,8,["modelValue"]),e.createElementVNode("text",{class:"required"},"*")])])),_:1})])),_:1})])])),_:1},8,["title","onConfirm","onClose"])])),_:1},512),e.createVNode(c,{ref:"scanCodeDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"易耗品搜索",value:o.searchCodeVal,placeholder:"编码/名称",onConfirm:o.dialogsearchCodeValConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.IsScroll.header}px`),"scroll-y":""},[e.createElementVNode("view",{class:"bill_header"},[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{disabled:!0},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"单号")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:"item_text_content",selectable:""},e.toDisplayString(o.bill.code?o.bill.code:"自动生成"),1)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view")]))])])),_:1}),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"申领日期：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[e.createElementVNode("picker",{mode:"date",onChange:l[2]||(l[2]=(...e)=>o.applyDateTimeChange&&o.applyDateTimeChange(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.applyDateTime.value?"content_effective":""])},e.toDisplayString(o.bill.applyDateTime.value?o.bill.applyDateTime.value:"请选择日期"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.applyDateTime.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[3]||(l[3]=e=>o.removeInput("applyDateTime")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"申领人员：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.applyPersonnel.value?"content_effective":""]),onClick:l[4]||(l[4]=e=>o.personnelSelect("applyPersonnel"))},e.toDisplayString(o.bill.applyPersonnel.value?o.bill.applyPersonnel.text:"请选择人员"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.applyPersonnel.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[5]||(l[5]=e=>o.removeInput("applyPersonnel")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"required"},"*"),e.createElementVNode("text",{class:"item_label_color"},"申领原因：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"item_text_content"},[o.nonEditable?(e.openBlock(),e.createElementBlock("text",{key:1,class:"item_text_content"},e.toDisplayString(o.bill.applyReason.value?o.bill.applyReason.text:"请选择申领原因"),1)):(e.openBlock(),e.createBlock(v,{key:0,placeholder:"请选择申领原因",border:!1,"clear-icon":!1,localdata:o.applyReasonOption,onInput:o.applyReasonHandle,modelValue:o.bill.applyReason.value,"onUpdate:modelValue":l[6]||(l[6]=e=>o.bill.applyReason.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.applyReason.value?"content_effective":""])},e.toDisplayString(o.bill.applyReason.value?o.bill.applyReason.text:"请选择申领原因"),3)])),_:1},8,["localdata","onInput","modelValue"]))])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.applyReason.value?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[7]||(l[7]=e=>o.removeInput("applyReason")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"]),e.createVNode(d,{disabled:o.nonEditable},{header:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_header_label"},[e.createElementVNode("text",{class:"item_label_color ensp"},"备注：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["item_text_content",o.bill.remark?"content_effective":""]),onClick:l[8]||(l[8]=e=>o.nonEditable?null:o.openRemarkDialog())},e.toDisplayString(o.bill.remark?o.bill.remark:"请输入备注信息"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[o.nonEditable?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"content_delete_icon"},[e.createElementVNode("view",null,[!o.nonEditable&&o.bill.remark?(e.openBlock(),e.createBlock(p,{key:0,onClick:l[9]||(l[9]=e=>o.removeInput("remark")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]))])])),_:1},8,["disabled"])])),_:1})])],4),e.createElementVNode("scroll-view",{class:"bill_detail_scroll",style:e.normalizeStyle(`height:${o.IsScroll.content}px`),onScroll:l[10]||(l[10]=e=>o.toIndex=""),"scroll-into-view":o.toIndex,"scroll-with-animation":!0,"scroll-y":""},[e.createElementVNode("view",{id:"listDetail"}),e.createVNode(g,{title:"明细列表",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"bill_detail_content"},[e.createVNode(f,null,{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.billDetail,((t,l)=>(e.openBlock(),e.createBlock(h,{disabled:o.nonEditable,"right-options":o.uniSwipeActionItemRightOptions,show:t.isOpened,"auto-close":!1,onChange:e=>o.uniSwipeChange(l),key:t.ConsumableID,onClick:e=>o.uniSwipeClick(e,l)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["detail_content_item",o.nonEditable?"disabled_color":""]),style:e.normalizeStyle(l+1==o.billDetail.length?"margin-bottom:0px":""),onClick:e.withModifiers((e=>o.editBillDetail(l)),["stop"])},[e.createElementVNode("text",{class:"content_item_title",selectable:""},"易耗品名称："+e.toDisplayString(t.ConsumableName),1),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"品牌："+e.toDisplayString(t.Brand),1),e.createElementVNode("text",null,"规格："+e.toDisplayString(t.Spec),1)]),e.createElementVNode("view",{class:"content_item_col"},[e.createElementVNode("text",null,"型号："+e.toDisplayString(t.Model),1),e.createElementVNode("text",null,"数量："+e.toDisplayString(t.Qty),1)])],14,["onClick"])])),_:2},1032,["disabled","right-options","show","onChange","onClick"])))),128))])),_:1}),o.billDetail.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:"height:100%"}," 暂 无 数 据 ")):e.createCommentVNode("",!0)])])),_:1}),e.createElementVNode("view",{id:"example"}),e.createVNode(y,{option:o.files,onChange:o.filesChange,nonEditable:o.nonEditable},null,8,["option","onChange","nonEditable"])],44,["scroll-into-view"]),e.createVNode(w,{consumable:!0,type:o.type,billType:"RequestDraw",bill:o.bill,nonEditable:o.nonEditable,autoStart:o.autoStart,onJumpList:o.jumpList,onSave:o.handleSaveDraft,onDelete:o.deleteDialogConfirm,onScrollToTop:l[11]||(l[11]=e=>o.toIndex="listDetail"),onScrollToFooter:l[12]||(l[12]=e=>o.toIndex="example"),onScan:l[13]||(l[13]=e=>o.scan()),onKeyword:l[14]||(l[14]=e=>o.scanCodeDialog.open()),onGetById:l[15]||(l[15]=e=>o.editGetByID(e))},null,8,["type","bill","nonEditable","autoStart","onJumpList","onSave","onDelete"])],64)}]]);var Dd=l({components:{DrawerAdvancedSearch:As,AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref(""),c=e.ref(""),d=e.ref(null),u=e.ref({applyCode:{hint:"申领单号",value:null},applyDateStart:{hint:"申领日期起",value:null},applyDateEnd:{hint:"申领日期止",value:null},code:{hint:"易耗品编码",value:null},name:{hint:"资产名称",value:null},brand:{hint:"品牌",value:null},spec:{hint:"规格",value:null},model:{hint:"型号",value:null},category:{hint:"易耗品分类",name:"",value:[]},IsEnd:{hint:"是否结束",name:"",value:null,options:[{text:"全部",value:"0"},{text:"是",value:"1"},{text:"否",value:"2"}]}}),m=e.ref(null),v=e.ref(""),h=e.ref("");async function f(){q();try{const{PageCount:e,Items:i,TotalRecordQty:r}=await Cd.requestDrawList({qst:t.value,pageNo:l,billCode:u.value.applyCode.value,startRequestDrawDate:u.value.applyDateStart.value,EndRequestDrawDate:u.value.applyDateEnd.value,consumableCode:u.value.code.value,consumableName:u.value.name.value,assetCategoryIDs:u.value.category.value,brand:u.value.brand.value,spec:u.value.spec.value,model:u.value.model.value,IsClosed:"0"==u.value.IsEnd.value?"":"1"==u.value.IsEnd.value});a=e,o.value=1===l?i:o.value.concat(i),n.value=r,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function g(){return l=1,f()}return f(),tt(lt.requestDrawDetailBack,g),uni.getSystemInfo({success:e=>{v.value=e.windowWidth,h.value=e.windowHeight}}),p((()=>{g()})),{qst:t,list:o,totalQty:n,toIndex:i,scrollTopDistance:r,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},refreshList:g,itemClick:function(e){k(`/subcontract/consumable/requestDraw/requestDraw?id=${e}&type=list`)},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,f())},windowWidths:v,windowHeights:h,advancedInputVal:s,advancedInputKey:c,advancedInputDialog:d,advancedSearch:u,openAdvancedInputDialog:function(e){s.value=u.value[e].value,c.value=e,d.value.open()},removeAdvancedInput:function(e){if("applyCode"!=e&&"applyDateStart"!=e&&"applyDateEnd"!=e&&"code"!=e&&"name"!=e&&"brand"!=e&&"spec"!=e&&"model"!=e)return"category"==e?(u.value[e].value=[],void(u.value[e].name=null)):void("IsEnd"==e&&(u.value[e].value=null,u.value[e].name=null));u.value[e].value=null},scanInput:function(e){uni.scanCode({scanType:["barCode","qrCode"],success:({result:t})=>{u.value[e].value=R(t)}})},conditionReset:function(){u.value.applyCode.value=null,u.value.applyDateStart.value=null,u.value.applyDateEnd.value=null,u.value.code.value=null,u.value.name.value=null,u.value.brand.value=null,u.value.spec.value=null,u.value.model.value=null,u.value.category.value=[],u.value.category.name=null,u.value.IsEnd.value=null,u.value.IsEnd.name=null},advancedInputConfirm:function(e){u.value[c.value].value=e},categorySelect:function(e){tt(lt.consumableCategoryBack,(({ids:t,names:l})=>{u.value[e].value=t,u.value[e].name=l})),k(`pages/selector/consumable/category?isLast=0&multiple=1&ids=${u.value[e].value}`)},conditionSearchPopup:m,applyDateTimeChange:({detail:{value:e}},t)=>{u.value[t].value=e},IsEndChange:function(e){u.value.IsEnd.name=u.value.IsEnd.options.filter((t=>t.value==e))[0].text,u.value.IsEnd.value=e},querySearch:function(){g(),m.value.close()},billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-popup-dialog"),al),c=r(e.resolveDynamicComponent("uni-popup"),dl),d=r(e.resolveDynamicComponent("uni-section"),ue),u=r(e.resolveDynamicComponent("uni-icons"),fe),m=r(e.resolveDynamicComponent("uni-list-item"),we),p=r(e.resolveDynamicComponent("uni-data-picker"),rs),v=r(e.resolveDynamicComponent("uni-list"),Ne),h=e.resolveComponent("DrawerAdvancedSearch"),f=e.resolveComponent("AnchorPointAndQty"),g=r(e.resolveDynamicComponent("uni-easyinput"),Ie);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(h,{ref:"conditionSearchPopup",mode:"right","mask-click":!0,width:o.windowWidths},{default:e.withCtx((()=>[e.createVNode(c,{ref:"advancedInputDialog",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(s,{ref:"inputClose",mode:"input",title:"录入检索信息",value:o.advancedInputVal,placeholder:"请输入检索信息",onConfirm:o.advancedInputConfirm},null,8,["value","onConfirm"])])),_:1},512),e.createElementVNode("view",{class:"advanced-search"},[e.createVNode(d,{title:"高级搜索",type:"line"}),e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-100}px`),"scroll-y":!0},[e.createElementVNode("view",{class:"advanced-condition_content"},[e.createVNode(v,null,{default:e.withCtx((()=>[e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"申领单号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.applyCode.value?"content_effective":""]),onClick:l[0]||(l[0]=e=>o.openAdvancedInputDialog("applyCode"))},e.toDisplayString(o.advancedSearch.applyCode.value?o.advancedSearch.applyCode.value:"申领单号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.applyCode.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[1]||(l[1]=e=>o.removeAdvancedInput("applyCode")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[2]||(l[2]=e=>o.scanInput("applyCode")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"申领日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[3]||(l[3]=e=>o.applyDateTimeChange(e,"applyDateStart"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.applyDateStart.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.applyDateStart.value?o.advancedSearch.applyDateStart.value:"申领日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.applyDateStart.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[4]||(l[4]=e=>o.removeAdvancedInput("applyDateStart")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"申领日期起：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createElementVNode("picker",{mode:"date",onChange:l[5]||(l[5]=e=>o.applyDateTimeChange(e,"applyDateEnd"))},[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.applyDateEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.applyDateEnd.value?o.advancedSearch.applyDateEnd.value:"申领日期起"),3)],32)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.applyDateEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[6]||(l[6]=e=>o.removeAdvancedInput("applyDateEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"易耗品编码：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.code.value?"content_effective":""]),onClick:l[7]||(l[7]=e=>o.openAdvancedInputDialog("code"))},e.toDisplayString(o.advancedSearch.code.value?o.advancedSearch.code.value:"易耗品编码"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.code.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[8]||(l[8]=e=>o.removeAdvancedInput("code")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[e.createVNode(u,{onClick:l[9]||(l[9]=e=>o.scanInput("code")),type:"scan",size:"16"})])])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"易耗品名称：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.name.value?"content_effective":""]),onClick:l[10]||(l[10]=e=>o.openAdvancedInputDialog("name"))},e.toDisplayString(o.advancedSearch.name.value?o.advancedSearch.name.value:"易耗品名称"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.name.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[11]||(l[11]=e=>o.removeAdvancedInput("name")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"品牌：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.brand.value?"content_effective":""]),onClick:l[12]||(l[12]=e=>o.openAdvancedInputDialog("brand"))},e.toDisplayString(o.advancedSearch.brand.value?o.advancedSearch.brand.value:"品牌"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.brand.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[13]||(l[13]=e=>o.removeAdvancedInput("brand")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"规格：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.spec.value?"content_effective":""]),onClick:l[14]||(l[14]=e=>o.openAdvancedInputDialog("spec"))},e.toDisplayString(o.advancedSearch.spec.value?o.advancedSearch.spec.value:"规格"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.spec.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[15]||(l[15]=e=>o.removeAdvancedInput("spec")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"型号：")])])),body:e.withCtx((()=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.model.value?"content_effective":""]),onClick:l[16]||(l[16]=e=>o.openAdvancedInputDialog("model"))},e.toDisplayString(o.advancedSearch.model.value?o.advancedSearch.model.value:"型号"),3)])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.model.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[17]||(l[17]=e=>o.removeAdvancedInput("model")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"易耗品分类：")])])),body:e.withCtx((()=>[e.createElementVNode("scroll-view",{style:{width:"calc(100% - 144px)"},"scroll-x":""},[e.createElementVNode("view",{class:e.normalizeClass(["selector-content_text",o.advancedSearch.category.value.length>0?"content_effective":""]),onClick:l[18]||(l[18]=e.withModifiers((e=>o.categorySelect("category")),["stop"]))},e.toDisplayString(o.advancedSearch.category.value.length>0?o.advancedSearch.category.name:"易耗品分类"),3)])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.category.value.length>0?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[19]||(l[19]=e=>o.removeAdvancedInput("category")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1}),e.createVNode(m,null,{header:e.withCtx((()=>[e.createElementVNode("view",{class:"align-item-center_label"},[e.createElementVNode("text",{class:"slot-box"},"是否结束：")])])),body:e.withCtx((()=>[e.createElementVNode("view",{class:"condition_item_text"},[e.createVNode(p,{class:"data-picker-request-draw",placeholder:"是否结束",border:!1,"clear-icon":!1,localdata:o.advancedSearch.IsEnd.options,onInput:o.IsEndChange,modelValue:o.advancedSearch.IsEnd.value,"onUpdate:modelValue":l[20]||(l[20]=e=>o.advancedSearch.IsEnd.value=e)},{default:e.withCtx((({data:t,error:l,options:a})=>[e.createElementVNode("text",{class:e.normalizeClass(["condition_item_text",o.advancedSearch.IsEnd.value?"content_effective":""])},e.toDisplayString(o.advancedSearch.IsEnd.value?o.advancedSearch.IsEnd.name:"是否结束"),3)])),_:1},8,["localdata","onInput","modelValue"])])])),footer:e.withCtx((()=>[e.createElementVNode("view",{class:"info-flex"},[e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view",null,[o.advancedSearch.IsEnd.value?(e.openBlock(),e.createBlock(u,{key:0,onClick:l[21]||(l[21]=e=>o.removeAdvancedInput("IsEnd")),type:"close",size:"16"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"content-delete_icon"},[e.createElementVNode("view")])])])),_:1})])),_:1})])],4),e.createElementVNode("view",{class:"advanced-search_button"},[e.createElementVNode("button",{onClick:l[22]||(l[22]=(...e)=>o.querySearch&&o.querySearch(...e)),type:"primary"},"查询"),e.createElementVNode("button",{onClick:l[23]||(l[23]=(...e)=>o.conditionReset&&o.conditionReset(...e))},"重置"),e.createElementVNode("button",{onClick:l[24]||(l[24]=e=>o.conditionSearchPopup.close())},"关闭")])])])),_:1},8,["width"]),e.createVNode(f,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-105,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[25]||(l[25]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createVNode(g,{prefixIcon:"search",modelValue:o.qst,"onUpdate:modelValue":l[26]||(l[26]=e=>o.qst=e),placeholder:"单号",onIconClick:o.refreshList,confirmType:"search",trim:"both",inputBorder:!1,onConfirm:o.refreshList,onClear:o.refreshList},null,8,["modelValue","onIconClick","onConfirm","onClear"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-105}px`),onScrolltolower:l[27]||(l[27]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[28]||(l[28]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({Status:t,StatusText:l,BillCode:a,BillDateTime:n,BillerEmployeeName:i,RequestDate:r,RequesterEmployeeName:s,RequestOrgName:c,RequestReasonText:d,IsClosedText:u,ID:m,Remark:p})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:m,onClick:e=>o.itemClick(m)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(a),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(l),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(l),1),e.createElementVNode("text",null,"申领人员："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申领日期："+e.toDisplayString(r?r.substring(0,10):""),1),e.createElementVNode("text",null,"申领部门："+e.toDisplayString(c),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申领原因："+e.toDisplayString(d),1),e.createElementVNode("text",null,"是否结束："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(i),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(p),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-105}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])]),e.createElementVNode("view",{class:"condition-query"},[e.createElementVNode("button",{onClick:l[29]||(l[29]=e=>o.conditionSearchPopup.open())},"高级搜索")])],64)}]]);var Vd=l({setup(){const e=h("UserName"),t=h("UserCode");return{userName:e,jobNo:t,contentDatas:[{lable:"工号",text:t},{lable:"所属部门",text:h("OrgName")}],headPhoto:"../../../static/images/touxiang.png"}},components:{}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("view",{class:"top"},[e.createElementVNode("view",{class:"top_top"},[e.createElementVNode("view",{class:"top_top_left"},[e.createElementVNode("image",{src:o.headPhoto,class:"top_top_image",mode:"aspectFit"},null,8,["src"])]),e.createElementVNode("view",{class:"top_top_right"},[e.createElementVNode("view",{class:"top_top_right_text bigtext"},e.toDisplayString(o.userName),1)])])]),e.createElementVNode("view",{class:"content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.contentDatas,((t,l)=>(e.openBlock(),e.createElementBlock("view",{class:"content_list bigtext"},[e.createElementVNode("view",{class:"content_list_left"},e.toDisplayString(t.lable),1),e.createElementVNode("view",{class:"content_list_right"},e.toDisplayString(t.text),1)])))),256))])],64)}],["__scopeId","data-v-32b457d5"]]);const kd=C.myWork;class xd extends te{constructor(e){super(e,kd)}request(e,t){return super.httpRequest(e,t)}}var _d=new class extends xd{todoWaitingApprovalBillList(e,t){const l={IsSetNumber:!0,PageNO:t,PageSize:20,Sort:1,UserId:e};return this.request("/Todo/WaitingApprovalBill/List",l)}};var Sd=l({components:{AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),r=e.ref(""),s=e.ref(0),c=e.ref(0);async function d(){q();try{const{PageCount:e,Items:t,TotalRecordQty:i}=await _d.todoWaitingApprovalBillList(h("EmployeeID"),l);a=e,o.value=1===l?t:o.value.concat(t),n.value=i,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function u(){return l=1,d()}return d(),tt(lt.billDetailBack,u),uni.getSystemInfo({success:e=>{i("log","at subcontract/mine/todo/todo.vue:137",e),c.value=e.windowHeight}}),p((()=>{u()})),{qst:t,list:o,totalQty:n,toIndex:r,scroll:function({detail:e}){s.value=e.scrollTop,r.value=""},scrollTopDistance:s,refreshList:u,itemClick:function(e,t){switch(t){case"RequestDrawDetail":k(`subcontract/asset/requestDraw/requestDraw?id=${e}&type=mywork`);break;case"drawDetail":k(`subcontract/asset/draw/drawDetail?id=${e}&type=mywork`);break;case"drawBackDetail":k(`subcontract/asset/drawBack/drawBackDetail?id=${e}&type=mywork`);break;case"WaitReceivingListAdd":k(`subcontract/asset/takeDelivery/takeDelivery?id=${e}&type=mywork`);break;case"transformDetail":k(`subcontract/asset/transform/detail?id=${e}&type=mywork`);break;case"requestDiscardDetail":k(`subcontract/asset/requestDiscard/detail?id=${e}&type=mywork`);break;case"discardDetail":k(`subcontract/asset/discard/detail?id=${e}&type=mywork`);break;case"ComRequestDrawDetail":k(`subcontract/consumable/requestDraw/requestDraw?id=${e}&type=mywork`);break;case"ComInWarehouseDetail":k(`subcontract/consumable/inwarehouse/detail/detail?id=${e}&type=mywork`);break;case"ComOutWarehouseDetail":k(`subcontract/consumable/outwarehouse/detail/detail?id=${e}&type=mywork`);break;case"ComAllocateDetail":k(`subcontract/consumable/allocate/detail/detail?id=${e}&type=mywork`);break;case"ComDiscardDetail":k(`subcontract/consumable/discard/detail/detail?id=${e}&type=mywork`)}},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,d())},windowHeights:c,billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const r=e.resolveComponent("AnchorPointAndQty");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(r,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-10,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-10}px`),onScrolltolower:l[1]||(l[1]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[2]||(l[2]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({BillStatus:t,BillName:l,BillStatusText:a,BillCode:n,BillDatetime:i,RequestDate:r,BillerOrgName:s,AssetUsageText:c,BillerEmployeer:d,BillerRequestOrgName:u,BillerRequestEmployeer:m,Remark:p,urlName:v,BillID:h,ID:f})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:f,onClick:e=>o.itemClick(h,v)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(a),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(a),1),e.createElementVNode("text",null,"单据名称："+e.toDisplayString(l),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申请日期："+e.toDisplayString(r?r.substring(0,10):""),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申请人员："+e.toDisplayString(m),1),e.createElementVNode("text",null,"申请部门："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(d),1),e.createElementVNode("text",null,"制单部门："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(p),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-10}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])])],64)}]]);var Id=new class extends xd{Done(e,t){const l={IsSetNumber:!0,PageNO:t,PageSize:20,Sort:1,UserId:e};return this.request("/Done",l)}};var Bd=l({components:{AnchorPointAndQty:Tt},setup(){const t=e.ref("");let l=1,a=-1;const o=e.ref([]),n=e.ref(0),i=e.ref(""),r=e.ref(0),s=e.ref("");async function c(){q();try{const{PageCount:e,Items:t,TotalRecordQty:i}=await Id.Done(h("EmployeeID"),l);a=e,o.value=1===l?t:o.value.concat(t),n.value=i,uni.stopPullDownRefresh(),uni.hideNavigationBarLoading()}finally{z()}}function d(){return l=1,c()}return c(),tt(lt.billDetailBack,d),uni.getSystemInfo({success:e=>{s.value=e.windowHeight}}),p((()=>{d()})),{qst:t,list:o,totalQty:n,toIndex:i,scroll:function({detail:e}){r.value=e.scrollTop,i.value=""},scrollTopDistance:r,refreshList:d,itemClick:function(e,t){switch(t){case"RequestDrawDetail":k(`subcontract/asset/requestDraw/requestDraw?id=${e}&type=list`);break;case"drawDetail":k(`subcontract/asset/draw/drawDetail?id=${e}&type=list`);break;case"drawBackDetail":k(`subcontract/asset/drawBack/drawBackDetail?id=${e}&type=list`);break;case"WaitReceivingListAdd":k(`subcontract/asset/takeDelivery/takeDelivery?id=${e}&type=list`);break;case"transformDetail":k(`subcontract/asset/transform/detail?id=${e}&type=list`);break;case"requestDiscardDetail":k(`subcontract/asset/requestDiscard/detail?id=${e}&type=list`);break;case"discardDetail":k(`subcontract/asset/discard/detail?id=${e}&type=list`);break;case"ComRequestDrawDetail":k(`subcontract/consumable/requestDraw/requestDraw?id=${e}&type=list`);break;case"ComInWarehouseDetail":k(`subcontract/consumable/inwarehouse/detail/detail?id=${e}&type=list`);break;case"ComOutWarehouseDetail":k(`subcontract/consumable/outwarehouse/detail/detail?id=${e}&type=list`);break;case"ComAllocateDetail":k(`subcontract/consumable/allocate/detail/detail?id=${e}&type=list`);break;case"ComDiscardDetail":k(`subcontract/consumable/discard/detail/detail?id=${e}&type=list`)}},reachBottom:function(){l>=a?(uni.hideNavigationBarLoading(),F("暂无更多数据")):(++l,c())},windowHeights:s,billStatusColor:Ft}}},[["render",function(t,l,a,o,n,i){const r=e.resolveComponent("AnchorPointAndQty");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(r,{qty:o.list.length,totalQty:o.totalQty,scrollAreaHeight:o.windowHeights-46,scrollTopDistance:o.scrollTopDistance,onScrollTop:l[0]||(l[0]=e=>o.toIndex="scrollTop")},null,8,["qty","totalQty","scrollAreaHeight","scrollTopDistance"]),e.createElementVNode("view",{class:"list-style"},[e.createElementVNode("view",{class:"list-content"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle(`height:${o.windowHeights-10}px`),onScrolltolower:l[1]||(l[1]=(...e)=>o.reachBottom&&o.reachBottom(...e)),onScroll:l[2]||(l[2]=(...e)=>o.scroll&&o.scroll(...e)),"scroll-into-view":o.toIndex,"scroll-with-animation":!1,"scroll-y":""},[e.createElementVNode("view",{id:"scrollTop"}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.list,(({BillStatus:t,BillName:l,BillStatusText:a,BillCode:n,BillDatetime:i,RequestDate:r,BillerOrgName:s,AssetUsageText:c,BillerEmployeer:d,BillerRequestOrgName:u,BillerRequestEmployeer:m,Remark:p,urlName:v,BillID:h,ID:f})=>(e.openBlock(),e.createElementBlock("view",{class:"list-item_card",style:{background:"#fff"},key:f,onClick:e=>o.itemClick(h,v)},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"bold",selectable:""},"单号："+e.toDisplayString(n),1)]),e.createElementVNode("view",{class:"list-item-bill_status",style:e.normalizeStyle(o.billStatusColor(t))},e.toDisplayString(a),5),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"单据状态："+e.toDisplayString(a),1),e.createElementVNode("text",null,"单据名称："+e.toDisplayString(l),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申请日期："+e.toDisplayString(r?r.substring(0,10):""),1),e.createElementVNode("text",null,"制单时间："+e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"申请人员："+e.toDisplayString(m),1),e.createElementVNode("text",null,"申请部门："+e.toDisplayString(u),1)]),e.createElementVNode("view",{class:"list-item-col"},[e.createElementVNode("text",null,"制单人员："+e.toDisplayString(d),1),e.createElementVNode("text",null,"制单部门："+e.toDisplayString(s),1)]),e.createElementVNode("view",{class:"list-item-row"},[e.createElementVNode("text",null,"单据备注："),e.createElementVNode("text",null,e.toDisplayString(p),1)])],8,["onClick"])))),128)),o.list.length<1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nothing",style:e.normalizeStyle(`height:${o.windowHeights-10}px`)}," 暂 无 数 据 ",4)):e.createCommentVNode("",!0)],44,["scroll-into-view"])])])],64)}]]);var Td=new class extends ae{modifyPassword(e){return this.request("/User/ModifyPassword",e)}getWithinLimitsByType(e){return this.request("/LabelPrint/GetWithinLimitsByType",{Type:e})}};var Ad=l({setup(){var t;const l=e.ref(null),a=e.reactive({newPassword:"",pastPassword:""}),o=null!=(t=JSON.parse(h("SystemPasswordPolicy")))?t:{},n=e.reactive({newPassword:{rules:[{required:!0,errorMessage:"新密码必填"},{validateFunction:function(e,t,l,n){if(t.trim().length<o.PasswordPolicyMinLength)n("长度不能小于"+o.PasswordPolicyMinLength+"个字符");else if(o.PasswordPolicyPasswordStrength){var i=0;/[a-z]|[A-Z]/.test(t)&&(i+=1);/\d/.test(t)&&(i+=1);/[\!\@\#\$\%\^\&\*]/.test(t)&&(i+=1),i<2&&n("密码必须包含字母、数字、特殊字符中的两种")}else a.pastPassword!=t&&n("新密码与确认密码不一致");return!0}}]},pastPassword:{rules:[{required:!0,errorMessage:"确认密码必填"},{validateFunction:function(e,t,l,n){return t.trim().length<o.PasswordPolicyMinLength?n("长度不能小于"+o.PasswordPolicyMinLength+"个字符"):a.newPassword!=t&&n("新密码与确认密码不一致"),!0}}]}});return{blur:function(){l.value.validate()},form:l,formData:a,submit:function(){l.value.validate().then((()=>{const e={ID:h("UserID"),NewPassword:a.newPassword,ReNewPassword:a.pastPassword};Td.modifyPassword(e).then((()=>{L("操作完成"),S()})).catch((e=>{F(e)})).finally((()=>z()))})).catch((e=>{i("log","at subcontract/mine/changePassword/index.vue:147","err",e)}))},goBack:function(){S()},rules:n,systemPasswordPolicy:o}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-easyinput"),Ie),c=r(e.resolveDynamicComponent("uni-forms-item"),Te),d=r(e.resolveDynamicComponent("uni-forms"),ze);return e.openBlock(),e.createElementBlock("view",{class:"upbox"},[e.createVNode(d,{ref:"form",modelValue:o.formData,rules:o.rules},{default:e.withCtx((()=>[e.createVNode(c,{label:"新 密 码",required:!0,name:"newPassword"},{default:e.withCtx((()=>[e.createVNode(s,{type:"password",modelValue:o.formData.newPassword,"onUpdate:modelValue":l[0]||(l[0]=e=>o.formData.newPassword=e),placeholder:"请输入密码",onBlur:o.blur},null,8,["modelValue","onBlur"])])),_:1}),e.createVNode(c,{label:"确认密码",required:!0,name:"pastPassword"},{default:e.withCtx((()=>[e.createVNode(s,{type:"password",modelValue:o.formData.pastPassword,"onUpdate:modelValue":l[1]||(l[1]=e=>o.formData.pastPassword=e),placeholder:"请输入密码",onBlur:o.blur},null,8,["modelValue","onBlur"])])),_:1})])),_:1},8,["modelValue","rules"]),e.createElementVNode("view",{class:"quick-return-btn"},[e.createElementVNode("button",{type:"primary",onClick:l[2]||(l[2]=(...e)=>o.submit&&o.submit(...e))},"确 认"),e.createElementVNode("button",{onClick:l[3]||(l[3]=(...e)=>o.goBack&&o.goBack(...e))},"取 消")])])}],["__scopeId","data-v-49d0e32d"]]);var Pd=l({setup(){const t=e.ref([]),l=e.ref(""),a=e.ref([]),o=e.ref("");function n(e){Gl.openPrinter(e,(e=>{e?(i("log","at subcontract/mine/printer/index.vue:103","打印机连接成功"),L("打印机连接成功")):(i("log","at subcontract/mine/printer/index.vue:106","打印机连接失败，请重新选择！"),F("打印机连接失败"))}))}return o.value="object"==typeof h("SelectLabelTemplate")?h("SelectLabelTemplate").LabelName:"",l.value="object"==typeof h("SelectPrinter")?h("SelectPrinter").name:"",l.value&&n(l.value),{printerList:t,selectPrinterFunc:async function(){q();try{const e=await Gl.getPrinters();e.length>0?(t.value=e,uni.showActionSheet({itemList:e.map((e=>e.name)),success:function(e){l.value=t.value[e.tapIndex].name,v("SelectPrinter",t.value[e.tapIndex]),n(l.value)},fail:function(e){i("log","at subcontract/mine/printer/index.vue:88",e.errMsg)}})):F("未检测到打印机")}finally{z()}},selectPrinterName:l,templateList:a,selectTemplateFunc:function(){q(),Td.getWithinLimitsByType(1).then((e=>{e.length>0?(a.value=e,uni.showActionSheet({itemList:e.map((e=>e.LabelName)),success:function(e){o.value=a.value[e.tapIndex].LabelName,v("SelectLabelTemplate",a.value[e.tapIndex])},fail:function(e){i("log","at subcontract/mine/printer/index.vue:132",e.errMsg)}})):F("无可用模板")})).catch((e=>{F(e)})).finally((()=>z()))},selectTemplateName:o,refreshFunc:function(){n(l.value)},testPrinterFunc:async function(){await Gl.isPrinterOpened()&&(await Gl.startJob({width:45,height:20}),await Gl.drawLine({x1:0,y1:5,x2:45,y2:5,lineWidth:.5}),await Gl.drawDashLine({x1:0,y1:10,x2:45,y2:10,dashLen:[.5,.5],lineWidth:.5}),await Gl.drawDashLine({x1:0,y1:15,x2:45,y2:15,dashLen:[.5,.75,1],lineWidth:.5}),await Gl.commitJob())}}}},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-list-item"),we),c=r(e.resolveDynamicComponent("uni-list"),Ne);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(s,{title:"蓝牙打印机列表",clickable:"",showArrow:"",onClick:o.selectPrinterFunc,rightText:`${o.selectPrinterName}`},null,8,["onClick","rightText"]),e.createVNode(s,{title:"标签模板",clickable:"",showArrow:"",onClick:o.selectTemplateFunc,rightText:`${o.selectTemplateName}`},null,8,["onClick","rightText"])])),_:1}),e.createElementVNode("view",{class:"quick-return-btn"},[e.createElementVNode("button",{type:"primary",onClick:l[0]||(l[0]=(...e)=>o.refreshFunc&&o.refreshFunc(...e))},"刷新")])],64)}],["__scopeId","data-v-02b3380f"]]);var Od=l({setup:()=>({appVersion:h("SystemVersion")})},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-list-item"),we),c=r(e.resolveDynamicComponent("uni-list"),Ne);return e.openBlock(),e.createElementBlock("view",{class:"about"},[e.createElementVNode("view",{class:"Logo"},[e.createElementVNode("image",{src:"/static/icon/logo.png"})]),e.createElementVNode("view",{class:"listInfo"},[e.createVNode(c,{border:!1},{default:e.withCtx((()=>[e.createVNode(s,{title:"版本：",note:o.appVersion,border:!1},null,8,["note"]),e.createVNode(s,{title:"技术支持邮箱：",note:"changejet@kibon.cn",border:!1}),e.createElementVNode("view",{class:"userAgree"},[e.createVNode(s,{title:"其他：",note:"《用户协议/隐私政策》",link:"navigateTo",to:"/subcontract/mine/aboutSystem/userAgreement",border:!1})])])),_:1})])])}],["__scopeId","data-v-217a6366"]]);var Rd=l({setup(){}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("web-view",{src:"http://saas.houqinstar.com/UserPrivacy.html"})])}]]);var Ld=l({setup:()=>({listInfo:e.reactive([{title:"PC端操作手册",filePath:"/static/畅捷实物资产管理系统（后勤之星）操作手册（202109更新）.pdf"},{title:"APP端操作手册",filePath:"/static/畅捷实物资产管理系统（后勤之星）手机APP操作手册（202109更新）.pdf"},{title:"员工账户操作手册",filePath:"/static/畅捷实物资产管理系统（后勤之星）操作手册（员工账户）（202109更新）.pdf"},{title:"辅助工具操作手册",filePath:"/static/辅助工具操作手册2021-06.pdf"}])})},[["render",function(t,l,a,o,n,i){const s=r(e.resolveDynamicComponent("uni-list-item"),we),c=r(e.resolveDynamicComponent("uni-list"),Ne);return e.openBlock(),e.createElementBlock("view",{class:"listInfo"},[e.createVNode(c,{border:!1},{default:e.withCtx((()=>[e.createElementVNode("view",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.listInfo,(({title:t,filePath:l})=>(e.openBlock(),e.createBlock(s,{title:t,link:"navigateTo",to:`/subcontract/mine/help/onlinePDF?filePath=${l}`},null,8,["title","to"])))),256))])])),_:1})])}]]);var Fd=l({props:{filePath:String},setup(t){let l=e.reactive("");return l=`${D("")}/pdfjs/web/viewer.html?path=${encodeURIComponent(D("")+"/static/辅助工具操作手册2021-06.pdf")}`,t&&t.filePath?l=l.split("=")[0]+"="+encodeURIComponent(D("")+t.filePath):F("未配置文件"),i("warn","at subcontract/mine/help/onlinePDF.vue:41",l),{hostPath:l,webviewStyles:{progress:{color:"#FF3333"}}}}},[["render",function(t,l,a,o,n,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("web-view",{"webview-styles":o.webviewStyles,src:o.hostPath},null,8,["webview-styles","src"])])}]]);__definePage("pages/login/login",de),__definePage("pages/home/home",_e),__definePage("pages/login/setting",Ue),__definePage("pages/selector/consumable/warehouse",at),__definePage("pages/selector/consumable/category",ot),__definePage("pages/selector/system/employee",ct),__definePage("pages/selector/asset/location",ut),__definePage("pages/selector/system/corpDept",vt),__definePage("pages/selector/asset/category",ht),__definePage("pages/selector/asset/supplier",ft),__definePage("pages/system/signConfirm/signConfirm",St),__definePage("pages/system/sign/sign",Bt),__definePage("subcontract/asset/myAssetList/list",Ut),__definePage("subcontract/asset/assetInfo/assetView",Yo),__definePage("subcontract/asset/assetInfo/assetPicture",es),__definePage("subcontract/asset/requestDraw/requestDraw",Ts),__definePage("subcontract/asset/requestDraw/requestDrawList",Ps),__definePage("subcontract/asset/repair/request/repairRequestList",Rs),__definePage("subcontract/asset/repair/request/repairRequestDetail",Fs),__definePage("subcontract/asset/borrowReturn/canBorrow/list",zs),__definePage("subcontract/asset/borrowReturn/quickBorrow/quickBorrow",Us),__definePage("subcontract/asset/borrowReturn/quickReturn/quickReturn",Ms),__definePage("subcontract/asset/inventory/employee/list",$s),__definePage("subcontract/asset/inventory/employee/detail",Qs),__definePage("subcontract/asset/inventory/employee/stockConfirm",Hs),__definePage("subcontract/asset/inventory/manageUser/list",Ks),__definePage("subcontract/asset/inventory/manageUser/detail",Js),__definePage("subcontract/asset/inventory/manageUser/inventoryConfirm",Zs),__definePage("subcontract/asset/inventory/manageUser/register",ec),__definePage("subcontract/asset/assetList/list",lc),__definePage("subcontract/asset/draw/drawDetail",nc),__definePage("subcontract/asset/draw/drawList",ic),__definePage("subcontract/asset/drawBack/drawBackDetail",cc),__definePage("subcontract/asset/drawBack/drawBackList",dc),__definePage("subcontract/asset/discard/detail",pc),__definePage("subcontract/asset/discard/list",vc),__definePage("subcontract/asset/repair/result/detail",gc),__definePage("subcontract/asset/requestDiscard/detail",Nc),__definePage("subcontract/asset/requestDiscard/list",Cc),__definePage("subcontract/asset/transform/detail",Dc),__definePage("subcontract/asset/transform/list",Vc),__definePage("subcontract/asset/assetInfo/scanCode",kc),__definePage("subcontract/asset/repair/record/list",xc),__definePage("subcontract/consumable/allocate/detail/detail",Bc),__definePage("subcontract/consumable/allocate/condition/condition",Ac),__definePage("subcontract/consumable/allocate/list/list",Oc),__definePage("subcontract/consumable/discard/detail/detail",Fc),__definePage("subcontract/consumable/discard/condition/condition",zc),__definePage("subcontract/consumable/inventory/taskDetail",Wc),__definePage("subcontract/consumable/inventory/inventoryConfirm",Qc),__definePage("subcontract/consumable/discard/list/list",Hc),__definePage("subcontract/consumable/inventory/list",Kc),__definePage("subcontract/consumable/inventory/condition",Jc),__definePage("subcontract/consumable/inwarehouse/detail/detail",Xc),__definePage("subcontract/consumable/inwarehouse/order/order",td),__definePage("subcontract/consumable/inwarehouse/list/list",ad),__definePage("subcontract/consumable/inwarehouse/condition/condition",nd),__definePage("subcontract/consumable/outwarehouse/detail/detail",cd),__definePage("subcontract/consumable/outwarehouse/requestDraw/requestDraw",md),__definePage("subcontract/consumable/outwarehouse/list/list",vd),__definePage("subcontract/consumable/outwarehouse/condition/condition",fd),__definePage("subcontract/consumable/stock/condition",yd),__definePage("subcontract/consumable/stock/list",Nd),__definePage("subcontract/consumable/requestDraw/requestDraw",bd),__definePage("subcontract/consumable/requestDraw/requestDrawList",Dd),__definePage("subcontract/mine/index/index",Vd),__definePage("subcontract/mine/todo/todo",Sd),__definePage("subcontract/mine/done/done",Bd),__definePage("subcontract/mine/changePassword/index",Ad),__definePage("subcontract/mine/printer/index",Pd),__definePage("subcontract/mine/aboutSystem/index",Od),__definePage("subcontract/mine/aboutSystem/userAgreement",Rd),__definePage("subcontract/mine/help/index",Ld),__definePage("subcontract/mine/help/onlinePDF",Fd);const qd={setup(){u((()=>{uni.getSystemInfo({success:e=>{i("log","at App.vue:11","success"),v("windowHeight",e.windowHeight)}}),plus.screen.lockOrientation("portrait-primary"),uni.addInterceptor("navigateTo",{success(){!1===xe(Q().route)&&A(50).then((()=>{xe(Q().route)}))}}),i("log","at App.vue:24","App Launch")})),c((()=>{i("log","at App.vue:27","App Show")})),d((()=>{i("log","at App.vue:30","App Hide")}))}};var zd=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",UniSection:ue,UniPopupCancelDialog:Vs,uIcon:a,UniFilePicker:Zr});const Ud=new Ml({modules:{asset:{namespaced:!0,state:()=>({info:{},pictures:[],attachments:[]}),mutations:{initAsset(e,{Asset:t,AssetPics:l,Attachments:a}){e.info=t,e.pictures=l,e.attachments=a}},getters:{}},inventory:{namespaced:!0,state:()=>({employee:{item:{}},manageUser:{item:{}}}),mutations:{setEmployeeItem(e,t){e.employee.item=t},setmanageUserItem(e,t){e.manageUser.item=t}},getters:{}},repairRecord:{namespaced:!0,state:()=>({detailInfo:{data:{}}}),mutations:{setrepairRecordInfo(e,t){e.detailInfo.data=t}}}}});const{app:Md,Vuex:Wd,Pinia:$d}=function(){const t=e.createVueApp(qd);for(const[e,l]of Object.entries(zd))t.component(e,l);return t.use(Ud),t.component(),{app:t}}();uni.Vuex=Wd,uni.Pinia=$d,Md.provide("__globalStyles",__uniConfig.styles),Md._component.mpType="app",Md._component.render=()=>{},Md.mount("#app")}(Vue,uni.VueShared);
